(function(){
var hola_ldr_require;(function(){if(!navigator||!navigator.userAgent||/ MSIE [1-8]\./.test(navigator.userAgent)){return}var E={};hola_ldr_require=E;E.zdot=function(name){

return {
json: "{\"loader\":{\"debug\":true,\"rules\":[{\"browser\":\"chrome\",\"cdn\":1},{\"browser\":\"firefox\",\"cdn\":1},{\"browser\":\"ie\",\"cdn\":1},{\"browser\":\"opera\",\"cdn\":1}],\"cdn_filter\":\"^(184.164.147.6|66.90.111.2|198.16.82.50|192.240.106.106)$\",\"post_message_wrapper\":true,\"multiplayer\":true,\"load_perf\":true,\"stub_modules\":[],\"autodetect\":{\"dailymotion\":{\"use_detection_api\":true}},\"vstat\":{\"load\":false},\"real_random\":false},\"zones\":{\"bootstrap\":{\"loader\":{\"match\":{\"url\":[\"holacdn.com/(cdn_)?(fun2|playground)\"],\"js\":\"var match = {\\\"url\\\":\\\"holacdn.com/(cdn_)?(fun2|playground)\\\"};\\nfunction url(opt, match){\\n    return new RegExp(match.url).test(opt.url);\\n}\\nreturn url(opt, match);\",\"country\":{}},\"rules\":[{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"order\":4,\"agent\":{\"cache\":{\"unicode_bom_fix\":true},\"origins\":[{\"__RegExp__\":\"/.*/m\"},\"makostore-hd.ctedgecdn.net\",\"player.h-cdn.org\"],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:30:04.000Z\"},\"id\":4}},\"cdn\":{\"bwsaver\":{\"before_play_buffer\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"mirror_origins\":false,\"zone_init_count\":100,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"monitor\":{},\"origin_control\":[{\"group\":\"/.*/m\",\"sources\":[{\"__RegExp__\":\"/.*/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.*/m\"},\"apply\":\"dont_change\"}]}]},{\"group\":\"makostore-hd.ctedgecdn.net\",\"sources\":[\"makostore-hd.ctedgecdn.net\"],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":\"makostore-hd.ctedgecdn.net\",\"apply\":\"dont_change\"}]}]},{\"group\":\"player.h-cdn.org\",\"sources\":[\"player.h-cdn.org\"],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":\"player.h-cdn.org\",\"apply\":\"dont_change\"}]}]}],\"player\":{\"allow_late_attach\":60,\"allow_stats_late_attach\":true,\"vjs\":{\"reload_max_pos\":60},\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"jwplayer\":{\"use_hap_provider\":true}},\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"dailymotion\":true,\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}}},\"ads\":{\"loader\":{\"match\":{\"url\":[\"holacdn.com/fun2\"],\"js\":\"var match = {\\\"video_url\\\":\\\"//player.h-cdn.org/static/.*/ad_.*\\\"};\\nfunction video_url(opt, match){\\n    return new RegExp(match.video_url).test(opt.video_url);\\n}\\nreturn video_url(opt, match);\",\"country\":{},\"video_url\":[\"//player.h-cdn.org/static/.*/ad_.*\"]},\"rules\":[{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"order\":3,\"agent\":{\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:29:59.000Z\"},\"id\":4}},\"cdn\":{\"bwsaver\":{\"before_play_buffer\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"hidden\":0,\"mirror_origins\":true,\"zone_init_count\":4,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"portal\":{\"agent\":{\"fast_servers\":{\"disable\":false},\"efast\":\"all\",\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"cdn\":{\"single_copy\":{\"in_parallel\":6},\"graph\":\"newgraph_progress_mode_highlight_tips\",\"bwsaver\":{\"before_play_buffer\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true}},\"loader\":{\"match\":{\"url\":[\"holacdn\\\\.com|\\\\/org\\\\.hola\\\\.cdndemo\\\\/\"],\"js\":\"var match = {\\\"url\\\":\\\"holacdn\\\\\\\\.com|\\\\\\\\/org\\\\\\\\.hola\\\\\\\\.cdndemo\\\\\\\\/\\\"};\\nfunction url(opt, match){\\n    return new RegExp(match.url).test(opt.url);\\n}\\nreturn url(opt, match);\",\"country\":{},\"fast_servers\":{\"disable\":true}},\"rules\":[{\"browser\":\"webos_app\",\"os\":\"webos\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"safari\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"order\":8,\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:31:55.000Z\"},\"id\":4}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"mirror_origins\":false,\"times_inited\":23,\"zone_init_count\":100,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"demo\":{\"fallback_delay\":120000},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"fastest\":{\"agent\":{\"fast_servers\":{\"disable\":true},\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"cdn\":{\"single_copy\":{\"in_parallel\":4},\"graph\":\"newgraph_progress_mode_highlight_tips\",\"send_reqs\":{\"origin_as_fastest\":true,\"hola\":{},\"origin\":{}},\"bwsaver\":{\"before_play_buffer\":true},\"overload\":{\"if_not_loaded\":true}},\"loader\":{\"match\":{\"url\":[\"holacdn.com\"],\"js\":\"var match = {\\\"url\\\":\\\"holacdn.com\\\"};\\nfunction url(opt, match){\\n    return new RegExp(match.url).test(opt.url);\\n}\\nreturn url(opt, match);\",\"country\":{}},\"rules\":[{\"browser\":\"safari\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"order\":12,\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:30:32.000Z\"},\"id\":4}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"hidden\":0,\"mirror_origins\":false,\"times_inited\":1,\"zone_init_count\":26,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"secure\":{\"agent\":{\"origin\":{\"ssl\":true},\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"loader\":{\"match\":{\"url\":[\"demo_secure=1\"],\"js\":\"var match = {\\\"url\\\":\\\"demo_secure=1\\\"};\\nfunction url(opt, match){\\n    return new RegExp(match.url).test(opt.url);\\n}\\nreturn url(opt, match);\",\"country\":{}},\"rules\":[{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"order\":9,\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:32:47.000Z\"},\"id\":4}},\"cdn\":{\"bwsaver\":{\"before_play_buffer\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"mirror_origins\":false,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"github_examples\":{\"cdn\":{\"media\":{\"mp4box\":false,\"mp4_exact_seek\":true},\"bwsaver\":{\"before_play_buffer\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"order\":10,\"agent\":{\"origins\":[{\"__RegExp__\":\"/(?:)/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:30:51.000Z\"},\"id\":4}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"mirror_origins\":false,\"times_inited\":5,\"zone_init_count\":100,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"loader\":{\"match\":{\"js\":\"var match = {\\\"url\\\":\\\"hola.github.io/\\\"};\\nfunction url(opt, match){\\n    return new RegExp(match.url).test(opt.url);\\n}\\nreturn url(opt, match);\",\"country\":{},\"url\":[\"hola.github.io/\"]},\"rules\":[{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"monitor\":{},\"origin_control\":[{\"group\":\"/(?:)/m\",\"sources\":[{\"__RegExp__\":\"/(?:)/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/(?:)/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"mp4box\":{\"cdn\":{\"media\":{\"mp4box\":true,\"try\":false},\"bwsaver\":{\"before_play_buffer\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"order\":11,\"agent\":{\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:31:09.000Z\"},\"id\":4}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"hidden\":0,\"mirror_origins\":true,\"zone_init_count\":1,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"loader\":{\"match\":{\"js\":\"var match = {\\\"url\\\":\\\"http://hk.dv.nextmedia.com\\\"};\\nfunction url(opt, match){\\n    return new RegExp(match.url).test(opt.url);\\n}\\nreturn url(opt, match);\",\"country\":{},\"url\":[\"http://hk.dv.nextmedia.com\"]},\"rules\":[{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chrome\",\"os\":\"windows\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"os\":\"windows\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"all_br\":{\"order\":5,\"agent\":{\"efast\":\"all\",\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"allow_fast_as_single\":true,\"fast\":{\"limit\":1},\"single\":{\"limit\":3}},\"whitelist\":[\"zagent1508\",\"zagent1352\",\"zagent885\",\"zagent37\"]},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:30:00.000Z\"},\"id\":4}},\"cdn\":{\"graph\":\"newgraph_progress_mode_highlight_tips\",\"bwsaver\":{\"before_play_buffer\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"hidden\":0,\"mirror_origins\":true,\"times_inited\":3,\"zone_init_count\":100,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"loader\":{\"match\":{\"js\":\"var match = {\\\"country\\\":{\\\"exclude\\\":[],\\\"include\\\":[\\\"br\\\"]}};\\nfunction country(opt, match){\\n    var whitelisted, blacklisted;\\n    if (match.country.include && match.country.include.length)\\n        whitelisted = match.country.include.includes(opt.country);\\n    else\\n        whitelisted = true;\\n    if (match.country.exclude && match.country.exclude.length)\\n        blacklisted = !match.country.exclude.includes(opt.country);\\n    else\\n        blacklisted = true;\\n    return whitelisted&&blacklisted;\\n}\\nreturn country(opt, match);\",\"country\":{\"include\":[\"br\"]}},\"rules\":[{\"browser\":\"safari\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"exact_seek\":{\"order\":13,\"agent\":{\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:30:18.000Z\"},\"id\":4}},\"cdn\":{\"bwsaver\":{\"lowcost_watermark_sec\":10,\"before_play_buffer\":true},\"media\":{\"mp4_exact_seek\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"hidden\":0,\"mirror_origins\":true,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"loader\":{\"match\":{\"js\":\"return false;\",\"country\":{}},\"rules\":[{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"onion_hls\":{\"order\":1,\"agent\":{\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:31:28.000Z\"},\"id\":4}},\"cdn\":{\"bwsaver\":{\"estimated_sec\":false,\"before_play_buffer\":true},\"method\":{\"hola_adaptive\":true,\"hola_adaptive_stats_no_skip\":true},\"send_reqs\":{\"disable_streaming\":true,\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"hidden\":0,\"mirror_origins\":true,\"zone_init_count\":1,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"loader\":{\"dailymotion\":{\"load\":true},\"match\":{\"allow_frame_match\":true,\"js\":\"var match = {\\\"browser\\\":[\\\"chrome\\\",\\\"chromium_based\\\",\\\"firefox\\\",\\\"ie\\\",\\\"opera\\\"],\\\"url\\\":\\\"onionstudios.com\\\",\\\"video_url\\\":\\\"m3u8\\\"};\\nfunction url_or_frame(opt, match){\\n    var re = new RegExp(match.url);\\n    return re.test(opt.url) || re.test(opt.frame_url);\\n}\\nfunction video_url(opt, match){\\n    return new RegExp(match.video_url).test(opt.video_url);\\n}\\nfunction browser(opt, match){\\n    if (typeof match.browser=='string')\\n        return match.browser=='*' || opt.browser==match.browser;\\n    return match.browser.includes(opt.browser);\\n}\\nreturn url_or_frame(opt, match) && video_url(opt, match) && browser(opt, match);\",\"country\":{},\"url\":[\"onionstudios.com\"],\"video_url\":[\"m3u8\"]},\"rules\":[{\"browser\":\"chrome\",\"cdn\":0,\"bwsaver\":0,\"stats\":1},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"player\":{\"jwplayer\":{\"prevent_background_video\":true,\"register_hls_provider\":true,\"use_hap_provider\":true},\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true},\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"dailymotion\":true,\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}}},\"onion_mp4\":{\"order\":2,\"agent\":{\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:31:38.000Z\"},\"id\":4}},\"cdn\":{\"bwsaver\":{\"estimated_sec\":false,\"before_play_buffer\":true},\"method\":{\"hola_adaptive\":true,\"hola_adaptive_stats_no_skip\":true},\"send_reqs\":{\"disable_streaming\":true,\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"hidden\":0,\"mirror_origins\":true,\"zone_init_count\":1,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"loader\":{\"dailymotion\":{\"load\":true},\"match\":{\"allow_frame_match\":true,\"js\":\"var match = {\\\"url\\\":\\\"onionstudios.com\\\",\\\"video_url\\\":\\\"mp4\\\"};\\nfunction url_or_frame(opt, match){\\n    var re = new RegExp(match.url);\\n    return re.test(opt.url) || re.test(opt.frame_url);\\n}\\nfunction video_url(opt, match){\\n    return new RegExp(match.video_url).test(opt.video_url);\\n}\\nreturn url_or_frame(opt, match) && video_url(opt, match);\",\"country\":{},\"url\":[\"onionstudios.com\"],\"video_url\":[\"mp4\"]},\"rules\":[{\"browser\":\"chrome\",\"cdn\":0,\"bwsaver\":0,\"stats\":1},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"player\":{\"jwplayer\":{\"prevent_background_video\":true,\"register_hls_provider\":true,\"use_hap_provider\":true},\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true},\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"dailymotion\":true,\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}}},\"portal_hls\":{\"order\":7,\"agent\":{\"efast\":\"all br in\",\"fast_servers\":{\"disable\":false},\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/colin@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2017-01-23T17:39:28.000Z\"},\"id\":20}},\"cdn\":{\"graph\":\"newgraph_progress_mode_highlight_tips\",\"bwsaver\":{\"before_play_buffer\":true},\"method\":{\"hola_adaptive\":true},\"send_reqs\":{\"disable_streaming\":true,\"hola\":{},\"origin\":{}},\"single_copy\":{\"in_parallel\":6},\"overload\":{\"if_not_loaded\":true}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"mirror_origins\":false,\"times_inited\":27,\"zone_init_count\":100,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"loader\":{\"match\":{\"js\":\"var match = {\\\"url\\\":\\\"holacdn.com\\\",\\\"video_url\\\":\\\"\\\\\\\\.m3u8$\\\"};\\nfunction url(opt, match){\\n    return new RegExp(match.url).test(opt.url);\\n}\\nfunction video_url(opt, match){\\n    return new RegExp(match.video_url).test(opt.video_url);\\n}\\nreturn url(opt, match) && video_url(opt, match);\",\"country\":{},\"fast_servers\":{\"disable\":true},\"url\":[\"holacdn.com\"],\"video_url\":[\"\\\\.m3u8$\"]},\"rules\":[{\"browser\":\"safari\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"demo\":{\"fallback_delay\":120000},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"portal_hls_live\":{\"order\":6,\"agent\":{\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:32:32.000Z\"},\"id\":4}},\"cdn\":{\"graph\":\"newgraph_progress_mode_highlight_tips\",\"bwsaver\":{\"before_play_buffer\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"hidden\":0,\"mirror_origins\":true,\"times_inited\":2,\"zone_init_count\":100,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"loader\":{\"match\":{\"js\":\"var match = {\\\"url\\\":\\\"holacdn\\\\\\\\.com.+?mode=live\\\",\\\"video_url\\\":\\\"\\\\\\\\.m3u8$\\\"};\\nfunction url(opt, match){\\n    return new RegExp(match.url).test(opt.url);\\n}\\nfunction video_url(opt, match){\\n    return new RegExp(match.video_url).test(opt.video_url);\\n}\\nreturn url(opt, match) && video_url(opt, match);\",\"country\":{},\"url\":[\"holacdn\\\\.com.+?mode=live\"],\"video_url\":[\"\\\\.m3u8$\"]},\"rules\":[{\"browser\":\"safari\",\"cdn\":0,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"use_jwplayer_for_html5\":true},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}},\"vstat\":{\"order\":14,\"agent\":{\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"analysis\":{\"hola_uid\":\"basic/denis@hola.org\",\"tag\":{\"date\":{\"__ISODate__\":\"2016-11-16T09:33:01.000Z\"},\"id\":3}},\"cdn\":{\"bwsaver\":{\"before_play_buffer\":true},\"send_reqs\":{\"hola\":{},\"origin\":{}},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"hidden\":0,\"mirror_origins\":true,\"customer_active\":1,\"enabled\":1},\"loader\":{\"match\":{\"js\":\"return false;\",\"rand\":0,\"country\":{}},\"rules\":[],\"use_jwplayer_for_html5\":true},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{}},\"test_urls\":[],\"util\":{\"log\":{\"log_level\":\"notice\",\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}}}},\"gen\":{\"agent\":{\"origins\":[{\"__RegExp__\":\"/.+/m\"}],\"select\":{\"fast\":{\"limit\":1},\"single\":{\"limit\":3}}},\"player\":{\"cache_control_test\":true,\"settings\":{\"report\":true,\"info\":true,\"quality\":true},\"allow_stats_late_attach\":true,\"jwplayer\":{\"use_hap_provider\":true}},\"cdn\":{\"bwsaver\":{\"before_play_buffer\":true},\"overload\":{\"if_not_loaded\":true},\"single_copy\":{\"in_parallel\":3},\"send_reqs\":{\"hola\":{},\"origin\":{}}},\"loader\":{\"use_jwplayer_for_html5\":true,\"rules\":[{\"browser\":\"chrome\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"chromium_based\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"firefox\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"ie\",\"cdn\":1,\"bwsaver\":0,\"stats\":0},{\"browser\":\"opera\",\"cdn\":1,\"bwsaver\":0,\"stats\":0}],\"match\":{\"js\":\"return false;\",\"country\":{}}},\"util\":{\"log\":{\"report\":{\"add_load_perf\":true,\"analysis\":{\"hola_uid\":\"basic/vitali@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2016-09-06T13:38:40.000Z\"},\"id\":3}}},\"log_level\":\"notice\"}},\"_xxx\":\"test5\",\"order\":15,\"analysis\":{\"hola_uid\":\"basic/colin@hola.org\",\"js\":[],\"tag\":{\"date\":{\"__ISODate__\":\"2017-01-23T17:34:48.000Z\"},\"id\":10}},\"kw\":{\"ads_only\":false,\"disabled\":0,\"mirror_origins\":false,\"customer_active\":1,\"enabled\":1,\"stats\":1,\"bwsaver\":1,\"active\":1,\"monitor_basic\":1,\"monitor_full\":1},\"monitor\":{},\"origin_control\":[{\"group\":\"/.+/m\",\"sources\":[{\"__RegExp__\":\"/.+/m\"}],\"rules\":[{\"policy\":\"dont_change\",\"select\":\"all\",\"set\":[{\"source\":{\"__RegExp__\":\"/.+/m\"},\"apply\":\"dont_change\"}]}]}],\"portal\":{\"conf\":{},\"match\":{},\"zones\":{\"demo\":{\"fallback_delay\":120000}}},\"test_urls\":[]},\"customer_code\":true,\"disabled\":false,\"test\":{\"tag\":{\"id\":226,\"date\":{\"__ISODate__\":\"2017-01-26T14:32:08.794Z\"}}},\"calc_usage\":{\"bw\":34971058069.00002,\"date\":{\"__ISODate__\":\"2016-08-31T07:00:49.000Z\"},\"day\":{\"__ISODate__\":\"2016-08-30T00:00:00.000Z\"},\"dur\":0.458,\"metrics\":60},\"_xxx\":\"12:08\",\"privacy\":false,\"post_intg_count\":{\"first\":50,\"stats\":0,\"cdn\":1002},\"send_impl_reminder\":true,\"send_conf_change\":true,\"customer\":\"demo\"}",
customer: "demo",
agents: [{"hostname":"zagent37.h-cdn.com","host":"198.255.10.234","country":"US","name":"zagent37","pool":"single"},{"hostname":"zagent7.h-cdn.com","host":"50.7.1.2","country":"US","name":"zagent7","pool":"single"},{"hostname":"zagent885.h-cdn.com","host":"198.255.64.146","country":"US","name":"zagent885","pool":"single"},{"hostname":"zagent981.h-cdn.com","host":"198.16.82.50","country":"NL","name":"zagent981","pool":"single"},{"hostname":"zagent1498.h-cdn.com","host":"95.211.213.98","country":"NL","name":"zagent1498","pool":"single"}],
version: "1.31.547",
qs_ver: 'ver=1.31.547',
disabled: !!+false,
ccgi_url: 'client.h-cdn.com',
videojs: '/svc/cdn/pub/video-js.swf?md5=18467-517c596c',
videojs_osmf: '/svc/cdn/pub/videojs-osmf.swf?md5=186245-ec749577',
videojs_flashls: '/svc/cdn/pub/videojs-flashls.swf?md5=74609-97e11010',
videojs5_osmf: '/svc/cdn/pub/videojs5-osmf.swf?md5=189643-2d3bd98a',
videojs5: '/svc/cdn/pub/videojs-5/video-js.swf?md5=92486-46aeeea9',
videojs5_10: '/svc/cdn/pub/videojs_swf_sv.swf?md5=92547-f789b0cf',
videojs5_10_css: '/svc/cdn/pub/css/vjs5_10.css?md5=47687-bb1aae6d',
hola_skin: '/svc/cdn/pub/css/videojs-hola-skin.css?md5=24828-5d4979f2',
thumbnails: '/svc/cdn/pub/css/videojs.thumbnails.css?md5=874-39aa2ea2',
tpl: "/svc/cdn/pub/player_vjs5_10.js?minify=true",
stats_css: '/css/stats.css?md5=22914-0a03f76c',
cdngraph_js: '/svc/cdn/pub/cdngraph.js?md5=69912-ad5a3a31',
debug_js: '/svc/cdn/pub/debug.js?md5=61665-11326f24',
hls_js: '/svc/cdn/pub/hls.js?md5=475660-b0e05799',
flow_hls_engine: '/svc/cdn/pub/flowplayer_hls_engine.js?md5=33373-ddeddaad',
flow_dash_engine: '/svc/cdn/pub/flowplayer_dash_engine.js?md5=20155-6413735a',
vjs_hls_provider: '/svc/cdn/pub/vjs_hls_provider.js?md5=8250-2b5b58e0',
vstat: '/svc/cdn/pub/vstat.js?md5=29637-b5628e0d',
}[name];
return{}[name]};var console=window.console;function ie9_console(){if(console)return;console={log:function(){},error:function(){}}}ie9_console();function escape_qs(param,opt){opt=opt||{};var qs=opt.qs||"";var sep=qs||opt.amp?"&":"";if(!param)return qs;var uri_comp=encodeURIComponent;var uri_comp_val=uri_comp;for(var i in param){var val=param[i];if(val===undefined)continue;var key=uri_comp(i);qs+=sep;if(val===null)qs+=key;else if(Array.isArray(val)){if(!val.length)continue;qs+=val.map(function(val){return key+"="+uri_comp_val(val)}).join("&")}else qs+=key+"="+uri_comp_val(val);sep="&"}return qs}function send_beacon(url,data){if(navigator&&navigator.sendBeacon){if(navigator.sendBeacon(url,to_form_data(data)))return}var is_xdr=window.XDomainRequest!==undefined;var xhr=is_xdr?new XDomainRequest:new XMLHttpRequest;xhr.open("POST",url);if(window.FormData&&!is_xdr)data=to_form_data(data);else{data=escape_qs(data);if(!is_xdr){xhr.setRequestHeader("Accept","*/*");xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8")}}xhr.send(data)}function to_form_data(o){var data=new FormData;for(var k in o)data.append(k,o[k]);return data}function perr_raw(opt){var data={},qs={},zone,ver,hola_mode;if(window.hola_cdn){zone=window.hola_cdn.zone;ver=window.hola_cdn.ver;hola_mode=window.hola_cdn.mode}qs.browser=window.chrome?"chrome":"other";qs.id=opt.id;qs.ver=ver;data.build="platform: "+navigator.platform+"\n"+"user_agent: "+navigator.userAgent;data.is_json=1;data.info=opt.info||{};data.info.customer=customer;data.info.zone=zone;data.info.hola_mode=hola_mode;data.info.location_url=location.href;data.info.referrer=document.referrer;data.info=JSON.stringify(data.info);data.bt=opt.bt;var protocol=window&&window.location&&window.location.protocol;protocol=!protocol||!protocol.startsWith("http")?"http:":protocol;var url=protocol+"//perr.h-cdn.com/be_client_cgi/perr?"+escape_qs(qs);send_beacon(url,data)}function array_reduce(callback){if(this===null){throw new TypeError("Array.prototype.reduce called on null or"+" undefined")}if(typeof callback!=="function")throw new TypeError(callback+" is not a function");var t=Object(this),len=t.length>>>0,k=0,value;if(arguments.length==2)value=arguments[1];else{while(k<len&&!(k in t))k++;if(k>=len)throw new TypeError("Reduce of empty array with no initial value");value=t[k++]}for(;k<len;k++){if(k in t)value=callback(value,t[k],k,t)}return value}function fix_obj_props(obj,prop,test,fix){if(!obj[prop]||!test()){if(!fix)return;obj[prop]=fix}Object.defineProperty(obj,prop,{writable:false})}var site_errors,hola_errors,js_errors,ldr_errors,is_loader;var customer=E.zdot("customer"),tpl=E.zdot("tpl");is_loader=/^\/svc\/cdn\/pub\/loader.js/.test(tpl);if(is_loader){window.addEventListener("error",function(e){try{var send_perr;js_errors=(js_errors||0)+1;if(e.error){if(/\.h-cdn.com/.test(e.filename)){hola_errors=(hola_errors||0)+1;send_perr=hola_errors==1}else site_errors=(site_errors||0)+1}if(send_perr){perr_raw({id:"www_cdn_db_hola_js_error",bt:(e.error||{}).stack,info:{filename:e.filename,err:""+e.error,hola_errors:hola_errors,js_errors:js_errors,site_errors:site_errors,ldr_errors:ldr_errors}})}}catch(err){console.error("ldr_require error handler error",err);ldr_errors=(ldr_errors||0)+1}});window.addEventListener(navigator.userAgent.match(/iPad|iPhone|iPod/)?"pagehide":"beforeunload",function(){if(!js_errors)return;perr_raw({id:"www_cdn_db_js_error",info:{hola_errors:hola_errors,js_errors:js_errors,site_errors:site_errors,ldr_errors:ldr_errors}})})}fix_obj_props(Array.prototype,"reduce",function(){return[].reduce(String,1)==1},array_reduce);if(window.Prototype){delete Object.prototype.toJSON;delete Array.prototype.toJSON;delete String.prototype.toJSON;delete Number.prototype.toJSON;for(var p in[])Object.defineProperty(Array.prototype,p,{enumerable:false})}E.module_registry={};E.aliases={};E.config=function(config){if(config.map!==undefined)E.aliases=config.map};function init_module(module,req){if(module.inited==true)return module.init;var args=get_args(module);if(module.inited==true)return module.init;module.init=typeof module.init!=="function"?module.init:module.init.apply(null,args);if(module.init instanceof Object){for(var prop in module.exports){if(module.exports.hasOwnProperty(prop))module.init[prop]=module.exports[prop]}}else if(!module.init){console.error("empty module: "+req);ldr_errors=(ldr_errors||0)+1}else module.init=module.exports;module.inited=true;return module.init}function get_args(requirments){var args=[];var reqs=Array.isArray(requirments)?requirments:requirments.reqs;for(var i=0,len=reqs.length;i<len;i++){var req=reqs[i];switch(req){case"exports":if(!requirments.exports)throw new Error("ldr_require: invalid dependence!");args.push(requirments.exports);break;default:var module=E.module_registry[req]||(E.aliases[req]?E.module_registry[E.aliases[req]]:undefined);if(!module)throw new Error("ldr_require: missing module: "+req);args.push(init_module(module,req));break}}return args}E.define=function(name,requirements,init){if(typeof name!="string")throw new Error("ldr_require: module name is needed");if(init===undefined&&!Array.isArray(requirements)){init=requirements;requirements=[]}E.module_registry[name]={init:init,reqs:requirements,inited:false,exports:{}}};E.specified=function(name){return!!E.module_registry[name]};E.require=function(requirements,fn){fn.apply(null,get_args(requirements))};if(is_loader)window.hola_cdn_require=E.require})();function define(name,deps,init){if(hola_ldr_require)return hola_ldr_require.define(name,deps,init)}define.amd=true;function require(reqs,fn){if(hola_ldr_require)return hola_ldr_require.require(reqs,fn)}require.config=function(){return require};require.specified=function(name){return hola_ldr_require.specified(name)};require.zdot=function(name){return hola_ldr_require.zdot(name)};define("/svc/cdn/pub/ldr_require.js",function(){});
(function(global){var __hola_stub_define;var is_node_ff=typeof module=="object"&&module.exports;if(!is_node_ff)define=define||self.define;else define=function(name,setup){module.exports=setup()};define("/svc/cdn/pub/typedarray_shim.js",[],function(){var E={};if(is_node_ff||typeof ArrayBuffer!="undefined")return E;var MAX_ARRAY_LENGTH=1e5;function Type(v){switch(typeof v){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";default:return v===null?"null":"object"}}function Class(v){return Object.prototype.toString.call(v).replace(/^\[object *|\]$/g,"")}function IsCallable(o){return typeof o==="function"}function ToObject(v){if(v===null||v===undefined)throw TypeError();return Object(v)}function ToInt32(v){return v>>0}function ToUint32(v){return v>>>0}var LN2=Math.LN2,abs=Math.abs,floor=Math.floor,log=Math.log,max=Math.max,min=Math.min,pow=Math.pow,round=Math.round;(function(){var orig=Object.defineProperty;var dom_only=!function(){try{return Object.defineProperty({},"x",{})}catch(_){return false}}();if(!orig||dom_only){Object.defineProperty=function(o,prop,desc){if(orig)try{return orig(o,prop,desc)}catch(_){}if(o!==Object(o))throw TypeError("Object.defineProperty called on non-object");if(Object.prototype.__defineGetter__&&"get"in desc)Object.prototype.__defineGetter__.call(o,prop,desc.get);if(Object.prototype.__defineSetter__&&"set"in desc)Object.prototype.__defineSetter__.call(o,prop,desc.set);if("value"in desc)o[prop]=desc.value;return o}}})();function makeArrayAccessors(obj){if(obj.length>MAX_ARRAY_LENGTH)throw RangeError("Array too large for polyfill");function makeArrayAccessor(index){Object.defineProperty(obj,index,{get:function(){return obj._getter(index)},set:function(v){obj._setter(index,v)},enumerable:true,configurable:false})}var i;for(i=0;i<obj.length;i+=1){makeArrayAccessor(i)}}function as_signed(value,bits){var s=32-bits;return value<<s>>s}function as_unsigned(value,bits){var s=32-bits;return value<<s>>>s}function packI8(n){return[n&255]}function unpackI8(bytes){return as_signed(bytes[0],8)}function packU8(n){return[n&255]}function unpackU8(bytes){return as_unsigned(bytes[0],8)}function packU8Clamped(n){n=round(Number(n));return[n<0?0:n>255?255:n&255]}function packI16(n){return[n&255,n>>8&255]}function unpackI16(bytes){return as_signed(bytes[1]<<8|bytes[0],16)}function packU16(n){return[n&255,n>>8&255]}function unpackU16(bytes){return as_unsigned(bytes[1]<<8|bytes[0],16)}function packI32(n){return[n&255,n>>8&255,n>>16&255,n>>24&255]}function unpackI32(bytes){return as_signed(bytes[3]<<24|bytes[2]<<16|bytes[1]<<8|bytes[0],32)}function packU32(n){return[n&255,n>>8&255,n>>16&255,n>>24&255]}function unpackU32(bytes){return as_unsigned(bytes[3]<<24|bytes[2]<<16|bytes[1]<<8|bytes[0],32)}function packIEEE754(v,ebits,fbits){var bias=(1<<ebits-1)-1;function roundToEven(n){var w=floor(n),f=n-w;if(f<.5)return w;if(f>.5)return w+1;return w%2?w+1:w}var s,e,f;if(v!==v){e=(1<<ebits)-1;f=pow(2,fbits-1);s=0}else if(v===Infinity||v===-Infinity){e=(1<<ebits)-1;f=0;s=v<0?1:0}else if(v===0){e=0;f=0;s=1/v===-Infinity?1:0}else{s=v<0;v=abs(v);if(v>=pow(2,1-bias)){e=min(floor(log(v)/LN2),1023);var significand=v/pow(2,e);if(significand<1){e-=1;significand*=2}if(significand>=2){e+=1;significand/=2}var d=pow(2,fbits);f=roundToEven(significand*d)-d;e+=bias;if(f/d>=1){e+=1;f=0}if(e>2*bias){e=(1<<ebits)-1;f=0}}else{e=0;f=roundToEven(v/pow(2,1-bias-fbits))}}var bits=[],i;for(i=fbits;i;i-=1){bits.push(f%2?1:0);f=floor(f/2)}for(i=ebits;i;i-=1){bits.push(e%2?1:0);e=floor(e/2)}bits.push(s?1:0);bits.reverse();var str=bits.join("");var bytes=[];while(str.length){bytes.unshift(parseInt(str.substring(0,8),2));str=str.substring(8)}return bytes}function unpackIEEE754(bytes,ebits,fbits){var bits=[],i,j,b,str,bias,s,e,f;for(i=0;i<bytes.length;++i){b=bytes[i];for(j=8;j;j-=1){bits.push(b%2?1:0);b=b>>1}}bits.reverse();str=bits.join("");bias=(1<<ebits-1)-1;s=parseInt(str.substring(0,1),2)?-1:1;e=parseInt(str.substring(1,1+ebits),2);f=parseInt(str.substring(1+ebits),2);if(e===(1<<ebits)-1){return f!==0?NaN:s*Infinity}else if(e>0){return s*pow(2,e-bias)*(1+f/pow(2,fbits))}else if(f!==0){return s*pow(2,-(bias-1))*(f/pow(2,fbits))}else{return s<0?-0:0}}function unpackF64(b){return unpackIEEE754(b,11,52)}function packF64(v){return packIEEE754(v,11,52)}function unpackF32(b){return unpackIEEE754(b,8,23)}function packF32(v){return packIEEE754(v,8,23)}(function(){function ArrayBuffer(length){length=ToInt32(length);if(length<0)throw RangeError("ArrayBuffer size is not a small enough positive integer.");Object.defineProperty(this,"byteLength",{value:length});Object.defineProperty(this,"_bytes",{value:Array(length)});for(var i=0;i<length;i+=1)this._bytes[i]=0}global.ArrayBuffer=global.ArrayBuffer||ArrayBuffer;function $TypedArray$(){if(!arguments.length||typeof arguments[0]!=="object"){return function(length){length=ToInt32(length);if(length<0)throw RangeError("length is not a small enough positive integer.");Object.defineProperty(this,"length",{value:length});Object.defineProperty(this,"byteLength",{value:length*this.BYTES_PER_ELEMENT});Object.defineProperty(this,"buffer",{value:new ArrayBuffer(this.byteLength)});Object.defineProperty(this,"byteOffset",{value:0})}.apply(this,arguments)}if(arguments.length>=1&&Type(arguments[0])==="object"&&arguments[0]instanceof $TypedArray$){return function(typedArray){if(this.constructor!==typedArray.constructor)throw TypeError();var byteLength=typedArray.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new ArrayBuffer(byteLength)});Object.defineProperty(this,"byteLength",{value:byteLength});Object.defineProperty(this,"byteOffset",{value:0});Object.defineProperty(this,"length",{value:typedArray.length});for(var i=0;i<this.length;i+=1)this._setter(i,typedArray._getter(i))}.apply(this,arguments)}if(arguments.length>=1&&Type(arguments[0])==="object"&&!(arguments[0]instanceof $TypedArray$)&&!(arguments[0]instanceof ArrayBuffer||Class(arguments[0])==="ArrayBuffer")){return function(array){var byteLength=array.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new ArrayBuffer(byteLength)});Object.defineProperty(this,"byteLength",{value:byteLength});Object.defineProperty(this,"byteOffset",{value:0});Object.defineProperty(this,"length",{value:array.length});for(var i=0;i<this.length;i+=1){var s=array[i];this._setter(i,Number(s))}}.apply(this,arguments)}if(arguments.length>=1&&Type(arguments[0])==="object"&&(arguments[0]instanceof ArrayBuffer||Class(arguments[0])==="ArrayBuffer")){return function(buffer,byteOffset,length){var byteLength;byteOffset=ToUint32(byteOffset);if(byteOffset>buffer.byteLength)throw RangeError("byteOffset out of range");if(byteOffset%this.BYTES_PER_ELEMENT)throw RangeError("buffer length minus the byteOffset is not a multiple of the element size.");if(length===undefined){byteLength=buffer.byteLength-byteOffset;if(byteLength%this.BYTES_PER_ELEMENT)throw RangeError("length of buffer minus byteOffset not a multiple of the element size");length=byteLength/this.BYTES_PER_ELEMENT}else{length=ToUint32(length);byteLength=length*this.BYTES_PER_ELEMENT}if(byteOffset+byteLength>buffer.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:buffer});Object.defineProperty(this,"byteLength",{value:byteLength});Object.defineProperty(this,"byteOffset",{value:byteOffset});Object.defineProperty(this,"length",{value:length})}.apply(this,arguments)}throw TypeError()}Object.defineProperty($TypedArray$,"from",{value:function(iterable){return new this(iterable)}});Object.defineProperty($TypedArray$,"of",{value:function(){return new this(arguments)}});var $TypedArrayPrototype$={};$TypedArray$.prototype=$TypedArrayPrototype$;Object.defineProperty($TypedArray$.prototype,"_getter",{value:function(index){if(arguments.length<1)throw SyntaxError("Not enough arguments");index=ToUint32(index);if(index>=this.length)return undefined;var bytes=[],i,o;for(i=0,o=this.byteOffset+index*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,o+=1){bytes.push(this.buffer._bytes[o])}return this._unpack(bytes)}});Object.defineProperty($TypedArray$.prototype,"get",{value:$TypedArray$.prototype._getter});Object.defineProperty($TypedArray$.prototype,"_setter",{value:function(index,value){if(arguments.length<2)throw SyntaxError("Not enough arguments");index=ToUint32(index);if(index>=this.length)return;var bytes=this._pack(value),i,o;for(i=0,o=this.byteOffset+index*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,o+=1){this.buffer._bytes[o]=bytes[i]}}});Object.defineProperty($TypedArray$.prototype,"constructor",{value:$TypedArray$});Object.defineProperty($TypedArray$.prototype,"copyWithin",{value:function(target,start){var end=arguments[2];var o=ToObject(this);var lenVal=o.length;var len=ToUint32(lenVal);len=max(len,0);var relativeTarget=ToInt32(target);var to;if(relativeTarget<0)to=max(len+relativeTarget,0);else to=min(relativeTarget,len);var relativeStart=ToInt32(start);var from;if(relativeStart<0)from=max(len+relativeStart,0);else from=min(relativeStart,len);var relativeEnd;if(end===undefined)relativeEnd=len;else relativeEnd=ToInt32(end);var final_;if(relativeEnd<0)final_=max(len+relativeEnd,0);else final_=min(relativeEnd,len);var count=min(final_-from,len-to);var direction;if(from<to&&to<from+count){direction=-1;from=from+count-1;to=to+count-1}else{direction=1}while(count>0){o._setter(to,o._getter(from));from=from+direction;to=to+direction;count=count-1}return o}});Object.defineProperty($TypedArray$.prototype,"every",{value:function(callbackfn){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);if(!IsCallable(callbackfn))throw TypeError();var thisArg=arguments[1];for(var i=0;i<len;i++){if(!callbackfn.call(thisArg,t._getter(i),i,t))return false}return true}});Object.defineProperty($TypedArray$.prototype,"fill",{value:function(value){var start=arguments[1],end=arguments[2];var o=ToObject(this);var lenVal=o.length;var len=ToUint32(lenVal);len=max(len,0);var relativeStart=ToInt32(start);var k;if(relativeStart<0)k=max(len+relativeStart,0);else k=min(relativeStart,len);var relativeEnd;if(end===undefined)relativeEnd=len;else relativeEnd=ToInt32(end);var final_;if(relativeEnd<0)final_=max(len+relativeEnd,0);else final_=min(relativeEnd,len);while(k<final_){o._setter(k,value);k+=1}return o}});Object.defineProperty($TypedArray$.prototype,"filter",{value:function(callbackfn){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);if(!IsCallable(callbackfn))throw TypeError();var res=[];var thisp=arguments[1];for(var i=0;i<len;i++){var val=t._getter(i);if(callbackfn.call(thisp,val,i,t))res.push(val)}return new this.constructor(res)}});Object.defineProperty($TypedArray$.prototype,"find",{value:function(predicate){var o=ToObject(this);var lenValue=o.length;var len=ToUint32(lenValue);if(!IsCallable(predicate))throw TypeError();var t=arguments.length>1?arguments[1]:undefined;var k=0;while(k<len){var kValue=o._getter(k);var testResult=predicate.call(t,kValue,k,o);if(Boolean(testResult))return kValue;++k}return undefined}});Object.defineProperty($TypedArray$.prototype,"findIndex",{value:function(predicate){var o=ToObject(this);var lenValue=o.length;var len=ToUint32(lenValue);if(!IsCallable(predicate))throw TypeError();var t=arguments.length>1?arguments[1]:undefined;var k=0;while(k<len){var kValue=o._getter(k);var testResult=predicate.call(t,kValue,k,o);if(Boolean(testResult))return k;++k}return-1}});Object.defineProperty($TypedArray$.prototype,"forEach",{value:function(callbackfn){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);if(!IsCallable(callbackfn))throw TypeError();var thisp=arguments[1];for(var i=0;i<len;i++)callbackfn.call(thisp,t._getter(i),i,t)}});Object.defineProperty($TypedArray$.prototype,"indexOf",{value:function(searchElement){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);if(len===0)return-1;var n=0;if(arguments.length>0){n=Number(arguments[1]);if(n!==n){n=0}else if(n!==0&&n!==1/0&&n!==-(1/0)){n=(n>0||-1)*floor(abs(n))}}if(n>=len)return-1;var k=n>=0?n:max(len-abs(n),0);for(;k<len;k++){if(t._getter(k)===searchElement){return k}}return-1}});Object.defineProperty($TypedArray$.prototype,"join",{value:function(separator){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);var tmp=Array(len);for(var i=0;i<len;++i)tmp[i]=t._getter(i);return tmp.join(separator===undefined?",":separator)}});Object.defineProperty($TypedArray$.prototype,"lastIndexOf",{value:function(searchElement){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);if(len===0)return-1;var n=len;if(arguments.length>1){n=Number(arguments[1]);if(n!==n){n=0}else if(n!==0&&n!==1/0&&n!==-(1/0)){n=(n>0||-1)*floor(abs(n))}}var k=n>=0?min(n,len-1):len-abs(n);for(;k>=0;k--){if(t._getter(k)===searchElement)return k}return-1}});Object.defineProperty($TypedArray$.prototype,"map",{value:function(callbackfn){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);if(!IsCallable(callbackfn))throw TypeError();var res=[];res.length=len;var thisp=arguments[1];for(var i=0;i<len;i++)res[i]=callbackfn.call(thisp,t._getter(i),i,t);return new this.constructor(res)}});Object.defineProperty($TypedArray$.prototype,"reduce",{value:function(callbackfn){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);if(!IsCallable(callbackfn))throw TypeError();if(len===0&&arguments.length===1)throw TypeError();var k=0;var accumulator;if(arguments.length>=2){accumulator=arguments[1]}else{accumulator=t._getter(k++)}while(k<len){accumulator=callbackfn.call(undefined,accumulator,t._getter(k),k,t);k++}return accumulator}});Object.defineProperty($TypedArray$.prototype,"reduceRight",{value:function(callbackfn){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);if(!IsCallable(callbackfn))throw TypeError();if(len===0&&arguments.length===1)throw TypeError();var k=len-1;var accumulator;if(arguments.length>=2){accumulator=arguments[1]}else{accumulator=t._getter(k--)}while(k>=0){accumulator=callbackfn.call(undefined,accumulator,t._getter(k),k,t);k--}return accumulator}});Object.defineProperty($TypedArray$.prototype,"reverse",{value:function(){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);var half=floor(len/2);for(var i=0,j=len-1;i<half;++i,--j){var tmp=t._getter(i);t._setter(i,t._getter(j));t._setter(j,tmp)}return t}});Object.defineProperty($TypedArray$.prototype,"set",{value:function(index,value){if(arguments.length<1)throw SyntaxError("Not enough arguments");var array,sequence,offset,len,i,s,d,byteOffset,byteLength,tmp;if(typeof arguments[0]==="object"&&arguments[0].constructor===this.constructor){array=arguments[0];offset=ToUint32(arguments[1]);if(offset+array.length>this.length){throw RangeError("Offset plus length of array is out of range")}byteOffset=this.byteOffset+offset*this.BYTES_PER_ELEMENT;byteLength=array.length*this.BYTES_PER_ELEMENT;if(array.buffer===this.buffer){tmp=[];for(i=0,s=array.byteOffset;i<byteLength;i+=1,s+=1){tmp[i]=array.buffer._bytes[s]}for(i=0,d=byteOffset;i<byteLength;i+=1,d+=1){this.buffer._bytes[d]=tmp[i]}}else{for(i=0,s=array.byteOffset,d=byteOffset;i<byteLength;i+=1,s+=1,d+=1){this.buffer._bytes[d]=array.buffer._bytes[s]}}}else if(typeof arguments[0]==="object"&&typeof arguments[0].length!=="undefined"){sequence=arguments[0];len=ToUint32(sequence.length);offset=ToUint32(arguments[1]);if(offset+len>this.length){throw RangeError("Offset plus length of array is out of range")}for(i=0;i<len;i+=1){s=sequence[i];this._setter(offset+i,Number(s))}}else{throw TypeError("Unexpected argument type(s)")}}});Object.defineProperty($TypedArray$.prototype,"slice",{value:function(start,end){var o=ToObject(this);var lenVal=o.length;var len=ToUint32(lenVal);var relativeStart=ToInt32(start);var k=relativeStart<0?max(len+relativeStart,0):min(relativeStart,len);var relativeEnd=end===undefined?len:ToInt32(end);var final_=relativeEnd<0?max(len+relativeEnd,0):min(relativeEnd,len);var count=final_-k;var c=o.constructor;var a=new c(count);var n=0;while(k<final_){var kValue=o._getter(k);a._setter(n,kValue);++k;++n}return a}});Object.defineProperty($TypedArray$.prototype,"some",{value:function(callbackfn){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);if(!IsCallable(callbackfn))throw TypeError();var thisp=arguments[1];for(var i=0;i<len;i++){if(callbackfn.call(thisp,t._getter(i),i,t)){return true}}return false}});Object.defineProperty($TypedArray$.prototype,"sort",{value:function(comparefn){if(this===undefined||this===null)throw TypeError();var t=Object(this);var len=ToUint32(t.length);var tmp=Array(len);for(var i=0;i<len;++i)tmp[i]=t._getter(i);if(comparefn)tmp.sort(comparefn);else tmp.sort();for(i=0;i<len;++i)t._setter(i,tmp[i]);return t}});Object.defineProperty($TypedArray$.prototype,"subarray",{value:function(start,end){function clamp(v,min,max){return v<min?min:v>max?max:v}start=ToInt32(start);end=ToInt32(end);if(arguments.length<1){start=0}if(arguments.length<2){end=this.length}if(start<0){start=this.length+start}if(end<0){end=this.length+end}start=clamp(start,0,this.length);end=clamp(end,0,this.length);var len=end-start;if(len<0){len=0}return new this.constructor(this.buffer,this.byteOffset+start*this.BYTES_PER_ELEMENT,len)}});function makeTypedArray(elementSize,pack,unpack){var TypedArray=function(){Object.defineProperty(this,"constructor",{value:TypedArray});$TypedArray$.apply(this,arguments);if(0)makeArrayAccessors(this)};if("__proto__"in TypedArray){TypedArray.__proto__=$TypedArray$}else{TypedArray.from=$TypedArray$.from;TypedArray.of=$TypedArray$.of}TypedArray.BYTES_PER_ELEMENT=elementSize;var TypedArrayPrototype=function(){};TypedArrayPrototype.prototype=$TypedArrayPrototype$;TypedArray.prototype=new TypedArrayPrototype;Object.defineProperty(TypedArray.prototype,"BYTES_PER_ELEMENT",{value:elementSize});Object.defineProperty(TypedArray.prototype,"_pack",{value:pack});Object.defineProperty(TypedArray.prototype,"_unpack",{value:unpack});return TypedArray}var Int8Array=makeTypedArray(1,packI8,unpackI8);var Uint8Array=makeTypedArray(1,packU8,unpackU8);var Uint8ClampedArray=makeTypedArray(1,packU8Clamped,unpackU8);var Int16Array=makeTypedArray(2,packI16,unpackI16);var Uint16Array=makeTypedArray(2,packU16,unpackU16);var Int32Array=makeTypedArray(4,packI32,unpackI32);var Uint32Array=makeTypedArray(4,packU32,unpackU32);var Float32Array=makeTypedArray(4,packF32,unpackF32);var Float64Array=makeTypedArray(8,packF64,unpackF64);global.Int8Array=global.Int8Array||Int8Array;global.Uint8Array=global.Uint8Array||Uint8Array;global.Uint8ClampedArray=global.Uint8ClampedArray||Uint8ClampedArray;global.Int16Array=global.Int16Array||Int16Array;global.Uint16Array=global.Uint16Array||Uint16Array;global.Int32Array=global.Int32Array||Int32Array;global.Uint32Array=global.Uint32Array||Uint32Array;global.Float32Array=global.Float32Array||Float32Array;global.Float64Array=global.Float64Array||Float64Array})();(function(){function r(array,index){return IsCallable(array.get)?array.get(index):array[index]}var IS_BIG_ENDIAN=function(){var u16array=new Uint16Array([4660]),u8array=new Uint8Array(u16array.buffer);return r(u8array,0)===18}();function DataView(buffer,byteOffset,byteLength){if(!(buffer instanceof ArrayBuffer||Class(buffer)==="ArrayBuffer"))throw TypeError();byteOffset=ToUint32(byteOffset);if(byteOffset>buffer.byteLength)throw RangeError("byteOffset out of range");if(byteLength===undefined)byteLength=buffer.byteLength-byteOffset;else byteLength=ToUint32(byteLength);if(byteOffset+byteLength>buffer.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:buffer});Object.defineProperty(this,"byteLength",{value:byteLength});Object.defineProperty(this,"byteOffset",{value:byteOffset})}function makeGetter(arrayType){return function GetViewValue(byteOffset,littleEndian){byteOffset=ToUint32(byteOffset);if(byteOffset+arrayType.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");byteOffset+=this.byteOffset;var uint8Array=new Uint8Array(this.buffer,byteOffset,arrayType.BYTES_PER_ELEMENT),bytes=[];for(var i=0;i<arrayType.BYTES_PER_ELEMENT;i+=1)bytes.push(r(uint8Array,i));if(Boolean(littleEndian)===Boolean(IS_BIG_ENDIAN))bytes.reverse();return r(new arrayType(new Uint8Array(bytes).buffer),0)}}Object.defineProperty(DataView.prototype,"getUint8",{value:makeGetter(Uint8Array)});Object.defineProperty(DataView.prototype,"getInt8",{value:makeGetter(Int8Array)});Object.defineProperty(DataView.prototype,"getUint16",{value:makeGetter(Uint16Array)});Object.defineProperty(DataView.prototype,"getInt16",{value:makeGetter(Int16Array)});Object.defineProperty(DataView.prototype,"getUint32",{value:makeGetter(Uint32Array)});Object.defineProperty(DataView.prototype,"getInt32",{value:makeGetter(Int32Array)});Object.defineProperty(DataView.prototype,"getFloat32",{value:makeGetter(Float32Array)});Object.defineProperty(DataView.prototype,"getFloat64",{value:makeGetter(Float64Array)});function makeSetter(arrayType){return function SetViewValue(byteOffset,value,littleEndian){byteOffset=ToUint32(byteOffset);if(byteOffset+arrayType.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");var typeArray=new arrayType([value]),byteArray=new Uint8Array(typeArray.buffer),bytes=[],i,byteView;for(i=0;i<arrayType.BYTES_PER_ELEMENT;i+=1)bytes.push(r(byteArray,i));if(Boolean(littleEndian)===Boolean(IS_BIG_ENDIAN))bytes.reverse();byteView=new Uint8Array(this.buffer,byteOffset,arrayType.BYTES_PER_ELEMENT);byteView.set(bytes)}}Object.defineProperty(DataView.prototype,"setUint8",{value:makeSetter(Uint8Array)});Object.defineProperty(DataView.prototype,"setInt8",{value:makeSetter(Int8Array)});Object.defineProperty(DataView.prototype,"setUint16",{value:makeSetter(Uint16Array)});Object.defineProperty(DataView.prototype,"setInt16",{value:makeSetter(Int16Array)});Object.defineProperty(DataView.prototype,"setUint32",{value:makeSetter(Uint32Array)});Object.defineProperty(DataView.prototype,"setInt32",{value:makeSetter(Int32Array)});Object.defineProperty(DataView.prototype,"setFloat32",{value:makeSetter(Float32Array)});Object.defineProperty(DataView.prototype,"setFloat64",{value:makeSetter(Float64Array)});global.DataView=global.DataView||DataView})();return E})})(this);
(function(){var __hola_stub_define;var is_node_ff=typeof module=="object"&&module.exports;if(!is_node_ff)define=define||self.define;else define=function(setup){module.exports=setup()};define("/util/es6_shim.js",[],function(){var E={t:{}};function add_prop(obj,prop,fn){if(obj[prop])return;Object.defineProperty(obj,prop,{enumerable:false,writable:true,configurable:true,value:fn})}E.t.object_assign=function(obj){for(var i=1;i<arguments.length;i++){var source=arguments[i];if(!source)continue;for(var prop in source){if(source.hasOwnProperty(prop))obj[prop]=source[prop]}}return obj};add_prop(Object,"assign",E.t.object_assign);E.t.object_values=function(obj){if(obj==null)throw new TypeError("Cannot convert undefined or null to object");var res=[];for(var prop in obj){if(obj.hasOwnProperty(prop))res.push(obj[prop])}return res};add_prop(Object,"values",E.t.object_values);E.t.object_entries=function(obj){if(obj==null)throw new TypeError("Cannot convert undefined or null to object");var res=[];for(var prop in obj){if(obj.hasOwnProperty(prop))res.push([prop,obj[prop]])}return res};add_prop(Object,"entries",E.t.object_entries);var can_set_proto={__proto__:[]}instanceof Array;E.t.object_setPrototypeOf=function(obj,proto){if(can_set_proto)obj.__proto__=proto;else{for(var prop in proto)obj[prop]=proto[prop]}return true};add_prop(Object,"setPrototypeOf",E.t.object_setPrototypeOf);E.t.string_startsWith=function(head){head=""+head;return!head||this.slice(0,head.length)===head};add_prop(String.prototype,"startsWith",E.t.string_startsWith);E.t.string_endsWith=function(tail){tail=""+tail;return!tail||this.slice(-tail.length)==tail};add_prop(String.prototype,"endsWith",E.t.string_endsWith);E.t.string_includes=function(search,index){return this.indexOf(search,index)>=0};add_prop(String.prototype,"includes",E.t.string_includes);E.t.string_repeat=function(n){var s="";for(var i=0;i<n;i++)s+=this;return s};add_prop(String.prototype,"repeat",E.t.string_repeat);E.t.string_trimLeft=function(){return this.replace(/^\s+/,"")};add_prop(String.prototype,"trimLeft",E.t.string_trimLeft);E.t.string_trimRight=function(){return this.replace(/\s+$/,"")};add_prop(String.prototype,"trimRight",E.t.string_trimRight);E.t.string_padStart=function(len,val){val=val||" ";var l=len-this.length;return l<=0?this:val.repeat(Math.ceil(l/val.length)).slice(0,l)+this};add_prop(String.prototype,"padStart",E.t.string_padStart);E.t.string_padEnd=function(len,val){val=val||" ";var l=len-this.length;return l<=0?this:this+val.repeat(Math.ceil(l/val.length)).slice(0,l)};add_prop(String.prototype,"padEnd",E.t.string_padEnd);E.t.array_includes=function(search,index){return this.indexOf(search,index)>=0};add_prop(Array.prototype,"includes",E.t.array_includes);E.t.array_find=function(fn,this_arg){var a=this,value;for(var i=0;i<a.length;i++){value=a[i];if(i in a&&fn.call(this_arg,value,i,a))return value}};add_prop(Array.prototype,"find",E.t.array_find);E.t.array_findIndex=function(fn,this_arg){var a=this,value;for(var i=0;i<a.length;i++){value=a[i];if(i in a&&fn.call(this_arg,value,i,a))return i}return-1};add_prop(Array.prototype,"findIndex",E.t.array_findIndex);E.t.array_of=function(){return Array.prototype.slice.call(arguments)};add_prop(Array,"of",E.t.array_of);E.t.array_from=function(a,fn,_this){a=Array.prototype.slice.call(a);return!fn?a:a.map(fn,_this)};add_prop(Array,"from",E.t.array_from);E.t.arraybuffer_slice=function(begin,end){begin=begin|0;end=(end==null?this.byteLength:end)|0;if(begin<0)begin+=this.byteLength;if(end<0)end+=this.byteLength;begin=Math.min(Math.max(0,begin),this.byteLength);end=Math.min(Math.max(0,end),this.byteLength);if(end-begin<=0)return new ArrayBuffer(0);var result=new ArrayBuffer(end-begin);var resultBytes=new Uint8Array(result);var sourceBytes=new Uint8Array(this,begin,end-begin);resultBytes.set(sourceBytes);return result};if(typeof ArrayBuffer!="undefined")add_prop(ArrayBuffer.prototype,"slice",E.t.arraybuffer_slice);function number_epsilon(){if(typeof window!="object")return;if(!window.Number)window.Number={};if(!window.Number.EPSILON)window.Number.EPSILON=Math.pow(2,-52)}number_epsilon();E.t.math_sign=function(x){x=+x;return x!==x?NaN:!x?x:x<0?-1:1};add_prop(Math,"sign",E.t.math_sign);E.t.math_trunc=function(x){x=+x;return x!==x?NaN:x<0?Math.ceil(x):Math.floor(x)};add_prop(Math,"trunc",E.t.math_trunc);function ie9_console(){if(typeof window!="object")return;if(window.console){if(!window.console.debug)window.console.debug=window.console.info;return}var console=window.console={};["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profiles","profileEnd","show","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"].forEach(function(p){console[p]=function(){}});["memory"].forEach(function(p){console[p]={}})}ie9_console();function ie9_location_origin(){if(typeof window!="object"||!window.location||"origin"in window.location){return}var location=window.location;var default_ports={"http:":80,"https:":443};var port=location.port;if(default_ports[location.protocol]==port)port=null;location.origin=location.protocol+"//"+location.hostname+(port?":"+port:"")}ie9_location_origin();function ie_edge_closest(){if(typeof Element!="object"&&typeof Element!="function"||Element.prototype.closest){return}var matches=Element.prototype.matches||Element.prototype.msMatchesSelector;if(!matches)return;Element.prototype.closest=function(selector){var el=this;while(el){if(matches.call(el,selector))return el;el=el.parentElement}return null}}ie_edge_closest();E.t.function_name=function(){var n=this.toString().match(/^function\s+([^\s(]+)/);return n&&n[1]||""};function ie_function_name(){if(ie_function_name.name=="ie_function_name")return;Object.defineProperty(Function.prototype,"name",{enumerable:false,configurable:false,get:E.t.function_name})}ie_function_name();function android18_animFrame(){if(typeof window!="object"||window.requestAnimationFrame)return;var start=Date.now();window.requestAnimationFrame=function(cb){setTimeout(function(){cb(Date.now()-start)},16)}}android18_animFrame();return E})})();
if(typeof hola_ldr_require!="undefined")hola_ldr_require.config({map:{events:"/util/events.js"}});define("/svc/cdn/pub/config.js",[],function(){var E={};var b="//"+require.zdot("ccgi_url");E.swf_urls={videojs:b+require.zdot("videojs"),videojs_osmf:b+require.zdot("videojs_osmf"),videojs_flashls:b+require.zdot("videojs_flashls"),videojs5_osmf:b+require.zdot("videojs5_osmf"),videojs5:b+require.zdot("videojs5"),videojs5_10:b+require.zdot("videojs5_10")};E.css_urls={videojs:b+require.zdot("videojs5_10_css"),hola_skin:b+require.zdot("hola_skin"),thumbnails:b+require.zdot("thumbnails")};return E});require(["/util/es6_shim.js","/svc/cdn/pub/typedarray_shim.js"],function(){});
define("jquery",[],function(){var define;!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l="1.11.1",m=function(a,b){return new m.fn.init(a,b)},n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,o=/^-ms-/,p=/-([\da-z])/gi,q=function(a,b){return b.toUpperCase()};m.fn=m.prototype={jquery:l,constructor:m,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=m.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return m.each(this,a,b)},map:function(a){return this.pushStack(m.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},m.extend=m.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||m.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(m.isPlainObject(c)||(b=m.isArray(c)))?(b?(b=!1,f=a&&m.isArray(a)?a:[]):f=a&&m.isPlainObject(a)?a:{},g[d]=m.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},m.extend({expando:"jQuery"+(l+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===m.type(a)},isArray:Array.isArray||function(a){return"array"===m.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!m.isArray(a)&&a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==m.type(a)||a.nodeType||m.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(k.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(b){b&&m.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(o,"ms-").replace(p,q)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=r(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(n,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(r(Object(a))?m.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=r(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),m.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||m.guid++,e):void 0},now:function(){return+new Date},support:k}),m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function r(a){var b=a.length,c=m.type(a);return"function"===c||m.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var s=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+-new Date,v=a.document,w=0,x=0,y=gb(),z=gb(),A=gb(),B=function(a,b){return a===b&&(l=!0),0},C="undefined",D=1<<31,E={}.hasOwnProperty,F=[],G=F.pop,H=F.push,I=F.push,J=F.slice,K=F.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",N="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",O=N.replace("w","w#"),P="\\["+M+"*("+N+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+M+"*\\]",Q=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+P+")*)|.*)\\)|)",R=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),S=new RegExp("^"+M+"*,"+M+"*"),T=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),V=new RegExp(Q),W=new RegExp("^"+O+"$"),X={ID:new RegExp("^#("+N+")"),CLASS:new RegExp("^\\.("+N+")"),TAG:new RegExp("^("+N.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+Q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ab=/[+~]/,bb=/'|\\/g,cb=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),db=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{I.apply(F=J.call(v.childNodes),v.childNodes),F[v.childNodes.length].nodeType}catch(eb){I={apply:F.length?function(a,b){H.apply(a,J.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function fb(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],!a||"string"!=typeof a)return d;if(1!==(k=b.nodeType)&&9!==k)return[];if(p&&!e){if(f=_.exec(a))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return I.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return I.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=9===k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(bb,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+qb(o[l]);w=ab.test(a)&&ob(b.parentNode)||b,x=o.join(",")}if(x)try{return I.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function gb(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function hb(a){return a[u]=!0,a}function ib(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function jb(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function kb(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||D)-(~a.sourceIndex||D);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function lb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function mb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function nb(a){return hb(function(b){return b=+b,hb(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function ob(a){return a&&typeof a.getElementsByTagName!==C&&a}c=fb.support={},f=fb.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=fb.setDocument=function(a){var b,e=a?a.ownerDocument||a:v,g=e.defaultView;return e!==n&&9===e.nodeType&&e.documentElement?(n=e,o=e.documentElement,p=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener("unload",function(){m()},!1):g.attachEvent&&g.attachEvent("onunload",function(){m()})),c.attributes=ib(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ib(function(a){return a.appendChild(e.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(e.getElementsByClassName)&&ib(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),c.getById=ib(function(a){return o.appendChild(a).id=u,!e.getElementsByName||!e.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if(typeof b.getElementById!==C&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){var c=typeof a.getAttributeNode!==C&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==C?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==C&&p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(e.querySelectorAll))&&(ib(function(a){a.innerHTML="<select msallowclip=''><option selected=''></option></select>",a.querySelectorAll("[msallowclip^='']").length&&q.push("[*^$]="+M+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+M+"*(?:value|"+L+")"),a.querySelectorAll(":checked").length||q.push(":checked")}),ib(function(a){var b=e.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+M+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ib(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",Q)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===v&&t(v,a)?-1:b===e||b.ownerDocument===v&&t(v,b)?1:k?K.call(k,a)-K.call(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],i=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:k?K.call(k,a)-K.call(k,b):0;if(f===g)return kb(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?kb(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},e):n},fb.matches=function(a,b){return fb(a,null,null,b)},fb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return fb(b,n,null,[a]).length>0},fb.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},fb.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&E.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},fb.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},fb.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=fb.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=fb.selectors={cacheLength:50,createPseudo:hb,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(cb,db),a[3]=(a[3]||a[4]||a[5]||"").replace(cb,db),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||fb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&fb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(cb,db).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+M+")"+a+"("+M+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==C&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=fb.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||fb.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?hb(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=K.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:hb(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?hb(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:hb(function(a){return function(b){return fb(a,b).length>0}}),contains:hb(function(a){return function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:hb(function(a){return W.test(a||"")||fb.error("unsupported lang: "+a),a=a.replace(cb,db).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:nb(function(){return[0]}),last:nb(function(a,b){return[b-1]}),eq:nb(function(a,b,c){return[0>c?c+b:c]}),even:nb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:nb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:nb(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:nb(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=lb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=mb(b);function pb(){}pb.prototype=d.filters=d.pseudos,d.setFilters=new pb,g=fb.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?fb.error(a):z(a,i).slice(0)};function qb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function rb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function sb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function tb(a,b,c){for(var d=0,e=b.length;e>d;d++)fb(a,b[d],c);return c}function ub(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function vb(a,b,c,d,e,f){return d&&!d[u]&&(d=vb(d)),e&&!e[u]&&(e=vb(e,f)),hb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||tb(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:ub(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=ub(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?K.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=ub(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):I.apply(g,r)})}function wb(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=rb(function(a){return a===b},h,!0),l=rb(function(a){return K.call(b,a)>-1},h,!0),m=[function(a,c,d){return!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];f>i;i++)if(c=d.relative[a[i].type])m=[rb(sb(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return vb(i>1&&sb(m),i>1&&qb(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&wb(a.slice(i,e)),f>e&&wb(a=a.slice(e)),f>e&&qb(a))}m.push(c)}return sb(m)}function xb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=G.call(i));s=ub(s)}I.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&fb.uniqueSort(i)}return k&&(w=v,j=t),r};return c?hb(f):f}return h=fb.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=wb(b[c]),f[u]?d.push(f):e.push(f);f=A(a,xb(e,d)),f.selector=a}return f},i=fb.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(cb,db),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(cb,db),ab.test(j[0].type)&&ob(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&qb(j),!a)return I.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,ab.test(a)&&ob(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ib(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ib(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||jb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ib(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||jb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ib(function(a){return null==a.getAttribute("disabled")})||jb(L,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),fb}(a);m.find=s,m.expr=s.selectors,m.expr[":"]=m.expr.pseudos,m.unique=s.uniqueSort,m.text=s.getText,m.isXMLDoc=s.isXML,m.contains=s.contains;var t=m.expr.match.needsContext,u=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,v=/^.[^:#\[\.,]*$/;function w(a,b,c){if(m.isFunction(b))return m.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return m.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(v.test(b))return m.filter(b,a,c);b=m.filter(b,a)}return m.grep(a,function(a){return m.inArray(a,b)>=0!==c})}m.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?m.find.matchesSelector(d,a)?[d]:[]:m.find.matches(a,m.grep(b,function(a){return 1===a.nodeType}))},m.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(m(a).filter(function(){for(b=0;e>b;b++)if(m.contains(d[b],this))return!0}));for(b=0;e>b;b++)m.find(a,d[b],c);return c=this.pushStack(e>1?m.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(w(this,a||[],!1))},not:function(a){return this.pushStack(w(this,a||[],!0))},is:function(a){return!!w(this,"string"==typeof a&&t.test(a)?m(a):a||[],!1).length}});var x,y=a.document,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=m.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||x).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof m?b[0]:b,m.merge(this,m.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:y,!0)),u.test(c[1])&&m.isPlainObject(b))for(c in b)m.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=y.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return x.find(a);this.length=1,this[0]=d}return this.context=y,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):m.isFunction(a)?"undefined"!=typeof x.ready?x.ready(a):a(m):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),m.makeArray(a,this))};A.prototype=m.fn,x=m(y);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};m.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!m(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),m.fn.extend({has:function(a){var b,c=m(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(m.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=t.test(a)||"string"!=typeof a?m(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&m.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?m.unique(f):f)},index:function(a){return a?"string"==typeof a?m.inArray(this[0],m(a)):m.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(m.unique(m.merge(this.get(),m(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}m.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return m.dir(a,"parentNode")},parentsUntil:function(a,b,c){return m.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return m.dir(a,"nextSibling")},prevAll:function(a){return m.dir(a,"previousSibling")},nextUntil:function(a,b,c){return m.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return m.dir(a,"previousSibling",c)},siblings:function(a){return m.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return m.sibling(a.firstChild)},contents:function(a){return m.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:m.merge([],a.childNodes)}},function(a,b){m.fn[a]=function(c,d){var e=m.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=m.filter(d,e)),this.length>1&&(C[a]||(e=m.unique(e)),B.test(a)&&(e=e.reverse())),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return m.each(a.match(E)||[],function(a,c){b[c]=!0}),b}m.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):m.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){m.each(b,function(b,c){var d=m.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&m.each(arguments,function(a,c){var d;while((d=m.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?m.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},m.extend({Deferred:function(a){var b=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return m.Deferred(function(c){m.each(b,function(b,f){var g=m.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&m.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?m.extend(a,d):d}},e={};return d.pipe=d.then,m.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&m.isFunction(a.promise)?e:0,g=1===f?a:m.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&m.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;m.fn.ready=function(a){return m.ready.promise().done(a),this},m.extend({isReady:!1,readyWait:1,holdReady:function(a){a?m.readyWait++:m.ready(!0)},ready:function(a){if(a===!0?!--m.readyWait:!m.isReady){if(!y.body)return setTimeout(m.ready);m.isReady=!0,a!==!0&&--m.readyWait>0||(H.resolveWith(y,[m]),m.fn.triggerHandler&&(m(y).triggerHandler("ready"),m(y).off("ready")))}}});function I(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",J,!1),a.removeEventListener("load",J,!1)):(y.detachEvent("onreadystatechange",J),a.detachEvent("onload",J))}function J(){(y.addEventListener||"load"===event.type||"complete"===y.readyState)&&(I(),m.ready())}m.ready.promise=function(b){if(!H)if(H=m.Deferred(),"complete"===y.readyState)setTimeout(m.ready);else if(y.addEventListener)y.addEventListener("DOMContentLoaded",J,!1),a.addEventListener("load",J,!1);else{y.attachEvent("onreadystatechange",J),a.attachEvent("onload",J);var c=!1;try{c=null==a.frameElement&&y.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!m.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}I(),m.ready()}}()}return H.promise(b)};var K="undefined",L;for(L in m(k))break;k.ownLast="0"!==L,k.inlineBlockNeedsLayout=!1,m(function(){var a,b,c,d;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",k.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=y.createElement("div");if(null==k.deleteExpando){k.deleteExpando=!0;try{delete a.test}catch(b){k.deleteExpando=!1}}a=null}(),m.acceptData=function(a){var b=m.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var M=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,N=/([A-Z])/g;function O(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(N,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:M.test(c)?m.parseJSON(c):c}catch(e){}m.data(a,b,c)}else c=void 0}return c}function P(a){var b;for(b in a)if(("data"!==b||!m.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;
return!0}function Q(a,b,d,e){if(m.acceptData(a)){var f,g,h=m.expando,i=a.nodeType,j=i?m.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||m.guid++:h),j[k]||(j[k]=i?{}:{toJSON:m.noop}),("object"==typeof b||"function"==typeof b)&&(e?j[k]=m.extend(j[k],b):j[k].data=m.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[m.camelCase(b)]=d),"string"==typeof b?(f=g[b],null==f&&(f=g[m.camelCase(b)])):f=g,f}}function R(a,b,c){if(m.acceptData(a)){var d,e,f=a.nodeType,g=f?m.cache:a,h=f?a[m.expando]:m.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){m.isArray(b)?b=b.concat(m.map(b,m.camelCase)):b in d?b=[b]:(b=m.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;while(e--)delete d[b[e]];if(c?!P(d):!m.isEmptyObject(d))return}(c||(delete g[h].data,P(g[h])))&&(f?m.cleanData([a],!0):k.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}m.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?m.cache[a[m.expando]]:a[m.expando],!!a&&!P(a)},data:function(a,b,c){return Q(a,b,c)},removeData:function(a,b){return R(a,b)},_data:function(a,b,c){return Q(a,b,c,!0)},_removeData:function(a,b){return R(a,b,!0)}}),m.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=m.data(f),1===f.nodeType&&!m._data(f,"parsedAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=m.camelCase(d.slice(5)),O(f,d,e[d])));m._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){m.data(this,a)}):arguments.length>1?this.each(function(){m.data(this,a,b)}):f?O(f,a,m.data(f,a)):void 0},removeData:function(a){return this.each(function(){m.removeData(this,a)})}}),m.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=m._data(a,b),c&&(!d||m.isArray(c)?d=m._data(a,b,m.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=m.queue(a,b),d=c.length,e=c.shift(),f=m._queueHooks(a,b),g=function(){m.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return m._data(a,c)||m._data(a,c,{empty:m.Callbacks("once memory").add(function(){m._removeData(a,b+"queue"),m._removeData(a,c)})})}}),m.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?m.queue(this[0],a):void 0===b?this:this.each(function(){var c=m.queue(this,a,b);m._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&m.dequeue(this,a)})},dequeue:function(a){return this.each(function(){m.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=m.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=m._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var S=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=["Top","Right","Bottom","Left"],U=function(a,b){return a=b||a,"none"===m.css(a,"display")||!m.contains(a.ownerDocument,a)},V=m.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===m.type(c)){e=!0;for(h in c)m.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,m.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(m(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},W=/^(?:checkbox|radio)$/i;!function(){var a=y.createElement("input"),b=y.createElement("div"),c=y.createDocumentFragment();if(b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",k.leadingWhitespace=3===b.firstChild.nodeType,k.tbody=!b.getElementsByTagName("tbody").length,k.htmlSerialize=!!b.getElementsByTagName("link").length,k.html5Clone="<:nav></:nav>"!==y.createElement("nav").cloneNode(!0).outerHTML,a.type="checkbox",a.checked=!0,c.appendChild(a),k.appendChecked=a.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,c.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,k.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){k.noCloneEvent=!1}),b.cloneNode(!0).click()),null==k.deleteExpando){k.deleteExpando=!0;try{delete b.test}catch(d){k.deleteExpando=!1}}}(),function(){var b,c,d=y.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(k[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),k[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var X=/^(?:input|select|textarea)$/i,Y=/^key/,Z=/^(?:mouse|pointer|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=/^([^.]*)(?:\.(.+)|)$/;function ab(){return!0}function bb(){return!1}function cb(){try{return y.activeElement}catch(a){}}m.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=m.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof m===K||a&&m.event.triggered===a.type?void 0:m.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(E)||[""],h=b.length;while(h--)f=_.exec(b[h])||[],o=q=f[1],p=(f[2]||"").split(".").sort(),o&&(j=m.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=m.event.special[o]||{},l=m.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&m.expr.match.needsContext.test(e),namespace:p.join(".")},i),(n=g[o])||(n=g[o]=[],n.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?n.splice(n.delegateCount++,0,l):n.push(l),m.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m.hasData(a)&&m._data(a);if(r&&(k=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=_.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=m.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,n=k[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=n.length;while(f--)g=n[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(n.splice(f,1),g.selector&&n.delegateCount--,l.remove&&l.remove.call(a,g));i&&!n.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||m.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)m.event.remove(a,o+b[j],c,d,!0);m.isEmptyObject(k)&&(delete r.handle,m._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,n,o=[d||y],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||y,3!==d.nodeType&&8!==d.nodeType&&!$.test(p+m.event.triggered)&&(p.indexOf(".")>=0&&(q=p.split("."),p=q.shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,b=b[m.expando]?b:new m.Event(p,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:m.makeArray(c,[b]),k=m.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!m.isWindow(d)){for(i=k.delegateType||p,$.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||y)&&o.push(l.defaultView||l.parentWindow||a)}n=0;while((h=o[n++])&&!b.isPropagationStopped())b.type=n>1?i:k.bindType||p,f=(m._data(h,"events")||{})[b.type]&&m._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&m.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&m.acceptData(d)&&g&&d[p]&&!m.isWindow(d)){l=d[g],l&&(d[g]=null),m.event.triggered=p;try{d[p]()}catch(r){}m.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=m.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(m._data(this,"events")||{})[a.type]||[],k=m.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=m.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((m.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?m(c,this).index(i)>=0:m.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[m.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=Z.test(e)?this.mouseHooks:Y.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new m.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||y),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||y,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==cb()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===cb()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return m.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return m.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=m.extend(new m.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?m.event.trigger(e,null,b):m.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},m.removeEvent=y.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===K&&(a[d]=null),a.detachEvent(d,c))},m.Event=function(a,b){return this instanceof m.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?ab:bb):this.type=a,b&&m.extend(this,b),this.timeStamp=a&&a.timeStamp||m.now(),void(this[m.expando]=!0)):new m.Event(a,b)},m.Event.prototype={isDefaultPrevented:bb,isPropagationStopped:bb,isImmediatePropagationStopped:bb,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ab,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ab,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ab,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){m.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!m.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.submitBubbles||(m.event.special.submit={setup:function(){return m.nodeName(this,"form")?!1:void m.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=m.nodeName(b,"input")||m.nodeName(b,"button")?b.form:void 0;c&&!m._data(c,"submitBubbles")&&(m.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),m._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&m.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return m.nodeName(this,"form")?!1:void m.event.remove(this,"._submit")}}),k.changeBubbles||(m.event.special.change={setup:function(){return X.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(m.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),m.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),m.event.simulate("change",this,a,!0)})),!1):void m.event.add(this,"beforeactivate._change",function(a){var b=a.target;X.test(b.nodeName)&&!m._data(b,"changeBubbles")&&(m.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||m.event.simulate("change",this.parentNode,a,!0)}),m._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return m.event.remove(this,"._change"),!X.test(this.nodeName)}}),k.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){m.event.simulate(b,a.target,m.event.fix(a),!0)};m.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=m._data(d,b);e||d.addEventListener(a,c,!0),m._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=m._data(d,b)-1;e?m._data(d,b,e):(d.removeEventListener(a,c,!0),m._removeData(d,b))}}}),m.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=bb;else if(!d)return this;return 1===e&&(g=d,d=function(a){return m().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=m.guid++)),this.each(function(){m.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,m(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=bb),this.each(function(){m.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){m.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?m.event.trigger(a,b,c,!0):void 0}});function db(a){var b=eb.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var eb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",fb=/ jQuery\d+="(?:null|\d+)"/g,gb=new RegExp("<(?:"+eb+")[\\s/>]","i"),hb=/^\s+/,ib=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,jb=/<([\w:]+)/,kb=/<tbody/i,lb=/<|&#?\w+;/,mb=/<(?:script|style|link)/i,nb=/checked\s*(?:[^=]|=\s*.checked.)/i,ob=/^$|\/(?:java|ecma)script/i,pb=/^true\/(.*)/,qb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,rb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:k.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},sb=db(y),tb=sb.appendChild(y.createElement("div"));rb.optgroup=rb.option,rb.tbody=rb.tfoot=rb.colgroup=rb.caption=rb.thead,rb.th=rb.td;function ub(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==K?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==K?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||m.nodeName(d,b)?f.push(d):m.merge(f,ub(d,b));return void 0===b||b&&m.nodeName(a,b)?m.merge([a],f):f}function vb(a){W.test(a.type)&&(a.defaultChecked=a.checked)}function wb(a,b){return m.nodeName(a,"table")&&m.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function xb(a){return a.type=(null!==m.find.attr(a,"type"))+"/"+a.type,a}function yb(a){var b=pb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function zb(a,b){for(var c,d=0;null!=(c=a[d]);d++)m._data(c,"globalEval",!b||m._data(b[d],"globalEval"))}function Ab(a,b){if(1===b.nodeType&&m.hasData(a)){var c,d,e,f=m._data(a),g=m._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)m.event.add(b,c,h[c][d])}g.data&&(g.data=m.extend({},g.data))}}function Bb(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!k.noCloneEvent&&b[m.expando]){e=m._data(b);for(d in e.events)m.removeEvent(b,d,e.handle);b.removeAttribute(m.expando)}"script"===c&&b.text!==a.text?(xb(b).text=a.text,yb(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),k.html5Clone&&a.innerHTML&&!m.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&W.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}m.extend({clone:function(a,b,c){var d,e,f,g,h,i=m.contains(a.ownerDocument,a);if(k.html5Clone||m.isXMLDoc(a)||!gb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(tb.innerHTML=a.outerHTML,tb.removeChild(f=tb.firstChild)),!(k.noCloneEvent&&k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||m.isXMLDoc(a)))for(d=ub(f),h=ub(a),g=0;null!=(e=h[g]);++g)d[g]&&Bb(e,d[g]);if(b)if(c)for(h=h||ub(a),d=d||ub(f),g=0;null!=(e=h[g]);g++)Ab(e,d[g]);else Ab(a,f);return d=ub(f,"script"),d.length>0&&zb(d,!i&&ub(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,l,n=a.length,o=db(b),p=[],q=0;n>q;q++)if(f=a[q],f||0===f)if("object"===m.type(f))m.merge(p,f.nodeType?[f]:f);else if(lb.test(f)){h=h||o.appendChild(b.createElement("div")),i=(jb.exec(f)||["",""])[1].toLowerCase(),l=rb[i]||rb._default,h.innerHTML=l[1]+f.replace(ib,"<$1></$2>")+l[2],e=l[0];while(e--)h=h.lastChild;if(!k.leadingWhitespace&&hb.test(f)&&p.push(b.createTextNode(hb.exec(f)[0])),!k.tbody){f="table"!==i||kb.test(f)?"<table>"!==l[1]||kb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)m.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j)}m.merge(p,h.childNodes),h.textContent="";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),k.appendChecked||m.grep(ub(p,"input"),vb),q=0;while(f=p[q++])if((!d||-1===m.inArray(f,d))&&(g=m.contains(f.ownerDocument,f),h=ub(o.appendChild(f),"script"),g&&zb(h),c)){e=0;while(f=h[e++])ob.test(f.type||"")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=m.expando,j=m.cache,l=k.deleteExpando,n=m.event.special;null!=(d=a[h]);h++)if((b||m.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)n[e]?m.event.remove(d,e):m.removeEvent(d,e,g.handle);j[f]&&(delete j[f],l?delete d[i]:typeof d.removeAttribute!==K?d.removeAttribute(i):d[i]=null,c.push(f))}}}),m.fn.extend({text:function(a){return V(this,function(a){return void 0===a?m.text(this):this.empty().append((this[0]&&this[0].ownerDocument||y).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?m.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||m.cleanData(ub(c)),c.parentNode&&(b&&m.contains(c.ownerDocument,c)&&zb(ub(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&m.cleanData(ub(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&m.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return m.clone(this,a,b)})},html:function(a){return V(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(fb,""):void 0;if(!("string"!=typeof a||mb.test(a)||!k.htmlSerialize&&gb.test(a)||!k.leadingWhitespace&&hb.test(a)||rb[(jb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(ib,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(m.cleanData(ub(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,m.cleanData(ub(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,n=this,o=l-1,p=a[0],q=m.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&nb.test(p))return this.each(function(c){var d=n.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(i=m.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=m.map(ub(i,"script"),xb),f=g.length;l>j;j++)d=i,j!==o&&(d=m.clone(d,!0,!0),f&&m.merge(g,ub(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,m.map(g,yb),j=0;f>j;j++)d=g[j],ob.test(d.type||"")&&!m._data(d,"globalEval")&&m.contains(h,d)&&(d.src?m._evalUrl&&m._evalUrl(d.src):m.globalEval((d.text||d.textContent||d.innerHTML||"").replace(qb,"")));i=c=null}return this}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){m.fn[a]=function(a){for(var c,d=0,e=[],g=m(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),m(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Cb,Db={};function Eb(b,c){var d,e=m(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:m.css(e[0],"display");return e.detach(),f}function Fb(a){var b=y,c=Db[a];return c||(c=Eb(a,b),"none"!==c&&c||(Cb=(Cb||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(Cb[0].contentWindow||Cb[0].contentDocument).document,b.write(),b.close(),c=Eb(a,b),Cb.detach()),Db[a]=c),c}!function(){var a;k.shrinkWrapBlocks=function(){if(null!=a)return a;a=!1;var b,c,d;return c=y.getElementsByTagName("body")[0],c&&c.style?(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",b.appendChild(y.createElement("div")).style.width="5px",a=3!==b.offsetWidth),c.removeChild(d),a):void 0}}();var Gb=/^margin/,Hb=new RegExp("^("+S+")(?!px)[a-z%]+$","i"),Ib,Jb,Kb=/^(top|right|bottom|left)$/;a.getComputedStyle?(Ib=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},Jb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ib(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||m.contains(a.ownerDocument,a)||(g=m.style(a,b)),Hb.test(g)&&Gb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):y.documentElement.currentStyle&&(Ib=function(a){return a.currentStyle},Jb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ib(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Hb.test(g)&&!Kb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"});function Lb(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h;if(b=y.createElement("div"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=d&&d.style){c.cssText="float:left;opacity:.5",k.opacity="0.5"===c.opacity,k.cssFloat=!!c.cssFloat,b.style.backgroundClip="content-box",b.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===b.style.backgroundClip,k.boxSizing=""===c.boxSizing||""===c.MozBoxSizing||""===c.WebkitBoxSizing,m.extend(k,{reliableHiddenOffsets:function(){return null==g&&i(),g},boxSizingReliable:function(){return null==f&&i(),f},pixelPosition:function(){return null==e&&i(),e},reliableMarginRight:function(){return null==h&&i(),h}});function i(){var b,c,d,i;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),b.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",e=f=!1,h=!0,a.getComputedStyle&&(e="1%"!==(a.getComputedStyle(b,null)||{}).top,f="4px"===(a.getComputedStyle(b,null)||{width:"4px"}).width,i=b.appendChild(y.createElement("div")),i.style.cssText=b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",b.style.width="1px",h=!parseFloat((a.getComputedStyle(i,null)||{}).marginRight)),b.innerHTML="<table><tr><td></td><td>t</td></tr></table>",i=b.getElementsByTagName("td"),i[0].style.cssText="margin:0;border:0;padding:0;display:none",g=0===i[0].offsetHeight,g&&(i[0].style.display="",i[1].style.display="none",g=0===i[0].offsetHeight),c.removeChild(d))}}}(),m.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Mb=/alpha\([^)]*\)/i,Nb=/opacity\s*=\s*([^)]*)/,Ob=/^(none|table(?!-c[ea]).+)/,Pb=new RegExp("^("+S+")(.*)$","i"),Qb=new RegExp("^([+-])=("+S+")","i"),Rb={position:"absolute",visibility:"hidden",display:"block"},Sb={letterSpacing:"0",fontWeight:"400"},Tb=["Webkit","O","Moz","ms"];function Ub(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Tb.length;while(e--)if(b=Tb[e]+c,b in a)return b;return d}function Vb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=m._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&U(d)&&(f[g]=m._data(d,"olddisplay",Fb(d.nodeName)))):(e=U(d),(c&&"none"!==c||!e)&&m._data(d,"olddisplay",e?c:m.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Wb(a,b,c){var d=Pb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Xb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=m.css(a,c+T[f],!0,e)),d?("content"===c&&(g-=m.css(a,"padding"+T[f],!0,e)),"margin"!==c&&(g-=m.css(a,"border"+T[f]+"Width",!0,e))):(g+=m.css(a,"padding"+T[f],!0,e),"padding"!==c&&(g+=m.css(a,"border"+T[f]+"Width",!0,e)));return g}function Yb(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ib(a),g=k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Jb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Hb.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Xb(a,b,c||(g?"border":"content"),d,f)+"px"}m.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Jb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":k.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=m.camelCase(b),i=a.style;if(b=m.cssProps[h]||(m.cssProps[h]=Ub(i,h)),g=m.cssHooks[b]||m.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Qb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(m.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||m.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=m.camelCase(b);return b=m.cssProps[h]||(m.cssProps[h]=Ub(a.style,h)),g=m.cssHooks[b]||m.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Jb(a,b,d)),"normal"===f&&b in Sb&&(f=Sb[b]),""===c||c?(e=parseFloat(f),c===!0||m.isNumeric(e)?e||0:f):f}}),m.each(["height","width"],function(a,b){m.cssHooks[b]={get:function(a,c,d){return c?Ob.test(m.css(a,"display"))&&0===a.offsetWidth?m.swap(a,Rb,function(){return Yb(a,b,d)}):Yb(a,b,d):void 0},set:function(a,c,d){var e=d&&Ib(a);return Wb(a,c,d?Xb(a,b,d,k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,e),e):0)}}}),k.opacity||(m.cssHooks.opacity={get:function(a,b){return Nb.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=m.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===m.trim(f.replace(Mb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Mb.test(f)?f.replace(Mb,e):f+" "+e)}}),m.cssHooks.marginRight=Lb(k.reliableMarginRight,function(a,b){return b?m.swap(a,{display:"inline-block"},Jb,[a,"marginRight"]):void 0}),m.each({margin:"",padding:"",border:"Width"},function(a,b){m.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+T[d]+b]=f[d]||f[d-2]||f[0];return e}},Gb.test(a)||(m.cssHooks[a+b].set=Wb)}),m.fn.extend({css:function(a,b){return V(this,function(a,b,c){var d,e,f={},g=0;if(m.isArray(b)){for(d=Ib(a),e=b.length;e>g;g++)f[b[g]]=m.css(a,b[g],!1,d);return f}return void 0!==c?m.style(a,b,c):m.css(a,b)},a,b,arguments.length>1)},show:function(){return Vb(this,!0)},hide:function(){return Vb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){U(this)?m(this).show():m(this).hide()})}});function Zb(a,b,c,d,e){return new Zb.prototype.init(a,b,c,d,e)}m.Tween=Zb,Zb.prototype={constructor:Zb,
init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(m.cssNumber[c]?"":"px")},cur:function(){var a=Zb.propHooks[this.prop];return a&&a.get?a.get(this):Zb.propHooks._default.get(this)},run:function(a){var b,c=Zb.propHooks[this.prop];return this.pos=b=this.options.duration?m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Zb.propHooks._default.set(this),this}},Zb.prototype.init.prototype=Zb.prototype,Zb.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=m.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){m.fx.step[a.prop]?m.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Zb.propHooks.scrollTop=Zb.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},m.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},m.fx=Zb.prototype.init,m.fx.step={};var $b,_b,ac=/^(?:toggle|show|hide)$/,bc=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),cc=/queueHooks$/,dc=[ic],ec={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=bc.exec(b),f=e&&e[3]||(m.cssNumber[a]?"":"px"),g=(m.cssNumber[a]||"px"!==f&&+d)&&bc.exec(m.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,m.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function fc(){return setTimeout(function(){$b=void 0}),$b=m.now()}function gc(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=T[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function hc(a,b,c){for(var d,e=(ec[b]||[]).concat(ec["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function ic(a,b,c){var d,e,f,g,h,i,j,l,n=this,o={},p=a.style,q=a.nodeType&&U(a),r=m._data(a,"fxshow");c.queue||(h=m._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,n.always(function(){n.always(function(){h.unqueued--,m.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=m.css(a,"display"),l="none"===j?m._data(a,"olddisplay")||Fb(a.nodeName):j,"inline"===l&&"none"===m.css(a,"float")&&(k.inlineBlockNeedsLayout&&"inline"!==Fb(a.nodeName)?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",k.shrinkWrapBlocks()||n.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],ac.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||m.style(a,d)}else j=void 0;if(m.isEmptyObject(o))"inline"===("none"===j?Fb(a.nodeName):j)&&(p.display=j);else{r?"hidden"in r&&(q=r.hidden):r=m._data(a,"fxshow",{}),f&&(r.hidden=!q),q?m(a).show():n.done(function(){m(a).hide()}),n.done(function(){var b;m._removeData(a,"fxshow");for(b in o)m.style(a,b,o[b])});for(d in o)g=hc(q?r[d]:0,d,n),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function jc(a,b){var c,d,e,f,g;for(c in a)if(d=m.camelCase(c),e=b[d],f=a[c],m.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=m.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function kc(a,b,c){var d,e,f=0,g=dc.length,h=m.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$b||fc(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:m.extend({},b),opts:m.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$b||fc(),duration:c.duration,tweens:[],createTween:function(b,c){var d=m.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(jc(k,j.opts.specialEasing);g>f;f++)if(d=dc[f].call(j,a,k,j.opts))return d;return m.map(k,hc,j),m.isFunction(j.opts.start)&&j.opts.start.call(a,j),m.fx.timer(m.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}m.Animation=m.extend(kc,{tweener:function(a,b){m.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],ec[c]=ec[c]||[],ec[c].unshift(b)},prefilter:function(a,b){b?dc.unshift(a):dc.push(a)}}),m.speed=function(a,b,c){var d=a&&"object"==typeof a?m.extend({},a):{complete:c||!c&&b||m.isFunction(a)&&a,duration:a,easing:c&&b||b&&!m.isFunction(b)&&b};return d.duration=m.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in m.fx.speeds?m.fx.speeds[d.duration]:m.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){m.isFunction(d.old)&&d.old.call(this),d.queue&&m.dequeue(this,d.queue)},d},m.fn.extend({fadeTo:function(a,b,c,d){return this.filter(U).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=m.isEmptyObject(a),f=m.speed(b,c,d),g=function(){var b=kc(this,m.extend({},a),f);(e||m._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=m.timers,g=m._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&cc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&m.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=m._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=m.timers,g=d?d.length:0;for(c.finish=!0,m.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];m.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gc(b,!0),a,d,e)}}),m.each({slideDown:gc("show"),slideUp:gc("hide"),slideToggle:gc("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),m.timers=[],m.fx.tick=function(){var a,b=m.timers,c=0;for($b=m.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||m.fx.stop(),$b=void 0},m.fx.timer=function(a){m.timers.push(a),a()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){_b||(_b=setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){clearInterval(_b),_b=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(a,b){return a=m.fx?m.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e;b=y.createElement("div"),b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=y.createElement("select"),e=c.appendChild(y.createElement("option")),a=b.getElementsByTagName("input")[0],d.style.cssText="top:1px",k.getSetAttribute="t"!==b.className,k.style=/top/.test(d.getAttribute("style")),k.hrefNormalized="/a"===d.getAttribute("href"),k.checkOn=!!a.value,k.optSelected=e.selected,k.enctype=!!y.createElement("form").enctype,c.disabled=!0,k.optDisabled=!e.disabled,a=y.createElement("input"),a.setAttribute("value",""),k.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),k.radioValue="t"===a.value}();var lc=/\r/g;m.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=m.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,m(this).val()):a,null==e?e="":"number"==typeof e?e+="":m.isArray(e)&&(e=m.map(e,function(a){return null==a?"":a+""})),b=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=m.valHooks[e.type]||m.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(lc,""):null==c?"":c)}}}),m.extend({valHooks:{option:{get:function(a){var b=m.find.attr(a,"value");return null!=b?b:m.trim(m.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&m.nodeName(c.parentNode,"optgroup"))){if(b=m(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=m.makeArray(b),g=e.length;while(g--)if(d=e[g],m.inArray(m.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),m.each(["radio","checkbox"],function(){m.valHooks[this]={set:function(a,b){return m.isArray(b)?a.checked=m.inArray(m(a).val(),b)>=0:void 0}},k.checkOn||(m.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var mc,nc,oc=m.expr.attrHandle,pc=/^(?:checked|selected)$/i,qc=k.getSetAttribute,rc=k.input;m.fn.extend({attr:function(a,b){return V(this,m.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){m.removeAttr(this,a)})}}),m.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===K?m.prop(a,b,c):(1===f&&m.isXMLDoc(a)||(b=b.toLowerCase(),d=m.attrHooks[b]||(m.expr.match.bool.test(b)?nc:mc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=m.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void m.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=m.propFix[c]||c,m.expr.match.bool.test(c)?rc&&qc||!pc.test(c)?a[d]=!1:a[m.camelCase("default-"+c)]=a[d]=!1:m.attr(a,c,""),a.removeAttribute(qc?c:d)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&m.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),nc={set:function(a,b,c){return b===!1?m.removeAttr(a,c):rc&&qc||!pc.test(c)?a.setAttribute(!qc&&m.propFix[c]||c,c):a[m.camelCase("default-"+c)]=a[c]=!0,c}},m.each(m.expr.match.bool.source.match(/\w+/g),function(a,b){var c=oc[b]||m.find.attr;oc[b]=rc&&qc||!pc.test(b)?function(a,b,d){var e,f;return d||(f=oc[b],oc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,oc[b]=f),e}:function(a,b,c){return c?void 0:a[m.camelCase("default-"+b)]?b.toLowerCase():null}}),rc&&qc||(m.attrHooks.value={set:function(a,b,c){return m.nodeName(a,"input")?void(a.defaultValue=b):mc&&mc.set(a,b,c)}}),qc||(mc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},oc.id=oc.name=oc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},m.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:mc.set},m.attrHooks.contenteditable={set:function(a,b,c){mc.set(a,""===b?!1:b,c)}},m.each(["width","height"],function(a,b){m.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),k.style||(m.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var sc=/^(?:input|select|textarea|button|object)$/i,tc=/^(?:a|area)$/i;m.fn.extend({prop:function(a,b){return V(this,m.prop,a,b,arguments.length>1)},removeProp:function(a){return a=m.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),m.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!m.isXMLDoc(a),f&&(b=m.propFix[b]||b,e=m.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=m.find.attr(a,"tabindex");return b?parseInt(b,10):sc.test(a.nodeName)||tc.test(a.nodeName)&&a.href?0:-1}}}}),k.hrefNormalized||m.each(["href","src"],function(a,b){m.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),k.optSelected||(m.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){m.propFix[this.toLowerCase()]=this}),k.enctype||(m.propFix.enctype="encoding");var uc=/[\t\r\n\f]/g;m.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(uc," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=m.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(uc," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?m.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(m.isFunction(a)?function(c){m(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=m(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===K||"boolean"===c)&&(this.className&&m._data(this,"__className__",this.className),this.className=this.className||a===!1?"":m._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(uc," ").indexOf(b)>=0)return!0;return!1}}),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){m.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),m.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var vc=m.now(),wc=/\?/,xc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;m.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=m.trim(b+"");return e&&!m.trim(e.replace(xc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():m.error("Invalid JSON: "+b)},m.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+b),c};var yc,zc,Ac=/#.*$/,Bc=/([?&])_=[^&]*/,Cc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Dc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ec=/^(?:GET|HEAD)$/,Fc=/^\/\//,Gc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Hc={},Ic={},Jc="*/".concat("*");try{zc=location.href}catch(Kc){zc=y.createElement("a"),zc.href="",zc=zc.href}yc=Gc.exec(zc.toLowerCase())||[];function Lc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(m.isFunction(c))while(d=f[e++])"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Mc(a,b,c,d){var e={},f=a===Ic;function g(h){var i;return e[h]=!0,m.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Nc(a,b){var c,d,e=m.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&m.extend(!0,a,c),a}function Oc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Pc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zc,type:"GET",isLocal:Dc.test(yc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Jc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Nc(Nc(a,m.ajaxSettings),b):Nc(m.ajaxSettings,a)},ajaxPrefilter:Lc(Hc),ajaxTransport:Lc(Ic),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=m.ajaxSetup({},b),l=k.context||k,n=k.context&&(l.nodeType||l.jquery)?m(l):m.event,o=m.Deferred(),p=m.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Cc.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||zc)+"").replace(Ac,"").replace(Fc,yc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=m.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(c=Gc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===yc[1]&&c[2]===yc[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(yc[3]||("http:"===yc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=m.param(k.data,k.traditional)),Mc(Hc,k,b,v),2===t)return v;h=k.global,h&&0===m.active++&&m.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Ec.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(wc.test(e)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=Bc.test(e)?e.replace(Bc,"$1_="+vc++):e+(wc.test(e)?"&":"?")+"_="+vc++)),k.ifModified&&(m.lastModified[e]&&v.setRequestHeader("If-Modified-Since",m.lastModified[e]),m.etag[e]&&v.setRequestHeader("If-None-Match",m.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Jc+"; q=0.01":""):k.accepts["*"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Mc(Ic,k,b,v)){v.readyState=1,h&&n.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Oc(k,v,c)),u=Pc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(m.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(m.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&n.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(n.trigger("ajaxComplete",[v,k]),--m.active||m.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return m.get(a,b,c,"json")},getScript:function(a,b){return m.get(a,void 0,b,"script")}}),m.each(["get","post"],function(a,b){m[b]=function(a,c,d,e){return m.isFunction(c)&&(e=e||d,d=c,c=void 0),m.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){m.fn[b]=function(a){return this.on(b,a)}}),m._evalUrl=function(a){return m.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},m.fn.extend({wrapAll:function(a){if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});if(this[0]){var b=m(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(m.isFunction(a)?function(b){m(this).wrapInner(a.call(this,b))}:function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()}}),m.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!k.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||m.css(a,"display"))},m.expr.filters.visible=function(a){return!m.expr.filters.hidden(a)};var Qc=/%20/g,Rc=/\[\]$/,Sc=/\r?\n/g,Tc=/^(?:submit|button|image|reset|file)$/i,Uc=/^(?:input|select|textarea|keygen)/i;function Vc(a,b,c,d){var e;if(m.isArray(b))m.each(b,function(b,e){c||Rc.test(a)?d(a,e):Vc(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==m.type(b))d(a,b);else for(e in b)Vc(a+"["+e+"]",b[e],c,d)}m.param=function(a,b){var c,d=[],e=function(a,b){b=m.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,function(){e(this.name,this.value)});else for(c in a)Vc(c,a[c],b,e);return d.join("&").replace(Qc,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=m.prop(this,"elements");return a?m.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!m(this).is(":disabled")&&Uc.test(this.nodeName)&&!Tc.test(a)&&(this.checked||!W.test(a))}).map(function(a,b){var c=m(this).val();return null==c?null:m.isArray(c)?m.map(c,function(a){return{name:b.name,value:a.replace(Sc,"\r\n")}}):{name:b.name,value:c.replace(Sc,"\r\n")}}).get()}}),m.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Zc()||$c()}:Zc;var Wc=0,Xc={},Yc=m.ajaxSettings.xhr();a.ActiveXObject&&m(a).on("unload",function(){for(var a in Xc)Xc[a](void 0,!0)}),k.cors=!!Yc&&"withCredentials"in Yc,Yc=k.ajax=!!Yc,Yc&&m.ajaxTransport(function(a){if(!a.crossDomain||k.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Wc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Xc[g],b=void 0,f.onreadystatechange=m.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Xc[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function Zc(){try{return new a.XMLHttpRequest}catch(b){}}function $c(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return m.globalEval(a),a}}}),m.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),m.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=y.head||m("head")[0]||y.documentElement;return{send:function(d,e){b=y.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var _c=[],ad=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=_c.pop()||m.expando+"_"+vc++;return this[a]=!0,a}}),m.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(ad.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&ad.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=m.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(ad,"$1"+e):b.jsonp!==!1&&(b.url+=(wc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||m.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,_c.push(e)),g&&m.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),m.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||y;var d=u.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=m.buildFragment([a],b,e),e&&e.length&&m(e).remove(),m.merge([],d.childNodes))};var bd=m.fn.load;m.fn.load=function(a,b,c){if("string"!=typeof a&&bd)return bd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=m.trim(a.slice(h,a.length)),a=a.slice(0,h)),m.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&m.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?m("<div>").append(m.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},m.expr.filters.animated=function(a){return m.grep(m.timers,function(b){return a===b.elem}).length};var cd=a.document.documentElement;function dd(a){return m.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}m.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=m.css(a,"position"),l=m(a),n={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=m.css(a,"top"),i=m.css(a,"left"),j=("absolute"===k||"fixed"===k)&&m.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),m.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(n.top=b.top-h.top+g),null!=b.left&&(n.left=b.left-h.left+e),"using"in b?b.using.call(a,n):l.css(n)}},m.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){m.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,m.contains(b,e)?(typeof e.getBoundingClientRect!==K&&(d=e.getBoundingClientRect()),c=dd(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===m.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),m.nodeName(a[0],"html")||(c=a.offset()),c.top+=m.css(a[0],"borderTopWidth",!0),c.left+=m.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-m.css(d,"marginTop",!0),left:b.left-c.left-m.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||cd;while(a&&!m.nodeName(a,"html")&&"static"===m.css(a,"position"))a=a.offsetParent;return a||cd})}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);m.fn[a]=function(d){return V(this,function(a,d,e){var f=dd(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?m(f).scrollLeft():e,c?e:m(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),m.each(["top","left"],function(a,b){m.cssHooks[b]=Lb(k.pixelPosition,function(a,c){return c?(c=Jb(a,b),Hb.test(c)?m(a).position()[b]+"px":c):void 0})}),m.each({Height:"height",Width:"width"},function(a,b){m.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){m.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return V(this,function(b,c,d){var e;return m.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?m.css(b,c,g):m.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),m.fn.size=function(){return this.length},m.fn.andSelf=m.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return m});var ed=a.jQuery,fd=a.$;return m.noConflict=function(b){return a.$===m&&(a.$=fd),b&&a.jQuery===m&&(a.jQuery=ed),m},typeof b===K&&(a.jQuery=a.$=m),m});return jQuery.noConflict(true)});
(function(){var __hola_stub_define;var is_node=typeof module=="object"&&module.exports&&module.children;var is_ff_addon=typeof module=="object"&&module.uri&&!module.uri.indexOf("resource://");var qs;if(!is_node&&!is_ff_addon)define=define||self.define;else{define=require("./require_node.js").define(module,"../");qs=require(is_ff_addon?"sdk/querystring":"querystring")}define("/util/url.js",[],function(){var assign=Object.assign;var E={};E.add_proto=function(url){if(!url.match(/^([a-z0-9]+:)?\/\//i))url="http://"+url;return url};E.rel_proto_to_abs=function(url){var proto=is_node?"http:":location.protocol;return url.replace(/^\/\//,proto+"//")};E.get_top_level_domain=function(host){var n=host.match(/\.([^.]+)$/);return n?n[1]:""};E.get_host=function(url){var n=url.match(/^(https?:)?\/\/([^\/]+)\/.*$/);return n?n[2]:""};E.get_host_without_tld=function(host){return host.replace(/^([^.]+)\.[^.]{2,3}(\.[^.]{2,3})?$/,"$1")};E.get_path=function(url){var n=url.match(/^https?:\/\/[^\/]+(\/.*$)/);return n?n[1]:""};E.get_proto=function(url){var n=url.match(/^([a-z0-9]+):\/\//);return n?n[1]:""};E.get_host_gently=function(url){var n=url.match(/^(?:(?:[a-z0-9]+?:)?\/\/)?([^\/]+)/);return n?n[1]:""};E.is_ip=function(host){var m=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(host);if(!m)return false;for(var i=1;i<=4;i++){if(+m[i]>255)return false}return true};E.is_ip_mask=function(host){var m=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(host);if(!m)return false;if(E.ip2num(host)==0)return false;var final=false;var check_num_mask=function(num){var arr=(num>>>0).toString(2).split(""),final=false;for(var i=0;i<arr.length;i++){if(final&&arr[i]=="1")return false;if(!final&&arr[i]=="0")final=true}return true};for(var i=1;i<=4;i++){if(+m[i]>255)return false;if(final&&+m[i]>0)return false;if(!final&&+m[i]<255){if(!check_num_mask(+m[i]))return false;final=true}}return!!final};E.ip2num=function(ip){var num=0;ip.split(".").forEach(function(octet){num<<=8;num+=+octet});return num>>>0};E.num2ip=function(num){return(num>>>24)+"."+(num>>16&255)+"."+(num>>8&255)+"."+(num&255)};E.is_ip_subnet=function(host){var m=/(.+?)\/(\d+)$/.exec(host);return m&&E.is_ip(m[1])&&+m[2]<=32};E.is_ip_netmask=function(host){var ips=host.split("/");if(ips.length!=2||!E.is_ip(ips[0])||!E.is_ip_mask(ips[1]))return false;return true};E.is_ip_range=function(host){var ips=host.split("-");if(ips.length!=2||!E.is_ip(ips[0])||!E.is_ip(ips[1]))return false;return E.ip2num(ips[0])<E.ip2num(ips[1])};E.is_ip_port=function(host){var m=/(.+?)(?::(\d{1,5}))?$/.exec(host);return m&&E.is_ip(m[1])&&!(+m[2]>65535)};E.is_valid_url=function(url){return/^(https?:\/\/)?([a-z0-9-]+\.)+[a-z0-9-]+(\/.*)?$/i.test(url)};E.is_valid_domain=function(domain){return/^[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,63}$/.test(domain)};E.is_hola_domain=function(domain){return domain.search(/^(.*\.)?(hola\.org|holacdn\.com|h-cdn\.com)$/)!=-1};E.is_valid_email=function(email){var n=email.toLowerCase().match(/^[a-z0-9_\.\-\+]+@(.*)$/);return!!(n&&E.is_valid_domain(n[1]))};E.is_ip_in_range=function(ips_range,ip){if(!E.is_ip_range(ips_range)||!E.is_ip(ip))return false;var ips=ips_range.split("-");var min_ip=E.ip2num(ips[0]),max_ip=E.ip2num(ips[1]);var num_ip=E.ip2num(ip);return num_ip>=min_ip&&num_ip<=max_ip};E.host_lookup=function(lookup,host){var pos;while(1){if(host in lookup)return lookup[host];if((pos=host.indexOf("."))<0)return;host=host.slice(pos+1)}};E.uri_obj_href=function(uri){return(uri.protocol||"")+(uri.slashes?"//":"")+(uri.host?(uri.auth?uri.auth+"@":"")+uri.host:"")+uri.path+(uri.hash||"")};var protocol_re=/^((?:about|http|https|file|ftp|ws|wss):)?(\/\/)?/i;var host_section_re=/^(.*?)(?:[\/?#]|$)/;var host_re=/^(?:(([^:@]*):?([^:@]*))?@)?([^:]*)(?::(\d*))?/;var path_section_re=/^([^?#]*)(\?[^#]*)?(#.*)?$/;var path_re_loose=/^(\/(?:.(?![^\/]*\.[^\/.]+$))*\/?)?([^\/]*?(?:\.([^.]+))?)$/;var path_re_strict=/^(\/(?:.(?![^\/]*(?:\.[^\/.]+)?$))*\/?)?([^\/]*?(?:\.([^.]+))?)$/;E.parse=function(url,strict){function re(expr,str){var m;try{m=expr.exec(str)}catch(e){m=null}if(!m)return m;for(var i=0;i<m.length;i++)m[i]=m[i]===undefined?null:m[i];return m}url=url||location.href;var m,uri={orig:url},remaining=url;if(!(m=re(protocol_re,remaining)))return{};uri.protocol=m[1];if(uri.protocol!==null)uri.protocol=uri.protocol.toLowerCase();uri.slashes=!!m[2];if(!uri.protocol&&!uri.slashes){uri.protocol="http:";uri.slashes=true}remaining=remaining.slice(m[0].length);if(!(m=re(host_section_re,remaining)))return{};uri.authority=m[1];remaining=remaining.slice(m[1].length);if(!(m=re(host_re,uri.authority)))return{};uri.auth=m[1];uri.user=m[2];uri.password=m[3];uri.hostname=m[4];uri.port=m[5];if(uri.hostname!==null){uri.hostname=uri.hostname.toLowerCase();uri.host=uri.hostname+(uri.port?":"+uri.port:"")}if(!(m=re(path_section_re,remaining)))return{};uri.relative=m[0];uri.pathname=m[1];uri.search=m[2];uri.query=uri.search?uri.search.substring(1):null;uri.hash=m[3];if(!(m=re(strict?path_re_strict:path_re_loose,uri.pathname)))return{};uri.directory=m[1];uri.file=m[2];uri.ext=m[3];if(uri.file=="."+uri.ext)uri.ext=null;if(!uri.pathname)uri.pathname="/";uri.path=uri.pathname+(uri.search||"");uri.href=E.uri_obj_href(uri);return uri};E.qs_parse=function(q,bin){var obj={};q=q.length?q.split("&"):[];var len=q.length;var unescape_val=bin?function(val){return qs.unescapeBuffer(val,true).toString("binary")}:function(val){return decodeURIComponent(val.replace(/\+/g," "))};for(var i=0;i<len;++i){var x=q[i];var idx=x.indexOf("=");var kstr=idx>=0?x.substr(0,idx):x;var vstr=idx>=0?x.substr(idx+1):"";var k=unescape_val(kstr);var v=unescape_val(vstr);if(obj[k]===undefined)obj[k]=v;else if(Array.isArray(obj[k]))obj[k].push(v);else obj[k]=[obj[k],v]}return obj};function token_regex(s,end){return end?"^"+s+"$":s}E.http_glob_host=function(host,end){var n=host.match(/^(|.*[^*])(\*+)$/);if(n){host=E.http_glob_host(n[1])+(n[2].length==1?"[^./]+":"[^/]"+(n[1]?"*":"+"));return token_regex(host,end)}host=host.replace(/\*\*\./,"**").replace(/\*\./,"*").replace(/\./g,"\\.").replace(/\*\*/g,"(([^./]+\\.)+)?").replace(/\*/g,"[^./]+\\.");return token_regex(host,end)};E.http_glob_path=function(path,end){if(path[0]=="*")return E.http_glob_path("/"+path,end);var n=path.match(/^(|.*[^*])(\*+)([^*^\/]*)$/);if(n){path=E.http_glob_path(n[1])+(n[2].length==1?"[^/]+":".*")+E.http_glob_path(n[3]);return token_regex(path,end)}path=path.replace(/\*\*\//,"**").replace(/\*\//,"*").replace(/\//g,"\\/").replace(/\./g,"\\.").replace(/\*\*/g,"(([^/]+\\/)+)?").replace(/\*/g,"[^/]+\\/");return token_regex(path,end)};E.http_glob_url=function(url,end){var n=url.match(/^((.*):\/\/)?([^\/]+)(\/.*)?$/);if(!n)return null;var prot=n[1]?n[2]:"*";var host=n[3];var path=n[4]||"**";if(prot=="*")prot="https?";host=E.http_glob_host(host);path=E.http_glob_path(path);return token_regex(prot+":\\/\\/"+host+path,end)};E.root_url_cmp=function(a,b){var a_s=a.match(/^[*.]*([^*]+)$/);var b_s=b.match(/^[*.]*([^*]+)$/);if(!a_s&&!b_s)return false;var re,s;if(a_s&&b_s&&a_s[1].length>b_s[1].length||a_s&&!b_s){s=a_s[1];re=b}else{s=b_s[1];re=a}s=E.add_proto(s)+"/";if(!(re=E.http_glob_url(re,1)))return false;try{re=new RegExp(re)}catch(e){return false}return re.test(s)};E.qs_strip=function(url){return/^[^?#]*/.exec(url)[0]};function qs_str(qs){var q=[];for(var k in qs){(Array.isArray(qs[k])?qs[k]:[qs[k]]).forEach(function(v){q.push(encodeURIComponent(k)+"="+encodeURIComponent(v))})}return q.join("&")}E.qs_add=function(url,qs){var u=E.parse(url),q=assign(u.query?E.qs_parse(u.query):{},qs);u.path=u.pathname+"?"+qs_str(q);return E.uri_obj_href(u)};E.qs_parse_url=function(url){return E.qs_parse(url.replace(/(^.*\?)|(^[^\?]*$)/,""))};return E})})();
(function(){var __hola_stub_define;var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node)define=define||self.define;else define=require("./require_node.js").define(module,"../");define("/util/events.js",[],function(){function EventEmitter(){this._events={}}EventEmitter.prototype.listeners=function listeners(event){return Array.apply(this,this._events[event]||[])};EventEmitter.prototype.emit=function emit(event,a1,a2,a3,a4,a5){if(!this._events||!this._events[event])return false;var listeners=this._events[event],length=listeners.length,len=arguments.length,fn=listeners[0],args,i;if(1===length){switch(len){case 1:fn.call(fn.__EE3_context||this);break;case 2:fn.call(fn.__EE3_context||this,a1);break;case 3:fn.call(fn.__EE3_context||this,a1,a2);break;case 4:fn.call(fn.__EE3_context||this,a1,a2,a3);break;case 5:fn.call(fn.__EE3_context||this,a1,a2,a3,a4);break;case 6:fn.call(fn.__EE3_context||this,a1,a2,a3,a4,a5);break;default:for(i=1,args=new Array(len-1);i<len;i++){args[i-1]=arguments[i]}fn.apply(fn.__EE3_context||this,args)}if(fn.__EE3_once)this.removeListener(event,fn)}else{for(i=1,args=new Array(len-1);i<len;i++){args[i-1]=arguments[i]}for(i=0;i<length;fn=listeners[++i]){fn.apply(fn.__EE3_context||this,args);if(fn.__EE3_once)this.removeListener(event,fn)}}return true};function _addListener(event,fn,context,prepend){if(!this._events)this._events={};if(!this._events[event])this._events[event]=[];fn.__EE3_context=context;if(prepend)this._events[event].unshift(fn);else this._events[event].push(fn);return this}EventEmitter.prototype.on=function on(event,fn,context){return _addListener.apply(this,[event,fn,context])};EventEmitter.prototype.once=function once(event,fn,context){fn.__EE3_once=true;return this.on(event,fn,context)};EventEmitter.prototype.prependListener=function prependListener(event,fn,context){return _addListener.apply(this,[event,fn,context,true])};EventEmitter.prototype.prependOnceListener=function prependOnceListener(event,fn,context){fn.__EE3_once=true;return this.prependListener(event,fn,context)};EventEmitter.prototype.removeListener=function removeListener(event,fn){if(!this._events||!this._events[event])return this;var listeners=this._events[event],events=[];for(var i=0,length=listeners.length;i<length;i++){if(fn&&listeners[i]!==fn){events.push(listeners[i])}}if(events.length)this._events[event]=events;else this._events[event]=null;return this};EventEmitter.prototype.removeAllListeners=function removeAllListeners(event){if(!this._events)return this;if(event)this._events[event]=null;else this._events={};return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prototype.setMaxListeners=function setMaxListeners(){return this};EventEmitter.prototype.eventNames=function eventNames(){var _this=this;return Object.keys(this._events).filter(function(e){return _this._events[e]!==null})};EventEmitter.EventEmitter=EventEmitter;EventEmitter.EventEmitter2=EventEmitter;EventEmitter.EventEmitter3=EventEmitter;return EventEmitter})})();
(function(){var __hola_stub_define;var is_node_ff=typeof module=="object"&&module.exports;if(!is_node_ff)define=define||self.define;else define=require("./require_node.js").define(module,"../");define("/util/array.js",[],function(){var E={};var proto_slice=Array.prototype.slice;E.copy=function(a){switch(a.length){case 0:return[];case 1:return[a[0]];case 2:return[a[0],a[1]];case 3:return[a[0],a[1],a[2]];case 4:return[a[0],a[1],a[2],a[3]];case 5:return[a[0],a[1],a[2],a[3],a[4]];default:return proto_slice.call(a)}};E.push=function(a){for(var i=1;i<arguments.length;i++){var arg=arguments[i];if(Array.isArray(arg))a.push.apply(a,arg);else a.push(arg)}return a.length};E.unshift=function(a){for(var i=arguments.length-1;i>0;i--){var arg=arguments[i];if(Array.isArray(arg))a.unshift.apply(a,arg);else a.unshift(arg)}return a.length};E.slice=function(args,from,to){return Array.prototype.slice.call(args,from,to)};E.compact=function(a){return E.compact_self(a.slice())};E.compact_self=function(a){var i,j,n=a.length;for(i=0;i<n&&a[i];i++);if(i==n)return a;for(j=i;i<n;i++){if(!a[i])continue;a[j++]=a[i]}a.length=j;return a};E.flatten_shallow=function(a){return Array.prototype.concat.apply([],a)};E.flatten=function(a){var _a=[],i;for(i=0;i<a.length;i++){if(Array.isArray(a[i]))Array.prototype.push.apply(_a,E.flatten(a[i]));else _a.push(a[i])}return _a};E.unique=function(a){var _a=[];for(var i=0;i<a.length;i++){if(!_a.includes(a[i]))_a.push(a[i])}return _a};E.to_nl=function(a,sep){if(!a||!a.length)return"";if(sep===undefined)sep="\n";return a.join(sep)+sep};E.sed=function(a,regex,replace){var _a=new Array(a.length),i;for(i=0;i<a.length;i++)_a[i]=a[i].replace(regex,replace);return _a};E.grep=function(a,regex,replace){var _a=[],i;for(i=0;i<a.length;i++){if(a[i].search(regex)<0)continue;if(replace!==undefined)_a.push(a[i].replace(regex,replace));else _a.push(a[i])}return _a};E.rm_elm=function(a,elm){var i=a.indexOf(elm);if(i<0)return;a.splice(i,1);return elm};E.rm_elm_tail=function(a,elm){var i=a.length-1;if(elm===a[i]){a.pop();return elm}if((i=a.lastIndexOf(elm,i-1))<0)return;a.splice(i,1);return elm};E.add_elm=function(a,elm){if(a.includes(elm))return;a.push(elm);return elm};E.split_every=function(a,n){var ret=[];for(var i=0;i<a.length;i+=n)ret.push(a.slice(i,i+n));return ret};E.split_at=function(a,delim){var ret=[];delim=delim||"";for(var i=0;i<a.length;i++){var chunk=[];for(;i<a.length&&a[i]!=delim;i++)chunk.push(a[i]);if(chunk.length)ret.push(chunk)}return ret};E.rotate=function(a,n){if(a&&a.length>1&&(n=n%a.length))E.unshift(a,a.splice(n));return a};E.move=function(a,from,to,n){return Array.prototype.splice.apply(a,[to,n].concat(a.slice(from,from+n)))};E.to_array=function(v){return Array.isArray(v)?v:v==null?[]:[v]};var proto={};proto.sed=function(regex,replace){return E.sed(this,regex,replace)};proto.grep=function(regex,replace){return E.grep(this,regex,replace)};proto.to_nl=function(sep){return E.to_nl(this,sep)};proto.push_a=function(){return E.push.apply(null,[this].concat(Array.from(arguments)))};proto.unshift_a=function(){return E.unshift.apply(null,[this].concat(Array.from(arguments)))};var installed;E.prototype_install=function(){if(installed)return;installed=true;for(var i in proto){Object.defineProperty(Array.prototype,i,{value:proto[i],configurable:true,enumerable:false,writable:true})}};E.prototype_uninstall=function(){if(!installed)return;installed=false;for(var i in proto)delete Array.prototype[i]};return E})})();
(function(){var __hola_stub_define,node_util;var is_node=typeof module=="object"&&module.exports&&module.children;var is_ff_addon=typeof module=="object"&&module.uri&&!module.uri.indexOf("resource://");if(is_ff_addon)define=require("./require_node.js").define(module,"../");else if(!is_node)define=define||self.define;else{node_util=require("util");define=require("./require_node.js").define(module,"../")}define("/util/util.js",["/util/array.js"],function(array){var E={};E._is_mocha=undefined;E.is_mocha=function(){if(E._is_mocha!==undefined)return E._is_mocha;if(typeof process!="undefined")return E._is_mocha=process.env.IS_MOCHA||false;return E._is_mocha=false};E.is_lxc=function(){return is_node&&+process.env.LXC};E.f_mset=function(flags,mask,bits){return flags&~mask|bits};E.f_lset=function(flags,bits,logic){return E.f_mset(flags,bits,logic?bits:0)};E.f_meq=function(flags,mask,bits){return(flags&mask)==bits};E.f_eq=function(flags,bits){return(flags&bits)==bits};E.f_cmp=function(f1,f2,mask){return(f1&mask)==(f2&mask)};E.xor=function(a,b){return!a!=!b};E.div_ceil=function(a,b){return Math.floor((a+b-1)/b)};E.ceil_mul=function(a,b){return E.div_ceil(a,b)*b};E.floor_mul=function(a,b){return Math.floor(a/b)*b};E.range=function(x,a,b){return x>=a&&x<=b};E.range.ii=function(x,a,b){return x>=a&&x<=b};E.range.ie=function(x,a,b){return x>=a&&x<b};E.range.ei=function(x,a,b){return x>a&&x<=b};E.range.ee=function(x,a,b){return x>a&&x<b};E.clamp=function(lower_bound,value,upper_bound){if(value<lower_bound)return lower_bound;if(value<upper_bound)return value;return upper_bound};E.union_with=function(fn){var res={},args;if(arguments.length==2&&typeof arguments[1]=="object")args=arguments[1];else args=array.slice(arguments,1);for(var i=0;i<args.length;++i){for(var key in args[i]){var arg=args[i];res[key]=res.hasOwnProperty(key)?fn(res[key],arg[key]):arg[key]}}return res};function _clone_deep(obj){var i,n,ret;if(obj instanceof Array){ret=new Array(obj.length);n=obj.length;for(i=0;i<n;i++)ret[i]=obj[i]instanceof Object?_clone_deep(obj[i]):obj[i];return ret}else if(obj instanceof Date)return new Date(obj);else if(obj instanceof RegExp)return new RegExp(obj);else if(obj instanceof Function)return obj;ret={};for(i in obj)ret[i]=obj[i]instanceof Object?_clone_deep(obj[i]):obj[i];return ret}E.clone_deep=function(obj){if(!(obj instanceof Object))return obj;return _clone_deep(obj)};E.extend=function(obj){for(var i=1;i<arguments.length;i++){var source=arguments[i];if(!source)continue;for(var prop in source)obj[prop]=source[prop]}return obj};function is_object(obj){return obj&&obj.constructor==Object}E.extend_deep=function(obj){for(var i=1;i<arguments.length;i++){var source=arguments[i];if(!source)continue;for(var prop in source){if(is_object(source[prop])&&is_object(obj[prop]))E.extend_deep(obj[prop],source[prop]);else obj[prop]=source[prop]}}return obj};E.extend_deep_del_null=function(obj){for(var i=1;i<arguments.length;i++){var source=arguments[i];if(!source)continue;for(var prop in source){if(is_object(source[prop])){if(!is_object(obj[prop]))obj[prop]={};E.extend_deep_del_null(obj[prop],source[prop])}else if(source[prop]==null)delete obj[prop];else obj[prop]=source[prop]}}return obj};E.clone=function(obj){if(!(obj instanceof Object))return obj;if(obj instanceof Array){var a=new Array(obj.length);for(var i=0;i<obj.length;i++)a[i]=obj[i];return a}return E.extend({},obj)};E.freeze_deep=function(obj){if(typeof obj=="object"){for(var prop in obj){if(obj.hasOwnProperty(prop))E.freeze_deep(obj[prop])}}return Object.freeze(obj)};E.map_obj=function(obj,fn){var ret={};for(var i in obj)ret[i]=fn(obj[i],i,obj);return ret};E.sort_obj=function(obj){if(obj instanceof Array||!(obj instanceof Object))return obj;var ret={},keys=Object.keys(obj).sort();for(var i=0;i<keys.length;i++)ret[keys[i]]=E.sort_obj(obj[keys[i]]);return ret};E.forEach=function(obj,fn,_this){for(var i in obj)fn.call(_this,obj[i],i,obj)};E.find=function(obj,fn,_this){for(var i in obj){if(fn.call(_this,obj[i],i,obj))return obj[i]}};E.find_prop=function(obj,prop,val){return E.find(obj,function(o){return o[prop]===val})};E.isspace=function(c){return/\s/.test(c)};E.isdigit=function(c){return c>="0"&&c<="9"};E.isalpha=function(c){return c>="a"&&c<="z"||c>="A"&&c<="Z"};E.isalnum=function(c){return E.isdigit(c)||E.isalpha(c)};E.obj_pluck=function(obj,prop){var val=obj[prop];delete obj[prop];return val};E.proto_keys=function(proto){var keys=[];for(var i in proto)keys.push(i);return keys};E.values=function(obj){var values=[];for(var i in obj)values.push(obj[i]);return values};E.path=function(path){if(Array.isArray(path))return path;path=""+path;if(!path)return[];return path.split(".")};E.get=function(o,path,def){path=E.path(path);for(var i=0;i<path.length;i++){if(!o||!(path[i]in o))return def;o=o[path[i]]}return o};E.set=function(o,path,value){path=E.path(path);for(var i=0;i<path.length-1;i++){var p=path[i];o=o[p]||(o[p]={})}o[path[path.length-1]]=value};var has_unique={};E.has=function(o,path){return E.get(o,path,has_unique)!==has_unique};E.own=function(o,prop){return Object.prototype.hasOwnProperty.call(o,prop)};E.bool_lookup=function(a,split){var ret={},i;if(typeof a=="string")a=a.split(split||/\s/);for(i=0;i<a.length;i++)ret[a[i]]=true;return ret};E.clone_inplace=function(dst,src){if(dst===src)return dst;if(Array.isArray(dst)){for(var i=0;i<src.length;i++)dst[i]=src[i];dst.splice(src.length)}else if(typeof dst=="object"){for(var k in src)dst[k]=src[k];for(k in dst){if(!src.hasOwnProperty(k))delete dst[k]}}return dst};if(node_util)E.inherits=node_util.inherits;else{E.inherits=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}E.inherit_init=function(obj,ctor,params){var orig_proto=Object.getPrototypeOf(obj);var ctor_proto=Object.assign({},ctor.prototype);Object.setPrototypeOf(ctor_proto,orig_proto);Object.setPrototypeOf(obj,ctor_proto);return ctor.apply(obj,params)};E.pick=function(obj){var i,o={};for(i=1;i<arguments.length;i++){if(E.own(obj,arguments[i]))o[arguments[i]]=obj[arguments[i]]}return o};return E})})();
(function(){var __hola_stub_define,process,zerr,assert;var is_node=typeof module=="object"&&module.exports&&module.children;var is_ff_addon=typeof module=="object"&&module.uri&&!module.uri.indexOf("resource://");if(!is_node){if(is_ff_addon)define=require("./require_node.js").define(module,"../");else define=define||self.define;process={nextTick:function(fn){setTimeout(fn,0)},env:{}};assert=function(){};if(!is_ff_addon&&self.hola&&self.hola.zerr)zerr=self.hola.zerr;else{zerr=function(){console.log.apply(console,arguments)};zerr.perr=zerr;zerr.debug=function(){};zerr.is=function(){return false};zerr.L={DEBUG:0}}if(!zerr.is)zerr.is=function(){return false}}else{require("./config.js");process=global.process||require("_process");zerr=require("./zerr.js");assert=require("assert");define=require("./require_node.js").define(module,"../")}define("/util/etask.js",["/util/events.js","/util/array.js","/util/util.js"],function(events,array,zutil){var E=Etask;var etask=Etask;var env=process.env,assign=Object.assign;E.use_bt=+env.ETASK_BT;E.root=[];E.assert_extra=+env.ETASK_ASSERT_EXTRA;E.nextTick=process.nextTick;E.set_zerr=function(_zerr){zerr=_zerr};E.events=new events;var cb_pre,cb_post,longcb_ms,perf_enable;E.perf_stat={};function _cb_pre(et){return{start:Date.now()}}function _cb_post(et,ctx){var ms=Date.now()-ctx.start;if(longcb_ms&&ms>longcb_ms){zerr("long cb "+ms+"ms: "+et.get_name()+", "+et.run_state.f.toString().slice(0,128))}if(perf_enable){var name=et.get_name();var perf=E.perf_stat[name]||(E.perf_stat[name]={ms:0,n:0});perf.ms+=ms;perf.n++}}function cb_set(){if(longcb_ms||perf_enable){cb_pre=_cb_pre;cb_post=_cb_post}else cb_pre=cb_post=undefined}E.longcb=function(ms){longcb_ms=ms;cb_set()};E.perf=function(enable){perf_enable=enable;cb_set()};E.longcb(+env.LONGCB);E.perf(+env.ETASK_PERF);function stack_get(){var prev=Error.stackTraceLimit,err;Error.stackTraceLimit=4;err=new Error;Error.stackTraceLimit=prev;return err}function Etask(opt,states){if(!(this instanceof Etask))return new Etask(opt,states);if(Array.isArray(opt)||typeof opt=="function"){states=opt;opt=undefined}opt=typeof opt=="string"&&{name:opt}||opt||{};if(typeof states=="function"){if(states.constructor.name=="GeneratorFunction")return E._generator(null,states,opt);states=[states]}this.cur_state=this.states=this._finally=this.error=this.at_return=this.next_state=this.use_retval=this.running=this.at_continue=this.cancel=this.wait_timer=this.retval=this.run_state=this._stack=this.down=this.up=this.child=this.name=this._name=this.parent=this.cancelable=this.tm_create=this._alarm=this.tm_completed=this.parent_type=this.info=this.then_waiting=this.free=this.parent_guess=this.child_guess=this.wait_retval=undefined;this.name=opt.name;this._name=this.name===undefined?"noname":this.name;this.cancelable=opt.cancel;this.then_waiting=[];this.child=[];this.child_guess=[];this.cur_state=-1;this.states=[];this._stack=Etask.use_bt?stack_get():undefined;this.tm_create=Date.now();this.info={};var idx=this.states.idx={};for(var i=0;i<states.length;i++){var pstate=states[i],t;if(typeof pstate!="function")assert(0,"invalid state type");t=this._get_func_type(pstate);var state={f:pstate,label:t.label,try_catch:t.try_catch,"catch":t.catch,"finally":t.finally,cancel:t.cancel,sig:undefined};if(i==0&&opt.state0_args){state.f=state.f.bind.apply(state.f,[this].concat(opt.state0_args))}if(state.label)idx[state.label]=i;assert((state.catch||state.try_catch?1:0)+(state.finally?1:0)+(state.cancel?1:0)<=1,"invalid multiple state types");state.sig=state.finally||state.cancel;if(state.finally){assert(this._finally===undefined,"more than 1 finally$");this._finally=i}if(state.cancel){assert(this.cancel===undefined,"more than 1 cancel$");this.cancel=i}this.states[i]=state}var _this=this;E.root.push(this);var in_run=E.in_run_top();if(opt.spawn_parent)this.spawn_parent(opt.spawn_parent);else if(opt.up)opt.up._set_down(this);else if(in_run)this._spawn_parent_guess(in_run);if(opt.init)opt.init.call(this);if(opt.async){var wait_retval=this._set_wait_retval();E.nextTick(function(){if(_this.running!==undefined)return;_this._got_retval(wait_retval)})}else this._next_run();return this}zutil.inherits(Etask,events.EventEmitter);E.prototype._root_remove=function(){assert(!this.parent,"cannot remove from root when has parent");if(!array.rm_elm_tail(E.root,this))assert(0,"etask not in root\n"+E.ps({MARK:this}))};E.prototype._parent_remove=function(){if(this.up){var up=this.up;this.up=this.up.down=undefined;if(up.tm_completed)up._check_free();return}if(this.parent_guess)this._parent_guess_remove();if(!this.parent)return this._root_remove();if(!array.rm_elm_tail(this.parent.child,this)){assert(0,"etask child not in parent\n"+E.ps({MARK:[["child",this],["parent",this.parent]]}))}if(this.parent.tm_completed)this.parent._check_free();this.parent=undefined};E.prototype._check_free=function(){if(this.down||this.child.length)return;this._parent_remove();this.free=true};E.prototype._call_err=function(e){E.ef(e)};E.prototype.emit_safe=function(){try{this.emit.apply(this,arguments)}catch(e){this._call_err(e)}};E.prototype._call_safe=function(state_fn){try{return state_fn.call(this)}catch(e){this._call_err(e)}};E.prototype._complete=function(){if(zerr.is(zerr.L.DEBUG))zerr.debug(this._name+": close");this.tm_completed=Date.now();this.parent_type=this.up?"call":"spawn";if(this.error)this.emit_safe("uncaught",this.error);if(this._finally!==undefined){var ret=this._call_safe(this.states[this._finally].f);if(E.is_err(ret))this._set_retval(ret)}this.emit_safe("finally");this.emit_safe("ensure");if(this.error&&!this.up&&!this.parent&&!this.parent_guess)E.events.emit("uncaught",this);if(this.parent)this.parent.emit("child",this);if(this.up&&(this.down||this.child.length)){var up=this.up;this.up=this.up.down=undefined;this.parent=up;up.child.push(this)}this._check_free();this._del_wait_timer();this.del_alarm();this._ecancel_child();this.emit_safe("finally1");while(this.then_waiting.length)this.then_waiting.shift()()};E.prototype._next=function(rv){if(this.tm_completed)return true;rv=rv||{ret:undefined,err:undefined};var states=this.states;var state=this.at_return?states.length:this.next_state!==undefined?this.next_state:this.cur_state+1;this.retval=rv.ret;this.error=rv.err;if(rv.err!==undefined){if(zerr.on_exception)zerr.on_exception(rv.err);if(this.run_state.try_catch){this.use_retval=true;for(;state<states.length&&states[state].sig;state++);}else for(;state<states.length&&!states[state].catch;state++);}else{for(;state<states.length&&(states[state].sig||states[state].catch);state++);}this.cur_state=state;this.run_state=states[state];this.next_state=undefined;if(this.cur_state<states.length)return false;this._complete();return true};E.prototype._next_run=function(rv){if(this._next(rv))return;this._run()};E.prototype._handle_rv=function(rv){var wait_retval,_this=this,ret=rv.ret;if(ret===this.retval);else if(!ret);else if(ret instanceof Etask){if(!ret.tm_completed){this._set_down(ret);wait_retval=this._set_wait_retval();ret.then_waiting.push(function(){_this._got_retval(wait_retval,E.err_res(ret.error,ret.retval))});return true}rv.err=ret.error;rv.ret=ret.retval}else if(ret instanceof Etask_err){rv.err=ret.error;rv.ret=undefined}else if(typeof ret.then=="function"){wait_retval=this._set_wait_retval();ret.then(function(ret){_this._got_retval(wait_retval,ret)},function(err){_this._got_retval(wait_retval,E.err(err))});return true}else if(typeof ret.next=="function"&&typeof ret.throw=="function"){rv.ret=E._generator(ret,this.states[this.cur_state]);return this._handle_rv(rv)}return false};E.prototype._set_retval=function(ret){if(ret===this.retval&&!this.error);else if(!ret){this.retval=ret;this.error=undefined}else if(ret instanceof Etask){if(ret.tm_completed){this.retval=ret.retval;this.error=ret.error}}else if(ret instanceof Etask_err){this.retval=undefined;this.error=ret.error}else if(typeof ret.then=="function");else if(typeof ret.next=="function"&&typeof ret.throw=="function");else{this.retval=ret;this.error=undefined}return ret};E.prototype._set_wait_retval=function(){return this.wait_retval=new Etask_wait(this,"wait_int")};E.in_run=[];E.in_run_top=function(){return E.in_run[E.in_run.length-1]};E.prototype._run=function(){var rv={ret:undefined,err:undefined};while(1){var cb_ctx;var arg=this.error&&!this.use_retval?this.error:this.retval;this.use_retval=false;this.running=true;rv.ret=rv.err=undefined;E.in_run.push(this);if(zerr.is(zerr.L.DEBUG))zerr.debug(this._name+":S"+this.cur_state+": running");if(cb_pre)cb_ctx=cb_pre(this);try{rv.ret=this.run_state.f.call(this,arg)}catch(e){rv.err=e;if(rv.err instanceof Error)rv.err.etask=this}if(cb_post)cb_post(this,cb_ctx);this.running=false;E.in_run.pop();for(;this.child_guess.length;this.child_guess.pop().parent_guess=undefined);if(rv.ret instanceof Etask_wait){var wait_completed=false,wait=rv.ret;if(!this.at_continue&&!wait.ready){this.wait_retval=wait;if(wait.op=="wait_child")wait_completed=this._set_wait_child(wait);if(wait.timeout)this._set_wait_timer(wait.timeout);if(!wait_completed)return;this.wait_retval=undefined}rv.ret=this.at_continue?this.at_continue.ret:wait.ready&&!wait.completed?wait.ready.ret:undefined;wait.completed=true}this.at_continue=undefined;if(this._handle_rv(rv))return;if(this._next(rv))return}};E.prototype._set_down=function(down){if(this.down)assert(0,"caller already has a down\n"+this.ps());if(down.parent_guess)down._parent_guess_remove();assert(!down.parent,"returned etask already has a spawn parent");assert(!down.up,"returned etask already has a caller parent");down._parent_remove();this.down=down;down.up=this};var func_type_cache={};E.prototype._get_func_type=function(func,on_fail){var name=func.name;var type=func_type_cache[name];if(type)return type;type=func_type_cache[name]={name:undefined,label:undefined,try_catch:undefined,"catch":undefined,"finally":undefined,cancel:undefined};if(!name)return type;type.name=name;var n=name.split("$");if(n.length==1){type.label=n[0];return type}if(n.length>2)return type;if(n[1].length)type.label=n[1];var f=n[0].split("_");for(var j=0;j<f.length;j++){if(f[j]=="try"){type.try_catch=true;if(f[j+1]=="catch")j++}else if(f[j]=="catch")type["catch"]=true;else if(f[j]=="finally"||f[j]=="ensure")type.finally=true;else if(f[j]=="cancel")type.cancel=true;else{return void(on_fail||assert.bind(null,false))("unknown func name "+name)}}return type};E.prototype.spawn=function(child,replace){if(!(child instanceof Etask)&&child&&typeof child.then=="function"){var promise=child;child=etask([function(){return promise}])}if(!(child instanceof Etask)){this.emit("child",child);return}if(!replace&&child.parent)assert(0,"child already has a parent\n"+child.parent.ps());child.spawn_parent(this)};E.prototype._spawn_parent_guess=function(parent){this.parent_guess=parent;parent.child_guess.push(this)};E.prototype._parent_guess_remove=function(){if(!array.rm_elm_tail(this.parent_guess.child_guess,this))assert(0,"etask not in parent_guess\n"+E.ps({MARK:this}));this.parent_guess=undefined};E.prototype.spawn_parent=function(parent){if(this.up)assert(0,"child already has an up\n"+this.up.ps());if(this.tm_completed&&!this.parent)return;this._parent_remove();if(parent&&parent.free)parent=undefined;if(!parent)return void E.root.push(this);parent.child.push(this);this.parent=parent};E.prototype.set_state=function(name){var state=this.states.idx[name];assert(state!==undefined,'named func "'+name+'" not found');return this.next_state=state};E.prototype.finally=function(cb){this.prependListener("finally",cb)};E.prototype.goto_fn=function(name){return this.goto.bind(this,name)};E.prototype.goto=function(name,promise){this.set_state(name);var state=this.states[this.next_state];assert(!state.sig,"goto to sig");return this.continue(promise)};E.prototype.loop=function(promise){this.next_state=this.cur_state;return promise};E.prototype._set_wait_timer=function(timeout){var _this=this;this.wait_timer=setTimeout(function(){_this.wait_timer=undefined;_this._next_run({ret:undefined,err:"timeout"})},timeout)};E.prototype._del_wait_timer=function(){if(this.wait_timer)this.wait_timer=clearTimeout(this.wait_timer);this.wait_retval=undefined};E.prototype._get_child_running=function(from){var i,child=this.child;for(i=from||0;i<child.length&&child[i].tm_completed;i++);return i>=child.length?-1:i};E.prototype._set_wait_child=function(wait_retval){var i,_this=this,child=wait_retval.child;var cond=wait_retval.cond,wait_on;assert(!cond||child=="any",'condition supported only for "any" '+"option, you can add support if needed");if(child=="any"){if(this._get_child_running()<0)return true;wait_on=function(){_this.once("child",function(child){if(!cond||cond.call(child,child.retval))return _this._got_retval(wait_retval,{child:child});if(_this._get_child_running()<0)return _this._got_retval(wait_retval);wait_on()})};wait_on()}else if(child=="all"){if((i=this._get_child_running())<0)return true;wait_on=function(child){_this.once("child",function(child){var i;if((i=_this._get_child_running())<0)return _this._got_retval(wait_retval);wait_on(_this.child[i])})};wait_on(this.child[i])}else{assert(child,"no child provided");assert(this===child.parent,"child does not belong to parent");if(child.tm_completed)return true;child.once("finally",function(){return _this._got_retval(wait_retval,{child:child})})}this.emit_safe("wait_on_child")};E.prototype._got_retval=function(wait_retval,res){if(this.wait_retval!==wait_retval||wait_retval.completed)return;wait_retval.completed=true;this._next_run(E._res2rv(res))};E.prototype.continue_fn=function(){return this.continue.bind(this)};E.continue_depth=0;E.prototype.continue=function(promise,sync){this.wait_retval=undefined;this._set_retval(promise);if(this.tm_completed)return promise;if(this.down)this.down._ecancel();this._del_wait_timer();var rv={ret:promise,err:undefined};if(this.running){this.at_continue=rv;return promise}if(this._handle_rv(rv))return rv.ret;var _this=this;if(E.is_final(promise)&&(!E.continue_depth&&!E.in_run.length||sync)){E.continue_depth++;this._next_run(rv);E.continue_depth--}else E.nextTick(function(){_this._next_run(rv)});return promise};E.prototype._ecancel=function(){if(this.tm_completed)return this;this.emit_safe("cancel");if(this.cancel!==undefined)return this._call_safe(this.states[this.cancel].f);if(this.cancelable)return this.return()};E.prototype._ecancel_child=function(){if(!this.child.length)return;var child=Array.from(this.child);for(var i=0;i<child.length;i++)child[i]._ecancel()};E.prototype.return_fn=function(){return this.return.bind(this)};E.prototype.return=function(promise){if(this.tm_completed)return this._set_retval(promise);this.at_return=true;this.next_state=undefined;return this.continue(promise,true)};E.prototype.del_alarm=function(){var a=this._alarm;if(!a)return;clearTimeout(a.id);if(a.cb)this.removeListener("sig_alarm",a.cb);this._alarm=undefined};E.prototype.alarm_left=function(){var a=this._alarm;if(!a)return 0;return a.start-Date.now()};E.prototype._operation_opt=function(opt){if(opt.goto)return{ret:this.goto(opt.goto,opt.ret)};if(opt.throw)return{ret:this.throw(opt.throw)};if(opt.return!==undefined)return{ret:this.return(opt.return)};if(opt.continue!==undefined)return{ret:this.continue(opt.continue)}};E.prototype.alarm=function(ms,cb){var _this=this,opt,a;if(cb&&typeof cb!="function"){opt=cb;cb=function(){var v;if(!(v=_this._operation_opt(opt)))assert(0,"invalid alarm cb opt");return v.ret}}this.del_alarm();a=this._alarm={ms:ms,cb:cb,start:Date.now()};a.id=setTimeout(function(){_this._alarm=undefined;_this.emit("sig_alarm")},a.ms);if(cb)this.once("sig_alarm",cb)};function Etask_wait(et,op,timeout){this.timeout=timeout;this.et=et;this.op=op;this.child=this.at_child=this.cond=undefined;this.ready=this.completed=undefined}Etask_wait.prototype.continue=function(res){if(this.completed)return;if(!this.et.wait_retval)return void(this.ready={ret:res});if(this!==this.et.wait_retval)return;this.et.continue(res)};Etask_wait.prototype.continue_fn=function(){return this.continue.bind(this)};Etask_wait.prototype.throw=function(err){return this.continue(E.err(err))};Etask_wait.prototype.throw_fn=function(){return this.throw.bind(this)};E.prototype.wait=function(timeout){return new Etask_wait(this,"wait",timeout)};E.prototype.wait_child=function(child,timeout,cond){if(typeof timeout=="function"){cond=timeout;timeout=0}var wait=new Etask_wait(this,"wait_child",timeout);wait.child=child;wait.at_child=null;wait.cond=cond;return wait};E.prototype.throw_fn=function(err){return err?this.throw.bind(this,err):this.throw.bind(this)};E.prototype.throw=function(err){return this.continue(E.err(err))};E.prototype.get_name=function(flags){var stack=this._stack instanceof Error?this._stack.stack.split("\n"):undefined;var caller;flags=flags||{};if(stack){caller=/^    at (.*)$/.exec(stack[4]);caller=caller?caller[1]:undefined}var names=[];if(this.name)names.push(this.name);if(caller&&!(this.name&&flags.SHORT_NAME))names.push(caller);if(!names.length)names.push("noname");return names.join(" ")};E.prototype.state_str=function(){return this.cur_state+(this.next_state?"->"+this.next_state:"")};E.prototype.get_depth=function(){var i=0,et=this;for(;et;et=et.up,i++);return i};function trim_space(s){if(s[s.length-1]!=" ")return s;return s.slice(0,-1)}function ms_to_str(ms){var s=""+ms;return s.length<=3?s+"ms":s.slice(0,-3)+"."+s.slice(-3)+"s"}E.prototype.get_time_passed=function(){return ms_to_str(Date.now()-this.tm_create)};E.prototype.get_time_completed=function(){return ms_to_str(Date.now()-this.tm_completed)};E.prototype.get_info=function(){var info=this.info,s="",_i;if(!info)return"";for(var i in info){_i=info[i];if(!_i)continue;if(s!=="")s+=" ";if(typeof _i=="function")s+=_i();else s+=_i}return trim_space(s)};function Etask_err(err){this.error=err||new Error}E.Etask_err=Etask_err;E.err=function(err){return new Etask_err(err)};E.is_err=function(v){return v instanceof Etask&&v.error!==undefined||v instanceof Etask_err};E.err_res=function(err,res){return err?E.err(err):res};E._res2rv=function(res){return E.is_err(res)?{ret:undefined,err:res.error}:{ret:res,err:undefined}};E.is_final=function(v){return!v||typeof v.then!="function"||v instanceof Etask_err||v instanceof Etask&&!!v.tm_completed};E.prototype.then=function(on_res,on_err){var _this=this;function on_done(){if(!_this.error)return!on_res?_this.retval:on_res(_this.retval);return!on_err?E.err(_this.error):on_err(_this.error)}if(this.tm_completed)return etask("then_completed",[function(){return on_done()}]);var then_wait=etask("then_wait",[function(){return this.wait()}]);this.then_waiting.push(function(){try{then_wait.continue(on_done())}catch(e){then_wait.throw(e)}});return then_wait};E.prototype.otherwise=E.prototype.catch=function(on_err){return this.then(null,on_err)};E.prototype.ensure=function(on_ensure){return this.then(function(res){on_ensure();return res},function(err){on_ensure();throw err})};Etask_err.prototype.then=function(on_res,on_err){var _this=this;return etask("then_err",[function(){return!on_err?E.err(_this.error):on_err(_this.error)}])};Etask_err.prototype.otherwise=Etask_err.prototype.catch=function(on_err){return this.then(null,on_err)};Etask_err.prototype.ensure=function(on_ensure){this.then(null,function(){on_ensure()});return this};E.resolve=function(res){return etask([function(){return res}])};E.reject=function(err){return etask([function(){throw err}])};E.prototype.wait_ext=function(promise){if(!promise||typeof promise.then!="function")return promise;var wait=this.wait();promise.then(wait.continue_fn(),wait.throw_fn());return wait};E.prototype.longname=function(flags){flags=flags||{TIME:1};var s="",_s;if(this.running)s+="RUNNING ";s+=this.get_name(flags)+(!this.tm_completed?"."+this.state_str():"")+" ";if(this.tm_completed)s+="COMPLETED"+(flags.TIME?" "+this.get_time_completed():"")+" ";if(flags.TIME)s+=this.get_time_passed()+" ";if(_s=this.get_info())s+=_s+" ";return trim_space(s)};E.prototype.stack=function(flags){var et=this,s="";flags=assign({STACK:1,RECURSIVE:1,GUESS:1},flags);while(et){var _s=et.longname(flags)+"\n";if(et.up)et=et.up;else if(et.parent){_s=(et.parent_type=="call"?"CALL":"SPAWN")+" "+_s;et=et.parent}else if(et.parent_guess&&flags.GUESS){_s="SPAWN? "+_s;et=et.parent_guess}else et=undefined;if(flags.TOPDOWN)s=_s+s;else s+=_s}return s};E.prototype._ps=function(pre_first,pre_next,flags){var i,s="",task_trail,et=this,child_guess;if(++flags.limit_n>=flags.LIMIT)return flags.limit_n==flags.LIMIT?"\nLIMIT "+flags.LIMIT+"\n":"";for(;et.up;et=et.up);for(var first=1;et;et=et.down,first=0){s+=first?pre_first:pre_next;first=0;if(flags.MARK&&(i=flags.MARK.sp.indexOf(et))>=0)s+=(flags.MARK.name[i]||"***")+" ";s+=et.longname(flags)+"\n";if(flags.RECURSIVE){var stack_trail=et.down?".":" ";var child=et.child;if(flags.GUESS)child=child.concat(et.child_guess);for(i=0;i<child.length;i++){task_trail=i<child.length-1?"|":stack_trail;child_guess=child[i].parent_guess?"\\? ":child[i].parent_type=="call"?"\\> ":"\\_ ";s+=child[i]._ps(pre_next+task_trail+child_guess,pre_next+task_trail+"   ",flags)}}}return s};function ps_flags(flags){var m,_m;if(m=flags.MARK){if(!Array.isArray(m))_m={sp:[m],name:[]};else if(!Array.isArray(flags.MARK[0]))_m={sp:m,name:[]};else{_m={sp:[],name:[]};for(var i=0;i<m.length;i++){_m.name.push(m[i][0]);_m.sp.push(m[i][1])}}flags.MARK=_m}}E.prototype.ps=function(flags){flags=assign({STACK:1,RECURSIVE:1,LIMIT:1e7,TIME:1,GUESS:1},flags,{limit_n:0});ps_flags(flags);return this._ps("","",flags)};E._longname_root=function(){return(zerr.prefix?zerr.prefix+"pid "+process.pid+" ":"")+"root"};E.ps=function(flags){var i,s="",task_trail;flags=assign({STACK:1,RECURSIVE:1,LIMIT:1e7,TIME:1,GUESS:1},flags,{limit_n:0});ps_flags(flags);s+=E._longname_root()+"\n";var child=E.root;if(flags.GUESS){child=[];for(i=0;i<E.root.length;i++){if(!E.root[i].parent_guess)child.push(E.root[i])}}for(i=0;i<child.length;i++){task_trail=i<child.length-1?"|":" ";s+=child[i]._ps(task_trail+"\\_ ",task_trail+"   ",flags)}return s};function assert_tree_unique(a){var i;for(i=0;i<a.length-1;i++)assert(!a.includes(a[i],i+1))}E.prototype._assert_tree=function(opt){var i,et;opt=opt||{};assert_tree_unique(this.child);assert(this.parent);if(this.down){et=this.down;assert(et.up===this);assert(!et.parent);assert(!et.parent_guess);this.down._assert_tree(opt)}for(i=0;i<this.child.length;i++){et=this.child[i];assert(et.parent===this);assert(!et.parent_guess);assert(!et.up);et._assert_tree(opt)}if(this.child_guess.length)assert(E.in_run.includes(this));for(i=0;i<this.child_guess.length;i++){et=this.child_guess[i];assert(et.parent_guess===this);assert(!et.parent);assert(!et.up)}};E._assert_tree=function(opt){var i,et,child=E.root;opt=opt||{};assert_tree_unique(E.root);for(i=0;i<child.length;i++){et=child[i];assert(!et.parent);assert(!et.up);et._assert_tree(opt)}};E.prototype._assert_parent=function(){if(this.up)return assert(!this.parent&&!this.parent_guess);assert(this.parent&&this.parent_guess,"parent_guess together with parent");if(this.parent){var child=this.parent?this.parent.child:E.root;assert(child.includes(this),"cannot find in parent "+(this.parent?"":"root"))}else if(this.parent_guess){assert(this.parent_guess.child_guess.includes(this),"cannot find in parent_guess");assert(E.in_run.includes(this.parent_guess))}};E.prototype.return_child=function(){var child=Array.from(this.child);for(var i=0;i<child.length;i++)child[i].return()};E.sleep=function(ms){var timer;ms=ms||0;return etask({name:"sleep",cancel:true},[function(){this.info.ms=ms+"ms";timer=setTimeout(this.continue_fn(),ms);return this.wait()},function finally$(){clearTimeout(timer)}])};var ebreak_obj={ebreak:1};E.prototype.break=function(ret){return this.throw({ebreak:ebreak_obj,ret:ret})};E.for=function(cond,inc,opt,states){if(Array.isArray(opt)||typeof opt=="function"){states=opt;opt={}}if(typeof states=="function")states=[states];opt=opt||{};return etask({name:"for",cancel:true,init:opt.init_parent},[function loop(){return!cond||cond.call(this)},function try_catch$(res){if(!res)return this.return();return etask({name:"for_iter",cancel:true,init:opt.init},states||[])},function(){if(this.error){if(this.error.ebreak===ebreak_obj)return this.return(this.error.ret);return this.throw(this.error)}return inc&&inc.call(this)},function(){return this.goto("loop")}])};E.for_each=function(obj,states){var keys=Object.keys(obj);var iter={obj:obj,keys:keys,i:0,key:undefined,val:undefined};function init_iter(){this.iter=iter}return E.for(function(){this.iter=this.iter||iter;iter.key=keys[iter.i];iter.val=obj[keys[iter.i]];return iter.i<keys.length},function(){return iter.i++},{init:init_iter,init_parent:init_iter},states)};E.while=function(cond,states){return E.for(cond,null,states)};E.all=function(a_or_o,ao2){var i,j,opt={};if(ao2){opt=a_or_o;a_or_o=ao2}if(Array.isArray(a_or_o)){var a=Array.from(a_or_o);i=0;return etask({name:"all_a",cancel:true},[function(){for(j=0;j<a.length;j++)this.spawn(a[j])},function try_catch$loop(){if(i>=a.length)return this.return(a);this.info.at="at "+i+"/"+a.length;var _a=a[i];if(_a instanceof Etask)_a.spawn_parent();return _a},function(res){if(this.error){if(!opt.allow_fail)return this.throw(this.error);res=E.err(this.error)}a[i]=res;i++;return this.goto("loop")}])}else if(a_or_o instanceof Object){var keys=Object.keys(a_or_o),o={};i=0;return etask({name:"all_o",cancel:true},[function(){for(j=0;j<keys.length;j++)this.spawn(a_or_o[keys[j]])},function try_catch$loop(){if(i>=keys.length)return this.return(o);var _i=keys[i],_a=a_or_o[_i];this.info.at="at "+_i+" "+i+"/"+keys.length;if(_a instanceof Etask)_a.spawn_parent();return _a},function(res){if(this.error){if(!opt.allow_fail)return this.throw(this.error);res=E.err(this.error)}o[keys[i]]=res;i++;return this.goto("loop")}])}else assert(0,"invalid type")};E.all_limit=function(limit,arr_iter,cb){var at=0;var iter=!Array.isArray(arr_iter)?arr_iter:function(){if(at<arr_iter.length)return cb.call(this,arr_iter[at++])};return etask({name:"all_limit",cancel:true},[function(){var next;if(!(next=iter.call(this)))return this.goto("done");this.spawn(next);this.loop();if(this.child.length>=limit)return this.wait_child("any")},function done(){return this.wait_child("all")}])};E._apply=function(opt,func,_this,args){var func_name;if(typeof _this=="string"){assert(_this[0]==".","invalid method "+_this);var method=_this.slice(1),_class=func;func=_class[method];_this=_class;assert(_this instanceof Object,"invalid method ."+method);func_name=method}else if(Array.isArray(_this)&&!args){args=_this;_this=null}opt.name=opt.name||func_name||func.name;return etask(opt,[function(){var et=this,ret_sync,returned=0;args=Array.from(args);args.push(function cb(err,res){if(typeof opt.ret_sync=="string"&&!returned){var a=arguments;returned++;return void E.nextTick(function(){cb.apply(null,a)})}var nfn=opt.nfn===undefined||opt.nfn?1:0;if(opt.ret_o){var o={},i;if(Array.isArray(opt.ret_o)){for(i=0;i<opt.ret_o.length;i++)o[opt.ret_o[i]]=arguments[i+nfn]}else if(typeof opt.ret_o=="string")o[opt.ret_o]=array.slice(arguments,nfn);else assert(0,"invalid opt.ret_o");if(typeof opt.ret_sync=="string")o[opt.ret_sync]=ret_sync;res=o}else if(opt.ret_a)res=array.slice(arguments,nfn);else if(!nfn)res=err;et.continue(nfn?E.err_res(err,res):res)});ret_sync=func.apply(_this,args);if(Array.isArray(opt.ret_sync))opt.ret_sync[0][opt.ret_sync[1]]=ret_sync;returned++;return this.wait()}])};E.nfn_apply=function(opt,func,_this,args){var _opt={nfn:1};if(typeof opt=="function"||typeof func=="string"){args=_this;_this=func;func=opt;opt=_opt}else opt=assign(_opt,opt);return E._apply(opt,func,_this,args)};E.cb_apply=function(opt,func,_this,args){var _opt={nfn:0};if(typeof opt=="function"||typeof func=="string"){args=_this;_this=func;func=opt;opt=_opt}else opt=assign(_opt,opt);return E._apply(opt,func,_this,args)};E.prototype.continue_nfn=function(){return function(err,res){this.continue(E.err_res(err,res))}.bind(this)};E.augment=function(_prototype,method,e_method){var i,opt={};if(method instanceof Object&&!Array.isArray(method)){assign(opt,method);method=arguments[2];e_method=arguments[3]}if(Array.isArray(method)){if(e_method)opt.prefix=e_method;for(i=0;i<method.length;i++)E.augment(_prototype,opt,method[i]);return}opt.prefix=opt.prefix||"e_";if(!e_method)e_method=opt.prefix+method;var fn=_prototype[method];_prototype[e_method]=function(){return etask._apply({name:e_method,nfn:1},fn,this,arguments)}};E.wait=function(timeout){return etask({name:"wait",cancel:true},[function(){return this.wait(timeout)}])};E.to_nfn=function(promise,cb,opt){return etask({name:"to_nfn",async:true},[function try_catch$(){return promise},function(res){var ret=[this.error];if(opt&&opt.ret_a)ret=ret.concat(res);else ret.push(res);cb.apply(null,ret)}])};function etask_fn(opt,states,push_this){if(Array.isArray(opt)||typeof opt=="function"){states=opt;opt=undefined}return function(){var _opt=assign({},opt);_opt.state0_args=Array.from(arguments);if(push_this)_opt.state0_args.unshift(this);return etask(_opt,states)}}E.fn=function(opt,states){return etask_fn(opt,states,false)};E._fn=function(opt,states){return etask_fn(opt,states,true)};E._generator=function(gen,ctor,opt){opt=opt||{};opt.name=opt.name||ctor&&ctor.name||"generator";if(opt.cancel===undefined)opt.cancel=true;var done;return etask(opt,[function(){this.generator=gen=gen||ctor.apply(this,opt.state0_args||[]);this.generator_ctor=ctor;return{ret:undefined,err:undefined}},function try_catch$loop(rv){var res;try{res=rv.err?gen.throw(rv.err):gen.next(rv.ret)}catch(e){return this.return(E.err(e))}if(res.done){done=true;return this.return(res.value)}return res.value},function(ret){return this.goto("loop",this.error?{ret:undefined,err:this.error}:{ret:ret,err:undefined})},function finally$(){if(!done&&gen.return)try{gen.return()}catch(e){}}])};E.ef=function(err){if(zerr.on_exception)zerr.on_exception(err);return err};E.interval=function(opt,states){if(typeof opt=="number")opt={ms:opt};if(opt.mode=="fixed"){return E.for(null,function(){return etask.sleep(opt.ms)},states)}if(opt.mode=="smart"||!opt.mode){var now;return E.for(function(){now=Date.now();return true},function(){var delay=zutil.clamp(0,now+opt.ms-Date.now(),Infinity);return etask.sleep(delay)},states)}if(opt.mode=="spawn"){var stopped=false;return etask([function loop(){etask([function try_catch$(){return etask(states)},function(res){if(!this.error)return;if(this.error.ebreak!==ebreak_obj)return this.throw(this.error);stopped=true}])},function(){if(stopped)return this.return();return etask.sleep(opt.ms)},function(){if(stopped)return this.return();return this.goto("loop")}])}throw new Error("unexpected mode "+opt.mode)};return Etask})})();
(function(){var __hola_stub_define;var is_node=typeof module=="object"&&module.exports&&module.children;var is_node_ff=typeof module=="object"&&module.exports;if(!is_node_ff)define=define||self.define;else define=require("./require_node.js").define(module,"../");define("/util/date.js",[],function(){var E=date_get;function pad(num,size){return("000"+num).slice(-size)}E.ms_to_dur=function(_ms){var s="";var sec=Math.floor(_ms/1e3);if(sec<0){s+="-";sec=-sec}var days=Math.floor(sec/(60*60*24));sec-=days*60*60*24;var hours=Math.floor(sec/(60*60));sec-=hours*60*60;var mins=Math.floor(sec/60);sec-=mins*60;if(days)s+=days+" "+(days>1?"Days":"Day")+" ";return s+pad(hours,2)+":"+pad(mins,2)+":"+pad(sec,2)};E.dur_to_str=function(duration,opt){opt=opt||{};var parts=[];duration=+duration;function chop(period,name){if(duration<period)return;var number=Math.floor(duration/period);parts.push(number+name);duration-=number*period}chop(ms.YEAR,"y");chop(ms.MONTH,"mo");if(opt.week)chop(ms.WEEK,"w");chop(ms.DAY,"d");chop(ms.HOUR,"h");chop(ms.MIN,"min");chop(ms.SEC,"s");if(duration)parts.push(duration+"ms");if(!parts.length)return"0s";return parts.slice(0,opt.units||parts.length).join(opt.sep||"")};E.monotonic=undefined;E.init=function(){var adjust,last;if(typeof window=="object"&&window.performance&&window.performance.now){adjust=Date.now()-window.performance.now();E.monotonic=function(){return window.performance.now()+adjust}}else if(is_node&&!global.mocha_running){var timer=process.binding("timer_wrap").Timer;adjust=Date.now()-timer.now();E.monotonic=function(){return timer.now()+adjust}}else{last=adjust=0;E.monotonic=function(){var now=Date.now()+adjust;if(now>=last)return last=now;adjust+=last-now;return last}}};E.init();E.str_to_dur=function(str,opt){opt=opt||{};var month="mo|mon|months?";if(opt.short_month)month+="|m";var m=str.replace(/ /g,"").match(new RegExp("^(([0-9]+)y(ears?)?)?"+"(([0-9]+)("+month+"))?(([0-9]+)w(eeks?)?)?(([0-9]+)d(ays?)?)?"+"(([0-9]+)h(ours?)?)?(([0-9]+)(min|minutes?))?"+"(([0-9]+)s(ec|econds?)?)?(([0-9]+)ms(ec)?)?$"));if(!m)return;return ms.YEAR*(+m[2]||0)+ms.MONTH*(+m[5]||0)+ms.WEEK*(+m[8]||0)+ms.DAY*(+m[11]||0)+ms.HOUR*(+m[14]||0)+ms.MIN*(+m[17]||0)+ms.SEC*(+m[20]||0)+(+m[23]||0)};E.months_long=["January","February","March","April","May","June","July","August","September","October","November","December"];E.months_short=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var months_short_lc=E.months_short.map(function(m){return m.toLowerCase()});E.days_long=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];E.days_short=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var days_short_lc=E.days_short.map(function(d){return d.toLowerCase()});E.locale={months_long:E.months_long,months_short:E.months_short,days_long:E.days_long,days_short:E.days_short,AM:"AM",PM:"PM"};E.get=date_get;function date_get(d,_new){var y,mon,day,H,M,S,_ms;if(d===undefined)return new Date;if(d==null)return new Date(null);if(d instanceof Date)return _new?new Date(d):d;if(typeof d=="string"){var m;d=d.trim();if(m=/^((\d\d\d\d)-(\d\d)-(\d\d)|(\d\d?)-([A-Za-z]{3})-(\d\d(\d\d)?))\s*([\sT](\d\d):(\d\d)(:(\d\d)(\.(\d\d\d))?)?Z?)?$/.exec(d)){H=+m[10]||0;M=+m[11]||0;S=+m[13]||0;_ms=+m[15]||0;if(m[2]){y=+m[2];mon=+m[3];day=+m[4];if(!y&&!mon&&!day&&!H&&!M&&!S&&!_ms)return new Date(NaN);return new Date(Date.UTC(y,mon-1,day,H,M,S,_ms))}if(m[5]){y=+m[7];mon=months_short_lc.indexOf(m[6].toLowerCase())+1;day=+m[5];if(m[7].length==2){y=+y;y+=y>=70?1900:2e3}return new Date(Date.UTC(y,mon-1,day,H,M,S,_ms))}}if(/^\d+$/.test(d))return new Date(+d);return new Date(d)}if(typeof d=="number")return new Date(d);throw new TypeError("invalid date "+d)}E.to_sql_ms=function(d){d=E.get(d);if(isNaN(d))return"0000-00-00 00:00:00.000";return pad(d.getUTCFullYear(),4)+"-"+pad(d.getUTCMonth()+1,2)+"-"+pad(d.getUTCDate(),2)+" "+pad(d.getUTCHours(),2)+":"+pad(d.getUTCMinutes(),2)+":"+pad(d.getUTCSeconds(),2)+"."+pad(d.getUTCMilliseconds(),3)};E.to_sql_sec=function(d){return E.to_sql_ms(d).slice(0,-4)};E.to_sql=function(d){return E.to_sql_ms(d).replace(/( 00:00:00)?....$/,"")};E.from_sql=E.get;E.to_month_short=function(d){d=E.get(d);return E.months_short[d.getUTCMonth()]};E.to_jdate=function(d){d=E.get(d);return(pad(d.getUTCDate(),2)+"-"+E.months_short[d.getUTCMonth()]+"-"+pad(d.getUTCFullYear()%100,2)+" "+pad(d.getUTCHours(),2)+":"+pad(d.getUTCMinutes(),2)+":"+pad(d.getUTCSeconds(),2)).replace(/( 00:00)?:00$/,"")};E.to_log_file=function(d){d=E.get(d);return d.getUTCFullYear()+pad(d.getUTCMonth()+1,2)+pad(d.getUTCDate(),2)+"_"+pad(d.getUTCHours(),2)+pad(d.getUTCMinutes(),2)+pad(d.getUTCSeconds(),2)};E.from_log_file=function(d){var m=d.match(/^(\d{4})(\d{2})(\d{2})_(\d{2})(\d{2})(\d{2})$/);if(!m)return;return new Date(Date.UTC(m[1],m[2]-1,m[3],m[4],m[5],m[6]))};E.to_log_ms=function(d){return E.to_sql_ms(d).replace(/-/g,".")};E.from_rcs=function(d){var m=d.match(/^(\d{4})\.(\d{2})\.(\d{2})\.(\d{2})\.(\d{2})\.(\d{2})$/);if(!m)return;return new Date(Date.UTC(m[1],m[2]-1,m[3],m[4],m[5],m[6]))};E.to_rcs=function(d){return E.to_sql_sec(d).replace(/[-: ]/g,".")};E.sec={MS:.001,SEC:1,MIN:60,HOUR:60*60,DAY:24*60*60,WEEK:7*24*60*60,MONTH:30*24*60*60,YEAR:365*24*60*60};E.ms={};for(var key in E.sec)E.ms[key]=E.sec[key]*1e3;var ms=E.ms;E.align=function(d,align){d=E.get(d,1);switch(align.toUpperCase()){case"MS":break;case"SEC":d.setUTCMilliseconds(0);break;case"MIN":d.setUTCSeconds(0,0);break;case"HOUR":d.setUTCMinutes(0,0,0);break;case"DAY":d.setUTCHours(0,0,0,0);break;case"WEEK":d.setUTCDate(d.getUTCDate()-d.getUTCDay());d.setUTCHours(0,0,0,0);break;case"MONTH":d.setUTCDate(1);d.setUTCHours(0,0,0,0);break;case"YEAR":d.setUTCMonth(0,1);d.setUTCHours(0,0,0,0);break;default:throw new Error("invalid align "+align)}return d};E.add=function(d,duration){d=E.get(d,1);if(duration.year)d.setUTCFullYear(d.getUTCFullYear()+duration.year);if(duration.month)d.setUTCMonth(d.getUTCMonth()+duration.month);["day","hour","min","sec","ms"].forEach(function(key){if(duration[key])d.setTime(+d+duration[key]*ms[key.toUpperCase()])});return d};E.describe_interval=function(_ms){if(_ms<2*ms.MIN)return Math.round(_ms/ms.SEC)+" sec";if(_ms<2*ms.HOUR)return Math.round(_ms/ms.MIN)+" min";if(_ms<2*ms.DAY)return Math.round(_ms/ms.HOUR)+" hours";if(_ms<2*ms.WEEK)return Math.round(_ms/ms.DAY)+" days";if(_ms<2*ms.MONTH)return Math.round(_ms/ms.WEEK)+" weeks";if(_ms<2*ms.YEAR)return Math.round(_ms/ms.MONTH)+" months";return Math.round(_ms/ms.YEAR)+" years"};E.time_ago=function(d,until_date){var _ms=E.get(until_date)-E.get(d);if(_ms<ms.SEC)return"right now";return E.describe_interval(_ms)+" ago"};E.ms_to_str=function(_ms){var s=""+_ms;return s.length<=3?s+"ms":s.slice(0,-3)+"."+s.slice(-3)+"s"};E.parse=function(text,opt){opt=opt||{};if(opt.fmt)return E.strptime(text,opt.fmt);var d,a,i,v,_v,dir,_dir,amount,now=opt.now;now=!now?new Date:new Date(now);text=text.replace(/\s+/g," ").trim().toLowerCase();if(!text)return;if(text=="now")return now;if(!isNaN(d=E.get(text)))return d;d=now;a=text.split(" ");dir=a.includes("ago")?-1:a.includes("last")?-1:a.includes("next")?1:undefined;for(i=0;i<a.length;i++){v=a[i];if(/^(ago|last|next)$/.test(v));else if(v=="today")d=E.align(d,"DAY");else if(v=="yesterday")d=E.align(+d-ms.DAY,"DAY");else if(v=="tomorrow")d=E.align(+d+ms.DAY,"DAY");else if((_v=days_short_lc.indexOf(v))>=0)d=new Date(+E.align(d,"WEEK")+_v*ms.DAY+(dir||0)*ms.WEEK);else if(_v=/^([+-]?\d+)(?:([ymoinwdhs]+)(\d.*)?)?$/.exec(v)){if(amount!==undefined)return;amount=dir!==undefined?Math.abs(+_v[1]):+_v[1];if(_v[2]){a.splice(i+1,0,_v[2]);if(_v[3])a.splice(i+2,0,_v[3])}continue}else if(/^([ywdhs]|years?|months?|mon?|weeks?|days?|hours?|minutes?|min|seconds?|sec)$/.test(v)){_v=v[0]=="m"&&v[1]=="i"?ms.MIN:v[0]=="y"?ms.YEAR:v[0]=="m"&&v[1]=="o"?ms.MONTH:v[0]=="w"?ms.WEEK:v[0]=="d"?ms.DAY:v[0]=="h"?ms.HOUR:ms.SEC;amount=amount===undefined?1:amount;_dir=dir===undefined?opt.dir||1:dir;if(_v==ms.MONTH)d.setUTCMonth(d.getUTCMonth()+_dir*amount);else if(_v==ms.YEAR)d.setUTCFullYear(d.getUTCFullYear()+_dir*amount);else d=new Date(+d+_v*amount*_dir);amount=undefined}else return;if(amount!==undefined)return}if(amount!==undefined)return;return d};E.strptime=function(str,fmt){function month(m){return months_short_lc.indexOf(m.toLowerCase())}var parse={"%":["%",function(){},0],a:["[a-z]+",function(m){},0],A:["[a-z]+",function(m){},0],b:["[a-z]+",function(m){d.setUTCMonth(month(m))},2],B:["[a-z]+",function(m){d.setUTCMonth(month(m.toLowerCase()))},2],y:["[0-9]{2}",function(m){d.setUTCFullYear(+m+(m<70?2e3:1900))},1],Y:["[0-9]{4}",function(m){d.setUTCFullYear(+m)},1],m:["[0-9]{0,2}",function(m){d.setUTCMonth(+m-1)},2],d:["[0-9]{0,2}",function(m){d.setUTCDate(+m)},3],H:["[0-9]{0,2}",function(m){d.setUTCHours(+m)},4],M:["[0-9]{0,2}",function(m){d.setUTCMinutes(+m)},5],S:["[0-9]{0,2}",function(m){d.setUTCSeconds(+m)},6],s:["[0-9]+",function(m){d=new Date(+m)},0],L:["[0-9]{0,3}",function(m){d.setUTCMilliseconds(+m)},7],z:["[+-][0-9]{4}",function(m){var timezone=+m.slice(0,3)*3600+m.slice(3,5)*60;d=new Date(d.getTime()-timezone*1e3)},8],Z:["[a-z]{0,3}[+-][0-9]{2}:?[0-9]{2}|[a-z]{1,3}",function(m){m=/^([a-z]{0,3})(?:([+-][0-9]{2}):?([0-9]{2}))?$/i.exec(m);if(m[1]=="Z"||m[1]=="UTC")return;var timezone=+m[2]*3600+m[3]*60;d=new Date(d.getTime()-timezone*1e3)},8],I:["[0-9]{0,2}",function(m){d.setUTCHours(+m)},4],p:["AM|PM",function(m){if(d.getUTCHours()==12)d.setUTCHours(d.getUTCHours()-12);if(m.toUpperCase()=="PM")d.setUTCHours(d.getUTCHours()+12)},9]};var ff=[];var ff_idx=[];var re=new RegExp("^\\s*"+fmt.replace(/%(?:([a-zA-Z%]))/g,function(_,fd){var d=parse[fd];if(!d)throw Error("Unknown format descripter: "+fd);ff_idx[d[2]]=ff.length;ff.push(d[1]);return"("+d[0]+")"})+"\\s*$","i");var matched=str.match(re);if(!matched)return;var d=new Date(0);for(var i=0;i<ff_idx.length;i++){var idx=ff_idx[i];var fun=ff[idx];if(fun)fun(matched[idx+1])}return d};var utc_local={local:{getSeconds:function(d){return d.getSeconds()},getMinutes:function(d){return d.getMinutes()},getHours:function(d){return d.getHours()},getDay:function(d){return d.getDay()},getDate:function(d){return d.getDate()},getMonth:function(d){return d.getMonth()},getFullYear:function(d){return d.getFullYear()},getYearBegin:function(d){return new Date(d.getFullYear(),0,1)}},utc:{getSeconds:function(d){return d.getUTCSeconds()},getMinutes:function(d){return d.getUTCMinutes()},getHours:function(d){return d.getUTCHours()},getDay:function(d){return d.getUTCDay()},getDate:function(d){return d.getUTCDate()},getMonth:function(d){return d.getUTCMonth()},getFullYear:function(d){return d.getUTCFullYear()},getYearBegin:function(d){return new Date(Date.UTC(d.getUTCFullYear(),0,1))}}};E.strftime=function(fmt,d,opt){function hours12(hours){return hours==0?12:hours>12?hours-12:hours}function ord_str(n){var i=n%10,ii=n%100;if(ii>=11&&ii<=13||i==0||i>=4)return"th";switch(i){case 1:return"st";case 2:return"nd";case 3:return"rd"}}function week_num(l,d,first_weekday){var wday=l.getDay(d);if(first_weekday=="monday")wday=wday==0?wday=6:wday-1;var yday=(d-l.getYearBegin(d))/ms.DAY;return Math.floor((yday+7-wday)/7)}function padx(n,padding,length){if(typeof padding=="number"){length=padding;padding="0"}if(padding===undefined)padding="0";length=length||2;var s=""+n;if(padding)for(;s.length<length;s=padding+s);return s}opt=opt||{};d=E.get(d);var locale=opt.locale||E.locale;var formats=locale.formats||{};var tz=opt.timezone;var utc=opt.utc!==undefined?opt.utc:opt.local!==undefined?!opt.local:true;if(tz!=null){utc=true;if(typeof tz=="string"){var sign=tz[0]=="-"?-1:1;var hours=parseInt(tz.slice(1,3),10);var mins=parseInt(tz.slice(3,5),10);tz=sign*(60*hours+mins)}if(typeof tz=="number")d=new Date(+d+tz*6e4)}var l=utc?utc_local.utc:utc_local.local;function replace(fmt){return fmt.replace(/%([-_0]?.)/g,function(_,c){var mod,padding,day;if(c.length==2){mod=c[0];if(mod=="-")padding="";else if(mod=="_")padding=" ";else if(mod=="0")padding="0";else return _;c=c[1]}switch(c){case"A":return locale.days_long[l.getDay(d)];case"a":return locale.days_short[l.getDay(d)];case"B":return locale.months_long[l.getMonth(d)];case"b":return locale.months_short[l.getMonth(d)];case"C":return padx(Math.floor(l.getFullYear(d)/100),padding);case"D":return replace(formats.D||"%m/%d/%y");case"d":return padx(l.getDate(d),padding);case"e":return l.getDate(d);case"F":return replace(formats.F||"%Y-%m-%d");case"H":return padx(l.getHours(d),padding);case"h":return locale.months_short[l.getMonth(d)];case"I":return padx(hours12(l.getHours(d)),padding);case"j":day=Math.ceil((+d-l.getYearBegin(d))/(1e3*60*60*24));return pad(day,3);case"k":return padx(l.getHours(d),padding===undefined?" ":padding);case"L":return pad(Math.floor(d.getMilliseconds()),3);case"l":return padx(hours12(l.getHours(d)),padding===undefined?" ":padding);case"M":return padx(l.getMinutes(d),padding);case"m":return padx(l.getMonth(d)+1,padding);case"n":return"\n";case"o":return""+l.getDate(d)+ord_str(l.getDate(d));case"P":return(l.getHours(d)<12?locale.AM:locale.PM).toLowerCase();case"p":return l.getHours(d)<12?locale.AM:locale.PM;case"R":return replace(formats.R||"%H:%M");case"r":return replace(formats.r||"%I:%M:%S %p");case"S":return padx(l.getSeconds(d),padding);case"s":return Math.floor(+d/1e3);case"T":return replace(formats.T||"%H:%M:%S");case"t":return"	";case"U":return padx(week_num(l,d,"sunday"),padding);case"u":day=l.getDay(d);return day==0?7:day;case"v":return replace(formats.v||"%e-%b-%Y");case"W":return padx(week_num(l,d,"monday"),padding);case"w":return l.getDay(d);case"Y":return l.getFullYear(d);case"y":return(""+l.getFullYear(d)).slice(-2);case"Z":if(utc)return"GMT";var tz_string=d.toString().match(/\((\w+)\)/);return tz_string&&tz_string[1]||"";case"z":if(utc)return"+0000";var off=typeof tz=="number"?tz:-d.getTimezoneOffset();return(off<0?"-":"+")+pad(Math.abs(off/60),2)+pad(off%60,2);default:return c}})}return replace(fmt)};return E})})();
(function(){var __hola_stub_define;var is_node_ff=typeof module=="object"&&module.exports;if(!is_node_ff)define=define||self.define;else define=require("./require_node.js").define(module,"../");define("/util/sprintf.js",[],function(){var E=sprintf;E.sprintf=sprintf;var has=Object.prototype.hasOwnProperty;function sprintf(fmt){if(has.call(E.cache,fmt))return E.cache[fmt](arguments);E.cache[fmt]=E.parse(fmt);E.cache_n++;if(E.cache_cb)E.cache_cb(fmt);return E.cache[fmt](arguments)}E.cache={};E.cache_n=0;E.to_int=function(num){return(num=+num)>=0?Math.floor(num):-Math.floor(-num)};E.thousand_grouping=function(num_s){var m=/^([-+])?(\d*)(\.\d*)?$/.exec(num_s);if(!m)return num_s;m[2]=(m[2]||"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+",");return(m[1]||"")+m[2]+(m[3]||"")};E.parse_fast=function(fmt){var _fmt=fmt,match=[],arg_names=0,cursor=1;var pad_chr,pad_chrs,arg_padded,f,s=JSON.stringify;f='var out = "", arg, arg_s, sign;\n';for(;_fmt;_fmt=_fmt.substring(match[0].length)){if(match=/^[^%]+/.exec(_fmt))f+="out += "+s(match[0])+";\n";else if(match=/^%%/.exec(_fmt))f+='out += "%";\n';else if(match=/^%(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?(')?([bcdefoOsuxX])/.exec(_fmt)){var positional=match[1],keyword=match[2],sign=match[3];var pad_zero=match[4],pad_min=match[5],pad_max=match[6];var precision=match[7],thousand_grouping=match[8]=="'";var conversion=match[9],keyword_list=[];if(keyword){arg_names|=1;var _keyword=keyword,kmatch;if(!(kmatch=/^([a-z_][a-z_\d]*)/i.exec(_keyword)))throw"sprintf: invalid keyword property name "+_keyword;keyword_list.push(kmatch[1]);while(_keyword=_keyword.substring(kmatch[0].length)){if(kmatch=/^\.([a-z_][a-z_\d]*)/i.exec(_keyword))keyword_list.push(kmatch[1]);else if(kmatch=/^\[(\d+)\]/.exec(_keyword))keyword_list.push(kmatch[1]);else throw"sprintf: invalid keyword format "+_keyword}}else arg_names|=2;if(arg_names===3){throw"sprintf: mixing positional and named placeholders is "+"not (yet) supported"}f+="sign = false;\n";if(keyword_list.length){f+="arg = argv["+cursor+"]";for(var k=0;k<keyword_list.length;k++)f+="["+s(keyword_list[k])+"]";f+=";\n"}else if(positional)f+="arg = argv["+positional+"];\n";else f+="arg = argv["+cursor++ +"];\n";if(/[^sO]/.test(conversion))f+="arg = +arg;\n";switch(conversion){case"b":f+="arg_s = arg.toString(2);\n";break;case"c":f+="arg_s = String.fromCharCode(arg);\n";break;case"d":f+='arg = sprintf.to_int(arg); arg_s = ""+arg;\n';if(thousand_grouping)f+="arg_s = sprintf.thousand_grouping(arg_s);\n";break;case"e":f+="arg_s = arg.toExponential("+(precision?s(precision):"")+");\n";break;case"f":if(precision)f+="arg_s = arg.toFixed("+precision+");\n";else f+='arg_s = ""+arg;\n';if(thousand_grouping)f+="arg_s = sprintf.thousand_grouping(arg_s);\n";break;case"o":f+="arg_s = arg.toString(8);\n";break;case"O":f+="arg_s = JSON.stringify(arg);\n";break;case"u":f+='arg = arg >>> 0; arg_s = ""+arg;\n';break;case"x":f+="arg_s = arg.toString(16);\n";break;case"X":f+="arg_s = arg.toString(16).toUpperCase();\n";break;case"s":f+='arg_s = ""+arg;\n';if(precision)f+="arg_s = arg_s.substring(0, "+precision+");\n";break}if(/[def]/.test(conversion)){if(sign)f+='if (arg>=0) arg_s = "+"+arg_s;\n';f+='sign = arg_s[0]=="-" || arg_s[0]=="+";\n'}pad_chr=!pad_zero?" ":pad_zero=="0"?"0":pad_zero[1];pad_chrs=s(pad_chr)+".repeat(Math.max("+ +pad_max+"-arg_s.length, 0))";arg_padded=!pad_max?"arg_s":pad_min?"arg_s+"+pad_chrs:/[def]/.test(conversion)&&pad_chr=="0"?"(sign ? arg_s[0]+"+pad_chrs+"+arg_s.slice(1) : "+pad_chrs+"+arg_s)":pad_chrs+"+arg_s";f+="out += "+arg_padded+";\n"}else throw"sprintf invalid format "+_fmt}f+="return out;\n";return new Function(["sprintf","argv"],f).bind(null,sprintf)};E.parse_slow=function(fmt){var _fmt=fmt,match=[],arg_names=0,cursor=1;var _f=[],out,arg,arg_s,argv,sign;function f(fn){_f.push(fn)}for(;_fmt;_fmt=_fmt.substring(match[0].length))(function(){if(match=/^[^%]+/.exec(_fmt)){var _match=match;f(function(){return out+=_match[0]})}else if(match=/^%%/.exec(_fmt))f(function(){return out+="%"});else if(match=/^%(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?(')?([bcdefoOsuxX])/.exec(_fmt)){var positional=match[1],keyword=match[2],sign=match[3];var pad_zero=match[4],pad_min=match[5],pad_max=match[6];var precision=match[7],thousand_grouping=match[8]=="'";var conversion=match[9],keyword_list=[],_cursor=cursor;if(keyword){arg_names|=1;var _keyword=keyword,kmatch;if(!(kmatch=/^([a-z_][a-z_\d]*)/i.exec(_keyword)))throw"sprintf: invalid keyword property name "+_keyword;keyword_list.push(kmatch[1]);while(_keyword=_keyword.substring(kmatch[0].length)){if(kmatch=/^\.([a-z_][a-z_\d]*)/i.exec(_keyword))keyword_list.push(kmatch[1]);else if(kmatch=/^\[(\d+)\]/.exec(_keyword))keyword_list.push(kmatch[1]);else throw"sprintf: invalid keyword format "+_keyword}}else arg_names|=2;if(arg_names===3){throw"sprintf: mixing positional and named placeholders is "+"not (yet) supported"}f(function(){sign=false});if(keyword_list.length){f(function(){arg=argv[_cursor];for(var k=0;k<keyword_list.length&&arg!=null;k++)arg=arg[keyword_list[k]]})}else if(positional)f(function(){arg=argv[positional]});else{f(function(){arg=argv[_cursor]});cursor++}if(/[^sO]/.test(conversion))f(function(){return arg=+arg});switch(conversion){case"b":f(function(){arg_s=arg.toString(2)});break;case"c":f(function(){arg_s=String.fromCharCode(arg)});break;case"d":f(function(){arg=sprintf.to_int(arg);arg_s=""+arg});if(thousand_grouping)f(function(){arg_s=sprintf.thousand_grouping(arg_s)});break;case"e":f(function(){arg_s=arg.toExponential(precision?precision:undefined)});break;case"f":if(precision)f(function(){arg_s=arg.toFixed(precision)});else f(function(){arg_s=""+arg});if(thousand_grouping)f(function(){arg_s=sprintf.thousand_grouping(arg_s)});break;case"o":f(function(){arg_s=arg.toString(8)});break;case"O":f(function(){arg_s=JSON.stringify(arg)});break;case"u":f(function(){arg=arg>>>0;arg_s=""+arg});break;case"x":f(function(){arg_s=arg.toString(16)});break;case"X":f(function(){arg_s=arg.toString(16).toUpperCase()});break;case"s":f(function(){arg_s=""+arg});if(precision)f(function(){arg_s=arg_s.substring(0,precision)});break}if(/[def]/.test(conversion)){if(sign)f(function(){if(arg>=0)arg_s="+"+arg_s});f(function(){sign=arg_s[0]=="-"||arg_s[0]=="+"})}var pad_chr=!pad_zero?" ":pad_zero=="0"?"0":pad_zero[1];f(function(){var pad_chrs=pad_chr.repeat(Math.max(+pad_max-arg_s.length,0));var arg_padded=!pad_max?arg_s:pad_min?arg_s+pad_chrs:sign&&pad_chr[0]=="0"?arg_s[0]+pad_chrs+arg_s.slice(1):pad_chrs+arg_s;out+=arg_padded})}else throw"sprintf invalid format "+_fmt})();return function(_argv){argv=_argv;out="";for(var i=0;i<_f.length;i++)_f[i](argv);return out}};E.parse=function(){try{if(new Function("return 1")()==1)return E.parse_fast}catch(e){}return E.parse_slow}();E.vsprintf=function(fmt,argv,opt){if(opt){if(opt.fast)return E.parse_fast(fmt)([fmt].concat(argv));if(opt.slow)return E.parse_slow(fmt)([fmt].concat(argv))}return E.sprintf.apply(null,[fmt].concat(argv))};return E})})();
(function(){var __hola_stub_define;var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node)define=define||self.define;else define=require("./require_node.js").define(module,"../");define("/util/rate_limit.js",[],function(){var E=rate_limit;function rate_limit(rl,ms,n){var now=Date.now();if(!rl.count||rl.ts+ms<now){rl.count=1;rl.ts=now;return true}rl.count++;return rl.count<=n}E.leaky_bucket=function leaky_bucket(size,rate){this.size=size;this.rate=rate;this.time=Date.now();this.level=0};E.leaky_bucket.prototype.inc=function(inc){if(inc===undefined)inc=1;var now=Date.now();this.level-=this.rate*(now-this.time);this.time=now;if(this.level<0)this.level=0;var new_level=this.level+inc;if(new_level>this.size)return false;this.level=new_level;return true};return E})})();
(function(){var __hola_stub_define;var if_node_ff=typeof module=="object"&&module.exports;if(!if_node_ff)define=define||self.define;else define=require("./require_node.js").define(module,"../");define("/util/escape.js",[],function(){var E={};E.un={};var html_escape_table={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};E.html=function(html){return html.replace(/[&<>"']/g,function(m){return html_escape_table[m[0]]})};E.sh=function(s_or_a){function single(s){s=""+s;if(!s)return'""';if(/^[a-z0-9_\-.\/:]+$/i.test(s))return s;return'"'+s.replace(/([\\"`$])/g,"\\$1")+'"'}if(arguments.length==1&&!Array.isArray(s_or_a))return single(s_or_a);var s="",a=Array.isArray(s_or_a)?s_or_a:arguments;for(var i=0;i<a.length;i++)s+=(i?" ":"")+single(a[i]);return s};E.un_sh=function(s,keep_esc){var state={PARSE_STATE_INIT:0,PARSE_STATE_NORMAL_ARG:1,PARSE_STATE_QUOTE_ARG:2},cur_state=state.PARSE_STATE_INIT;var i,quote=0,argv=[],a="";for(i=0;i<s.length;i++){var esc=0;a+=s[i];if(s[i]=="\\"&&s[1]){if(!keep_esc)a=a.slice(0,-1);esc=1;i++;a+=s[i]}switch(cur_state){case state.PARSE_STATE_INIT:switch(s[i]){case"\r":case"\n":case" ":case"	":if(!esc){a="";break}case'"':case"'":if(!esc){cur_state=state.PARSE_STATE_QUOTE_ARG;if(!keep_esc)a=a.slice(0,-1);quote=s[i];break}default:cur_state=state.PARSE_STATE_NORMAL_ARG}break;case state.PARSE_STATE_NORMAL_ARG:switch(s[i]){case"\r":case"\n":case" ":case"	":if(!esc){cur_state=state.PARSE_STATE_INIT;a=a.slice(0,-1);argv.push(a);a=""}break;case'"':case"'":if(!esc){cur_state=state.PARSE_STATE_QUOTE_ARG;quote=s[i];if(!keep_esc)a=a.slice(0,-1)}break}break;case state.PARSE_STATE_QUOTE_ARG:if(s[i]==quote&&!esc){cur_state=state.PARSE_STATE_NORMAL_ARG;if(!keep_esc)a=a.slice(0,-1)}break}}if(cur_state==state.PARSE_STATE_NORMAL_ARG){cur_state=state.PARSE_STATE_INIT;argv.push(a)}if(cur_state!=state.PARSE_STATE_INIT)throw"error parsing shell";return argv};E.regex=function(s){return s.replace(/[[\]{}()*+?.\\^$|\/]/g,"\\$&")};E.uri_comp=function(s){return encodeURIComponent(s).replace(/%20/g,"+")};var http_escape_chars=[];(function(){var i;for(i=0;i<256;i++){var c=String.fromCharCode(i);http_escape_chars[i]=/^[a-zA-Z0-9_.~,\-]$/.test(c)?c:"%"+("0"+i.toString(16)).slice(-2)}})();E.encodeURIComponent_bin=function(s_or_b){var s=Buffer&&s_or_b instanceof Buffer?s_or_b.toString("binary"):""+s_or_b;var esc="";for(var i=0;i<s.length;i++)esc+=http_escape_chars[s.charCodeAt(i)];return esc};E.qs=function(param,opt){opt=opt||{};var qs=opt.qs||"";var sep=qs||opt.amp?"&":"";if(!param)return qs;var uri_comp=opt.space_plus===undefined||opt.space_plus?E.uri_comp:encodeURIComponent;var uri_comp_val=opt.bin?E.encodeURIComponent_bin:uri_comp;for(var i in param){var val=param[i];if(val===undefined)continue;var key=uri_comp(i);qs+=sep;if(val===null)qs+=key;else if(Array.isArray(val)){if(!val.length)continue;qs+=val.map(function(val){return key+"="+uri_comp_val(val)}).join("&")}else qs+=key+"="+uri_comp_val(val);sep="&"}return qs};E.uri=function(uri,qs,hash){var opt;if(typeof uri=="string")opt={uri:uri,_qs:qs,hash:hash};else{opt=Object.assign({},uri);opt._qs=opt.qs;opt.qs=undefined}uri=opt.uri;qs=typeof opt._qs=="string"?opt._qs:E.qs(opt._qs,opt);hash=typeof opt.hash=="string"?opt.hash:E.qs(opt.hash,opt);if(qs){if(!uri.includes("?"))uri+="?";else if(uri[uri.length-1]!="?"&&uri[uri.length-1]!="&")uri+="&"}else qs="";if(hash)hash="#"+hash;else hash="";return uri+qs+hash};E.mailto_url=function(mail){return"mailto:"+(mail.to||"")+"?"+E.qs({cc:mail.cc,bcc:mail.bcc,subject:mail.subject,body:mail.body},{space_plus:false})};E.parse={};E.parse.eat_token=function(s_obj,re){var match;if(!(match=re.exec(s_obj.s)))return match;s_obj.s=s_obj.s.substr(match.index+match[0].length);return match};E.parse.http_words=function(val){var res=[],o={s:val},eat_token=E.parse.eat_token,match;while(o.s){if(match=eat_token(o,/^\s*(=*[^\s=;,]+)/)){var v=match[1];if(match=eat_token(o,/^\s*=\s*\"([^\"\\]*(?:\\.[^\"\\]*)*)\"/))res.push([v,match[1].replace(/\\(.)/,"$1")]);else if(match=eat_token(o,/^\s*=\s*([^;,\s]*)/))res.push([v,match[1].replace(/\s+$/,"")]);else res.push([v,null])}else if(match=eat_token(o,/^\s*,/));else if((match=eat_token(o,/^\s*;/))||(match=eat_token(o,/^\s+/)));else throw new Error("This should not happen: "+o.s)}return res};return E})})();
(function(){var __hola_stub_define,process;var is_node=typeof module=="object"&&module.exports&&module.children;var is_ff_addon=typeof module=="object"&&module.uri&&!module.uri.indexOf("resource://");if(!is_node&&!is_ff_addon){define=define||self.define;process={env:{}}}else{define=require("./require_node.js").define(module,"../");if(is_ff_addon)process={env:{}};else if(is_node){process=global.process||require("_process");require("./config.js");var cluster=require("cluster");var fs=require("fs");var version=require("./version.js").version}}define("/util/zerr.js",["/util/array.js","/util/date.js","/util/util.js","/util/sprintf.js","/util/rate_limit.js","/util/escape.js"],function(array,date,zutil,sprintf,rate_limit,zescape){var E,_zerr;var env=process.env;var zerr=function(msg){_zerr(L.ERR,arguments)};E=zerr;E.zerr=zerr;var L=E.L={EMERG:0,ALERT:1,CRIT:2,ERR:3,WARN:4,NOTICE:5,INFO:6,DEBUG:7};var perr_pending=[];var LINV=E.LINV={};for(var k in L)LINV[L[k]]=k;["debug","info","notice","warn","err","crit"].forEach(function(l){var level=L[l.toUpperCase()];E[l]=function(){return _zerr(level,arguments)}});E.assert=function(exp,msg){if(!exp)zerr.crit(msg)};E.json=function(o,replacer,space){try{return JSON.stringify(o,replacer,space)||""}catch(err){return"[circular]"}};E.is=function(level){return level<=E.level};["debug","info","notice","warn","err"].forEach(function(l){var level=L[l.toUpperCase()];E.is[l]=function(){return level<=E.level}});E.log_tail=function(size){return E.log.join("\n").substr(-(size||4096))};E.perr=function(id,info,opt){E._zerr(!opt||opt.level===undefined?L.ERR:opt.level,["perr "+id+" "+E.json(info)]);if(perr_pending&&perr_pending.length<100)perr_pending.push(Array.from(arguments))};var perr_dropped={};var perr_orig=E.perr;function wrap_perr(perr_fn){var send=perr_fn,pre_send;if(typeof perr_fn!="function"){send=perr_fn.send;pre_send=perr_fn.pre_send}return function(id,info,opt){opt=opt||{};var ms=opt.rate_limit&&opt.rate_limit.ms||date.ms.HOUR;var count=opt.rate_limit&&opt.rate_limit.count||10;var rl_hash=perr_orig.rl_hash=perr_orig.rl_hash||{};var rl=rl_hash[id]=rl_hash[id]||{};if(pre_send)pre_send(id,info,opt);if(opt.rate_limit===false||rate_limit(rl,ms,count)){if(perr_dropped[id]){if(info&&typeof info!="string")info.w=perr_dropped[id];perr_dropped[id]=null}return send(id,info,opt)}perr_dropped[id]=(perr_dropped[id]||0)+1;if(info&&typeof info!="string")info=zerr.json(info);zerr("perr %s %s rate too high %s %d %d",id,info,zerr.json(rl),ms,count)}}E.perr_install=function(install_fn){E.perr=wrap_perr(install_fn(perr_orig,perr_pending||[]));perr_pending=null};function err_has_stack(err){return err instanceof Error&&err.stack}E.e2s=function(err){if(!is_node&&err_has_stack(err)){var e_str=""+err,e_stack=""+err.stack;return e_stack.startsWith(e_str)?e_stack:e_str+" "+e_stack}return err_has_stack(err)?""+err.stack:""+err};E.on_exception=undefined;var in_exception;E.set_exception_handler=function(prefix,err_func){E.on_exception=function(err){if(!(err instanceof TypeError||err instanceof ReferenceError)||err.sent_perr){return}if(in_exception)return;in_exception=1;err.sent_perr=true;err_func((prefix?prefix+"_":"")+"etask_typeerror",null,err);in_exception=0}};E.on_unhandled_exception=undefined;E.catch_unhandled_exception=function(func,obj){return function(){var args=arguments;try{return func.apply(obj,Array.from(args))}catch(e){E.on_unhandled_exception(e)}}};if(is_node){E.ZEXIT_LOG_DIR="/tmp/zexit_logs";E.prefix="";E.level=L.NOTICE;E.set_level=function(level){var prev="L"+LINV[E.level];level=level||env.ZERR;if(!level)return prev;var val=L[level]||L[level.replace(/^L/,"")];if(val!==undefined)E.level=val;return prev};E.flush=function(){};E.set_log_buffer=function(on){if(!on){if(E.log_buffer){E.flush();E.log_buffer(0)}return}E.log_buffer=require("log-buffer");E.log_buffer(32*1024);E.flush=function(){E.log_buffer.flush()};setInterval(E.flush,1e3).unref()};var node_init=function(){if(zutil.is_mocha())E.level=L.WARN;else E.prefix=!cluster.isMaster?"C"+cluster.worker.id+" ":""};var init=function(){if(is_node)node_init();E.set_level()};init();var zerr_format=function(args){return args.length<=1?args[0]:sprintf.apply(null,args)};var __zerr=function(level,args){var msg=zerr_format(args);var k=Object.keys(L);var prefix=E.hide_timestamp?"":E.prefix+date.to_sql_ms()+" ";console.error(prefix+k[level]+": "+msg)};E.set_logger=function(logger){__zerr=function(level,args){var msg=zerr_format(args);logger(level,msg)}};_zerr=function(level,args){if(level>E.level)return;__zerr(level,args)};E._zerr=_zerr;E.zexit=function(args){var stack;if(err_has_stack(args)){stack=args.stack;__zerr(L.CRIT,[E.e2s(args)])}else{var e=new Error;stack=e.stack;__zerr(L.CRIT,arguments);console.error(stack)}E.flush();if(zutil.is_mocha()){debugger;process.exit(1)}var zcounter_file=require("./zcounter_file.js");zcounter_file.inc("server_zexit");args=zerr_format(arguments);write_zexit_log({id:"server_zexit",info:""+args,ts:date.to_sql(),backtrace:stack,version:version});E.flush();debugger;process.exit(1)};var write_zexit_log=function(json){try{var file=require("./file.js");file.write_e(E.ZEXIT_LOG_DIR+"/"+date.to_log_file()+"_zexit_"+process.pid+".log",E.json(json),{mkdirp:1})}catch(e){E.zerr(E.e2s(e))}}}else{var chrome=self.chrome;E.conf=self.conf;E.log=[];var L_STR=E.L_STR=["EMERGENCY","ALERT","CRITICAL","ERROR","WARNING","NOTICE","INFO","DEBUG"];E.level=self.is_tpopup?L.CRITICAL:E.conf&&E.conf.zerr_level?L[self.conf.zerr_level]:L.WARN;E.log.max_size=200;var console_method=function(l){return l<=L.ERR?"error":!chrome?"log":l===L.WARN?"warn":l<=L.INFO?"info":"debug"};_zerr=function(l,args){var s;try{var fmt=""+args[0];var fmt_args=Array.prototype.slice.call(args,1);s=(fmt+(fmt_args.length?" "+E.json(fmt_args):"")).substr(0,1024);var prefix=date.to_sql_ms()+" "+L_STR[l]+": ";E.log.push(prefix+s);if(E.is(l)){Function.prototype.apply.bind(console[console_method(l)],console)([prefix+fmt].concat(fmt_args))}if(E.log.length>E.log.max_size)E.log.splice(0,E.log.length-E.log.max_size/2)}catch(err){try{console.error("ERROR in zerr "+(err.stack||err),arguments)}catch(e){}}if(l<=L.CRIT)throw new Error(s)};E._zerr=_zerr;var post=function(url,data){var use_xdr=typeof XDomainRequest=="function"&&!("withCredentials"in XMLHttpRequest.prototype);var req=use_xdr?new XDomainRequest:new XMLHttpRequest;req.open("POST",url);if(req.setRequestHeader){req.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")}req.send(zescape.qs(data))};var perr_transport=function(id,info,opt){opt=zutil.clone(opt||{});var qs=opt.qs||{},data=opt.data||{};data.is_json=1;if(info&&typeof info!="string")info=zerr.json(info);if(opt.err&&!info)info=""+(opt.err.message||zerr.json(opt.err));data.info=info;qs.id=id;if(!opt.no_zerr){zerr._zerr(opt.level,["perr "+id+(info?" info: "+info:"")+(opt.bt?"\n"+opt.bt:"")])}return post(zescape.uri(E.conf.url_perr+"/perr",qs),data)};var perr=function(perr_orig,pending){while(pending.length)perr_transport.apply(null,pending.shift());return perr_transport};E.perr_install(perr)}return E})})();
(function(){var __hola_stub_define;var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node)define=define||self.define;else define=require("./require_node.js").define(module,"../");define("/util/ajax_lite.js",["/util/etask.js","/util/date.js","/util/zerr.js","/util/escape.js","events"],function(etask,date,zerr,zescape,events){var E=ajax;var assign=Object.assign;E.json=function(opt){return ajax(assign({},opt,{data_type:"json"}))};E.events=new events.EventEmitter;E.t={};E.t.get_origin=get_origin;E.t.get_url_origin=get_url_origin;E.t.is_current_origin=is_current_origin;var raw_default_opt={method:"GET",url:null,headers:null,data_type:"text",data:null,qs:null,timeout:20*date.ms.SEC,with_credentials:false,return_headers:false};var ajax_default_opt={slow:2*date.ms.SEC,perr:null};var type_helpers={text:{setup:function(xhr){if(xhr instanceof XMLHttpRequest){xhr.setRequestHeader("Accept","text/*");xhr.responseType="text"}},extract:function(xhr){return xhr.responseText}},json:{setup:function(xhr){if(xhr instanceof XMLHttpRequest){xhr.setRequestHeader("Accept","application/json");xhr.responseType="text"}},extract:function(xhr){return JSON.parse(xhr.responseText)}}};function get_origin(location){if(location.origin)return location.origin;var default_ports={"http:":80,"https:":443};var port=location.port;if(default_ports[location.protocol]==port)port=null;return location.protocol+"//"+location.hostname+(port?":"+port:"")}var probe_link;function get_url_origin(url){probe_link=probe_link||document.createElement("a");probe_link.href=url;probe_link.href=probe_link.href;return get_origin(probe_link)}function is_current_origin(url){return is_node?false:window.location.origin==get_url_origin(url)}var can_use_xdr=typeof XDomainRequest=="function"&&!("withCredentials"in XMLHttpRequest.prototype);E.raw=function(opt){return etask([function(){opt=assign({},raw_default_opt,opt);var type_helper=type_helpers[opt.data_type];if(!type_helper){throw{status:null,status_text:"Unknown data_type "+opt.data_type,response_text:null}}var req=can_use_xdr&&!is_current_origin(opt.url)?new XDomainRequest:new XMLHttpRequest;var url=zescape.uri(opt.url,opt.qs);var wait=this.wait();if(opt.timeout){this.alarm(opt.timeout,function(){req.abort();wait.throw({status:null,status_text:"timeout",response_text:null})})}req.open(opt.method,url);type_helper.setup(req);if(opt.headers&&req.setRequestHeader){for(var header in opt.headers)req.setRequestHeader(header,opt.headers[header])}if(opt.with_credentials&&"withCredentials"in req)req.withCredentials=true;req.onload=function(){var status=req.status||200;if(status==1223)status=204;if(status>=200&&status<300){var res=type_helper.extract(req);if(opt.return_headers){return wait.continue({res:res,headers:req.getAllResponseHeaders?req.getAllResponseHeaders():""})}return wait.continue(res)}return wait.throw({status:status,status_text:req.statusText,response_text:req.responseText})};req.onerror=function(){wait.throw({status:req.status,status_text:req.statusText,response_text:req.responseText})};this.finally(function(){req.onload=req.onerror=null});var data=opt.data;if(data!=null){switch(typeof data){case"object":data=zescape.qs(data);break;case"string":data=zescape.uri_comp(data);break;default:data=data+""}if(req.setRequestHeader){req.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")}}req.send(data);return wait}])};function ajax(opt){opt=assign({},raw_default_opt,ajax_default_opt,opt);var t0=Date.now();var url=zescape.uri(opt.url,opt.qs);zerr.debug("ajax("+opt.data_type+") url "+url);return etask([function(){return E.raw(opt)},function catch$(err){zerr.err("ajax("+opt.data_type+") failed url "+url+" data "+zerr.json(opt.data).substr(0,200)+" status: "+err.status+" "+err.status_text+"\nresponseText: "+(err.response_text||"").substr(0,200));if(err.status_text=="timeout")E.events.emit("timeout",this);throw err},function(response){var t=Date.now()-t0,slow=t>opt.slow;zerr[slow?"err":"debug"]("ajax("+opt.data_type+") "+(slow?"SLOW ":"ok ")+t+"ms url "+url);if(slow&&opt.perr)opt.perr({id:"be_ajax_slow",info:t+"ms "+url});return response}])}return E})})();
!function(e){if("function"==typeof define&&define.amd)define("cookie",e);else if("object"==typeof exports)module.exports=e();else{var n=window.Cookies,t=window.Cookies=e();t.noConflict=function(){return window.Cookies=n,t}}}(function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var o in t)n[o]=t[o]}return n}function n(t){function o(n,r,i){var c;if("undefined"!=typeof document){if(arguments.length>1){if(i=e({path:"/"},o.defaults,i),"number"==typeof i.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*i.expires),i.expires=s}try{c=JSON.stringify(r),/^[\{\[]/.test(c)&&(r=c)}catch(a){}return r=t.write?t.write(r,n):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)),n=n.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),n=n.replace(/[\(\)]/g,escape),document.cookie=[n,"=",r,i.expires&&"; expires="+i.expires.toUTCString(),i.path&&"; path="+i.path,i.domain&&"; domain="+i.domain,i.secure?"; secure":""].join("")}n||(c={});for(var p=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,d=0;d<p.length;d++){var f=p[d].split("="),l=f[0].replace(u,decodeURIComponent),m=f.slice(1).join("=");'"'===m.charAt(0)&&(m=m.slice(1,-1));try{if(m=t.read?t.read(m,l):t(m,l)||m.replace(u,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(a){}if(n===l){c=m;break}n||(c[l]=m)}catch(a){}}return c}}return o.set=o,o.get=function(e){return o(e)},o.getJSON=function(){return o.apply({json:!0},[].slice.call(arguments))},o.defaults={},o.remove=function(n,t){o(n,"",e(t,{expires:-1}))},o.withConverter=n,o}return n(function(){})});
define("/util/storage.js",["cookie"],function(cookie){var E={};var storage;function have_local_storage(){try{var _=localStorage;return true}catch(e){}}function select_local_storage(){storage=localStorage}function select_cookies(domain){var cookie_opt={domain:"."+domain,path:"/",expires:30};storage={getItem:cookie.get,setItem:function(key,val){cookie.set(key,val,cookie_opt)},removeItem:function(key){cookie.remove(key,cookie_opt)}}}E.init=function(domain){if(have_local_storage())return select_local_storage();console.error("cannot use localStorage, using cookies instead");select_cookies(domain||"hola.org")};E.init();E.on_err=function(){};E.set=function(key,val){try{storage.setItem(key,val)}catch(err){E.on_err("storage_set",key,err)}};E.get=function(key){try{return storage.getItem(key)}catch(err){E.on_err("storage_get",key,err)}};E.get_int=function(key){return+E.get(key)||0};E.clr=function(key){try{storage.removeItem(key)}catch(err){E.on_err("storage_clr",key,err)}};E.set_json=function(key,val){try{return E.set(key,JSON.stringify(val||null))}catch(err){E.on_err("storage_set_json",key,err)}};E.get_json=function(key){var val=E.get(key);if(!val)return val;try{val=JSON.parse(val)}catch(err){console.log("err "+err)}return val};return E});
(function(){var __hola_stub_define;var is_node_ff=typeof module=="object"&&module.exports;if(!is_node_ff)define=define||self.define;else define=function(setup){module.exports=setup()};define("/util/user_agent.js",[],function(){var E={};var win_versions={"10.0":"10.0",6.3:"8.1",6.2:"8",6.1:"7","6.0":"vista",5.2:"2003",5.1:"xp","5.0":"2000"};var arch_mapping={x86_64:"64",i686:"32",arm:"arm"};var check_hola=/\bhola_android\b/i;var check_android_cdn=/Android.* CDNService\/([0-9\.]+)$/;var check_ios_cdn=/ CDNService\/([0-9\.]+)$/;var check_opera=/\bOPR\b\/(\d+)/i;var check_edge=/\bEdge\b\/(\d+)/i;var check_xbox=/\bxbox\b/i;var check_ucbrowser=/\bUCBrowser\b\/(\d+)/i;var check_webview=/ Version\/(\d+)(\.\d)/;var is_browser=!is_node_ff&&typeof window!="undefined";function ios_ua(ua,safari_ver){var res;if(res=/(?:iPhone|iPad|iPod|iPod touch);.*?OS ([\d._]+)/.exec(ua)){var ios_ver=res[1];return{browser:"safari",version:safari_ver||ios_ver,ios:ios_ver,hola_ios:is_browser&&window.hola_cdn_sdk||check_ios_cdn.test(ua)}}if(/HolaCDN iOS/.exec(ua))return{browser:"safari",hola_ios:true}}function check_chromium(ua){if(check_webview.test(ua)||/Android/.test(ua)||/ Mobile /.test(ua)||check_opera.test(ua)){return false}var group="(?: (\\w*)\\/)?",ver="\\/[\\d\\.]+";var res=new RegExp("AppleWebKit"+ver+"(?: \\(.*\\))?"+group+".* Chrome"+ver+group+".* Safari"+ver+group).exec(ua);return res&&(res[1]||res[2]||res[3])}E.guess_browser=function(ua){var res;ua=ua||(is_browser?window.navigator&&navigator.userAgent:"");if(res=/\bOpera Mini\/(\d+)/.exec(ua))return{browser:"opera_mini",version:res[1]};var ucbrowser=check_ucbrowser.exec(ua);if(res=/[( ]MSIE ([6789]|10).\d[);]/.exec(ua))return{browser:"ie",version:res[1],xbox:check_xbox.test(ua)};if(res=/[( ]Trident\/\d+(\.\d)+.*rv:(\d\d)(\.\d)+[);]/.exec(ua))return{browser:"ie",version:res[2],xbox:check_xbox.test(ua)};if(res=/ Chrome\/(\d+)(\.\d+)+.* Safari\/\d+(\.\d+)+/.exec(ua)){var opera=check_opera.exec(ua);var edge;if(edge=check_edge.exec(ua))return{browser:"ie",version:edge[1]};return{browser:"chrome",version:res[1],android:ua.match(/Android/),webview:ua.match(check_webview),hola_android:check_hola.test(ua),hola_app:check_android_cdn.test(ua),chromium_based:check_chromium(ua),opera:opera&&!!opera[1],opera_version:opera?opera[1]:undefined,ucbrowser:ucbrowser&&!!ucbrowser[1],ucbrowser_version:ucbrowser?ucbrowser[1]:undefined,webos_app:/Web0S/.test(ua)}}if(res=/ QupZilla\/(\d+\.\d+\.\d+).* Safari\/\d+.\d+/.exec(ua))return{browser:"qupzilla",version:res[1]};if(res=/\(PlayStation (\d+) (\d+\.\d+)\).* AppleWebKit\/\d+.\d+/.exec(ua)){return{browser:"playstation"+res[1],version:res[2]}}if(res=/ Version\/(\d+)(\.\d)+.* Safari\/\d+.\d+/.exec(ua)){if(!ua.match(/Android/))return ios_ua(ua,res[1])||{browser:"safari",version:res[1]};return{browser:"chrome",version:res[1],android:true,webview:true,hola_android:check_hola.test(ua),hola_app:check_android_cdn.test(ua),ucbrowser:ucbrowser&&!!ucbrowser[1],ucbrowser_version:ucbrowser?ucbrowser[1]:undefined}}if(res=/ (Firefox|PaleMoon)\/(\d+).\d/.exec(ua)){return{browser:"firefox",version:res[2],palemoon:res[1]=="PaleMoon"}}if(/Hola\/\d+\.\d+.*?(?:iPhone|iPad|iPod)/.exec(ua))return{browser:"safari",version:"Hola"};if(res=ios_ua(ua))return res;return{}};E.browser_to_string=function(browser){if(typeof browser!="object"||!browser.browser)return"unknown";var s=browser.browser;if(browser.version)s+=" "+browser.version;if(browser.xbox)s+=" xbox";if(browser.android)s+=" android";if(browser.webview)s+=" webview";if(browser.chromium_based)s+=" chromium_based";if(browser.opera){s+=" opera";if(browser.opera_version)s+="-"+browser.opera_version}if(browser.hola_android)s+=" hola_android";if(browser.hola_app)s+=" hola_app";if(browser.ucbrowser){s+=" ucbrowser";if(browser.ucbrowser_version)s+="-"+browser.ucbrowser_version}if(browser.palemoon)s+=" palemoon";if(browser.ios)s+=" ios";if(browser.webos_app)s+=" webos_app";return s?s:"unknown"};E.guess=function(ua,platform){var res;ua=ua||(is_browser?navigator.userAgent:"");platform=platform||(is_browser?navigator.platform:"");if(check_xbox.exec(ua))return{os:"xbox",mobile:false};if(res=/Windows(?: NT(?: (.*?))?)?[);]/.exec(ua)){return{os:"windows",version:win_versions[res[1]],release_version:res[1],arch:ua.match(/WOW64|Win64|x64/)?"64":"32",mobile:false}}if(res=/Macintosh.*; (?:Intel|PPC) Mac OS X (\d+[._]\d+)/.exec(ua))return{os:"macos",version:res[1].replace("_","."),mobile:false};if(/Macintosh/.exec(ua))return{os:"macos",mobile:false};if(/Web0S.*SmartTV/.exec(ua)){return{os:"webos",version:/Chrome/.test(ua)?"3":"2",mobile:false,tv:true}}if(res=/Android(?: (\d+\.\d+))?/.exec(ua))return{os:"android",version:res[1],mobile:true};if(res=/(Linux|CrOS|OpenBSD|FreeBSD)(?: (x86_64|i686|arm))?/.exec(ua)){if(check_opera.test(ua)&&res[1]=="Linux"&&res[2]=="x86_64"&&/^Linux arm/.test(platform)){return{os:"android",mobile:true}}return{os:res[1].toLowerCase(),arch:arch_mapping[res[2]],nix:true,mobile:false}}if(res=/(?:iPhone|iPad|iPod|iPod touch);.*?OS (\d+[._]\d+)/.exec(ua))return{os:"ios",version:res[1].replace("_","."),mobile:true};if(/iPhone|iPad|iPod|HolaCDN iOS/.exec(ua))return{os:"ios",mobile:true};if(/PLAYSTATION/.exec(ua))return{os:"ps",mobile:false};if(/Windows Phone/.exec(ua))return{os:"winphone",mobile:true};if(/HitLeap Viewer/.exec(ua))return{os:"windows",mobile:false};return{}};E.guess_device=function(ua){var res;ua=ua||(is_browser?navigator.userAgent:"");if(res=/(iPhone|iPad|iPod)/.exec(ua))return{device:res[1].toLowerCase()};return{}};E.support_fullscreen=function(){return!!(is_browser&&(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled))};return E})})();
(function(){var __hola_stub_define,is_node=typeof module=="object"&&module.exports;if(!is_node)define=define||self.define;else define=require("../../../util/require_node.js").define(module,"../");define("/svc/cdn/pub/log.js",["/util/storage.js","/util/date.js","/util/array.js","/util/util.js","/util/zerr.js","/util/etask.js","/util/sprintf.js"],function(storage,date,array,zutil,zerr,etask,sprintf){var E=log_cdn;var assign=Object.assign;E.type="cdn";zerr.set_exception_handler("cdn",function(id,info,err){E.err("exception "+id+" "+(err.stack||err));E.perr({id:id,info:""+err,bt:err.stack})});etask.set_zerr(zerr);function log_cdn(){var s;try{var args=[].slice.call(arguments);var opt={};if(typeof args[args.length-1]=="object")opt=args.pop();s=args.length>1?sprintf.apply(null,args):args[0];log(E.type,s,opt);if(opt.perr_id&&E.perr)E.perr({id:opt.perr_id,info:s})}catch(err){console.error("error in log_cdn",E.type,s,err);if(E.perr)E.perr({id:"log_cdn_err",info:s,bt:err.stack})}}function extend_opt(def_opt){if(def_opt.muted)return;var args=[].slice.call(arguments,1);var opt={};if(typeof args[args.length-1]=="object")opt=assign({},args.pop());log_cdn.apply(this,args.concat(assign(opt,def_opt)))}var log_levels={crit:1,err:2,warn:3,notice:4,info:5,debug:6};function log_level_handler(opt,level){var level_opt=level=="console"?{console_log:true,level:"info"}:{level:level};return extend_opt.bind(E,assign({},opt,level_opt))}function log_create(opt){opt=opt||{logs:[]};return{crit:log_level_handler(opt,"crit"),err:log_level_handler(opt,"err"),warn:log_level_handler(opt,"warn"),notice:log_level_handler(opt,"notice"),info:log_level_handler(opt,"info"),debug:log_level_handler(opt,"debug"),console:log_level_handler(opt,"console"),set_module:function(module){return log_create(assign({},opt,{module:module}))},reset_module:function(){return this.set_module(null)},mute:function(){return log_create(assign({},opt,{muted:true}))},unmute:function(){return log_create(assign({},opt,{muted:false}))},get_logs:function(){return opt.logs},reset_logs:function(){opt.logs.splice(0,opt.logs.length)},logs_to_str:function(logs,full_log){return logs_to_str(logs||opt.logs,full_log)},concat:function(logs,need_sort){return logs_concat(opt.logs,logs,need_sort)},fork:function(id){return log_create(assign({},opt,{id:id,logs:opt.logs.slice()}))},stash:function(){var stash=opt.logs.slice();return function(){zutil.clone_inplace(opt.logs,stash)}}}}assign(E,log_create());E.settings_def=function(){return{log_level:"notice",max_size:2048,max_full_history_size:8192}};E.settings=E.settings_def();E.init=function(opt){E.settings=assign({},E.settings_def(),storage.get_json("hola_log_settings"),zutil.clone_deep(opt))};E.set=function(o,no_storage){if(!no_storage)storage.set_json("hola_log_settings",o);E.settings=assign({},E.settings_def(),zutil.clone_deep(o))};E.log_is=function(level){return log_levels[E.settings.log_level]>=log_levels[level]};E.full_history=[];function pad(num,size){return E.zmocha_pad||("000"+num).slice(-size)}function log(type,s,opt){opt=opt||{};var logs=opt.logs||E.get_logs();var msg=type+(opt.module?"/"+opt.module:"")+": "+s;var slevel=opt.level||"debug";var level=log_levels[slevel];var set_level=log_levels[E.settings.log_level||"notice"];var print=false;if(opt.console_log)print=true;else if(level<=set_level){var mods=E.settings.log_modules;if(!opt.module||!mods)print=true;else if(mods&&(mods.includes(opt.module)||mods.includes("*")))print=true}var d=zutil.is_mocha()?E.zmocha_date||new Date:new Date;var _msg=date.to_sql_ms(d)+" ["+(opt.id||0)+"] "+msg;if(print){var l=E.level_to_console(slevel);if(zutil.is_mocha()&&E.zmocha_test_log){E.zmocha_console=E.zmocha_console||[];E.zmocha_console.push(l+" "+_msg)}else console[l](_msg)}E.full_history.push(_msg);if(level<=Math.max(log_levels.info,set_level))logs.push(date.to_log_ms(d)+pad(logs.length,3)+" "+msg);var max_full=E.settings.max_full_history_size||8192;var max_size=E.settings.max_size||2048;if(!E.debug_mode&&E.full_history.length>max_full)E.full_history.splice(0,max_full/2);if(!E.debug_mode&&logs.length>max_size)logs.splice(0,max_size/2)}E.level_to_console=function(level){switch(level){case"crit":return"error";case"err":return"error";case"warn":return"warn";case"notice":return"log";case"info":return"info";case"debug":return zutil.is_mocha()?"info":"debug";default:console.error("invalid level",level);return"error"}};function logs_to_str(logs,full_log){if(!logs)return"no logs";var size=E.settings.max_size/2;if(!full_log&&logs.length>size)logs=logs.slice(-size);return array.to_nl(logs)||"empty logs"}function logs_concat(logs,logs2,need_sort){var combined_logs=(logs||[]).concat(logs2||[]);if(need_sort)combined_logs.sort();return combined_logs}E.set_perr=function(perr_func){E.perr=perr_func};return E})})();
(function(){var __hola_stub_define;var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node)define=define||self.define;else define=require("./require_node.js").define(module,"../");define("/util/rand.js",["/util/array.js"],function(array){var E={};var is_jtest=false;var jtest_vals={};var MAX_INT=2147483647;var MIN_INT=-MAX_INT-1;function jtest_pop(s){var elm;if(s===undefined)return null;if((elm=jtest_vals[s])===undefined)return null;return elm.shift()}E.rand=function(s){var ret;if(is_jtest&&(ret=jtest_pop(s))!==null)return ret;return Math.random()};E.rand_int=function(s){var ret;if(is_jtest&&(ret=jtest_pop(s))!==null)return ret;return Math.floor(Math.random()*(MAX_INT-MIN_INT+1))-MAX_INT};E.rand_range=function(from,to,s){var ret;if(is_jtest&&(ret=jtest_pop(s))!==null)return ret;return Math.floor(Math.random()*(to-from))+from};E.jtest_push=function(s,arr){if(!jtest_vals[s])jtest_vals[s]=[];if(Array.isArray(arr))array.push(jtest_vals[s],arr);else jtest_vals[s].push(arr)};E.jtest_init=function(){is_jtest=true;jtest_vals={}};E.jtest_uninit=function(){is_jtest=false};E.basic_u32=function(v){return 1103515245*v+12345>>>0};E.basic_u31=function(v){return 1103515245*v+12345&2147483647};return E})})();
!function(n){function t(n,t){var r=(65535&n)+(65535&t),e=(n>>16)+(t>>16)+(r>>16);return e<<16|65535&r}function r(n,t){return n<<t|n>>>32-t}function e(n,e,o,u,c,f){return t(r(t(t(e,n),t(u,f)),c),o)}function o(n,t,r,o,u,c,f){return e(t&r|~t&o,n,t,u,c,f)}function u(n,t,r,o,u,c,f){return e(t&o|r&~o,n,t,u,c,f)}function c(n,t,r,o,u,c,f){return e(t^r^o,n,t,u,c,f)}function f(n,t,r,o,u,c,f){return e(r^(t|~o),n,t,u,c,f)}function i(n,r){n[r>>5]|=128<<r%32,n[(r+64>>>9<<4)+14]=r;var e,i,a,h,d,l=1732584193,g=-271733879,v=-1732584194,m=271733878;for(e=0;e<n.length;e+=16)i=l,a=g,h=v,d=m,l=o(l,g,v,m,n[e],7,-680876936),m=o(m,l,g,v,n[e+1],12,-389564586),v=o(v,m,l,g,n[e+2],17,606105819),g=o(g,v,m,l,n[e+3],22,-1044525330),l=o(l,g,v,m,n[e+4],7,-176418897),m=o(m,l,g,v,n[e+5],12,1200080426),v=o(v,m,l,g,n[e+6],17,-1473231341),g=o(g,v,m,l,n[e+7],22,-45705983),l=o(l,g,v,m,n[e+8],7,1770035416),m=o(m,l,g,v,n[e+9],12,-1958414417),v=o(v,m,l,g,n[e+10],17,-42063),g=o(g,v,m,l,n[e+11],22,-1990404162),l=o(l,g,v,m,n[e+12],7,1804603682),m=o(m,l,g,v,n[e+13],12,-40341101),v=o(v,m,l,g,n[e+14],17,-1502002290),g=o(g,v,m,l,n[e+15],22,1236535329),l=u(l,g,v,m,n[e+1],5,-165796510),m=u(m,l,g,v,n[e+6],9,-1069501632),v=u(v,m,l,g,n[e+11],14,643717713),g=u(g,v,m,l,n[e],20,-373897302),l=u(l,g,v,m,n[e+5],5,-701558691),m=u(m,l,g,v,n[e+10],9,38016083),v=u(v,m,l,g,n[e+15],14,-660478335),g=u(g,v,m,l,n[e+4],20,-405537848),l=u(l,g,v,m,n[e+9],5,568446438),m=u(m,l,g,v,n[e+14],9,-1019803690),v=u(v,m,l,g,n[e+3],14,-187363961),g=u(g,v,m,l,n[e+8],20,1163531501),l=u(l,g,v,m,n[e+13],5,-1444681467),m=u(m,l,g,v,n[e+2],9,-51403784),v=u(v,m,l,g,n[e+7],14,1735328473),g=u(g,v,m,l,n[e+12],20,-1926607734),l=c(l,g,v,m,n[e+5],4,-378558),m=c(m,l,g,v,n[e+8],11,-2022574463),v=c(v,m,l,g,n[e+11],16,1839030562),g=c(g,v,m,l,n[e+14],23,-35309556),l=c(l,g,v,m,n[e+1],4,-1530992060),m=c(m,l,g,v,n[e+4],11,1272893353),v=c(v,m,l,g,n[e+7],16,-155497632),g=c(g,v,m,l,n[e+10],23,-1094730640),l=c(l,g,v,m,n[e+13],4,681279174),m=c(m,l,g,v,n[e],11,-358537222),v=c(v,m,l,g,n[e+3],16,-722521979),g=c(g,v,m,l,n[e+6],23,76029189),l=c(l,g,v,m,n[e+9],4,-640364487),m=c(m,l,g,v,n[e+12],11,-421815835),v=c(v,m,l,g,n[e+15],16,530742520),g=c(g,v,m,l,n[e+2],23,-995338651),l=f(l,g,v,m,n[e],6,-198630844),m=f(m,l,g,v,n[e+7],10,1126891415),v=f(v,m,l,g,n[e+14],15,-1416354905),g=f(g,v,m,l,n[e+5],21,-57434055),l=f(l,g,v,m,n[e+12],6,1700485571),m=f(m,l,g,v,n[e+3],10,-1894986606),v=f(v,m,l,g,n[e+10],15,-1051523),g=f(g,v,m,l,n[e+1],21,-2054922799),l=f(l,g,v,m,n[e+8],6,1873313359),m=f(m,l,g,v,n[e+15],10,-30611744),v=f(v,m,l,g,n[e+6],15,-1560198380),g=f(g,v,m,l,n[e+13],21,1309151649),l=f(l,g,v,m,n[e+4],6,-145523070),m=f(m,l,g,v,n[e+11],10,-1120210379),v=f(v,m,l,g,n[e+2],15,718787259),g=f(g,v,m,l,n[e+9],21,-343485551),l=t(l,i),g=t(g,a),v=t(v,h),m=t(m,d);return[l,g,v,m]}function a(n){var t,r="";for(t=0;t<32*n.length;t+=8)r+=String.fromCharCode(n[t>>5]>>>t%32&255);return r}function h(n){var t,r=[];for(r[(n.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;for(t=0;t<8*n.length;t+=8)r[t>>5]|=(255&n.charCodeAt(t/8))<<t%32;return r}function d(n){return a(i(h(n),8*n.length))}function l(n,t){var r,e,o=h(n),u=[],c=[];for(u[15]=c[15]=void 0,o.length>16&&(o=i(o,8*n.length)),r=0;16>r;r+=1)u[r]=909522486^o[r],c[r]=1549556828^o[r];return e=i(u.concat(h(t)),512+8*t.length),a(i(c.concat(e),640))}function g(n){var t,r,e="0123456789abcdef",o="";for(r=0;r<n.length;r+=1)t=n.charCodeAt(r),o+=e.charAt(t>>>4&15)+e.charAt(15&t);return o}function v(n){return unescape(encodeURIComponent(n))}function m(n){return d(v(n))}function p(n){return g(m(n))}function s(n,t){return l(v(n),v(t))}function C(n,t){return g(s(n,t))}function A(n,t,r){return t?r?s(t,n):C(t,n):r?m(n):p(n)}"function"==typeof define&&define.amd?define("md5",[],function(){return A}):"object"==typeof module&&module.exports?module.exports=A:n.md5=A}(this);
(function(){var __hola_stub_define,is_node=typeof module=="object"&&module.exports;if(!is_node)define=define||self.define;else{var define_node=require("../../../util/require_node.js").define(module,"../");define=function(name,deps,fn){return define_node(name,["/util/url.js"],fn)}}define("/svc/cdn/pub/util.js",["/util/url.js","/util/ajax_lite.js","/util/storage.js","/util/escape.js","/util/zerr.js","/util/user_agent.js","/util/etask.js","/util/date.js","/util/array.js","/util/util.js","/svc/cdn/pub/log.js","/util/events.js","/util/rand.js","md5","/util/rate_limit.js"],function(zurl,ajax,storage,zescape,zerr,user_agent,etask,date,array,zutil,_log,events,rand,md5,rate_limit){var def_perr_url="//perr.h-cdn.com/be_client_cgi/perr";var E={conf:{}};var assign=Object.assign;var log;if(is_node){}else{E.geoip=zutil.clone(storage.get_json("hola_geoip")||{});E.perr_url=def_perr_url;E.jtest={};E.uri_opts_list=["tech"];E.session_id="session_id_"+rand.rand("cdn_session_id");var protocol=typeof window!="undefined"&&window.location&&window.location.protocol;E.protocol=!protocol||!protocol.startsWith("http")?"http:":protocol;log=_log.set_module("util");E.ERR={failed:-1,ranges_unsupported:-2,aborted:-3,head_unsupported:-4,disconnected:-5,unicode_bom:-6};E.ERR_str={"-1":"failed","-2":"ranges_unsupported","-3":"aborted","-4":"head_unsupported","-5":"disconnected","-6":"unicode_bom"};E.BEFOREUNLOAD=typeof navigator!="undefined"&&navigator.userAgent.match(/iPad|iPhone|iPod/)?"pagehide":"beforeunload";E.browser_init=function(ua,platform){var browser=E.browser=user_agent.guess_browser(ua);var guess=E.guess=user_agent.guess(ua,platform);E.is_chrome=browser.browser=="chrome"&&!browser.opera;E.is_firefox=browser.browser=="firefox";E.is_ie=browser.browser=="ie";E.is_opera=browser.opera;E.is_safari=browser.browser=="safari";E.is_windows=guess.os=="windows";E.is_android=guess.os=="android";E.is_winphone=guess.os=="winphone";E.is_mac=guess.os=="macos";E.is_ios=guess.os=="ios";E.is_linux=guess.os=="linux";E.is_webos=guess.os=="webos";E.is_mobile=guess.mobile;E.is_tv=guess.tv;E.is_ios_sdk=browser.hola_ios;E.is_android_sdk=browser.hola_app;E.browser_rule_s=E.browser.opera?"opera":E.browser.hola_app?"android_app":E.browser.hola_ios?"ios_app":E.browser.webos_app?"webos_app":E.browser.chromium_based?"chromium_based":E.browser.browser};E.browser_init();E.fix_url=function(url){return url.startsWith("//")?E.protocol+url:url};function dom_query_fn(method){return function(selector){var root=document[method]?document:document.body&&document.body[method]?document.body:document.createElement("div");return root[method](selector)}}E.dom_query=dom_query_fn("querySelector");E.dom_query_all=dom_query_fn("querySelectorAll");E.dom_listen=function(element,on_dom_change){if(window.MutationObserver){var observer=new window.MutationObserver(on_dom_change);observer.observe(element,{childList:true,subtree:true});return observer.disconnect.bind(observer)}if(window.MutationEvent&&element.addEventListener){E.cdn_perr({id:"using_mutation_events",info:{from:"dom_listen"}});document.addEventListener("DOMSubtreeModified",on_dom_change);return element.removeEventListener.bind(element,"DOMSubtreeModified",on_dom_change)}E.cdn_perr({id:"dom_listen_unavailable"});return function(){}};E.attr_watch=function(element,opt){if(window.MutationObserver){var observer=new window.MutationObserver(function(mutations){var first;if(first=mutations.find(function(record){return record.attributeName==opt.attr})){opt.watch_fn(first.oldValue,element.getAttribute(opt.attr))}});observer.observe(element,{attributes:true,attributeOldValue:true});return observer.disconnect.bind(observer)}if(window.MutationEvent&&element.addEventListener){var on_attr_modified=function(e){if(e.attrName==opt.attr)opt.watch_fn(e.prevValue,e.newValue)};E.cdn_perr({id:"using_mutation_events",info:{from:"attr_watch"}});element.addEventListener("DOMAttrModified",on_attr_modified);return element.removeEventListener.bind(element,"DOMAttrModified",on_attr_modified)}E.cdn_perr({id:"attr_watch_unavailable"})};E.send_beacon=function(url,data){if(typeof navigator!="undefined"&&navigator.sendBeacon){data.send_type="BEACON";if(navigator.sendBeacon(url,to_form_data(data)))return;data.send_type=undefined;E.cdn_perr({id:"send_beacon_err"})}data.send_type="POST";ajax.raw({url:E.fix_url(url),data:data,method:"POST"})};E.is_numeric=function(n){return!isNaN(n)&&n!=null&&n!=Infinity};E.valid_ranges=function(ranges){return ranges&&(!ranges.length||ranges.every(function(r){return E.is_numeric(r.from)&&E.is_numeric(r.to)}))};E.set_local_conf=function(local){storage.set_json("hola_local_conf",local)};E.get_local_conf=function(){var local=storage.get_json("hola_local_conf")||{};if(local.ver!=E.conf.ver)E.set_local_conf(local={ver:E.conf.ver});return local};E.get_dbg_conf=function(){var dbg_conf=storage.get_json("hola_dbg_conf");var window_dbg_conf=typeof window!="undefined"&&window.hola_dbg_conf;if(!window_dbg_conf&&!dbg_conf)return;dbg_conf=zutil.extend_deep({},window_dbg_conf,dbg_conf);log.warn("using hola_dbg_conf %O",dbg_conf,{});return dbg_conf};E.init=function(conf){if(E.inited)return;E.perr_sent={};E.perr_rl_hash={};E.inited=true;E.conf=zutil.extend_deep({},conf,E.get_local_conf(),E.get_dbg_conf());E.perr_url=E.conf.perr_url||def_perr_url;E.ver=E.conf.ver;E.loader=E.loader||{};E._events=new E.events;E.debug_err_url_rx=storage.get("hola_debug_err_url_rx");if(typeof window!="undefined")window.addEventListener(E.BEFOREUNLOAD,on_beforeunload);if(typeof document!="undefined"&&document.visibilityState)document.addEventListener("visibilitychange",on_visibilitychange)};function on_beforeunload(){E.is_beforeunload=true;E._events.emit("beforeunload")}function on_visibilitychange(){if(document.visibilityState=="visible")E._events.emit("visible_state");if(document.visibilityState=="hidden")E._events.emit("hidden_state")}E.conf_enable=function(path,save){E.conf_set(path,true,save)};E.conf_disable=function(path,save){E.conf_set(path,false,save)};E.conf_set=function(path,val,save,conf){path=path.split(".");conf=conf||E.conf||{};var i,c={},_c=c;for(i=0;i<path.length-1;c=c[path[i]],i++)c[path[i]]=c[path[i]]||{};c[path[i]]=val;zutil.extend_deep(conf,_c);if(save){var local=E.get_local_conf();zutil.extend_deep(local,_c);E.set_local_conf(local)}};E.conf_get_json=function(path,def){var s=E.conf_get(path,def);if(!s||typeof s=="object")return s;try{return JSON.parse(s)}catch(err){}};E.conf_get=function(path,def){var res=E.conf_find(path.split("."));return res===undefined?def:res};E.conf_find=function(path,conf){if(!path)return;conf=conf||E.conf;var i;for(i=0;i<path.length&&conf&&conf[path[i]]!==undefined;i++)conf=conf[path[i]];return i==path.length?conf:undefined};E.conf_test_disable=function(path){if(!E.conf_get(path))return false;E.conf_disable(path);return true};E.conf_have=function(path){return E.conf_get(path)!==undefined};E.is_mode_supported=function(mode){return["disabled","stats","bwsaver","cdn"].includes(mode)};E.is_mode_cdn=function(zone){return zone.CG("mode")=="cdn"};E.is_mode_stats=function(zone){return zone.CG("mode")=="stats"};E.is_mode_bwsaver=function(zone){return zone.CG("mode")=="bwsaver"};E.is_mode_disabled=function(zone){return zone.CG("mode")=="disabled"};E.is_mode_cdn_or_bwsaver=function(zone){return E.is_mode_cdn(zone)||E.is_mode_bwsaver(zone)};E.uninit=function(){if(!E.inited)return;if(typeof window!="undefined")window.removeEventListener(E.BEFOREUNLOAD,on_beforeunload);if(typeof document!="undefined"&&document.visibilityState)document.removeEventListener("visibilitychange",on_visibilitychange);E.inited=false;E.conf={}};function build_info(){var b={platform:typeof navigator!="undefined"&&navigator.platform,user_agent:typeof navigator!="undefined"&&navigator.userAgent};b.ver=E.ver;b.browser=E.browser.opera?"opera "+E.browser.opera_version:E.browser.ucbrowser?"ucbrowser "+E.browser.ucbrowser_version:E.browser.browser+" "+E.browser.version;b.browser_build=typeof window!="undefined"&&window.conf&&window.conf.browser&&window.conf.browser.name;b.guess=JSON.stringify(E.guess);return b}function build(){var info=build_info(),s="";for(var f in info)s+=(s&&"\n")+f+": "+info[f];return s}function to_form_data(o){var data=new FormData;zutil.forEach(o,function(v,k){data.append(k,v)});return data}function perr_raw(opt){var data={},qs={},delayed=false;data.info=opt.info;data.bt=opt.bt;data.filehead=opt.filehead;if(opt.delay){if(opt.wrapper&&opt.wrapper.cdn&&opt.wrapper.cdn.attached_bws&&!opt.wrapper.cdn.attached_bws.closed){data.id=opt.id;opt.wrapper.cdn.attached_bws.add_perr(data);delayed=true}else if(E.loader.init_delay){data.id=opt.id;E.loader.add_perr(data);delayed=true}}if(opt.delayed_perrs)data.delayed_perrs=JSON.stringify(opt.delayed_perrs);qs.id=opt.id;qs.browser=opt.browser||(E.browser.opera?"opera":E.browser.ucbrowser?"ucbrowser":E.browser.browser);qs.browser_ver=E.browser.version;qs.customer=opt.customer;if(opt.tag){qs.tag_id=opt.tag.id;qs.tag_date=+opt.tag.date}if(opt.zone)qs.zone=opt.zone;data.ver=E.ver;data.build=build();data.session_id=opt.session_id;data.is_json=1;if(delayed)return;var url=(opt.perr_url||E.perr_url)+"?"+zescape.qs(qs);if(opt.use_beacon)return void E.send_beacon(url,data);data.send_type="POST";ajax.raw({url:E.fix_url(url),data:data,method:"POST"})}var is_touch=typeof document!="undefined"&&"ontouchstart"in document.documentElement;var is_embed=typeof window!="undefined"&&window.top&&window.top!==window;function perr_rate_limit(opt){if(opt.rate_limit===false)return true;var _rl=assign({ms:date.ms.HOUR,count:10},opt.rate_limit);var id=opt.id,rl=E.perr_rl_hash[id]=E.perr_rl_hash[id]||{};var ret=rate_limit(rl,_rl.ms,_rl.count);if(!ret){var key="perr_rate_limit_"+id;if(!E.perr_sent[key])E.cdn_perr({id:"perr_rate_limit",info:id,rate_limit:false});E.perr_sent[key]=1}return ret}function db_perr(opt){opt=opt||{};var id=opt.id;if(opt.throttle&&!opt.force&&(E.perr_sent[id]||0)>=opt.throttle)return;perr_rate_limit(opt);var data=opt.data||{};data.sent=data.sent||{};var info=typeof opt.info!="object"?{_info:opt.info}:opt.info;var customer,zone=opt.zone||{};if(!info.customer&&(customer=E.conf.customer))info.customer=customer;if(!info.zone&&zone.name)info.zone=zone.name;if(!info.method&&zone.method)info.method=zone.method;info.hola_mode=info.hola_mode||zone.mode;info.skip=zone.skip;info.dashboard=";type="+(zone.stream_type||"unknown")+(zone.player_type?";player="+zone.player_type:"")+(zone.tech?";tech="+zone.tech:"");var url=data.url||opt.url||(typeof window!="undefined"&&window.top===window?location.href:typeof document!="undefined"&&document.referrer);var match=url?url.match(/^http(s)?:\/\/(www\.)?([a-zA-Z0-9-\.]+)\/.*$/):null;info.site=match?match[3]:"unknown";info.frame=typeof window!="undefined"&&window.top!==window;info.url=url;info.location_url=typeof location!="undefined"&&location.href;info.referrer=typeof document!="undefined"&&document.referrer;info.referrer_type=E.referrer_type(info.location_url,info.referrer,E.conf_get("loader.referrer_internal_regex"));assign(info,opt.extra,{file:data.file,link:data.link,err:opt.err||info.err});info.is_embed=is_embed;info.is_touch=is_touch;info.support_fullscreen=user_agent.support_fullscreen();var nc;if(typeof navigator!="undefined"&&(nc=navigator.connection))info.connection={type:nc.type,downlink_max:nc.downlinkMax};if(zone.bwsaver)info.bw_saving=zone.bwsaver;if(zone.video_url&&!info.video_url)info.video_url=zone.video_url;if(zone.video_live&&info.video_live===undefined)info.video_live=zone.video_live;if(zone.player_info)info.player_info=zone.player_info;if(E.is_beforeunload)info.before_unload=true;E.perr_sent[id]=E.perr_sent[id]+1||1;info.session_id=E.session_id;info.tag=E.loader&&E.loader.tag;info.analysis_tag=opt.analysis_tag;perr_raw({tag:E.loader&&E.loader.tag,session_id:E.session_id,id:opt.prefix+id,info:zerr.json(info),customer:customer,zone:zone.name,bt:opt.bt,browser:opt.browser,filehead:opt.filehead,use_beacon:opt.use_beacon,perr_url:opt.perr_url,wrapper:opt.wrapper,delay:!!opt.delay&&opt.prefix=="www_cdn_db_",delayed_perrs:opt.delayed_perrs})}_log.set_perr(function(opt){return E.cdn_perr(opt)});E.cdn_perr=function(opt){if(opt.filehead)opt.filehead+="\n\n";opt.filehead=opt.filehead||"";var logs;if(opt.add_log){var log_obj=opt.zone?opt.zone.log:_log;if(opt.full)opt.filehead+=log_obj.logs_to_str(_log.full_history,true);else{if(opt.player_logs)logs=log_obj.concat(opt.player_logs,true);opt.filehead+=log_obj.logs_to_str(logs,opt.full_log)}}else opt.filehead+="no log requested";return db_perr(assign(opt,{prefix:"www_cdn_db_"}))};E.stream_fetch_bin=function(opt){opt.timeout=opt.timeout||2e4;var sp,reader,url;function send_fetch(opt){opt.progress=0;opt.fullsize=0;fetch(url).then(function(res){opt.fullsize=res.headers.get("Content-Length");sp.continue(res.body.getReader())}).catch(function(e){sp.continue(e)})}sp=etask({name:"fetch_bin_fetch",cancel:true},[function(){url=zescape.uri(opt.url);this.opt=opt;send_fetch(opt);return this.wait(opt.timeout)},function(_reader){reader=_reader||{};if(this.error||!reader.read)throw"failed fetch request";return etask.while(null,[function(){var _this=this;reader.read().then(function(result){if(result.done)return _this.break();var chunk=result.value;opt.progress+=chunk.byteLength;if(opt.ondata)opt.ondata(chunk);return _this.continue()});return this.wait()}])},function catch$(err){this.return(-1)},function finally$(){if(reader)reader.cancel()}]);return sp};E.str2bin=function(s,offset){offset=offset||0;if(!s||!s.length)return;var arr=new Uint8Array(s.length-offset);var dv=new DataView(arr.buffer);for(var i=offset,j=0;i<s.length;i++,j++)dv.setUint8(j,s.charCodeAt(i));return arr};function update_xhr_progress(xhr,ev){if(ev.lengthComputable)xhr.total=ev.total;xhr.loaded=ev.loaded}function str2bin(xhr,opt){var arr=E.str2bin(xhr.response,opt.served||0);if(!arr)return;var ret={progress:opt.served,data:arr.buffer,last_progress:date.monotonic()};opt.progress=opt.served;opt.served=xhr.response.length;opt.onreadystatechange(xhr,ret)}function msstream2bin(xhr,opt){var reader=new window.MSStreamReader;function cb(data,to){var ret={progress:opt.served,data:data,last_progress:date.monotonic()};opt.progress=opt.served;opt.served=to;opt.onreadystatechange(xhr,ret)}reader.onprogress=reader.onload=function(ev){update_xhr_progress(xhr,ev);var data=ev.target.result;var to=ev.loaded;if(opt.served!=to)cb(data.slice(opt.served,to),to)};reader.readAsArrayBuffer(xhr.response)}var perr_no_res_sent=false;E.fetch_bin=function(opt){opt.timeout=opt.timeout||2e4;opt.onreadystatechange=opt.onreadystatechange||function(){};var xhr,url;return etask({name:"fetch_bin",cancel:true},[function(){url=zescape.uri(E.fix_url(opt.url));var _this=this;this.opt=opt;var fallback_wrapper=function(f){return opt.fallback_wrapper?opt.fallback_wrapper(f):f};if(opt.streaming)opt.progress=opt.served=0;xhr=opt.XHR?new opt.XHR(opt.xhr_opt):new XMLHttpRequest;if(opt.withCredentials)xhr.withCredentials=true;xhr.open(opt.method||(opt.data?"POST":"GET"),url);xhr.responseType=opt.response_type||"arraybuffer";xhr.onreadystatechange=fallback_wrapper(function(e){if(!opt.streaming||this.readyState!=this.LOADING)opt.onreadystatechange(xhr)});xhr.onprogress=opt.onprogress;var headers=opt.headers||{};if(headers.Range&&E.browser.browser=="safari")headers["Cache-Control"]="no-store";if(opt.data){headers["Content-Type"]=opt.content_type||"application/json";headers["Content-Length"]=opt.data.byteLength}for(var hdr in headers)xhr.setRequestHeader(hdr,headers[hdr]);function onload(e){var res=e.target.response;if(opt.response_type=="json"&&e.target.responseType!="json")try{res=JSON.parse(res)}catch(err){}if(this.responseType=="ms-stream")res=null;if(e.target.responseType=="moz-chunked-arraybuffer"&&!res)_this.continue({data:res,size:e.total,mozpatch:true});else _this.continue({data:res,size:e.total})}if(E.debug_err_url_rx&&new RegExp(E.debug_err_url_rx).test(url)){log.notice("Xhr onload handler is replaced with debug exception");xhr.onload=function(){log.notice("Generating debug xhr error for "+url);_this.throw("debug xhr error")}}else xhr.onload=fallback_wrapper(onload);xhr.onerror=function(err){_this.throw(err)};if(opt.streaming){switch(E.browser.browser){case"chrome":xhr.responseType="text";xhr.overrideMimeType("text/plain; charset=x-user-defined");xhr.onprogress=fallback_wrapper(function(e){update_xhr_progress(xhr,e);str2bin(xhr,opt);if(opt.onprogress)opt.onprogress.call(xhr,e)});break;case"ie":if(E.browser.version<10){opt.streaming=false;break}xhr.responseType="ms-stream";xhr.onreadystatechange=fallback_wrapper(function(e){if(xhr.readyState==xhr.LOADING)msstream2bin(xhr,opt);else opt.onreadystatechange(xhr)});break;case"firefox":if(E.browser.version>=9){xhr.responseType="moz-chunked-arraybuffer";xhr.onprogress=fallback_wrapper(function(ev){var res=xhr.response;if(!res){if(!perr_no_res_sent){perr_no_res_sent=true;E.cdn_perr({id:"on_progress_no_res",delay:true})}return}update_xhr_progress(xhr,ev);opt.served=ev.loaded;opt.progress=ev.loaded-res.byteLength;opt.onreadystatechange(xhr,{progress:opt.progress,data:res,last_progress:date.monotonic()});if(opt.onprogress)opt.onprogress.call(xhr,ev)})}else opt.streaming=false;break;default:opt.streaming=false;break}}xhr.streaming=opt.streaming;xhr.send(opt.data);return this.wait(opt.timeout)},function(res){if(this.error||!res)throw"failed fetch request";res.hdrs=E.get_resp_hdrs(xhr);if(!res.fullsize){var v;if(v=E.fullsize_from_xhr(xhr))res.fullsize=+v;else if(!opt.hrange&&(!opt.headers||!opt.headers.Range)){res.fullsize=!res.data?0:res.data.byteLength||res.data.length}}res.status=xhr.status;return res},function catch$(err){this.return()},function finally$(){opt.aborted=true;if(xhr.readyState<xhr.DONE)xhr.abort()}])};E.fullsize_from_xhr=function(xhr){return E.fullsize_from_hdrs(E.get_resp_hdrs(xhr))};E.fullsize_from_hdrs=function(hdrs){if(!hdrs)return;var fs,v;if(v=hdrs["x-hola-fullsize"])fs=+v;else if(v=hdrs["content-range"])fs=+v.split("/")[1];else if(v=hdrs["content-length"])fs=+v;return fs};E.guess_link_type=function(url){var type=E.get_video_type(url);switch(type){case"mp4":return"video/mp4";case"hls":return"application/x-mpegurl";case"hds":return"application/adobe-f4m";case"dash":return"application/dash+xml";case"flv":return"video/flv";case"webm":return"video/webm";default:log.debug('could not guess link type: "'+url+'" assuming mp4');return"video/mp4"}};E.blob_to_dataurl=function(blob){return etask({name:"blob_to_dataurl",cancel:true},[function(){var _this=this,reader=new FileReader;reader.onerror=function(err){_this.throw(err)};reader.onload=function(){_this.return(reader.result)};reader.readAsDataURL(blob);return this.wait()}])};E.blob_to_dataurl.supported=!!(typeof window!="undefined"&&window.FileReader&&window.Blob);E.btoa=function(arr){return etask([function(){if(E.blob_to_dataurl.supported)return;var bin="";var dv=new DataView(arr.buffer,arr.byteOffset,arr.byteLength);for(var i=0,l=arr.byteLength;i<l;i++)bin+=String.fromCharCode(dv.getUint8(i));return this.return(window.btoa(bin))},function(){return E.blob_to_dataurl(new Blob([arr]))},function(r){return r.slice(r.indexOf(",")+1)}])};E.set_geoip=function(data){if(!data)return;if(E.geoip&&E.geoip.country&&E.geoip.country!=data.country.toLowerCase()){E.cdn_perr({id:"geoip_country_change",info:{prev:E.geoip,next:data}})}E.geoip=zutil.clone(data);E.geoip.ver=E.conf.ver;for(var i in E.geoip){if(typeof E.geoip[i]=="string")E.geoip[i]=E.geoip[i].toLowerCase()}if(data.date){E.geoip.date_skew=new Date(date.to_jdate()).getTime()-new Date(data.date)}storage.set_json("hola_geoip",E.geoip)};E.array_equal=function(arr1,arr2){if(arr1.length!=arr2.length)return false;var i;for(i=0;i<arr1.length&&arr1[i]===arr2[i];i++);return i==arr1.length};E.events=function(){this.events=new events;return this};E.events.prototype.on=function on(event,fn,context){this.events.on(event,fn,context)};E.events.prototype.once=function once(event,fn,context){this.events.once(event,fn,context)};E.events.prototype.one=E.events.prototype.once;E.events.prototype.off=function off(event,fn){this.events.off(event,fn)};E.events.prototype.emit=function emit(event,a1,a2,a3,a4,a5){this.events.emit("pre-"+event,a1,a2,a3,a4,a5);this.events.emit(event,a1,a2,a3,a4,a5);this.events.emit("post-"+event,a1,a2,a3,a4,a5)};E.on=function(event,fn,ctx){E._events.on(event,fn,ctx)};E.off=function(event,fn){E._events.off(event,fn)};E.services={};E.services.brightcove=function(opt,cb){var sources=[];etask([function(){this.finally(function(){cb(sources)});return ajax.raw({url:"https://edge.api.brightcove.com/playback/v1"+"/accounts/"+(opt.account_id||opt.account)+"/videos/"+(opt.video_id||opt.video),headers:{"BCOV-Policy":opt.policy_key||opt.pk},data_type:"json"})},function catch$(){return this.return()},function(data){sources=data.sources.filter(function(src){return src.src&&/^mp4$/i.test(src.container||"")&&/^h264$/i.test(src.codec||"")});sources=sources.map(function(src){return{src:src.src,type:"video/mp4"}})}])};var web_sockets={};E.ws=function(host,opt){if(typeof WebSocket!="function"||!host)return;if(!(this instanceof E.ws))return new E.ws(host,opt);var path,customer,zone;opt=opt||{};if(typeof opt=="string")path=opt;else if(typeof opt=="object"){path=opt.path;customer=opt.customer;zone=opt.zone}var protocol=opt.protocol||(E.protocol=="https:"?"wss":"ws");this.url=protocol+"://"+host+"/"+path;this.url=zescape.uri(this.url,{customer:customer,zone:zone});if(web_sockets[this.url])return web_sockets[this.url];this.id=0;this.minor=!!opt.minor;this.pending=[];try{this.ws=new WebSocket(this.url)}catch(e){E.cdn_perr({id:"ws_failed",err:e.message,throttle:2,url:this.url,delay:true});return}this.ws.onopen=this.onopen.bind(this);this.ws.onclose=this.onclose.bind(this);this.ws.onerror=this.onerror.bind(this);this.ws.onmessage=this.onmessage.bind(this);this.timer=undefined;this.timedout=false;if(opt.timeout){this.timer=setTimeout(this.ontimedout.bind(this),opt.timeout==true?5e3:opt.timeout)}web_sockets[this.url]=this;return this};zutil.inherits(E.ws,events.EventEmitter);E.ws.prototype.close=function(){if(this.ws&&this.ws.readyState<this.ws.CLOSING)this.ws.close();web_sockets[this.url]=undefined};E.ws.prototype.send=function(cmd,data,onmessage){if(!this.ws||this.ws.readyState>=this.ws.CLOSING)return;if(this.ws.readyState<this.ws.OPEN){this.pending.push({cmd:cmd,data:data,onmessage:onmessage});return}if(typeof data=="string")data=JSON.parse(data);if(Array.isArray(data))data={data:data};var msg={cmd:cmd,opt:data||{}};msg.opt.__id=this.id++;if(onmessage)this.once(msg.opt.__id,onmessage);msg=JSON.stringify(msg);this.ws.send(msg);return msg.length};E.ws.prototype.onopen=function(){var _this=this;if(this.timer){clearTimeout(this.timer);this.timer=undefined}this.pending.forEach(function(item){_this.send(item.cmd,item.data,item.onmessage)});this.pending=[];this.emit("open")};E.ws.prototype.onclose=function(ev){if(!this.ws)return;if(this.timer){clearTimeout(this.timer);this.timer=undefined}this.ws=undefined;log.info("closed websocket "+this.url);this.emit("close");if(!ev)return;if(this.timedout){return E.cdn_perr({id:"ws_timedout",err:{url:this.url},throttle:2})}if(!ev.wasClean||ev.code!=1e3){E.cdn_perr({id:"ws_failed",err:{code:ev.code,reason:ev.reason,url:this.url},throttle:2})}};E.ws.prototype.onerror=function(err){log.info("error websocket "+this.url+" "+err);if(this.minor){console.info("Note: WebSockets only transmit auxilliary information "+"between clients and servers. WebSocket errors do not impact "+"HolaCDN functionality in any way.")}this.emit("error",err);this.close()};E.ws.prototype.onmessage=function(e){var json=JSON.parse(e.data)||{};var id=json.opt&&json.opt.__id!==undefined?json.opt.__id:"message";this.emit(id,json)};E.ws.prototype.ontimedout=function(){if(this.timer){clearTimeout(this.timer);this.timer=undefined}if(!this.ws)return;this.timedout=true;this.close()};E.ms_since=function(since){return Math.round(date.monotonic()-(since||0))};E.origin_is_allowed=function(origin,origins){return E._origin_is_allowed(origins||E.conf_get("agent.origins"),origin)};E.origin_is_allowed_url=function(url,origins){var o=zurl.parse(url);if(!o||!o.hostname)return;return E.origin_is_allowed(o.hostname,origins)}}E.get_api=function(){var g=typeof window!="undefined"?window:typeof global!="undefined"?global:self;return(g.hola_cdn||(g.hola_cdn={api:{}})).api};var mp4_suffix=/\.(mp4|m4p|m4v|mov)$/i;var hls_suffix=/\.m3u8$/;var hds_suffix=/\.f4m$/;var dash_suffix=/\.mpd$/;var flv_suffix=/\.flv$/;var webm_suffix=/\.webm$/;function is_rx_link(v,rx){return!!v&&rx.test(zurl.parse(v).pathname.split(";")[0])}E.is_mp4_link=function(v){return is_rx_link(v,mp4_suffix)};E.is_hls_link=function(v){return is_rx_link(v,hls_suffix)};E.is_hds_link=function(v){return is_rx_link(v,hds_suffix)};E.is_dash_link=function(v){return is_rx_link(v,dash_suffix)};E.is_flv_link=function(v){return is_rx_link(v,flv_suffix)};E.is_webm_link=function(v){return is_rx_link(v,webm_suffix)};E.is_youtube_link=function(v){return v&&/^(.*\.)?youtube.com$/.test(zurl.get_host(v))};E.get_video_type_from_player=function(url){url=url||this.get_url();return this.zone&&this.zone.get_video_type?this.zone.get_video_type(url):E.get_video_type(url)};E.get_video_type=function(v){if(E.is_youtube_link(v))return"yt";if(E.is_mp4_link(v))return"mp4";if(E.is_flv_link(v))return"flv";if(E.is_webm_link(v))return"webm";if(E.is_hls_link(v))return"hls";if(E.is_hds_link(v))return"hds";if(E.is_dash_link(v))return"dash";return null};E.is_adaptive=function(type){return["hls","hds","dash"].indexOf(type)>-1};E.is_progressive=function(type){return["mp4","flv","webm"].indexOf(type)>-1};E.is_adaptive_link=function(v){return E.is_adaptive(E.get_video_type(v))};E.get_method_type=function(type){if(E.is_progressive(type))return"progressive";if(E.is_adaptive(type))return type;return"unknown"};E.get_adaptive_by_type=function(type){if(E.is_adaptive(type)||type=="yt")return type;return null};E.get_adaptive_type=function(v){var type=E.get_video_type(v);return E.get_adaptive_by_type(type)};E.get_media_by_type=function(type){if(E.is_progressive(type))return type;return"mp4"};E.get_media_type=function(v){var type=E.get_video_type(v);return E.get_media_by_type(type)};E.is_blob_url=function(u){return u.startsWith("blob:")||u.startsWith("mediasource:")};E.is_data_url=function(u){return u.startsWith("data:")};E.is_proxy_url=function(u){var o=zurl.parse(u);return o.hostname=="player.h-cdn.com"};E.get_proxy_url=function(customer,zone,src){return"//player.h-cdn.com/api/zagent_get?customer="+customer+"&zone="+zone+"&url="+encodeURIComponent(src)};function check_re(lst,s){if(!lst)return false;for(var i=0;i<lst.length;i++){var re=lst[i];if(re===s||re instanceof RegExp&&re.test(s))return true}return false}E._origin_is_allowed=function(origins,origin){return origins=="*"||check_re(origins,origin)};E.video_format_is_enabled=function(zone,url){var media_filter_in=zone.CGJ("cdn.media.filter_in");if(!media_filter_in)return true;for(var i=0;i<media_filter_in.length;i++){var test_func=E["is_"+media_filter_in[i]+"_link"];if(test_func&&test_func(url))return true}return false};E.get_perr_link_msg=function(customer,bugid){return"report sent id "+bugid+"\nbug location url "+"http://holacdn.com/cp/admin/debug/saved?"+zescape.qs({cust:customer,filter:"info.bugid=="+bugid})};E.get_resp_hdrs=function(xhr){if(!xhr||!xhr.getAllResponseHeaders)return{};var hdrs=xhr.getAllResponseHeaders();if(!hdrs)return{};hdrs=hdrs.split("\n");var ret={},count=1;hdrs.forEach(function(h){if(!h.length||h=="\r")return;var args=h.split(/:(.+)/);var key=args[0].trim().toLowerCase();if(ret[key])key+="_dup"+count++;ret[key]=args[1]&&args[1].trim()});return ret};E.try_wrapper=function(opt,func){if(typeof opt=="function"){func=opt;opt={}}var throttle=opt.throttle||5;var prefix=opt.prefix||"util";return function(){try{return func.apply(this,arguments)}catch(e){if(opt.silent)return;E.cdn_perr({id:prefix+"_try_wrapper_err",err:e.message,throttle:throttle,bt:e.stack,opt:opt});if(log)log.err(prefix+"_try_wrapper_err "+e+" "+e.stack)}}};E.try_wrapper_silent=function(func){return E.try_wrapper({silent:true},func)};E.inject_hook=function(object,prop,opt){function get_property_descriptor_data(o,p){while(o&&!o.hasOwnProperty(p))o=Object.getPrototypeOf(o);return{obj:o,pd:o&&Object.getOwnPropertyDescriptor(o,p)}}if(!object)throw new Error("injecting hook, but no object");if(typeof opt=="function")opt={exec:opt};var setup={func_hook:{get_hook:function(){return typeof object[prop]=="function"&&object[prop].hook},install:function(hook){var _hook=function(){return hook("exec",arguments)};_hook.hook=hook;hook._orig_handler=object[prop];hook._orig_handler_inherited=Object.hasOwnProperty(object,prop);Object.defineProperty(object,prop,{configurable:true,writable:true,enumerable:true,value:_hook});if(typeof hook._orig_handler!="function")return{exec:function(){}};return{exec:hook._orig_handler}},uninstall:function(hook){if(hook._orig_handler_inherited)delete object[prop];else object[prop]=hook._orig_handler}},value_hook:{get_hook:function(){var data=get_property_descriptor_data(object,prop);return data.pd&&(data.pd.get||data.pd.set||{}).hook},install:function(hook){var data=hook._orig_desc_data=get_property_descriptor_data(object,prop);var pd=data.pd;if(!pd||!pd.set&&!pd.get){var v=pd&&pd.value;pd={get:function(){return v},set:function(_v){v=_v}}}var _hook=function(type){var h=function(){return hook(type,arguments)};h.hook=hook;return h};Object.defineProperty(object,prop,{configurable:true,enumerable:true,set:pd.set&&_hook("set"),get:pd.get&&_hook("get")});return{get:pd.get,set:pd.set}},uninstall:function(hook){var pd=hook._orig_desc_data.pd||{configurable:true,writable:true,enumarable:true};if(pd.writable)pd.value=object[prop];var target=hook._orig_desc_data.obj||object;if(target!=object)delete object[prop];Object.defineProperty(target,prop,pd)}}};var oh,hook,hook_method=opt.exec?setup.func_hook:setup.value_hook;if(!(hook=hook_method.get_hook())){hook=function(origin,args){var i,ret,handled;var e={set_handled:function(){handled=true}};for(i=0;i<hook.listeners.length;i++){var listener=hook.listeners[i];if(!listener[origin])continue;try{ret=listener[origin].call(object,e,args)}catch(err){E.cdn_perr({id:"hook_fail",info:{err:err},add_log:true});throw err}if(handled)return ret}if(hook.original_handlers[origin])return hook.original_handlers[origin].apply(object,args)};hook.listeners=[];hook.original_handlers=hook_method.install(hook);hook.uninstall=hook_method.uninstall.bind(hook_method,hook)}hook.listeners.push(opt);oh=hook.original_handlers;return{count:function(){return hook.listeners.length},remove:function(){var index=hook.listeners.indexOf(opt);if(index<0)return;hook.listeners.splice(index,1);if(!hook.listeners.length)hook.uninstall()},original_handlers:{exec:opt.exec&&oh.exec&&oh.exec.bind(object),get:!opt.exec&&oh.get&&oh.get.bind(object),set:!opt.exec&&oh.set&&oh.set.bind(object)}}};E.on_window_message=function(cb,async){function is_postm_modifiable(){var d=Object.getOwnPropertyDescriptor(window,"postMessage");var is_modifiable=!d||d.configurable;if(!is_modifiable)E.cdn_perr({id:"postm_non_modifiable"});return is_modifiable}if(!E.conf_get("loader.post_message_wrapper")||!is_postm_modifiable()){window.addEventListener("message",cb);return window.removeEventListener.bind(window,"message",cb)}var hfunc=async?function(d){setTimeout(function(){cb({data:d})},0)}:function(d){cb({data:d})};var hook=E.inject_hook(window,"postMessage",function(e,a){try{hfunc(a[0])}catch(err){E.cdn_perr({id:"overload_fail",info:{method:"window.postMessage",err:err},add_log:true})}});return hook.remove.bind(hook)};E.protect_video_src=function(video,opt){var src_hook=E.inject_hook(video,"src",{set:function(e,args){var from=video.src,to=args[0];if(opt.replace){if(to=opt.replace(from,to))args[0]=to}if(opt.ignore&&opt.ignore(from,to)){e.set_handled();if(opt.mock_next_load_attempt){
var load_hook=E.inject_hook(video,"load",function(e){e.set_handled();load_hook.remove()});setTimeout(load_hook.remove.bind(load_hook))}}}});return src_hook.remove.bind(src_hook)};E.absolute_uri=function(s){if(!s)return s;var el=document.createElement("source");el.src=s;return el.src};E.is_redirect=function(status){return[300,301,302,303,305,307,308].includes(+status)};E.set_param=function(name,value,delim){if([false,undefined].includes(value))return"";delim=delim||"&";return delim+name+([null,true].includes(value)?"":"="+value)};E.parse={};E.parse.cache_control=function(s){var cc=zescape.parse.http_words(s),ret={};for(var i=0;i<cc.length;i++)ret[cc[i][0]]=cc[i][1]||true;return ret};E.get_hola_uri=function(location,key){if(key===undefined){key=location;location=window.location}if(!key)return;var o_url=zurl.parse(window.top===window?location.href:document.referrer);var o_qs=zurl.qs_parse((o_url.search||"").substr(1));var o_hash=zurl.qs_parse((o_url.hash||"").substr(1));return o_qs[key]||o_hash[key]||false};E.get_uri_conf=function(){return{};var conf={};E.uri_opts_list.forEach(function(key){var value=E.get_hola_uri("hola_"+key);if(value!==undefined)conf[key]=value});return conf};E.load_script=function(url,onload,attrs){var script=document.createElement("script");script.src=E.fix_url(url);script.onload=onload;if(attrs)Object.assign(script,attrs);if(document.getElementsByTagName("head").length)document.getElementsByTagName("head")[0].appendChild(script);else if(document.getElementsByTagName("body").length)document.getElementsByTagName("body")[0].appendChild(script);else if(document.head)document.head.appendChild(script)};E.get_current_buf=function(player){player=player||this;var pos=player.get_pos()||0,b=player.get_buffered()||[];for(var i=0;i<b.length;i++){if(pos>=b.start(i)&&pos<=b.end(i))return{from:b.start(i),to:b.end(i)}}return{from:pos,to:pos}};E.build_flash_api=function(_this){function call_api(name,check){var f,slice=Array.prototype.slice;if(_this.swf&&(f=_this.swf["hola_"+name]))return check?!!f:f.apply(_this.swf,slice.call(arguments,2))}return{_call_api:call_api,set_bandwidth:call_api.bind(null,"setBandwidth",false),version:call_api.bind(null,"version",false),avail_version:call_api.bind(null,"version",true),settings:call_api.bind(null,"settings",false),avail_settings:call_api.bind(null,"settings",true),set_timeout:call_api.bind(null,"setTimeout",false),avail_set_timeout:call_api.bind(null,"setTimeout",true)}};E.get_elm_resolution=function(elm){var st=elm&&getComputedStyle(elm);if(!st)return;var full_screen=!(document.fullScreenElement!==undefined&&document.fullScreenElement===null||document.msFullscreenElement!==undefined&&document.msFullscreenElement===null||document.mozFullScreen!==undefined&&!document.mozFullScreen||document.webkitIsFullScreen!==undefined&&!document.webkitIsFullScreen);return{width:parseInt(st.width,10),height:parseInt(st.height,10),full_screen:full_screen}};E.max_qid_by_resolution=function(playlists,res){var have=0,max_level=playlists.length-1,chosen=max_level;if(!res||!res.width||!res.height)return max_level;for(var i=max_level;i>=0;i--){var _res=playlists[i].attributes.resolution;var bandwidth=playlists[i].attributes.bandwidth;if(!_res||!_res.width||!_res.height||bandwidth<=64e3)continue;have++;chosen=i;if(_res.width==res.width&&_res.height==res.height)break;if(+_res.width<+res.width&&+_res.height<+res.height){chosen=Math.min(i+1,max_level);break}}return chosen};E.get_bitrate_rank=function(player){var res=player.get_resolution();if(!res)return"unknown";var playlist=player.get_current_playlist();var playlists=player.get_playlists();if(!playlist||!playlists)return"unknown";var qid=playlist.level_idx;var best=E.max_qid_by_resolution(playlists,res);return qid>best?"high":qid<best?"low":qid==best?"best":"unknown"};E.fnv1a=function(chunk){var hash=2166136261,arr=new Uint8Array(chunk);for(var i=0;i<arr.length;i++)hash=(hash^arr[i])*16777619>>>0;return hash};E.create_fake_xhr=function(opt){var fake_xhr={setup:{},req_headers:[]};opt.log=opt.log.set_module("util");fake_xhr.open=function(verb,url){fake_xhr.verb=verb;fake_xhr.url=url};fake_xhr.setRequestHeader=function(header,value){fake_xhr.req_headers.push([header,value])};fake_xhr.getAllResponseHeaders=function(){};fake_xhr.send=function(){fake_xhr.sent=true;opt.onsend()};fake_xhr.abort=function(){if(!fake_xhr.req||fake_xhr.req.error===E.ERR.aborted||fake_xhr.req.info.rate){return}fake_xhr.req.abort();if(opt.onabort)opt.onabort();opt.log.notice("req aborted",fake_xhr.req.name);if(fake_xhr.onabort)fake_xhr.onabort();if(fake_xhr.onloadend)fake_xhr.onloadend()};return fake_xhr};E.update_fake_xhr=function(req){var fake_xhr=req.info.segment.fake_xhr,err=req.error;fake_xhr.response=err?null:req.res.data;fake_xhr.status=err?404:200;fake_xhr.responseURL=fake_xhr.url;fake_xhr.resp_hdrs=(req.resp||{}).hdrs;if(!err){var ev={loaded:req.res.size,total:req.res.size,target:fake_xhr,lengthComputable:true};if(fake_xhr.onload)fake_xhr.onload(ev)}if(fake_xhr.onloadend)fake_xhr.onloadend();return fake_xhr};E.module_fn=function(module,target){var name=typeof target=="function"?target.name:target;function get_orig(){var s=module.Player.super_,proto_fn=s&&s.prototype[name];return typeof target=="string"&&proto_fn?proto_fn:target}module.Player.prototype[name]=function(a1,a2,a3){var len=arguments.length,mod_fn=this.module&&this.module[name];var fn=mod_fn||get_orig(),fn_this=mod_fn?this.module:this;if(typeof fn!="function")return;switch(len){case 0:return fn.call(fn_this);case 1:return fn.call(fn_this,a1);case 2:return fn.call(fn_this,a1,a2);case 3:return fn.call(fn_this,a1,a2,a3);default:var args=new Array(len);for(var i=0;i<len;i++)args[i]=arguments[i];return fn.apply(fn_this,args)}};module.Player.prototype[name].orig=get_orig};E.super_fn=function(module,name){module.Player.prototype[name]=function(){var s=module.Player.super_,fn,len=arguments.length;if(!s||!(fn=s.prototype[name]))return;var args=new Array(len);for(var i=0;i<len;i++)args[i]=arguments[i];return fn.apply(this,args)}};E.call_super=function(module,pl,name){var in_len=arguments.length,s,fn,out_len=in_len-3;if(!module.Player||!(s=module.Player.super_))return;var a=new Array(out_len>0?out_len:0);for(var i=3;i<in_len;i++)a[i-3]=arguments[i];return name?(fn=s.prototype[name])&&fn.apply(pl,a):s.apply(pl,a)};E.create_forwarding_emit=function(player){var events=player.module&&player.module.event_list,in_call=false;if(!events)return;var old_emit=player.emit;player.emit=function(e,o){return!events.includes(e)&&old_emit.call(player,e,o)};events.forEach(function(e){player.module.on(e,function(o){if(in_call)return;in_call=true;old_emit.call(player,e,o);in_call=false})})};E.resolve_url=function(base_url,path){var m=path.match(/^([^:\/?#]+:)?(?:\/\/(?:([^:@\/?#]*)(?::([^:@\/?#]*))?@)?((?:[^:\/?#]*)(?::(?:\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);var protocol=m[1]||"";var user=m[2]||"";var password=m[3]||"";var host=m[4]||"";var pathname=m[5]||"";var search=m[6]||"";var hash=m[7]||"";if(!/(\w+:)?\/\//.test(base_url))base_url=E.resolve_url(location.href,base_url);var base=zurl.parse(base_url);var is_full=!!protocol||!!host||!!user;if(!is_full&&!pathname&&!search)search=base.search||"";if(!is_full&&pathname.charAt(0)!="/"){pathname=pathname?((base.host||base.user)&&!base.pathname?"/":"")+base.pathname.slice(0,base.pathname.lastIndexOf("/")+1)+pathname:base.pathname}var output=[];pathname.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(p){if(p=="/..")output.pop();else output.push(p)});pathname=output.join("").replace(/^\//,pathname.charAt(0)=="/"?"/":"");if(!is_full){host=base.host;password=base.password;user=base.user}if(!protocol)protocol=base.protocol;return protocol+"//"+(user?user+(password?":"+password:"")+"@":"")+host+pathname+search+hash};var providers=[{provider:"Akamai",regex:/\.akamai(hd)?\./},{provider:"Amazon",regex:/\.s3\.amazon/},{provider:"Cloudfront",regex:/\.cloudfront\./},{provider:"Fastly",regex:/\.fastly\./},{provider:"MaxCDN",regex:/\.(max|netdna-|h-)cdn\./},{provider:"Limelight",regex:/\.llnwd\.net\//},{provider:"Overon",regex:/\.overon\.es\//}];E.get_origin_provider=function(origin){for(var i=0,l=providers.length;i<l;i++){if(providers[i].regex.test(origin))return providers[i].provider}E.cdn_perr({id:"origin_provider_unidentified",info:{origin:origin}});return"unidentified"};var jw_swf_exist=["6.12.4","7.1.0","7.1.4","7.2.4","7.3.3","7.3.4","7.4.3","7.4.4","7.5.0","7.6.0","7.7.0","7.7.1","7.8.1","7.8.4","7.8.6"];E.is_jw_swf_exist=function(ver){return jw_swf_exist.includes(ver)};var swf_versions=[{match:{jwplayer_version:[7]},expected:[1,0,34]},{match:{jwplayer_version:[6]},expected:[1,0,28]},{match:{flashls_version:"*"},expected:[2,0,13]},{match:{osmf_version:"*"},expected:[1,0,14]}];var min_hola_player_version=[5,10];function check_ver(version,exp){if(exp=="*")return true;var actual=(version||"").split(".");for(var i=0,l=exp.length;i<l;i++){var act_i=actual[i]|0;if(exp[i]<act_i)return true;if(exp[i]>act_i)return false}return true}E.is_old_hola_player=function(ver){return ver&&!check_ver(ver,min_hola_player_version)};E.is_old_swf=function(ver){if(!ver)return;for(var i=0,l=swf_versions.length;i<l;i++){var rule=swf_versions[i];var matches=Object.keys(rule.match);function check_player(p){return ver[p]&&check_ver(ver[p],rule.match[p])}if(matches.some(check_player))return!check_ver(ver.patch_version,rule.expected)}};E.is_enabled=function(module){return!!module&&!module.__stub};E.assert_enabled=function(module,message){if(!E.is_enabled(module))throw new Error(message||"module is disabled")};E.log_report=function(opt){var bws=opt.cdn.attached_bws;if(!bws||!opt.id)return;if(!opt.add_unittest&&!opt.add_log&&!opt.load_perf&&!opt.exception)return;var zperr=bws.zone.perr_get();var o={id:opt.id+"_report",info:{only_stats:false},extra:!opt.exception&&opt.cdn&&opt.cdn.attached_stats.get_stats_all(),use_beacon:true,add_log:opt.add_log,analysis_tag:opt.analysis_tag};if(bws.zone.CG("log.full"))o.full=true;if(opt.add_unittest)o.filehead="last test:\n"+bws.unittest.gen_test();if(opt.load_perf){o.filehead=(o.filehead?o.filehead+"\n":"")+"Load perf:\n";o.filehead+=opt.load_perf;o.info.load_perf=true}if(opt.exception)o.info.exception=opt.exception;zperr(o)};E.get_random=function(salt){var key="hola_random_"+salt;var force=+E.get_hola_uri(key);if(force){log.notice("force %s random %s",salt,force);return force}if(E.conf_get("loader.real_random")){var saved=storage.get_int(key);if(saved)return saved;var random=rand.rand("random_from_storage");storage.set(key,random);return random}E.get_random.salt=E.get_random.salt||{};var ip=E.geoip&&E.geoip.ip;if(E.get_random.salt[salt])return E.get_random.salt[salt];if(!ip){log.notice("no ip, using random");if(!E.get_random.salt[salt])E.get_random.salt[salt]=rand.rand("random_by_ip")}else{E.get_random.salt[salt]=parseInt(md5(ip+salt).slice(-4),16)/Math.pow(2,16)}return E.get_random.salt[salt]};E.is_media_element=function(el){return["object","embed","video"].includes(el.tagName.toLowerCase())};E.is_hola_hls_js=function(hls){return!!zutil.get(hls,"streamController.onFragChunkLoaded")};E.get_hls_sc=function(hls){return hls.streamController||hls.mediaController};E.def_hola_hls_config=function(conf_get){var ret={fragLoadingLoopThreshold:1e3,manifestLoadingTimeOut:20*date.ms.SEC,manifestLoadingMaxRetry:4,levelLoadingTimeOut:20*date.ms.SEC,levelLoadingMaxRetry:4};conf_get=conf_get||E.conf_get;assign(ret,conf_get("loader.dailymotion.config")||{});return ret};E.get_size_name=function(width,height){if(!isFinite(width)||!isFinite(height))return"unknown";return Math.round(width/100)*100+"x"+Math.round(height/100)*100};E.get_width_name=function(width){return!isFinite(width)||width<=0?"width_unknown":width<300?"width_300":width<600?"width_600":width<900?"width_900":width<1200?"width_1200":"width_over_1200"};E.get_height_name=function(height){return!isFinite(height)||height<=0?"height_unknown":height<300?"height_300":height<600?"height_600":height<900?"height_900":height<1200?"height_1200":"height_over_1200"};E.referrer_type=function(url,ref,regex){if(!ref)return"none";var url_host=zurl.get_host(url),ref_host=zurl.get_host(ref);if(!url_host||!ref_host)return"invalid";return(regex?regex.test(ref_host):url_host==ref_host)?"internal":"external"};E.data_snapshot=function(data,fields){var past=zutil.clone_deep(data);fields=fields||Object.keys(data);return{diff:function(now){var res=zutil.clone_deep(now);fields.forEach(function(path){var val_past=zutil.get(past,path);var val_now=zutil.get(now,path);var val_res=typeof val_past=="number"&&typeof val_now=="number"?val_now-val_past:val_now;zutil.set(res,path,val_res)});return res}}};E.build_player_caps=function(caps){return assign({save_context:[]},caps)};return E})})();
(function(){var __hola_stub_define,crypto,assert,zerr,vm;var is_node=typeof module=="object"&&module.exports&&module.children;var is_ff_addon=typeof module=="object"&&module.uri&&!module.uri.indexOf("resource://");if(!is_node){if(is_ff_addon)define=require("./require_node.js").define(module,"../");else define=define||self.define;assert=function(){};if(!is_ff_addon&&self.hola&&self.hola.zerr)zerr=self.hola.zerr;else{zerr=function(){console.log.apply(console,arguments)};zerr.perr=zerr}}else{require("./config.js");zerr=require("./zerr.js");crypto=require("crypto");assert=require("assert");vm=require("vm");define=require("./require_node.js").define(module,"../")}define("/util/conv.js",["/util/util.js"],function(zutil){var E={};var has_map=typeof Map=="function"&&Map.prototype.get&&Map.prototype.set;has_map=0;E.cache_str_map_fn=function(fn){var cache=new Map;return function(s){s=""+s;var v=cache.get(s);if(v!==undefined||cache.has(s))return v;cache.set(s,v=fn(s));return v}};E.cache_str_obj_fn=function(fn){var cache={};return function(s){if(s in cache)return cache[s];return cache[s]=fn(s)}};E.cache_str_fn=has_map?E.cache_str_map_fn:E.cache_str_obj_fn;E.cache_str_fn2=function(fn){var cache={};return function(s1,s2){var cache2=cache[s1]=cache[s1]||{};if(s2 in cache2)return cache2[s2];return cache2[s2]=fn(s1,s2)}};E.o=function(oct_str){return parseInt(oct_str,8)};E.md5=function(buf,hash_len,encoding){return crypto.createHash("md5").update(buf,encoding||"utf8").digest("hex").slice(0,hash_len)};E.md5_zero=function(key,hash_len){assert(hash_len<=32,"invalid hash len"+hash_len);if(!key||!key.length)return"0".repeat(hash_len);return E.md5(key,hash_len)};E.md5_etag=function(buf){return E.md5(buf,8)};E.inet_ntoa_t=function(ip){return((ip&4278190080)>>>24)+"."+((ip&16711680)>>>16)+"."+((ip&65280)>>>8)+"."+(ip&255)};E.inet_addr=function(ip){var parts=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(ip);if(parts===null)return null;if(parts[1]>255||parts[2]>255||parts[3]>255||parts[4]>255)return null;return(parts[1]<<24)+(parts[2]<<16)+(parts[3]<<8)+(parts[4]|0)>>>0};function flags_to_str_once(flags,conv){var f='var s = "";\n';f+='if (!flags) return "";\n';for(var i in conv){if(!conv.hasOwnProperty(i))continue;f+="if (flags & "+conv[i]+") "+"{ s += "+JSON.stringify(i.toLowerCase())+'+" ";'+" flags &= ~"+conv[i]+"; }\n"}f+="if (flags && conv.__conv_to_str.err) "+"conv.__conv_to_str.err(flags, conv);\n";f+="return s.slice(0, -1);\n";var func=new Function(["flags","conv"],f);Object.defineProperty(conv,"__conv_to_str",{enumerable:false,writable:true});conv.__conv_to_str=func;func.err=function(flags,conv){zerr.perr("flags_str_invalid","flags "+flags+" "+JSON.stringify(conv).slice(0,30))};return conv.__conv_to_str(flags,conv)}E.flags_to_str=function(flags,conv){if(conv.__conv_to_str)return conv.__conv_to_str(flags,conv);return flags_to_str_once(flags,conv)};function flags_from_str_once(s,conv){var f="var flags = 0, a, i;\n";f+="if (!s) return 0;\n";f+="s = s.toUpperCase();\n";f+='a = s.split(",");\n';f+="for (i=0; i<a.length; i++)\n";f+="{\n";f+="    if (!conv[a[i]])\n";f+="    {\n";f+="        if (flags && conv.__conv_from_str.err) "+"conv.__conv_from_str.err(flags, conv);\n";f+="        return -1;\n";f+="    }\n";f+="    flags |= conv[a[i]];\n";f+="}\n";f+="return flags;\n";var func=new Function(["s","conv"],f);Object.defineProperty(conv,"__conv_from_str",{enumerable:false,writable:true});conv.__conv_from_str=func;func.err=function(s,conv){zerr.perr("flags_str_invalid","flags "+s+" "+JSON.stringify(conv).slice(0,30))};return conv.__conv_from_str(s,conv)}E.flags_from_str=function(s,conv){if(conv.__conv_from_str)return conv.__conv_from_str(s,conv);return flags_from_str_once(s,conv)};E.scale_vals={1e3:[{s:"",n:1},{s:"K",n:1e3},{s:"M",n:1e6},{s:"G",n:1e9},{s:"T",n:1e12},{s:"P",n:1e15}],1024:[{s:"",n:1},{s:"K",n:1024},{s:"M",n:Math.pow(1024,2)},{s:"G",n:Math.pow(1024,3)},{s:"T",n:Math.pow(1024,4)},{s:"P",n:Math.pow(1024,5)}]};E.scaled_number=function(num,opt){opt=opt||{};var sign="",per=opt.per,scale=opt.scale;var base=opt.base==1024?1024:1e3,ratio=opt.ratio||1;function _per(){return per?E.format_per(per):""}if(num<0){sign="-";num=-num}if(num===undefined)return"";if(isNaN(num))return opt.nan||"x";if(num==Infinity)return sign+"∞";var scale_vals=E.scale_vals[base],i=0;if(scale==null)for(;i<scale_vals.length-1&&num>=scale_vals[i+1].n*ratio;i++);else i=scale_vals.findIndex(function(_scale){return _scale.s==scale});if(per=="ms"&&i){per="s";i--;num=num/1e3}scale=scale_vals[i];if(opt.is_scale)return scale.n;num/=scale.n;if(num<.001)return"0"+_per();if(num>=base-1)num=Math.trunc(num);var str=num.toFixed(num<1?3:num<10?2:num<100?1:0);return sign+str.replace(/\.0*$/,"")+(opt.space?" ":"")+scale.s+_per()};E.format_per=function(per){if(!per)return"";switch(per){case"s":case"ms":return per;case"%":case"%%":return"%";default:return"/"+per[0]}};E.parse_function=function(f){var m=/^function\s*([\w$]+)?\s*\(([\s\w$,]*?)(\s*\/\*\*\/)?\)\s*\{\n?([\s\S]*?)\n?\}$/.exec(f);return{name:m[1]||null,args:m[2]?m[2].split(/\s*,\s*/):[],body:m[4]}};function date_stringify(d){return{__ISODate__:d.toISOString()}}E.JSON_stringify=function(obj,opt){var s,prev_date,_date,prev_func,prev_re;var date_class,func_class,re_class;opt=opt||{};if(opt.date)_date=typeof opt.date=="function"?opt.date:date_stringify;if(opt.mongo)_date=date_stringify;if(_date){date_class=opt.vm_context?vm.runInContext("Date",opt.vm_context):Date;prev_date=date_class.prototype.toJSON;date_class.prototype.toJSON=function(){return _date(this)}}if(opt.func){func_class=opt.vm_context?vm.runInContext("Function",opt.vm_context):Function;prev_func=func_class.prototype.toJSON;func_class.prototype.toJSON=function(){return{__Function__:this.toString()}}}if(opt.re){re_class=opt.vm_context?vm.runInContext("RegExp",opt.vm_context):RegExp;prev_re=re_class.prototype.toJSON;Object.defineProperty(re_class.prototype,"toJSON",{value:function(){return{__RegExp__:this.toString()}},writable:true})}try{s=JSON.stringify(obj,opt.replacer,opt.spaces)}finally{if(_date)date_class.prototype.toJSON=prev_date;if(opt.func)func_class.prototype.toJSON=prev_func;if(opt.re)re_class.prototype.toJSON=prev_re}if(opt.mongo)s=s.replace(/\{"__ISODate__":("[0-9TZ:.-]+")\}/g,"ISODate($1)");return s};function parse_leaf(v,opt){opt=Object.assign({date:1,re:1,func:1},opt);if(!v||typeof v!="object"||Object.keys(v).length!=1)return v;if(v.__ISODate__&&opt.date)return new Date(v.__ISODate__);if(v.__Function__&&opt.func){if(vm)return vm.runInThisContext("("+v.__Function__+")");var info=E.parse_function(v.__Function__);return new Function(info.args.join(","),info.body)}if(v.__RegExp__&&opt.re){var parsed=/^\/(.*)\/(\w*)$/.exec(v.__RegExp__);if(!parsed)throw new Error("failed parsing regexp");return new RegExp(parsed[1],parsed[2])}return v}E.JSON_parse=function(s,opt){return JSON.parse(s,function(k,v){return parse_leaf(v,opt)})};E.JSON_parse_obj=function(v,opt){if(!v||typeof v!="object")return v;if(Array.isArray(v)){for(var i=0;i<v.length;i++)v[i]=E.JSON_parse_obj(v[i],opt);return v}var v2=parse_leaf(v,opt);if(v2!==v)return v2;for(var key in v)v[key]=E.JSON_parse_obj(v[key],opt);return v};E.hex2bin=function(hex,opt){var byte_array=opt&&opt.byte_array;var bin=byte_array?new Uint8Array:[];var re=/('.)|([0-9a-f][0-9a-f]?)|\s+|[.-]|(.)/gi;var m,v;for(re.lastIndex=0;m=re.exec(hex);){if(m[1])v=m[1].charCodeAt(1);else if(m[2])v=parseInt(m[2],16);else if(m[3])return null;else continue;bin.push(v)}return bin};E.bin2hex=function(arr){var s="",v,i;for(i=0;i<arr.length;i++){v=(arr[i]&255).toString(16).toUpperCase();s+=(v.length<2?"0":"")+v+" "}return s.trim()};E.tab2sp=function(line){var added=0;return line.replace(/\t/g,function(m,offset,str){var insert=8-(added+offset)%8;added+=insert-1;return" ".repeat(insert)})};return E})})();
(function(){var __hola_stub_define=typeof define==="function"&&typeof hola_ldr_require!=="undefined"&&define;(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define("/svc/cdn/pub/hls.js",[],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Hls=f()}})(function(){var __hola_stub_define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}else{var err=new Error('Uncaught, unspecified "error" event. ('+er+")");err.context=er;throw err}}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1);handler.apply(this,args)}}else if(isObject(handler)){args=Array.prototype.slice.call(arguments,1);listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else if(listeners){while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;else if(evlistener)return evlistener.length}return 0};EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],2:[function(_dereq_,module,exports){var bundleFn=arguments[3];var sources=arguments[4];var cache=arguments[5];var stringify=JSON.stringify;module.exports=function(fn,options){var wkey;var cacheKeys=Object.keys(cache);for(var i=0,l=cacheKeys.length;i<l;i++){var key=cacheKeys[i];var exp=cache[key].exports;if(exp===fn||exp&&exp.default===fn){wkey=key;break}}if(!wkey){wkey=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var wcache={};for(var i=0,l=cacheKeys.length;i<l;i++){var key=cacheKeys[i];wcache[key]=key}sources[wkey]=[Function(["require","module","exports"],"("+fn+")(self)"),wcache]}var skey=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var scache={};scache[wkey]=wkey;sources[skey]=[Function(["require"],"var f = require("+stringify(wkey)+");"+"(f.default ? f.default : f)(self);"),scache];var workerSources={};resolveSources(skey);function resolveSources(key){workerSources[key]=true;for(var depPath in sources[key][1]){var depKey=sources[key][1][depPath];if(!workerSources[depKey]){resolveSources(depKey)}}}var src="("+bundleFn+")({"+Object.keys(workerSources).map(function(key){return stringify(key)+":["+sources[key][0]+","+stringify(sources[key][1])+"]"}).join(",")+"},{},["+stringify(skey)+"])";var URL=window.URL||window.webkitURL||window.mozURL||window.msURL;var blob=new Blob([src],{type:"text/javascript"});if(options&&options.bare){return blob}var workerUrl=URL.createObjectURL(blob);var worker=new Worker(workerUrl);worker.objectURL=workerUrl;return worker}},{}],3:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);var _bufferHelper=_dereq_("../helper/buffer-helper");var _bufferHelper2=_interopRequireDefault(_bufferHelper);var _errors=_dereq_("../errors");var _logger=_dereq_("../utils/logger");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var AbrController=function(_EventHandler){_inherits(AbrController,_EventHandler);function AbrController(hls){_classCallCheck(this,AbrController);var _this=_possibleConstructorReturn(this,(AbrController.__proto__||Object.getPrototypeOf(AbrController)).call(this,hls,_events2.default.FRAG_LOADING,_events2.default.FRAG_LOAD_PROGRESS,_events2.default.FRAG_LOADED,_events2.default.ERROR));_this.lastLoadedFragLevel=0;_this._autoLevelCapping=-1;_this._nextAutoLevel=-1;_this.hls=hls;_this.onCheck=_this.abandonRulesCheck.bind(_this);return _this}_createClass(AbrController,[{key:"destroy",value:function destroy(){this.clearTimer();_eventHandler2.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function onFragLoading(data){if(!this.timer){this.timer=setInterval(this.onCheck,100)}this.fragCurrent=data.frag}},{key:"onFragLoadProgress",value:function onFragLoadProgress(data){var stats=data.stats;if(stats.aborted===undefined&&data.frag.loadCounter===1){this.lastfetchduration=(performance.now()-stats.trequest)/1e3;this.lastbw=stats.loaded*8/this.lastfetchduration}}},{key:"abandonRulesCheck",value:function abandonRulesCheck(){var hls=this.hls,v=hls.media,frag=this.fragCurrent;if(!frag.loader||frag.loader.stats&&frag.loader.stats.aborted){_logger.logger.warn("frag loader destroy or aborted, disarm abandonRulesCheck");this.clearTimer();return}if(v&&(!v.paused||!v.readyState)&&frag.autoLevel&&frag.level){var requestDelay=performance.now()-frag.trequest;if(requestDelay>500*frag.duration){var loadRate=Math.max(1,frag.loaded*1e3/requestDelay);if(frag.expectedLen<frag.loaded){frag.expectedLen=frag.loaded}var pos=v.currentTime;var fragLoadedDelay=(frag.expectedLen-frag.loaded)/loadRate;var bufferStarvationDelay=_bufferHelper2.default.bufferInfo(v,pos,hls.config.maxBufferHole).end-pos;if(bufferStarvationDelay<2*frag.duration&&fragLoadedDelay>bufferStarvationDelay){var fragLevelNextLoadedDelay=void 0,nextLoadLevel=void 0;for(nextLoadLevel=frag.level-1;nextLoadLevel>=0;nextLoadLevel--){fragLevelNextLoadedDelay=frag.duration*hls.levels[nextLoadLevel].bitrate/(8*.8*loadRate);_logger.logger.log("fragLoadedDelay/bufferStarvationDelay/fragLevelNextLoadedDelay["+nextLoadLevel+"] :"+fragLoadedDelay.toFixed(1)+"/"+bufferStarvationDelay.toFixed(1)+"/"+fragLevelNextLoadedDelay.toFixed(1));if(fragLevelNextLoadedDelay<bufferStarvationDelay){break}}if(fragLevelNextLoadedDelay<fragLoadedDelay){nextLoadLevel=Math.max(0,nextLoadLevel);hls.nextLoadLevel=nextLoadLevel;_logger.logger.warn("loading too slow, abort fragment loading and switch to level "+nextLoadLevel);frag.loader.abort();this.clearTimer();hls.trigger(_events2.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:frag})}}}}}},{key:"onFragLoaded",value:function onFragLoaded(data){this.clearTimer();this.lastLoadedFragLevel=data.frag.level;this._nextAutoLevel=-1}},{key:"onError",value:function onError(data){switch(data.details){case _errors.ErrorDetails.FRAG_LOAD_ERROR:case _errors.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break;default:break}}},{key:"clearTimer",value:function clearTimer(){if(this.timer){clearInterval(this.timer);this.timer=null}}},{key:"autoLevelCapping",get:function get(){return this._autoLevelCapping},set:function set(newLevel){this._autoLevelCapping=newLevel}},{key:"nextAutoLevel",get:function get(){var lastbw=this.lastbw,hls=this.hls,adjustedbw,i,maxAutoLevel;if(this._autoLevelCapping===-1&&hls.levels&&hls.levels.length){maxAutoLevel=hls.levels.length-1}else{maxAutoLevel=this._autoLevelCapping}if(this._nextAutoLevel!==-1){return Math.min(this._nextAutoLevel,maxAutoLevel)}for(i=0;i<=maxAutoLevel;i++){if(i<=this.lastLoadedFragLevel){adjustedbw=.8*lastbw}else{adjustedbw=.7*lastbw}if(adjustedbw<hls.levels[i].bitrate){return Math.max(0,i-1)}}return i-1},set:function set(nextLevel){this._nextAutoLevel=nextLevel}}]);return AbrController}(_eventHandler2.default);exports.default=AbrController},{"../errors":21,"../event-handler":22,"../events":23,"../helper/buffer-helper":25,"../utils/logger":39}],4:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);var _logger=_dereq_("../utils/logger");var _errors=_dereq_("../errors");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var BufferController=function(_EventHandler){_inherits(BufferController,_EventHandler);function BufferController(hls){_classCallCheck(this,BufferController);var _this=_possibleConstructorReturn(this,(BufferController.__proto__||Object.getPrototypeOf(BufferController)).call(this,hls,_events2.default.MEDIA_ATTACHING,_events2.default.MEDIA_DETACHING,_events2.default.BUFFER_RESET,_events2.default.BUFFER_APPENDING,_events2.default.BUFFER_CODECS,_events2.default.BUFFER_EOS,_events2.default.BUFFER_FLUSHING,_events2.default.FRAG_APPENDING,_events2.default.LEVEL_UPDATED));_this._msDuration=null;_this._levelDuration=null;_this.onsbue=_this.onSBUpdateEnd.bind(_this);_this.onsbe=_this.onSBUpdateError.bind(_this);return _this}_createClass(BufferController,[{key:"destroy",value:function destroy(){_eventHandler2.default.prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function onMediaAttaching(data){var media=this.media=data.media;if(media){var ms=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this);this.onmse=this.onMediaSourceEnded.bind(this);this.onmsc=this.onMediaSourceClose.bind(this);ms.addEventListener("sourceopen",this.onmso);ms.addEventListener("sourceended",this.onmse);ms.addEventListener("sourceclose",this.onmsc);var url=URL.createObjectURL(ms);_logger.logger.log("set object url "+url);media.src=url}}},{key:"onMediaDetaching",value:function onMediaDetaching(){_logger.logger.log("media source detaching");var ms=this.mediaSource;if(ms){if(ms.readyState==="open"){try{ms.endOfStream()}catch(err){_logger.logger.warn("onMediaDetaching:"+err.message+" while calling endOfStream")}}ms.removeEventListener("sourceopen",this.onmso);ms.removeEventListener("sourceended",this.onmse);ms.removeEventListener("sourceclose",this.onmsc);try{this.media.src="";this.media.removeAttribute("src")}catch(err){_logger.logger.warn("onMediaDetaching:"+err.message+" while unlinking video.src")}this.mediaSource=null;this.media=null;this.pendingTracks=null;this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.onmso=this.onmse=this.onmsc=null;this.waitForAppended=false;this.hls.trigger(_events2.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function onMediaSourceOpen(){_logger.logger.log("media source opened");this.hls.trigger(_events2.default.MEDIA_ATTACHED,{media:this.media});this.mediaSource.removeEventListener("sourceopen",this.onmso);var pendingTracks=this.pendingTracks;if(pendingTracks){this.onBufferCodecs(pendingTracks);this.pendingTracks=null;this.doAppending()}}},{key:"onMediaSourceClose",value:function onMediaSourceClose(){_logger.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function onMediaSourceEnded(){_logger.logger.log("media source ended")}},{key:"onFragAppending",value:function onFragAppending(){var segments=this.segments||[];if(!segments.length){this.hls.trigger(_events2.default.FRAG_APPENDED)}else{this.waitForAppended=true}}},{key:"isSbUpdating",value:function isSbUpdating(){var sourceBuffer=this.sourceBuffer;if(sourceBuffer){for(var type in sourceBuffer){if(sourceBuffer[type].updating){return true}}}}},{key:"dump",value:function dump(video){var str="",b=video.buffered,len=b.length;for(var i=0;i<len;i++){str+="["+b.start(i)+","+b.end(i)+"]"}return str}},{key:"clear",value:function clear(video,keepSec){var st,sb=this.sourceBuffer,end=video.currentTime-keepSec;var b=video.buffered,len=b.length;if(end<=0||sb.audio&&sb.audio.updating||sb.video&&sb.video.updating){return}st=b.start(0);for(var i=1;i<len;i++){st=Math.min(st,b.start(i))}if(st&&st<end){_logger.logger.log("video buffered: "+this.dump(this.media)+" removing: ["+st+","+end+"]");if(sb.audio){sb.audio.remove(st,end)}if(sb.video){sb.video.remove(st,end)}}}},{key:"onSBUpdateEnd",value:function onSBUpdateEnd(){if(this._needsFlush){this.doFlush()}if(this._needsEos){this.onBufferEos()}this.updateMediaElementDuration();this.doAppending();if(this.waitForAppended&&!this.segments.length&&!this.isSbUpdating()){this.hls.trigger(_events2.default.FRAG_APPENDED);this.waitForAppended=false}var keep=void 0;if((keep=this.hls.config.keepBuffered)&&this.media){try{this.clear(this.media,keep)}catch(err){_logger.logger.log(err)}}}},{key:"onSBUpdateError",value:function onSBUpdateError(event){var err=this.lastSegment?"last segment type:"+this.lastSegment.type+",size:"+this.lastSegment.data.length+")":"";_logger.logger.error("onSBUpdateError: sourceBuffer error:"+event+" "+err);this.lastSegment=undefined;this.printDump();this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:false})}},{key:"onBufferReset",value:function onBufferReset(){var sourceBuffer=this.sourceBuffer,segments=this.segments||[];_logger.logger.log("onBufferReset: pending segments:"+segments.length);for(var type in sourceBuffer){var sb=sourceBuffer[type];try{this.mediaSource.removeSourceBuffer(sb);sb.removeEventListener("updateend",this.onsbue);sb.removeEventListener("error",this.onsbe)}catch(err){}}this.sourceBuffer={};this.flushRange=[];this.appended=0;this.dumpSegments=undefined}},{key:"onBufferCodecs",value:function onBufferCodecs(tracks){var mediaSource=this.mediaSource;if(!mediaSource||mediaSource.readyState!=="open"){this.pendingTracks=tracks;return}var sourceBuffer=this.sourceBuffer;for(var trackName in tracks){if(!sourceBuffer[trackName]){var track=tracks[trackName];var codec=track.levelCodec||track.codec;var mimeType=track.container+";codecs="+codec;_logger.logger.log("creating sourceBuffer with mimeType:"+mimeType);try{var sb=sourceBuffer[trackName]=mediaSource.addSourceBuffer(mimeType);sb.addEventListener("updateend",this.onsbue);sb.addEventListener("error",this.onsbe)}catch(err){_logger.logger.error("error while trying to add sourceBuffer:"+err.message);this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:false,err:err,mimeType:mimeType})}}}}},{key:"onBufferAppending",value:function onBufferAppending(data){if(!this.segments){this.segments=[data]}else{this.segments.push(data)}this.doAppending()}},{key:"onBufferAppendFail",value:function onBufferAppendFail(data){var err=this.lastSegment?"last segment type:"+this.lastSegment.type+",size:"+this.lastSegment.data.length+")":"";_logger.logger.error("onBufferAppendFail:sourceBuffer error:"+data.event+" "+err);this.lastSegment=undefined;this.printDump();this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:false,frag:this.fragCurrent})}},{key:"onBufferEos",value:function onBufferEos(){var sb=this.sourceBuffer,mediaSource=this.mediaSource;if(!mediaSource||mediaSource.readyState!=="open"){return}if(!(sb.audio&&sb.audio.updating||sb.video&&sb.video.updating)){_logger.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");mediaSource.endOfStream();this._needsEos=false}else{this._needsEos=true}}},{key:"onBufferFlushing",value:function onBufferFlushing(data){this.flushRange.push({start:data.startOffset,end:data.endOffset});this.flushBufferCounter=0;this.doFlush()}},{key:"onLevelUpdated",value:function onLevelUpdated(event){var details=event.details;if(details.fragments.length===0){return}this._levelDuration=details.totalduration+details.fragments[0].start;this.updateMediaElementDuration()}},{key:"updateMediaElementDuration",value:function updateMediaElementDuration(){var media=this.media,mediaSource=this.mediaSource,levelDuration=this._levelDuration;if(levelDuration===null||!media||!mediaSource||media.readyState===0||mediaSource.readyState!=="open"){return}for(var i=0;i<mediaSource.sourceBuffers.length;i++){if(mediaSource.sourceBuffers[i].updating){return}}if(this._msDuration===null){this._msDuration=mediaSource.duration}var duration=media.duration;if(levelDuration>this._msDuration&&levelDuration>duration||duration===Infinity||isNaN(duration)){_logger.logger.log("Updating mediasource duration to "+levelDuration.toFixed(3));this._msDuration=mediaSource.duration=levelDuration}}},{key:"doFlush",value:function doFlush(){while(this.flushRange.length){var range=this.flushRange[0];if(this.flushBuffer(range.start,range.end)){this.flushRange.shift();this.flushBufferCounter=0}else{this._needsFlush=true;return}}if(this.flushRange.length===0){this._needsFlush=false;var appended=0;var sourceBuffer=this.sourceBuffer;for(var type in sourceBuffer){appended+=sourceBuffer[type].buffered.length}this.appended=appended;this.hls.trigger(_events2.default.BUFFER_FLUSHED)}}},{key:"dumpSegment",value:function dumpSegment(segment){var i=void 0,len=segment.data.length;var info="queue:"+this.segments.length+"type:"+segment.type+",size:"+len+",buf:[";for(i=0,len=Math.min(len,10);i<len;i++){if(i){info+=","}info+=segment.data[i]}info+="..]";if(!this.dumpSegments){this.dumpSegments=[info]}else{this.dumpSegments.push(info)}if(this.dumpSegments.length>10){this.dumpSegments.shift()}}},{key:"printDump",value:function printDump(){if(this.dumpSegments&&this.dumpSegments.length){_logger.logger.error(this.dumpSegments.join("|"))}}},{key:"doAppending",value:function doAppending(){var hls=this.hls,sourceBuffer=this.sourceBuffer,segments=this.segments;if(sourceBuffer&&Object.keys(sourceBuffer).length){if(!this.media){return}if(this.media.error){this.segments=[];_logger.logger.error("trying to append although a media error occured, flush segment and abort");return}if(this.isSbUpdating()){return}if(segments.length){var segment=segments.shift();this.dumpSegment(segment);try{if(sourceBuffer[segment.type]){this.lastSegment=segment;sourceBuffer[segment.type].appendBuffer(segment.data);this.appendError=0;this.appended++}else{this.onSBUpdateEnd()}}catch(err){_logger.logger.error("error while trying to append buffer:"+err.message);segments.unshift(segment);var event={type:_errors.ErrorTypes.MEDIA_ERROR};if(err.code!==22){if(this.appendError){this.appendError++}else{this.appendError=1}event.details=_errors.ErrorDetails.BUFFER_APPEND_ERROR;event.frag=this.fragCurrent;event.reason=err.message+" (type:"+segment.type+",size:"+segment.data.length+")";if(this.appendError>hls.config.appendErrorMaxRetry){_logger.logger.log("fail "+hls.config.appendErrorMaxRetry+" times to append segment in sourceBuffer");this.segments=[];event.fatal=true;hls.trigger(_events2.default.ERROR,event);return}else{event.fatal=false;hls.trigger(_events2.default.ERROR,event)}}else{this.segments=[];event.details=_errors.ErrorDetails.BUFFER_FULL_ERROR;hls.trigger(_events2.default.ERROR,event)}}}}}},{key:"flushBuffer",value:function flushBuffer(startOffset,endOffset){var sb,i,bufStart,bufEnd,flushStart,flushEnd;if(this.flushBufferCounter<this.appended&&this.sourceBuffer){for(var type in this.sourceBuffer){sb=this.sourceBuffer[type];if(!sb.updating){for(i=0;i<sb.buffered.length;i++){bufStart=sb.buffered.start(i);bufEnd=sb.buffered.end(i);if(navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&endOffset===Number.POSITIVE_INFINITY){flushStart=startOffset;flushEnd=endOffset}else{flushStart=Math.max(bufStart,startOffset);flushEnd=Math.min(bufEnd,endOffset)}if(Math.min(flushEnd,bufEnd)-flushStart>.5){this.flushBufferCounter++;_logger.logger.log("flush "+type+" ["+flushStart+","+flushEnd+"], of ["+bufStart+","+bufEnd+"], pos:"+this.media.currentTime);sb.remove(flushStart,flushEnd);return false}}}else{_logger.logger.warn("cannot flush, sb updating in progress");return false}}}else{_logger.logger.warn("abort flushing too many retries")}_logger.logger.log("buffer flushed");return true}}]);return BufferController}(_eventHandler2.default);exports.default=BufferController},{"../errors":21,"../event-handler":22,"../events":23,"../utils/logger":39}],5:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var CapLevelController=function(_EventHandler){_inherits(CapLevelController,_EventHandler);function CapLevelController(hls){_classCallCheck(this,CapLevelController);return _possibleConstructorReturn(this,(CapLevelController.__proto__||Object.getPrototypeOf(CapLevelController)).call(this,hls,_events2.default.FPS_DROP_LEVEL_CAPPING,_events2.default.MEDIA_ATTACHING,_events2.default.MANIFEST_PARSED))}_createClass(CapLevelController,[{key:"destroy",value:function destroy(){if(this.hls.config.capLevelToPlayerSize){this.media=this.restrictedLevels=null;this.autoLevelCapping=Number.POSITIVE_INFINITY;if(this.timer){this.timer=clearInterval(this.timer)}}}},{key:"onFpsDropLevelCapping",value:function onFpsDropLevelCapping(data){if(!this.restrictedLevels){this.restrictedLevels=[]}if(!this.isLevelRestricted(data.droppedLevel)){this.restrictedLevels.push(data.droppedLevel)}}},{key:"onMediaAttaching",value:function onMediaAttaching(data){this.media=data.media instanceof HTMLVideoElement?data.media:null}},{key:"onManifestParsed",value:function onManifestParsed(data){if(this.hls.config.capLevelToPlayerSize){this.autoLevelCapping=Number.POSITIVE_INFINITY;this.levels=data.levels;this.hls.firstLevel=this.getMaxLevel(data.firstLevel);clearInterval(this.timer);this.timer=setInterval(this.detectPlayerSize.bind(this),1e3);this.detectPlayerSize()}}},{key:"detectPlayerSize",value:function detectPlayerSize(){if(this.media){var levelsLength=this.levels?this.levels.length:0;if(levelsLength){this.hls.autoLevelCapping=this.getMaxLevel(levelsLength-1);if(this.hls.autoLevelCapping>this.autoLevelCapping){this.hls.streamController.nextLevelSwitch()}this.autoLevelCapping=this.hls.autoLevelCapping}}}},{key:"getMaxLevel",value:function getMaxLevel(capLevelIndex){var result=0,i=void 0,level=void 0,mWidth=this.mediaWidth,mHeight=this.mediaHeight,lWidth=0,lHeight=0;for(i=0;i<=capLevelIndex;i++){level=this.levels[i];if(this.isLevelRestricted(i)){break}result=i;lWidth=level.width;lHeight=level.height;if(mWidth<=lWidth||mHeight<=lHeight){break}}return result}},{key:"isLevelRestricted",value:function isLevelRestricted(level){return this.restrictedLevels&&this.restrictedLevels.indexOf(level)!==-1?true:false}},{key:"contentScaleFactor",get:function get(){var pixelRatio=1;try{pixelRatio=window.devicePixelRatio}catch(e){}return pixelRatio}},{key:"mediaWidth",get:function get(){var width=void 0;if(this.media){width=this.media.width||this.media.clientWidth||this.media.offsetWidth;width*=this.contentScaleFactor}return width}},{key:"mediaHeight",get:function get(){var height=void 0;if(this.media){height=this.media.height||this.media.clientHeight||this.media.offsetHeight;height*=this.contentScaleFactor}return height}}]);return CapLevelController}(_eventHandler2.default);exports.default=CapLevelController},{"../event-handler":22,"../events":23}],6:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);var _logger=_dereq_("../utils/logger");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{
"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var FPSController=function(_EventHandler){_inherits(FPSController,_EventHandler);function FPSController(hls){_classCallCheck(this,FPSController);return _possibleConstructorReturn(this,(FPSController.__proto__||Object.getPrototypeOf(FPSController)).call(this,hls,_events2.default.MEDIA_ATTACHING))}_createClass(FPSController,[{key:"destroy",value:function destroy(){if(this.timer){clearInterval(this.timer)}this.isVideoPlaybackQualityAvailable=false}},{key:"onMediaAttaching",value:function onMediaAttaching(data){if(this.hls.config.capLevelOnFPSDrop){this.video=data.media instanceof HTMLVideoElement?data.media:null;if(typeof this.video.getVideoPlaybackQuality==="function"){this.isVideoPlaybackQualityAvailable=true}clearInterval(this.timer);this.timer=setInterval(this.checkFPSInterval.bind(this),this.hls.config.fpsDroppedMonitoringPeriod)}}},{key:"checkFPS",value:function checkFPS(video,decodedFrames,droppedFrames){var currentTime=performance.now();if(decodedFrames){if(this.lastTime){var currentPeriod=currentTime-this.lastTime,currentDropped=droppedFrames-this.lastDroppedFrames,currentDecoded=decodedFrames-this.lastDecodedFrames,droppedFPS=1e3*currentDropped/currentPeriod;this.hls.trigger(_events2.default.FPS_DROP,{currentDropped:currentDropped,currentDecoded:currentDecoded,totalDroppedFrames:droppedFrames});if(droppedFPS>0){if(currentDropped>this.hls.config.fpsDroppedMonitoringThreshold*currentDecoded){var currentLevel=this.hls.currentLevel;_logger.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+currentLevel);if(currentLevel>0&&(this.hls.autoLevelCapping===-1||this.hls.autoLevelCapping>=currentLevel)){currentLevel=currentLevel-1;this.hls.trigger(_events2.default.FPS_DROP_LEVEL_CAPPING,{level:currentLevel,droppedLevel:this.hls.currentLevel});this.hls.autoLevelCapping=currentLevel;this.hls.streamController.nextLevelSwitch()}}}}this.lastTime=currentTime;this.lastDroppedFrames=droppedFrames;this.lastDecodedFrames=decodedFrames}}},{key:"checkFPSInterval",value:function checkFPSInterval(){if(this.video){if(this.isVideoPlaybackQualityAvailable){var videoPlaybackQuality=this.video.getVideoPlaybackQuality();this.checkFPS(this.video,videoPlaybackQuality.totalVideoFrames,videoPlaybackQuality.droppedVideoFrames)}else{this.checkFPS(this.video,this.video.webkitDecodedFrameCount,this.video.webkitDroppedFrameCount)}}}}]);return FPSController}(_eventHandler2.default);exports.default=FPSController},{"../event-handler":22,"../events":23,"../utils/logger":39}],7:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);var _logger=_dereq_("../utils/logger");var _errors=_dereq_("../errors");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var LevelController=function(_EventHandler){_inherits(LevelController,_EventHandler);function LevelController(hls){_classCallCheck(this,LevelController);var _this=_possibleConstructorReturn(this,(LevelController.__proto__||Object.getPrototypeOf(LevelController)).call(this,hls,_events2.default.MANIFEST_LOADED,_events2.default.LEVEL_LOADED,_events2.default.ERROR));_this.ontick=_this.tick.bind(_this);_this._manualLevel=_this._autoLevelCapping=-1;return _this}_createClass(LevelController,[{key:"destroy",value:function destroy(){if(this.timer){clearTimeout(this.timer);this.timer=null}this._manualLevel=-1}},{key:"startLoad",value:function startLoad(){this.canload=true;var levels=this._levels;if(levels){levels.forEach(function(level){level.loadError=0;var levelDetails=level.details;if(levelDetails&&levelDetails.live){level.details=undefined}})}if(this.timer){this.tick()}}},{key:"stopLoad",value:function stopLoad(){this.canload=false}},{key:"onManifestLoaded",value:function onManifestLoaded(data){var levels0=[],levels=[],bitrateStart,bitrateSet={},videoCodecFound=false,audioCodecFound=false,hls=this.hls,i,brokenmp4inmp3=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),checkSupported=function checkSupported(type,codec){return MediaSource.isTypeSupported(type+"/mp4;codecs="+codec)};data.levels.forEach(function(level){if(level.videoCodec){videoCodecFound=true}if(brokenmp4inmp3&&level.audioCodec&&level.audioCodec.indexOf("mp4a.40.34")!==-1){level.audioCodec=undefined}if(level.audioCodec||level.attrs&&level.attrs.AUDIO){audioCodecFound=true}var redundantLevelId=bitrateSet[level.bitrate];if(redundantLevelId===undefined){bitrateSet[level.bitrate]=levels0.length;level.url=[level.url];level.urlId=0;levels0.push(level)}else{levels0[redundantLevelId].url.push(level.url)}});if(videoCodecFound&&audioCodecFound){levels0.forEach(function(level){if(level.videoCodec){levels.push(level)}})}else{levels=levels0}levels=levels.filter(function(level){var audioCodec=level.audioCodec,videoCodec=level.videoCodec;return(!audioCodec||checkSupported("audio",audioCodec))&&(!videoCodec||checkSupported("video",videoCodec))});if(levels.length){bitrateStart=levels[0].bitrate;levels.sort(function(a,b){return a.bitrate-b.bitrate});this._levels=levels;for(i=0;i<levels.length;i++){if(levels[i].bitrate===bitrateStart){this._firstLevel=i;_logger.logger.log("manifest loaded,"+levels.length+" level(s) found, first bitrate:"+bitrateStart);break}}hls.trigger(_events2.default.MANIFEST_PARSED,{levels:this._levels,firstLevel:this._firstLevel,stats:data.stats})}else{hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:true,url:hls.url,reason:"no level with compatible codecs found in manifest"})}return}},{key:"setLevelInternal",value:function setLevelInternal(newLevel){var levels=this._levels;if(newLevel>=0&&newLevel<levels.length){if(this.timer){clearTimeout(this.timer);this.timer=null}if(this._level!==newLevel){_logger.logger.log("switching to level "+newLevel);this._level=newLevel;this.hls.trigger(_events2.default.LEVEL_SWITCH,{level:newLevel})}var level=levels[newLevel];if(!level.details||level.details.live===true){_logger.logger.log("(re)loading playlist for level "+newLevel);var urlId=level.urlId;this.hls.trigger(_events2.default.LEVEL_LOADING,{url:level.url[urlId],level:newLevel,id:urlId})}}else{this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.OTHER_ERROR,details:_errors.ErrorDetails.LEVEL_SWITCH_ERROR,level:newLevel,fatal:false,reason:"invalid level idx"})}}},{key:"onError",value:function onError(data){if(data.fatal){return}var details=data.details,hls=this.hls,levelId=void 0,level=void 0,levelError=false;switch(details){case _errors.ErrorDetails.FRAG_LOAD_ERROR:case _errors.ErrorDetails.FRAG_LOAD_TIMEOUT:case _errors.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case _errors.ErrorDetails.KEY_LOAD_ERROR:case _errors.ErrorDetails.KEY_LOAD_TIMEOUT:levelId=data.frag.level;break;case _errors.ErrorDetails.LEVEL_LOAD_ERROR:case _errors.ErrorDetails.LEVEL_LOAD_TIMEOUT:levelId=data.level;levelError=true;break;default:break}if(levelId!==undefined){level=this._levels[levelId];if(level.urlId<level.url.length-1){level.urlId++;level.details=undefined;_logger.logger.warn("level controller,"+details+" for level "+levelId+": switching to redundant stream id "+level.urlId)}else{var recoverable=this._manualLevel===-1&&levelId;if(recoverable){_logger.logger.warn("level controller,"+details+": emergency switch-down for next fragment");hls.abrController.nextAutoLevel=0}else if(level&&level.details&&level.details.live){_logger.logger.warn("level controller,"+details+" on live stream, discard");if(levelError){this._level=undefined}}else if(details!==_errors.ErrorDetails.FRAG_LOAD_ERROR&&details!==_errors.ErrorDetails.FRAG_LOAD_TIMEOUT){_logger.logger.error("cannot recover "+details+" error");this._level=undefined;if(this.timer){clearTimeout(this.timer);this.timer=null}data.fatal=true;hls.trigger(_events2.default.ERROR,data)}}}}},{key:"onLevelLoaded",value:function onLevelLoaded(data){if(data.level===this._level){var newDetails=data.details;if(newDetails.live){var reloadInterval=1e3*(newDetails.averagetargetduration?newDetails.averagetargetduration:newDetails.targetduration),curLevel=this._levels[data.level],curDetails=curLevel.details;if(curDetails&&newDetails.endSN===curDetails.endSN){reloadInterval/=2;_logger.logger.log("same live playlist, reload twice faster")}reloadInterval-=performance.now()-data.stats.trequest;reloadInterval=Math.max(1e3,Math.round(reloadInterval));_logger.logger.log("live playlist, reload in "+reloadInterval+" ms");this.timer=setTimeout(this.ontick,reloadInterval)}else{this.timer=null}}}},{key:"tick",value:function tick(){var levelId=this._level;if(levelId!==undefined&&this.canload){var level=this._levels[levelId],urlId=level.urlId;this.hls.trigger(_events2.default.LEVEL_LOADING,{url:level.url[urlId],level:levelId,id:urlId})}}},{key:"levels",get:function get(){return this._levels}},{key:"level",get:function get(){return this._level},set:function set(newLevel){var levels=this._levels;if(levels&&levels.length>newLevel){if(this._level!==newLevel||levels[newLevel].details===undefined){this.setLevelInternal(newLevel)}}}},{key:"manualLevel",get:function get(){return this._manualLevel},set:function set(newLevel){this._manualLevel=newLevel;if(this._startLevel===undefined){this._startLevel=newLevel}if(newLevel!==-1){this.level=newLevel}}},{key:"firstLevel",get:function get(){return this._firstLevel},set:function set(newLevel){this._firstLevel=newLevel}},{key:"startLevel",get:function get(){return this._startLevel===undefined?this._firstLevel:this._startLevel},set:function set(newLevel){this._startLevel=newLevel}},{key:"nextLoadLevel",get:function get(){if(this._manualLevel!==-1){return this._manualLevel}else{return this.hls.abrController.nextAutoLevel}},set:function set(nextLevel){this.level=nextLevel;if(this._manualLevel===-1){this.hls.abrController.nextAutoLevel=nextLevel}}}]);return LevelController}(_eventHandler2.default);exports.default=LevelController},{"../errors":21,"../event-handler":22,"../events":23,"../utils/logger":39}],8:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _demuxer=_dereq_("../demux/demuxer");var _demuxer2=_interopRequireDefault(_demuxer);var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);var _logger=_dereq_("../utils/logger");var _binarySearch=_dereq_("../utils/binary-search");var _binarySearch2=_interopRequireDefault(_binarySearch);var _bufferHelper=_dereq_("../helper/buffer-helper");var _bufferHelper2=_interopRequireDefault(_bufferHelper);var _levelHelper=_dereq_("../helper/level-helper");var _levelHelper2=_interopRequireDefault(_levelHelper);var _errors=_dereq_("../errors");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var State={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR"};var StreamController=function(_EventHandler){_inherits(StreamController,_EventHandler);function StreamController(hls){_classCallCheck(this,StreamController);var _this=_possibleConstructorReturn(this,(StreamController.__proto__||Object.getPrototypeOf(StreamController)).call(this,hls,_events2.default.MEDIA_ATTACHED,_events2.default.MEDIA_DETACHING,_events2.default.MANIFEST_LOADING,_events2.default.MANIFEST_PARSED,_events2.default.LEVEL_LOADED,_events2.default.LEVEL_PTS_UPDATED,_events2.default.KEY_LOADED,_events2.default.FRAG_CHUNK_LOADED,_events2.default.FRAG_LOADED,_events2.default.FRAG_LOAD_EMERGENCY_ABORTED,_events2.default.FRAG_PARSING_INIT_SEGMENT,_events2.default.FRAG_PARSING_DATA,_events2.default.FRAG_PARSED,_events2.default.FRAG_APPENDED,_events2.default.ERROR,_events2.default.BUFFER_FLUSHED,_events2.default.DEMUXER_QUEUE_EMPTY));_this.config=hls.config;_this.audioCodecSwap=false;_this.ticks=0;_this.ontick=_this.tick.bind(_this);_this.noMediaCount=0;return _this}_createClass(StreamController,[{key:"destroy",value:function destroy(){this.stopLoad();if(this.timer){clearInterval(this.timer);this.timer=null}_eventHandler2.default.prototype.destroy.call(this);this.state=State.STOPPED}},{key:"startLoad",value:function startLoad(){var startPosition=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(this.levels){var media=this.media,lastCurrentTime=this.lastCurrentTime;this.stopLoad();if(!this.demuxer){this.demuxer=new _demuxer2.default(this.hls);this.fragParsing=null}if(!this.timer){this.timer=setInterval(this.ontick,100)}this.level=-1;this.fragLoadError=0;if(media&&lastCurrentTime>0){_logger.logger.log("configure startPosition @"+lastCurrentTime);if(!this.lastPaused){_logger.logger.log("resuming video");media.play()}this.state=State.IDLE}else{this.lastCurrentTime=this.startPosition?this.startPosition:startPosition;_logger.logger.log("configure lastCurrentTime @"+this.lastCurrentTime+" start:"+this.startPosition+","+startPosition);this.state=State.STARTING}this.nextLoadPosition=this.startPosition=this.lastCurrentTime;this.tick()}else{_logger.logger.warn("cannot start loading as manifest not parsed yet");this.state=State.STOPPED}}},{key:"onDemuxerQueueEmpty",value:function onDemuxerQueueEmpty(){this.fragParsing=null}},{key:"stopLoad",value:function stopLoad(){var frag=this.fragCurrent;if(frag){if(frag.loader){frag.loader.abort()}this.fragCurrent=null}this.fragPrevious=null;if(this.state===State.PARSING&&this.demuxer&&this.config.enableWorker){this.fragParsing=frag;this.demuxer.waitQueue()}this.state=State.STOPPED}},{key:"tick",value:function tick(){this.ticks++;if(this.ticks===1){this.doTick();if(this.ticks>1){setTimeout(this.tick,1)}this.ticks=0}}},{key:"doTick",value:function doTick(){switch(this.state){case State.STARTING:var hls=this.hls;var startLevel=hls.startLevel;if(startLevel===-1){startLevel=0}this.level=hls.nextLoadLevel=startLevel;this.state=State.WAITING_LEVEL;this.loadedmetadata=false;break;case State.IDLE:if(!this.media){if(this.noMediaCount++%20===0){var media=this.hls.bufferController.media||{};var ms=this.hls.bufferController.mediaSource||{};_logger.logger.log("no media "+media+" src="+media.src+" ms_state="+ms.readyState)}}else{if(this.noMediaCount){_logger.logger.log("media is set to "+this.media.src)}this.noMediaCount=0}if(!this._doTickIdle()){return}break;case State.WAITING_LEVEL:var level=this.levels[this.level];if(level&&level.details){this.state=State.IDLE}break;case State.FRAG_LOADING:try{if(this.levels[this.level].details.live&&this.fragCurrent.sn<this.levels[this.level].details.startSN){_logger.logger.log("live playlist slided forward loading segments: reload");this.state=State.IDLE}}catch(e){}break;case State.FRAG_LOADING_WAITING_RETRY:var now=performance.now();var retryDate=this.retryDate;if(!retryDate||now>=retryDate||this.media&&this.media.seeking){_logger.logger.log("mediaController: retryDate reached, switch back to IDLE state");this.state=State.IDLE}break;case State.ERROR:case State.PAUSED:case State.STOPPED:case State.PARSING:case State.PARSED:case State.ENDED:break;default:break}this._checkBuffer();this._checkFragmentChanged()}},{key:"_doTickIdle",value:function _doTickIdle(){var hls=this.hls,config=hls.config;if(this.levelLastLoaded!==undefined&&!this.media&&(this.startFragRequested||!config.startFragPrefetch)){return true}var pos=void 0;if(this.loadedmetadata){pos=this.media.currentTime}else{pos=this.nextLoadPosition}var level=hls.nextLoadLevel;var maxBufLen=void 0;if(this.levels[level].hasOwnProperty("bitrate")){maxBufLen=Math.max(8*config.maxBufferSize/this.levels[level].bitrate,config.maxBufferLength);maxBufLen=Math.min(maxBufLen,config.maxMaxBufferLength)}else{maxBufLen=config.maxBufferLength}var bufferInfo=_bufferHelper2.default.bufferInfo(this.media,pos,config.maxBufferHole),bufferLen=bufferInfo.len;if(bufferLen>=maxBufLen){return true}_logger.logger.trace("buffer length of "+bufferLen.toFixed(3)+" is below max of "+maxBufLen.toFixed(3)+". checking for more payload ...");this.level=hls.nextLoadLevel=level;var levelDetails=this.levels[level].details;if(typeof levelDetails==="undefined"||levelDetails.live&&this.levelLastLoaded!==level){this.state=State.WAITING_LEVEL;return true}return this._fetchPayloadOrEos({pos:pos,bufferInfo:bufferInfo,levelDetails:levelDetails})}},{key:"_fetchPayloadOrEos",value:function _fetchPayloadOrEos(_ref){var pos=_ref.pos,bufferInfo=_ref.bufferInfo,levelDetails=_ref.levelDetails;var fragPrevious=this.fragPrevious,level=this.level,fragments=levelDetails.fragments,fragLen=fragments.length;if(fragLen===0){return false}var start=fragments[0].start,end=fragments[fragLen-1].start+fragments[fragLen-1].duration,bufferEnd=bufferInfo.end,frag=void 0;if(levelDetails.live){frag=this._ensureFragmentAtLivePoint({levelDetails:levelDetails,bufferEnd:bufferEnd,start:start,end:end,fragPrevious:fragPrevious,fragments:fragments,fragLen:fragLen});if(frag===null){return false}}else{if(bufferEnd<start){frag=fragments[0]}}if(!frag){frag=this._findFragment({start:start,fragPrevious:fragPrevious,fragLen:fragLen,fragments:fragments,bufferEnd:bufferEnd,end:end,levelDetails:levelDetails})}if(frag){return this._loadFragmentOrKey({frag:frag,level:level,levelDetails:levelDetails,pos:pos,bufferEnd:bufferEnd})}return true}},{key:"_ensureFragmentAtLivePoint",value:function _ensureFragmentAtLivePoint(_ref2){var levelDetails=_ref2.levelDetails,bufferEnd=_ref2.bufferEnd,start=_ref2.start,end=_ref2.end,fragPrevious=_ref2.fragPrevious,fragments=_ref2.fragments,fragLen=_ref2.fragLen;var config=this.hls.config,media=this.media;var frag=void 0;var maxLatency=config.liveMaxLatencyDuration!==undefined?config.liveMaxLatencyDuration:config.liveMaxLatencyDurationCount*levelDetails.targetduration;if(bufferEnd<Math.max(start-config.maxFragLookUpTolerance,end-maxLatency)){var liveSyncPosition=this.computeLivePosition(start,levelDetails);_logger.logger.log("buffer end: "+bufferEnd.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+liveSyncPosition.toFixed(3));bufferEnd=liveSyncPosition;if(media&&media.readyState&&media.duration>liveSyncPosition){media.currentTime=liveSyncPosition}}if(levelDetails.PTSKnown&&bufferEnd>end&&media&&media.readyState){return null}if(this.startFragRequested&&!levelDetails.PTSKnown){if(fragPrevious){var targetSN=fragPrevious.sn+1;if(targetSN>=levelDetails.startSN&&targetSN<=levelDetails.endSN){frag=fragments[targetSN-levelDetails.startSN];_logger.logger.log("live playlist, switching playlist, load frag with next SN: "+frag.sn)}}if(!frag){frag=fragments[Math.min(fragLen-1,Math.round(fragLen/2))];_logger.logger.log("live playlist, switching playlist, unknown, load middle frag : "+frag.sn)}}return frag}},{key:"_findFragment",value:function _findFragment(_ref3){var start=_ref3.start,fragPrevious=_ref3.fragPrevious,fragLen=_ref3.fragLen,fragments=_ref3.fragments,bufferEnd=_ref3.bufferEnd,end=_ref3.end,levelDetails=_ref3.levelDetails,holaSeek=_ref3.holaSeek;var config=this.hls.config;var frag=void 0,foundFrag=void 0,maxFragLookUpTolerance=config.maxFragLookUpTolerance,media=this.media,seekFlag=media&&media.seeking||holaSeek;if(bufferEnd<end-(fragments[fragLen-1].PTSDTSshift||0)-.05){if(bufferEnd>end-maxFragLookUpTolerance||seekFlag){maxFragLookUpTolerance=0}foundFrag=_binarySearch2.default.search(fragments,function(candidate){if(candidate.lastGop-maxFragLookUpTolerance<bufferEnd&&candidate.lastGop+maxFragLookUpTolerance>bufferEnd){return 1}if(candidate.firstGop-maxFragLookUpTolerance<bufferEnd&&candidate.firstGop+maxFragLookUpTolerance>bufferEnd){return 0}if(candidate.start+candidate.duration-candidate.PTSDTSshift-maxFragLookUpTolerance<=bufferEnd){return 1}if(candidate.start-candidate.PTSDTSshift-maxFragLookUpTolerance>bufferEnd&&candidate.start){return candidate.sn>levelDetails.startSN?-1:0}return 0})}else{foundFrag=fragments[fragLen-1]}if(foundFrag){frag=foundFrag;start=foundFrag.start;_logger.logger.log("find SN matching with pos:"+bufferEnd+":"+frag.sn);if(fragPrevious&&frag.sn===fragPrevious.sn){if(frag.sn<levelDetails.endSN){var deltaPTS=fragPrevious.deltaPTS,curSNIdx=frag.sn-levelDetails.startSN;if(this.loadedmetadata&&deltaPTS&&deltaPTS>config.maxSeekHole&&fragPrevious.dropped&&(!media||!_bufferHelper2.default.isBuffered(media,bufferEnd))){frag=fragments[curSNIdx-1];_logger.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this");fragPrevious.loadCounter--}else{frag=fragments[curSNIdx+1];_logger.logger.log("SN just loaded, load next one: "+frag.sn)}}else{if(!levelDetails.live){this.hls.trigger(_events2.default.BUFFER_EOS);if(!this.media.seeking){this.state=State.ENDED}}frag=null}}}return frag}},{key:"_loadFragmentOrKey",value:function _loadFragmentOrKey(_ref4){var frag=_ref4.frag,level=_ref4.level,levelDetails=_ref4.levelDetails,pos=_ref4.pos,bufferEnd=_ref4.bufferEnd;var hls=this.hls,config=hls.config;if(frag.decryptdata.uri!=null&&frag.decryptdata.key==null){_logger.logger.log("Loading key for "+frag.sn+" of ["+levelDetails.startSN+" ,"+levelDetails.endSN+"],level "+level);this.state=State.KEY_LOADING;hls.trigger(_events2.default.KEY_LOADING,{frag:frag})}else{_logger.logger.log("Loading "+frag.sn+" of ["+levelDetails.startSN+" ,"+levelDetails.endSN+"],level "+level+", currentTime:"+pos+",bufferEnd:"+bufferEnd.toFixed(3));frag.autoLevel=hls.autoLevelEnabled;if(this.levels.length>1){frag.expectedLen=Math.round(frag.duration*this.levels[level].bitrate/8);frag.trequest=performance.now()}if(this.fragLoadIdx!==undefined){this.fragLoadIdx++}else{this.fragLoadIdx=0}if(frag.loadCounter){frag.loadCounter++;var maxThreshold=config.fragLoadingLoopThreshold;if(frag.loadCounter>maxThreshold&&Math.abs(this.fragLoadIdx-frag.loadIdx)<maxThreshold){hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:false,frag:frag});return false}}else{frag.loadCounter=1}frag.loadIdx=this.fragLoadIdx;this.fragCurrent=frag;this.fragCurrent.loaded=false;this.startFragRequested=true;this.nextLoadPosition=frag.start+frag.duration;this.fragTimeOffset=frag.start;if(!this.demuxer){this.demuxer=new _demuxer2.default(hls,"main")}this.state=State.FRAG_LOADING;hls.trigger(_events2.default.FRAG_LOADING,{frag:frag});return true}}},{key:"getBufferRange",value:function getBufferRange(position){var i,range,bufferRange=this.bufferRange;if(bufferRange){for(i=bufferRange.length-1;i>=0;i--){range=bufferRange[i];if(position>=range.start&&position<=range.end){return range}}}return null}},{key:"followingBufferRange",value:function followingBufferRange(range){if(range){return this.getBufferRange(range.end+.5)}return null}},{key:"isBuffered",value:function isBuffered(position){var media=this.media;if(media){var buffered=media.buffered;for(var i=0;i<buffered.length;i++){if(position>=buffered.start(i)&&position<=buffered.end(i)){return true}}}return false}},{key:"_checkFragmentChanged",value:function _checkFragmentChanged(){var currentTime,video=this.media;if(video&&video.seeking===false){currentTime=video.currentTime;if(currentTime>video.playbackRate*this.lastCurrentTime){this.lastCurrentTime=currentTime}}}},{key:"immediateLevelSwitch",value:function immediateLevelSwitch(){_logger.logger.log("immediateLevelSwitch");if(!this.immediateSwitch){this.immediateSwitch=true;this.previouslyPaused=this.media.paused;this.media.pause()}var fragCurrent=this.fragCurrent;if(fragCurrent&&fragCurrent.loader){fragCurrent.loader.abort()}this.fragCurrent=null;this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold;this.state=State.PAUSED;this.hls.trigger(_events2.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY})}},{key:"immediateLevelSwitchEnd",value:function immediateLevelSwitchEnd(){var media=this.media;if(media&&media.buffered.length){this.immediateSwitch=false;if(_bufferHelper2.default.isBuffered(media,media.currentTime)){media.currentTime-=1e-4}if(!this.previouslyPaused){media.play()}}}},{key:"nextLevelSwitch",value:function nextLevelSwitch(){var media=this.media;if(media&&media.readyState){var fetchdelay=void 0,currentRange=void 0,nextRange=void 0;this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold;currentRange=this.getBufferRange(media.currentTime);if(currentRange&&currentRange.start>1){this.state=State.PAUSED;this.hls.trigger(_events2.default.BUFFER_FLUSHING,{startOffset:0,endOffset:currentRange.start-1})}if(!media.paused){var nextLevelId=this.hls.nextLoadLevel,nextLevel=this.levels[nextLevelId],fragLastKbps=this.fragLastKbps;if(fragLastKbps&&this.fragCurrent){fetchdelay=this.fragCurrent.duration*nextLevel.bitrate/(1e3*fragLastKbps)+1}else{fetchdelay=0}}else{fetchdelay=0}nextRange=this.getBufferRange(media.currentTime+fetchdelay);if(nextRange){nextRange=this.followingBufferRange(nextRange);if(nextRange){var fragCurrent=this.fragCurrent;if(fragCurrent&&fragCurrent.loader){fragCurrent.loader.abort()}this.fragCurrent=null;this.state=State.PAUSED;this.hls.trigger(_events2.default.BUFFER_FLUSHING,{startOffset:nextRange.start,endOffset:Number.POSITIVE_INFINITY})}}}}},{key:"onMediaAttached",value:function onMediaAttached(data){var media=this.media=data.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);this.onvended=this.onMediaEnded.bind(this);media.addEventListener("seeking",this.onvseeking);media.addEventListener("seeked",this.onvseeked);media.addEventListener("ended",this.onvended);if(this.demuxer){this.demuxer.destroy();this.demuxer=new _demuxer2.default(this.hls);this.fragParsing=null}if(this.levels&&this.config.autoStartLoad){this.hls.startLoad()}}},{key:"onMediaDetaching",value:function onMediaDetaching(){var media=this.media;if(media&&media.ended||this.state===State.ENDED){_logger.logger.log("MSE detaching and video ended, reset startPosition");this.startPosition=this.lastCurrentTime=0}var levels=this.levels;if(levels){levels.forEach(function(level){if(level.details){level.details.fragments.forEach(function(fragment){fragment.loadCounter=undefined})}})}if(media){media.removeEventListener("seeking",this.onvseeking);media.removeEventListener("seeked",this.onvseeked);media.removeEventListener("ended",this.onvended);this.onvseeking=this.onvseeked=this.onvended=null}this.media=null;this.loadedmetadata=false;this.stopLoad();this.fragParsing=null}},{key:"onMediaSeeking",value:function onMediaSeeking(){var currentTime=this.media.currentTime;_logger.logger.log("media seeking to "+currentTime);var fragCurrent=this.fragCurrent;if(this.state===State.FRAG_LOADING){if(_bufferHelper2.default.bufferInfo(this.media,currentTime,0).len===0){_logger.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load");if(fragCurrent){if(fragCurrent.loader){fragCurrent.loader.abort()}this.fragCurrent=null}this.fragPrevious=null;this.state=State.IDLE}}else if(this.state===State.ENDED){this.state=State.IDLE}else if(this.state===State.PARSING&&fragCurrent&&!fragCurrent.loaded){_logger.logger.log("mediaController: no final chunk, switch back to IDLE state");this.state=State.IDLE}if(this.media){this.lastCurrentTime=currentTime}if(this.fragLoadIdx!==undefined){this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold}if(!this.loadedmetadata){this.nextLoadPosition=this.startPosition=currentTime}this.tick()}},{key:"onMediaSeeked",value:function onMediaSeeked(){_logger.logger.log("media seeked to "+this.media.currentTime);this.tick()}},{key:"onMediaEnded",value:function onMediaEnded(){_logger.logger.log("media ended");this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function onManifestLoading(){_logger.logger.log("trigger BUFFER_RESET");this.hls.trigger(_events2.default.BUFFER_RESET);this.bufferRange=[];this.stalled=false;this.startPosition=this.lastCurrentTime=0;this.fragParsing=null}},{key:"onManifestParsed",value:function onManifestParsed(data){var aac=false,heaac=false,codec;data.levels.forEach(function(level){codec=level.audioCodec;if(codec){if(codec.indexOf("mp4a.40.2")!==-1){aac=true}if(codec.indexOf("mp4a.40.5")!==-1){heaac=true}}});this.audioCodecSwitch=aac&&heaac;if(this.audioCodecSwitch){_logger.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC");
}this.levels=data.levels;this.startLevelLoaded=false;this.startFragRequested=false;if(this.demuxer){this.demuxer.destroy();this.demuxer=new _demuxer2.default(this.hls);this.fragParsing=null}if(this.config.autoStartLoad){this.hls.startLoad()}}},{key:"onLevelLoaded",value:function onLevelLoaded(data){var newDetails=data.details,newLevelId=data.level,curLevel=this.levels[newLevelId],duration=newDetails.totalduration,sliding=0,lastDetails=this.levelLastLoaded!==undefined&&this.levels[this.levelLastLoaded]&&this.levels[this.levelLastLoaded].details;_logger.logger.log("level "+newLevelId+" loaded ["+newDetails.startSN+","+newDetails.endSN+"],duration:"+duration);if(newDetails.live){var curDetails=curLevel.details;if(lastDetails){var _LevelHelper$probeDet=_levelHelper2.default.probeDetails(lastDetails,newDetails),start=_LevelHelper$probeDet.start,end=_LevelHelper$probeDet.end;if(end>=start){curDetails=lastDetails}}if(curDetails){_levelHelper2.default.mergeDetails(curDetails,newDetails);sliding=newDetails.fragments[0].start;if(newDetails.PTSKnown){_logger.logger.log("live playlist sliding:"+sliding.toFixed(3))}else{_logger.logger.log("live playlist - outdated PTS, unknown sliding")}}else{newDetails.PTSKnown=false;_logger.logger.log("live playlist - first load, unknown sliding")}}else{newDetails.PTSKnown=false;if(lastDetails){_levelHelper2.default.mergeDetails(lastDetails,newDetails)}}this.levelLastLoaded=newLevelId;curLevel.details=newDetails;this.hls.trigger(_events2.default.LEVEL_UPDATED,{details:newDetails,level:newLevelId});if(this.startFragRequested===false){if(newDetails.live){this.startPosition=this.computeLivePosition(sliding,newDetails);_logger.logger.log("configure startPosition to "+this.startPosition)}this.nextLoadPosition=this.startPosition}if(this.state===State.WAITING_LEVEL){this.state=State.IDLE}this.tick()}},{key:"onKeyLoaded",value:function onKeyLoaded(){if(this.state===State.KEY_LOADING){this.state=State.IDLE;this.tick()}}},{key:"onFragChunkLoaded",value:function onFragChunkLoaded(data){var fragCurrent=this.fragCurrent;if((this.state===State.FRAG_LOADING||this.state===State.PARSING)&&fragCurrent&&data.frag.level===fragCurrent.level&&data.frag.sn===fragCurrent.sn){_logger.logger.log("Loaded chunk "+data.payload.byteLength+" of frag "+fragCurrent.sn+" of level "+fragCurrent.level);this.state=State.PARSING;this.stats=data.stats;var level=fragCurrent.level,fragLevel=this.levels[level],details=fragLevel.details,duration=details.totalduration,start=this.fragTimeOffset,sn=fragCurrent.sn,audioCodec=this.config.defaultAudioCodec||fragLevel.audioCodec;if(this.audioCodecSwap){_logger.logger.log("swapping playlist audio codec");if(audioCodec===undefined){audioCodec=this.lastAudioCodec}if(audioCodec){if(audioCodec.indexOf("mp4a.40.5")!==-1){audioCodec="mp4a.40.2"}else{audioCodec="mp4a.40.5"}}}_logger.logger.log("Demuxing "+sn+" of ["+details.startSN+" ,"+details.endSN+"],level "+level+", cc "+fragCurrent.cc);var demuxer=this.demuxer;if(demuxer){demuxer.push(data.payload,audioCodec,fragLevel.videoCodec,start,fragCurrent.cc,level,sn,duration,fragCurrent.decryptdata,details.PTSKnown||!details.live,details.endSN)}if(data.payload.final){fragCurrent.loaded=true}}}},{key:"onFragLoaded",value:function onFragLoaded(){_logger.logger.log("Loaded "+this.fragCurrent.sn+" of level "+this.fragCurrent.level);this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function onFragParsingInitSegment(data){if(this.state===State.PARSING){var tracks=data.tracks,trackName,track;track=tracks.audio;if(track){var audioCodec=this.levels[this.level].audioCodec,ua=navigator.userAgent.toLowerCase();if(audioCodec&&this.audioCodecSwap){_logger.logger.log("swapping playlist audio codec");if(audioCodec.indexOf("mp4a.40.5")!==-1){audioCodec="mp4a.40.2"}else{audioCodec="mp4a.40.5"}}if(this.audioCodecSwitch){if(track.metadata.channelCount!==1&&ua.indexOf("firefox")===-1){audioCodec="mp4a.40.5"}}if(ua.indexOf("android")!==-1&&track.container!=="audio/mpeg"){audioCodec="mp4a.40.2";_logger.logger.log("Android: force audio codec to "+audioCodec)}track.levelCodec=audioCodec}track=tracks.video;if(track){track.levelCodec=this.levels[this.level].videoCodec}if(data.unique){var mergedTrack={codec:"",levelCodec:""};for(trackName in data.tracks){track=tracks[trackName];mergedTrack.container=track.container;if(mergedTrack.codec){mergedTrack.codec+=",";mergedTrack.levelCodec+=","}if(track.codec){mergedTrack.codec+=track.codec}if(track.levelCodec){mergedTrack.levelCodec+=track.levelCodec}}tracks={audiovideo:mergedTrack}}this.hls.trigger(_events2.default.BUFFER_CODECS,tracks);for(trackName in tracks){track=tracks[trackName];var initSegment=track.initSegment;_logger.logger.log("track:"+trackName+",container:"+track.container+",codecs[level/parsed]=["+track.levelCodec+"/"+track.codec+"]"+(initSegment?",init:"+initSegment.length:""));if(initSegment){this.hls.trigger(_events2.default.BUFFER_APPENDING,{type:trackName,data:initSegment})}}this.tick()}}},{key:"onFragParsingData",value:function onFragParsingData(data){if(this.state===State.PARSING||this.fragParsing){this.tparse2=Date.now();var frag=this.fragCurrent||this.fragParsing;_logger.logger.log("parsed "+data.type+",PTS:["+data.startPTS.toFixed(3)+","+data.endPTS.toFixed(3)+"],DTS:["+data.startDTS.toFixed(3)+"/"+data.endDTS.toFixed(3)+"],nb:"+data.nb+",dropped:"+(data.dropped||0)+",deltaPTS:"+(data.deltaPTS||0));var hls=this.hls;if(data.type==="video"){frag.dropped=data.dropped;if(data.deltaPTS){if(isNaN(frag.deltaPTS)){frag.deltaPTS=data.deltaPTS}else{frag.deltaPTS=Math.max(data.deltaPTS,frag.deltaPTS)}}}[data.data1,data.data2].forEach(function(buffer){if(buffer){hls.trigger(_events2.default.BUFFER_APPENDING,{type:data.type,data:buffer})}});this.bufferRange.push({type:data.type,start:data.startPTS,end:data.endPTS,frag:frag});this.tick()}else{_logger.logger.warn("not in PARSING state but "+this.state+", ignoring FRAG_PARSING_DATA event")}}},{key:"onFragParsed",value:function onFragParsed(data){if(this.state===State.PARSING){var frag,level=this.levels[this.fragCurrent.level];this.stats.tparsed=performance.now();this.state=State.PARSED;if(data.startPTS!==undefined&&data.endPTS!==undefined){var drift=_levelHelper2.default.updateFragPTS(level.details,this.fragCurrent.sn,data.startPTS,data.endPTS,data.PTSDTSshift,data.lastGopPTS);this.hls.trigger(_events2.default.LEVEL_PTS_UPDATED,{details:level.details,level:this.fragCurrent.level,drift:drift})}else if(frag=this.fragCurrent){frag.dropped=1;frag.deltaPTS=this.config.maxSeekHole+1}this.hls.trigger(_events2.default.FRAG_APPENDING)}}},{key:"onFragAppended",value:function onFragAppended(){if(this.state===State.PARSED){var frag=this.fragCurrent,stats=this.stats;if(frag){this.fragPrevious=frag;stats.tbuffered=performance.now();this.fragLastKbps=Math.round(8*stats.length/(stats.tbuffered-stats.tfirst));this.hls.trigger(_events2.default.FRAG_BUFFERED,{stats:stats,frag:frag});_logger.logger.log("media buffered : "+this.timeRangesToString(this.media.buffered));this.state=State.IDLE}this.tick()}else{_logger.logger.warn("not in PARSED state but "+this.state)}}},{key:"onError",value:function onError(data){switch(data.details){case _errors.ErrorDetails.FRAG_LOAD_ERROR:case _errors.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!data.fatal){var loadError=(this.fragLoadError||0)+1;if(loadError<=this.config.fragLoadingMaxRetry){this.fragLoadError=loadError;data.frag.loadCounter=0;var delay=Math.min(Math.pow(2,loadError-1)*this.config.fragLoadingRetryDelay,64e3);_logger.logger.warn("mediaController: frag loading failed, retry in "+delay+" ms");this.retryDate=performance.now()+delay;this.state=State.FRAG_LOADING_WAITING_RETRY}else{_logger.logger.error("mediaController: "+data.details+" reaches max retry, redispatch as fatal ...");data.fatal=true;this.hls.trigger(_events2.default.ERROR,data);this.state=State.ERROR}}break;case _errors.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case _errors.ErrorDetails.LEVEL_LOAD_ERROR:case _errors.ErrorDetails.LEVEL_LOAD_TIMEOUT:case _errors.ErrorDetails.KEY_LOAD_ERROR:case _errors.ErrorDetails.KEY_LOAD_TIMEOUT:if(this.state!==State.ERROR){this.state=data.fatal?State.ERROR:State.IDLE;_logger.logger.warn("mediaController: "+data.details+" while loading frag,switch to "+this.state+" state ...")}break;case _errors.ErrorDetails.BUFFER_FULL_ERROR:this.config.maxMaxBufferLength/=2;_logger.logger.warn("reduce max buffer length to "+this.config.maxMaxBufferLength+"s and trigger a nextLevelSwitch to flush old buffer and fix QuotaExceededError");this.nextLevelSwitch();break;default:break}}},{key:"_checkBuffer",value:function _checkBuffer(){var media=this.media;if(media&&media.readyState){var currentTime;currentTime=media.currentTime;var loadedmetadata=this.loadedmetadata;if(!loadedmetadata&&media.buffered.length&&!media.seeking){this.loadedmetadata=true;var startPosition=this.startPosition,startPositionBuffered=_bufferHelper2.default.isBuffered(media,startPosition);if(currentTime!==this.startPosition||!startPositionBuffered){_logger.logger.log("target start position:"+startPosition);if(!startPositionBuffered){startPosition=media.buffered.start(0);_logger.logger.log("target start position not buffered, seek to buffered.start(0) "+startPosition)}_logger.logger.log("adjust currentTime from "+currentTime+" to "+startPosition);media.currentTime=startPosition}}else{var bufferInfo=_bufferHelper2.default.bufferInfo(media,currentTime,0),expectedPlaying=!(media.paused||media.ended||media.seeking||media.buffered.length===0),jumpThreshold=.5,playheadMoving=currentTime>media.playbackRate*this.lastCurrentTime;if(this.stalled&&playheadMoving){this.stalled=false;_logger.logger.log("playback not stuck anymore @"+currentTime)}if(expectedPlaying&&bufferInfo.len<=jumpThreshold){if(playheadMoving){jumpThreshold=0;this.seekHoleNudgeDuration=0}else{if(!this.stalled){this.seekHoleNudgeDuration=0;_logger.logger.log("playback seems stuck @"+currentTime);this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.BUFFER_STALLED_ERROR,fatal:false});this.stalled=true}else{this.seekHoleNudgeDuration+=this.config.seekHoleNudgeDuration}}if(bufferInfo.len<=jumpThreshold){var nextBufferStart=bufferInfo.nextStart,delta=nextBufferStart-currentTime;if(nextBufferStart&&delta<this.config.maxSeekHole&&delta>0){_logger.logger.log("adjust currentTime from "+media.currentTime+" to next buffered @ "+nextBufferStart+" + nudge "+this.seekHoleNudgeDuration);var hole=nextBufferStart+this.seekHoleNudgeDuration-media.currentTime;media.currentTime=nextBufferStart+this.seekHoleNudgeDuration;this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:false,hole:hole})}}}}}}},{key:"onFragLoadEmergencyAborted",value:function onFragLoadEmergencyAborted(){this.state=State.IDLE;this.tick()}},{key:"onBufferFlushed",value:function onBufferFlushed(){var newRange=[],range,i;for(i=0;i<this.bufferRange.length;i++){range=this.bufferRange[i];if(this.isBuffered((range.start+range.end)/2)){newRange.push(range)}}this.bufferRange=newRange;if(this.immediateSwitch){this.immediateLevelSwitchEnd()}this.state=State.IDLE;this.fragPrevious=null}},{key:"onLevelPtsUpdated",value:function onLevelPtsUpdated(lu){if(!this.levels||this.levels[lu.level].details.live){return}for(var level=0;level<this.levels.length;level++){if(level!==lu.level&&this.levels[level].details){_levelHelper2.default.mergeDetails(this.levels[lu.level].details,this.levels[level].details)}}}},{key:"swapAudioCodec",value:function swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"timeRangesToString",value:function timeRangesToString(r){if(!r){return"[]"}var log="",len=r.length;for(var i=0;i<len;i++){log+="["+r.start(i)+","+r.end(i)+"]"}return log}},{key:"computeLivePosition",value:function computeLivePosition(sliding,levelDetails){var targetLatency=this.config.liveSyncDuration!==undefined?this.config.liveSyncDuration:this.config.liveSyncDurationCount*levelDetails.targetduration;return sliding+Math.max(0,levelDetails.totalduration-targetLatency)}},{key:"state",set:function set(nextState){if(this.state!==nextState){var previousState=this.state;this._state=nextState;_logger.logger.log("engine state transition from "+previousState+" to "+nextState);if(nextState==="IDLE"){var media=this.media||{};_logger.logger.log("media "+media+" ct="+media.currentTime+" dur="+media.duration+" buf="+this.timeRangesToString(media.buffered)+" err="+media.error)}this.hls.trigger(_events2.default.STREAM_STATE_TRANSITION,{previousState:previousState,nextState:nextState})}},get:function get(){return this._state}},{key:"currentLevel",get:function get(){if(this.media){var range=this.getBufferRange(this.media.currentTime);if(range){return range.frag.level}}return-1}},{key:"nextBufferRange",get:function get(){if(this.media){return this.followingBufferRange(this.getBufferRange(this.media.currentTime))}else{return null}}},{key:"nextLevel",get:function get(){var range=this.nextBufferRange;if(range){return range.frag.level}else{return-1}}}]);return StreamController}(_eventHandler2.default);exports.default=StreamController},{"../demux/demuxer":17,"../errors":21,"../event-handler":22,"../events":23,"../helper/buffer-helper":25,"../helper/level-helper":26,"../utils/binary-search":36,"../utils/logger":39}],9:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);var _cea608Parser=_dereq_("../utils/cea-608-parser");var _cea608Parser2=_interopRequireDefault(_cea608Parser);var _cues=_dereq_("../utils/cues");var _cues2=_interopRequireDefault(_cues);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var TimelineController=function(_EventHandler){_inherits(TimelineController,_EventHandler);function TimelineController(hls){_classCallCheck(this,TimelineController);var _this=_possibleConstructorReturn(this,(TimelineController.__proto__||Object.getPrototypeOf(TimelineController)).call(this,hls,_events2.default.MEDIA_ATTACHING,_events2.default.MEDIA_DETACHING,_events2.default.FRAG_PARSING_USERDATA,_events2.default.MANIFEST_LOADING,_events2.default.FRAG_LOADED,_events2.default.LEVEL_SWITCH));_this.hls=hls;_this.config=hls.config;_this.enabled=true;if(_this.config.enableCEA708Captions){var self=_this;var channel1={newCue:function newCue(startTime,endTime,screen){if(!self.textTrack1){self.textTrack1=self.createTextTrack("captions","Unknown CC1","en")}_cues2.default.newCue(self.textTrack1,startTime,endTime,screen)}};var channel2={newCue:function newCue(startTime,endTime,screen){if(!self.textTrack2){self.textTrack2=self.createTextTrack("captions","Unknown CC2","es")}_cues2.default.newCue(self.textTrack2,startTime,endTime,screen)}};_this.cea608Parser=new _cea608Parser2.default(0,channel1,channel2)}return _this}_createClass(TimelineController,[{key:"clearCurrentCues",value:function clearCurrentCues(track){if(track&&track.cues){while(track.cues.length>0){track.removeCue(track.cues[0])}}}},{key:"createTextTrack",value:function createTextTrack(kind,label,lang){if(this.media){return this.media.addTextTrack(kind,label,lang)}}},{key:"destroy",value:function destroy(){_eventHandler2.default.prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function onMediaAttaching(data){this.media=data.media}},{key:"onMediaDetaching",value:function onMediaDetaching(){}},{key:"onManifestLoading",value:function onManifestLoading(){this.lastPts=Number.NEGATIVE_INFINITY}},{key:"onLevelSwitch",value:function onLevelSwitch(){if(this.hls.currentLevel.closedCaptions==="NONE"){this.enabled=false}else{this.enabled=true}}},{key:"onFragLoaded",value:function onFragLoaded(data){var pts=data.frag.start;if(pts<=this.lastPts){this.clearCurrentCues(this.textTrack1);this.clearCurrentCues(this.textTrack2)}this.lastPts=pts}},{key:"onFragParsingUserdata",value:function onFragParsingUserdata(data){if(this.enabled){for(var i=0;i<data.samples.length;i++){var ccdatas=this.extractCea608Data(data.samples[i].bytes);this.cea608Parser.addData(data.samples[i].pts,ccdatas)}}}},{key:"extractCea608Data",value:function extractCea608Data(byteArray){var count=byteArray[0]&31;var position=2;var tmpByte,ccbyte1,ccbyte2,ccValid,ccType;var actualCCBytes=[];for(var j=0;j<count;j++){tmpByte=byteArray[position++];ccbyte1=127&byteArray[position++];ccbyte2=127&byteArray[position++];ccValid=(4&tmpByte)===0?false:true;ccType=3&tmpByte;if(ccbyte1===0&&ccbyte2===0){continue}if(ccValid){if(ccType===0){actualCCBytes.push(ccbyte1);actualCCBytes.push(ccbyte2)}}}return actualCCBytes}}]);return TimelineController}(_eventHandler2.default);exports.default=TimelineController},{"../event-handler":22,"../events":23,"../utils/cea-608-parser":37,"../utils/cues":38}],10:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AES=function(){function AES(key){_classCallCheck(this,AES);this._tables=[[[],[],[],[],[]],[[],[],[],[],[]]];this._precompute();var i,j,tmp,encKey,decKey,sbox=this._tables[0][4],decTable=this._tables[1],keyLen=key.length,rcon=1;if(keyLen!==4&&keyLen!==6&&keyLen!==8){throw new Error("Invalid aes key size="+keyLen)}encKey=key.slice(0);decKey=[];this._key=[encKey,decKey];for(i=keyLen;i<4*keyLen+28;i++){tmp=encKey[i-1];if(i%keyLen===0||keyLen===8&&i%keyLen===4){tmp=sbox[tmp>>>24]<<24^sbox[tmp>>16&255]<<16^sbox[tmp>>8&255]<<8^sbox[tmp&255];if(i%keyLen===0){tmp=tmp<<8^tmp>>>24^rcon<<24;rcon=rcon<<1^(rcon>>7)*283}}encKey[i]=encKey[i-keyLen]^tmp}for(j=0;i;j++,i--){tmp=encKey[j&3?i:i-4];if(i<=4||j<4){decKey[j]=tmp}else{decKey[j]=decTable[0][sbox[tmp>>>24]]^decTable[1][sbox[tmp>>16&255]]^decTable[2][sbox[tmp>>8&255]]^decTable[3][sbox[tmp&255]]}}}_createClass(AES,[{key:"_precompute",value:function _precompute(){var encTable=this._tables[0],decTable=this._tables[1],sbox=encTable[4],sboxInv=decTable[4],i,x,xInv,d=[],th=[],x2,x4,x8,s,tEnc,tDec;for(i=0;i<256;i++){th[(d[i]=i<<1^(i>>7)*283)^i]=i}for(x=xInv=0;!sbox[x];x^=x2||1,xInv=th[xInv]||1){s=xInv^xInv<<1^xInv<<2^xInv<<3^xInv<<4;s=s>>8^s&255^99;sbox[x]=s;sboxInv[s]=x;x8=d[x4=d[x2=d[x]]];tDec=x8*16843009^x4*65537^x2*257^x*16843008;tEnc=d[s]*257^s*16843008;for(i=0;i<4;i++){encTable[i][x]=tEnc=tEnc<<24^tEnc>>>8;decTable[i][s]=tDec=tDec<<24^tDec>>>8}}for(i=0;i<5;i++){encTable[i]=encTable[i].slice(0);decTable[i]=decTable[i].slice(0)}}},{key:"decrypt",value:function decrypt(encrypted0,encrypted1,encrypted2,encrypted3,out,offset){var key=this._key[1],a=encrypted0^key[0],b=encrypted3^key[1],c=encrypted2^key[2],d=encrypted1^key[3],a2,b2,c2,nInnerRounds=key.length/4-2,i,kIndex=4,table=this._tables[1],table0=table[0],table1=table[1],table2=table[2],table3=table[3],sbox=table[4];for(i=0;i<nInnerRounds;i++){a2=table0[a>>>24]^table1[b>>16&255]^table2[c>>8&255]^table3[d&255]^key[kIndex];b2=table0[b>>>24]^table1[c>>16&255]^table2[d>>8&255]^table3[a&255]^key[kIndex+1];c2=table0[c>>>24]^table1[d>>16&255]^table2[a>>8&255]^table3[b&255]^key[kIndex+2];d=table0[d>>>24]^table1[a>>16&255]^table2[b>>8&255]^table3[c&255]^key[kIndex+3];kIndex+=4;a=a2;b=b2;c=c2}for(i=0;i<4;i++){out[(3&-i)+offset]=sbox[a>>>24]<<24^sbox[b>>16&255]<<16^sbox[c>>8&255]<<8^sbox[d&255]^key[kIndex++];a2=a;a=b;b=c;c=d;d=a2}}}]);return AES}();exports.default=AES},{}],11:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _aes=_dereq_("./aes");var _aes2=_interopRequireDefault(_aes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AES128Decrypter=function(){function AES128Decrypter(key,initVector){_classCallCheck(this,AES128Decrypter);this.key=key;this.iv=new Uint32Array(initVector)}_createClass(AES128Decrypter,[{key:"ntoh",value:function ntoh(word){return word<<24|(word&65280)<<8|(word&16711680)>>8|word>>>24}},{key:"doDecrypt",value:function doDecrypt(encrypted,key,initVector){var encrypted32=new Int32Array(encrypted.buffer,encrypted.byteOffset,encrypted.byteLength>>2),decipher=new _aes2.default(Array.prototype.slice.call(key)),decrypted=new Uint8Array(encrypted.byteLength),decrypted32=new Int32Array(decrypted.buffer),init0,init1,init2,init3,encrypted0,encrypted1,encrypted2,encrypted3,wordIx;init0=~~initVector[0];init1=~~initVector[1];init2=~~initVector[2];init3=~~initVector[3];for(wordIx=0;wordIx<encrypted32.length;wordIx+=4){encrypted0=~~this.ntoh(encrypted32[wordIx]);encrypted1=~~this.ntoh(encrypted32[wordIx+1]);encrypted2=~~this.ntoh(encrypted32[wordIx+2]);encrypted3=~~this.ntoh(encrypted32[wordIx+3]);decipher.decrypt(encrypted0,encrypted1,encrypted2,encrypted3,decrypted32,wordIx);decrypted32[wordIx]=this.ntoh(decrypted32[wordIx]^init0);decrypted32[wordIx+1]=this.ntoh(decrypted32[wordIx+1]^init1);decrypted32[wordIx+2]=this.ntoh(decrypted32[wordIx+2]^init2);decrypted32[wordIx+3]=this.ntoh(decrypted32[wordIx+3]^init3);init0=encrypted0;init1=encrypted1;init2=encrypted2;init3=encrypted3}return decrypted}},{key:"localDecrypt",value:function localDecrypt(encrypted,key,initVector,decrypted){var bytes=this.doDecrypt(encrypted,key,initVector);decrypted.set(bytes,encrypted.byteOffset)}},{key:"decrypt",value:function decrypt(encrypted){var step=4*8e3,encrypted32=new Int32Array(encrypted),decrypted=new Uint8Array(encrypted.byteLength),i=0;var key=this.key;var initVector=this.iv;this.localDecrypt(encrypted32.subarray(i,i+step),key,initVector,decrypted);for(i=step;i<encrypted32.length;i+=step){initVector=new Uint32Array([this.ntoh(encrypted32[i-4]),this.ntoh(encrypted32[i-3]),this.ntoh(encrypted32[i-2]),this.ntoh(encrypted32[i-1])]);this.localDecrypt(encrypted32.subarray(i,i+step),key,initVector,decrypted)}return decrypted}}]);return AES128Decrypter}();exports.default=AES128Decrypter},{"./aes":10}],12:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _aes128Decrypter=_dereq_("./aes128-decrypter");var _aes128Decrypter2=_interopRequireDefault(_aes128Decrypter);var _errors=_dereq_("../errors");var _logger=_dereq_("../utils/logger");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Decrypter=function(){function Decrypter(hls){_classCallCheck(this,Decrypter);this.hls=hls;this.iv=null;try{var browserCrypto=window?window.crypto:crypto;this.subtle=browserCrypto.subtle||browserCrypto.webkitSubtle;this.disableWebCrypto=!this.subtle}catch(e){this.disableWebCrypto=true}}_createClass(Decrypter,[{key:"destroy",value:function destroy(){}},{key:"decrypt",value:function decrypt(data,key,iv,callback){if(this.disableWebCrypto&&this.hls.config.enableSoftwareAES){this.decryptBySoftware(data,key,iv,callback)}else{this.decryptByWebCrypto(data,key,iv,callback)}}},{key:"decryptByWebCrypto",value:function decryptByWebCrypto(data,key,iv,callback){var _this=this;_logger.logger.log("decrypting by WebCrypto API");this.subtle.importKey("raw",key,{name:"AES-CBC",length:128},false,["decrypt"]).then(function(importedKey){_this.subtle.decrypt({name:"AES-CBC",iv:iv.buffer},importedKey,data).then(callback).catch(function(err){_this.onWebCryptoError(err,data,key,iv,callback)})}).catch(function(err){_this.onWebCryptoError(err,data,key,iv,callback)})}},{key:"decryptBySoftware",value:function decryptBySoftware(data,key8,iv8,callback){_logger.logger.log("decrypting by JavaScript Implementation");var view=new DataView(key8.buffer);var key=new Uint32Array([view.getUint32(0),view.getUint32(4),view.getUint32(8),view.getUint32(12)]);if(iv8){view=new DataView(iv8.buffer);this.iv=new Uint32Array([view.getUint32(0),view.getUint32(4),view.getUint32(8),view.getUint32(12)])}var decrypter=new _aes128Decrypter2.default(key,this.iv);var ivview=new DataView(data),len=data.byteLength;this.iv=new Uint32Array([ivview.getUint32(len-16),ivview.getUint32(len-12),ivview.getUint32(len-8),ivview.getUint32(len-4)]);callback(decrypter.decrypt(data).buffer)}},{key:"onWebCryptoError",value:function onWebCryptoError(err,data,key,iv,callback){if(this.hls.config.enableSoftwareAES){_logger.logger.log("disabling to use WebCrypto API");this.disableWebCrypto=true;this.decryptBySoftware(data,key,iv,callback)}else{_logger.logger.error("decrypting error : "+err.message);this.hls.trigger(Event.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:true,reason:err.message})}}}]);return Decrypter}();exports.default=Decrypter},{"../errors":21,"../utils/logger":39,"./aes128-decrypter":11}],13:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _adts=_dereq_("./adts");var _adts2=_interopRequireDefault(_adts);var _logger=_dereq_("../utils/logger");var _id=_dereq_("../demux/id3");var _id2=_interopRequireDefault(_id);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AACDemuxer=function(){function AACDemuxer(observer,remuxerClass,config){_classCallCheck(this,AACDemuxer);this.observer=observer;this.remuxerClass=remuxerClass;this.config=config;this.remuxer=new this.remuxerClass(observer,config);this._aacTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0}}_createClass(AACDemuxer,[{key:"push",value:function push(data,audioCodec,videoCodec,timeOffset,cc,level,sn,duration){var track=this._aacTrack,id3=new _id2.default(data),pts=90*id3.timeStamp,config,frameLength,frameDuration,frameIndex,offset,headerLength,stamp,len,aacSample;for(offset=id3.length,len=data.length;offset<len-1;offset++){if(data[offset]===255&&(data[offset+1]&240)===240){break}}if(!track.audiosamplerate){config=_adts2.default.getAudioConfig(this.observer,data,offset,audioCodec);track.config=config.config;track.audiosamplerate=config.samplerate;track.channelCount=config.channelCount;track.codec=config.codec;track.duration=duration;_logger.logger.log("parsed codec:"+track.codec+",rate:"+config.samplerate+",nb channel:"+config.channelCount)}frameIndex=0;frameDuration=1024*9e4/track.audiosamplerate;while(offset+5<len){headerLength=!!(data[offset+1]&1)?7:9;frameLength=(data[offset+3]&3)<<11|data[offset+4]<<3|(data[offset+5]&224)>>>5;frameLength-=headerLength;if(frameLength>0&&offset+headerLength+frameLength<=len){stamp=pts+frameIndex*frameDuration;aacSample={unit:data.subarray(offset+headerLength,offset+headerLength+frameLength),pts:stamp,dts:stamp};track.samples.push(aacSample);track.len+=frameLength;offset+=frameLength+headerLength;frameIndex++;for(;offset<len-1;offset++){if(data[offset]===255&&(data[offset+1]&240)===240){break}}}else{break}}this.remuxer.remux(this._aacTrack,{samples:[]},{samples:[{pts:pts,dts:pts,unit:id3.payload}]},{samples:[]},timeOffset)}},{key:"destroy",value:function destroy(){}}],[{key:"probe",value:function probe(data){var id3=new _id2.default(data),offset,len;if(id3.hasTimeStamp){for(offset=id3.length,len=data.length;offset<len-1;offset++){if(data[offset]===255&&(data[offset+1]&240)===240){return true}}}return false}}]);return AACDemuxer}();exports.default=AACDemuxer},{"../demux/id3":19,"../utils/logger":39,"./adts":14}],14:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _logger=_dereq_("../utils/logger");var _errors=_dereq_("../errors");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ADTS=function(){function ADTS(){_classCallCheck(this,ADTS)}_createClass(ADTS,null,[{key:"getAudioConfig",value:function getAudioConfig(observer,data,offset,audioCodec){
var adtsObjectType,adtsSampleingIndex,adtsExtensionSampleingIndex,adtsChanelConfig,config,userAgent=navigator.userAgent.toLowerCase(),adtsSampleingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];adtsObjectType=((data[offset+2]&192)>>>6)+1;adtsSampleingIndex=(data[offset+2]&60)>>>2;if(adtsSampleingIndex>adtsSampleingRates.length-1){observer.trigger(Event.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.FRAG_PARSING_ERROR,fatal:true,reason:"invalid ADTS sampling index:"+adtsSampleingIndex});return}adtsChanelConfig=(data[offset+2]&1)<<2;adtsChanelConfig|=(data[offset+3]&192)>>>6;_logger.logger.log("manifest codec:"+audioCodec+",ADTS data:type:"+adtsObjectType+",sampleingIndex:"+adtsSampleingIndex+"["+adtsSampleingRates[adtsSampleingIndex]+"Hz],channelConfig:"+adtsChanelConfig);if(userAgent.indexOf("firefox")!==-1){if(adtsSampleingIndex>=6){adtsObjectType=5;config=new Array(4);adtsExtensionSampleingIndex=adtsSampleingIndex-3}else{adtsObjectType=2;config=new Array(2);adtsExtensionSampleingIndex=adtsSampleingIndex}}else if(userAgent.indexOf("android")!==-1){adtsObjectType=2;config=new Array(2);adtsExtensionSampleingIndex=adtsSampleingIndex}else{adtsObjectType=5;config=new Array(4);if(audioCodec&&(audioCodec.indexOf("mp4a.40.29")!==-1||audioCodec.indexOf("mp4a.40.5")!==-1)||!audioCodec&&adtsSampleingIndex>=6){adtsExtensionSampleingIndex=adtsSampleingIndex-3}else{if(audioCodec&&audioCodec.indexOf("mp4a.40.2")!==-1&&adtsSampleingIndex>=6&&adtsChanelConfig===1||!audioCodec&&adtsChanelConfig===1){adtsObjectType=2;config=new Array(2)}adtsExtensionSampleingIndex=adtsSampleingIndex}}config[0]=adtsObjectType<<3;config[0]|=(adtsSampleingIndex&14)>>1;config[1]|=(adtsSampleingIndex&1)<<7;config[1]|=adtsChanelConfig<<3;if(adtsObjectType===5){config[1]|=(adtsExtensionSampleingIndex&14)>>1;config[2]=(adtsExtensionSampleingIndex&1)<<7;config[2]|=2<<2;config[3]=0}return{config:config,samplerate:adtsSampleingRates[adtsSampleingIndex],channelCount:adtsChanelConfig,codec:"mp4a.40."+adtsObjectType}}}]);return ADTS}();exports.default=ADTS},{"../errors":21,"../utils/logger":39}],15:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _errors=_dereq_("../errors");var _aacdemuxer=_dereq_("../demux/aacdemuxer");var _aacdemuxer2=_interopRequireDefault(_aacdemuxer);var _tsdemuxer=_dereq_("../demux/tsdemuxer");var _tsdemuxer2=_interopRequireDefault(_tsdemuxer);var _mp4Remuxer=_dereq_("../remux/mp4-remuxer");var _mp4Remuxer2=_interopRequireDefault(_mp4Remuxer);var _passthroughRemuxer=_dereq_("../remux/passthrough-remuxer");var _passthroughRemuxer2=_interopRequireDefault(_passthroughRemuxer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var DemuxerInline=function(){function DemuxerInline(hls,typeSupported){var config=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;_classCallCheck(this,DemuxerInline);var _this=this;this.hls=hls;this.config=this.hls.config||config;this.typeSupported=typeSupported;this.timeOffset=0;this.onFragParsingData=function(ev,data){if(data.type==="video"&&!data.flush){_this.timeOffset+=data.endDTS-data.startDTS}};this.hls.on(_events2.default.FRAG_PARSING_DATA,this.onFragParsingData)}_createClass(DemuxerInline,[{key:"destroy",value:function destroy(){var demuxer=this.demuxer;if(demuxer){demuxer.destroy()}this.hls.off(_events2.default.FRAG_PARSING_DATA,this.onFragParsingData)}},{key:"push",value:function push(data,audioCodec,videoCodec,timeOffset,cc,level,sn,duration,accurate,first,final,lastSN){var demuxer=this.demuxer;if(!demuxer){var hls=this.hls;if(_tsdemuxer2.default.probe(data)){if(this.typeSupported.mp2t===true){demuxer=new _tsdemuxer2.default(hls,_passthroughRemuxer2.default,this.config)}else{demuxer=new _tsdemuxer2.default(hls,_mp4Remuxer2.default,this.config)}}else if(_aacdemuxer2.default.probe(data)){demuxer=new _aacdemuxer2.default(hls,_mp4Remuxer2.default,this.config)}else{hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.FRAG_PARSING_ERROR,fatal:true,reason:"no demux matching with content found"});return}this.demuxer=demuxer}if(first){this.timeOffset=timeOffset}demuxer.push(data,audioCodec,videoCodec,this.timeOffset,cc,level,sn,duration,accurate,first,final,lastSN)}}]);return DemuxerInline}();exports.default=DemuxerInline},{"../demux/aacdemuxer":13,"../demux/tsdemuxer":20,"../errors":21,"../events":23,"../remux/mp4-remuxer":33,"../remux/passthrough-remuxer":34}],16:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _demuxerInline=_dereq_("../demux/demuxer-inline");var _demuxerInline2=_interopRequireDefault(_demuxerInline);var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _events3=_dereq_("events");var _events4=_interopRequireDefault(_events3);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var DemuxerWorker=function DemuxerWorker(self){var observer=new _events4.default;observer.trigger=function trigger(event){for(var _len=arguments.length,data=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){data[_key-1]=arguments[_key]}observer.emit.apply(observer,[event,event].concat(data))};observer.off=function off(event){for(var _len2=arguments.length,data=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){data[_key2-1]=arguments[_key2]}observer.removeListener.apply(observer,[event].concat(data))};self.addEventListener("message",function(ev){var data=ev.data;switch(data.cmd){case"init":self.demuxer=new _demuxerInline2.default(observer,data.typeSupported,JSON.parse(data.config));break;case"demux":self.demuxer.push(new Uint8Array(data.data),data.audioCodec,data.videoCodec,data.timeOffset,data.cc,data.level,data.sn,data.duration,data.accurate,data.first,data.final,data.lastSN);break;case"empty":self.postMessage({event:_events2.default.DEMUXER_QUEUE_EMPTY});break;default:break}});observer.on(_events2.default.FRAG_PARSING_INIT_SEGMENT,function(ev,data){self.postMessage({event:ev,tracks:data.tracks,unique:data.unique})});observer.on(_events2.default.FRAG_PARSING_DATA,function(ev,data){var objData={event:ev,type:data.type,startPTS:data.startPTS,endPTS:data.endPTS,startDTS:data.startDTS,endDTS:data.endDTS,data1:data.data1.buffer,data2:data.data2.buffer,nb:data.nb,dropped:data.dropped,deltaPTS:data.deltaPTS};self.postMessage(objData,[objData.data1,objData.data2])});observer.on(_events2.default.FRAG_PARSED,function(event,data){self.postMessage({event:event,data:data})});observer.on(_events2.default.FRAG_STATISTICS,function(event,data){self.postMessage({event:event,data:data})});observer.on(_events2.default.ERROR,function(event,data){self.postMessage({event:event,data:data})});observer.on(_events2.default.FRAG_PARSING_METADATA,function(event,data){var objData={event:event,samples:data.samples};self.postMessage(objData)});observer.on(_events2.default.FRAG_PARSING_USERDATA,function(event,data){var objData={event:event,samples:data.samples};self.postMessage(objData)})};exports.default=DemuxerWorker},{"../demux/demuxer-inline":15,"../events":23,events:1}],17:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _demuxerInline=_dereq_("../demux/demuxer-inline");var _demuxerInline2=_interopRequireDefault(_demuxerInline);var _demuxerWorker=_dereq_("../demux/demuxer-worker");var _demuxerWorker2=_interopRequireDefault(_demuxerWorker);var _logger=_dereq_("../utils/logger");var _decrypter=_dereq_("../crypt/decrypter");var _decrypter2=_interopRequireDefault(_decrypter);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Demuxer=function(){function Demuxer(hls){_classCallCheck(this,Demuxer);this.hls=hls;this.trail=new Uint8Array(0);var typeSupported={mp4:MediaSource.isTypeSupported("video/mp4"),mp2t:hls.config.enableMP2TPassThrough&&MediaSource.isTypeSupported("video/mp2t")};if(hls.config.enableWorker&&typeof Worker!=="undefined"){_logger.logger.log("demuxing in webworker");try{var work=_dereq_("webworkify");this.w=work(_demuxerWorker2.default);this.onwmsg=this.onWorkerMessage.bind(this);this.w.addEventListener("message",this.onwmsg);this.w.postMessage({cmd:"init",typeSupported:typeSupported,config:JSON.stringify(hls.config)})}catch(err){_logger.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline");this.demuxer=new _demuxerInline2.default(hls,typeSupported)}}else{this.demuxer=new _demuxerInline2.default(hls,typeSupported)}this.demuxInitialized=true}_createClass(Demuxer,[{key:"destroy",value:function destroy(){if(this.w){this.w.removeEventListener("message",this.onwmsg);this.w.terminate();this.w=null}else{this.demuxer.destroy();this.demuxer=null}if(this.decrypter){this.decrypter.destroy();this.decrypter=null}}},{key:"pushDecrypted",value:function pushDecrypted(data,audioCodec,videoCodec,timeOffset,cc,level,sn,duration,accurate,first,final,lastSN){if(this.w){this.w.postMessage({cmd:"demux",data:data,audioCodec:audioCodec,videoCodec:videoCodec,timeOffset:timeOffset,cc:cc,level:level,sn:sn,duration:duration,accurate:accurate,first:first,"final":final,lastSN:lastSN},[data])}else{this.demuxer.push(new Uint8Array(data),audioCodec,videoCodec,timeOffset,cc,level,sn,duration,accurate,first,final,lastSN)}}},{key:"push",value:function push(data,audioCodec,videoCodec,timeOffset,cc,level,sn,duration,decryptdata,accurate,lastSN){if(data.first){this.trail=new Uint8Array(0);this.trail.first=true}var traillen=this.trail.length;if(traillen||(data.byteLength+traillen)%752){var final=data.final,first=data.first||this.trail.first||false;var newlen=data.byteLength+traillen;if(!final){newlen-=newlen%752}var olddata=new Uint8Array(data);var newdata=new Uint8Array(newlen);var newtrail=new Uint8Array(data.byteLength+traillen-newlen);if(newlen){newdata.set(this.trail);newdata.set(olddata.subarray(0,newlen-traillen),traillen)}if(newtrail.length){if(newlen){newtrail.set(olddata.subarray(-newtrail.length))}else{newtrail.set(this.trail);newtrail.set(olddata,traillen);newtrail.first=first}}olddata=null;this.trail=newtrail;if(!newdata.length){return}data=newdata.buffer;data.final=final;data.first=first;newdata=null}if(data.byteLength>0&&decryptdata!=null&&decryptdata.key!=null&&decryptdata.method==="AES-128"){if(this.decrypter==null){this.decrypter=new _decrypter2.default(this.hls)}var localthis=this;this.decrypter.decrypt(data,decryptdata.key,data.first&&decryptdata.iv,function(decryptedData){localthis.pushDecrypted(decryptedData,audioCodec,videoCodec,timeOffset,cc,level,sn,duration,accurate,!!data.first,!!data.final,lastSN)})}else{this.pushDecrypted(data,audioCodec,videoCodec,timeOffset,cc,level,sn,duration,accurate,!!data.first,!!data.final,lastSN)}}},{key:"onWorkerMessage",value:function onWorkerMessage(ev){var data=ev.data;switch(data.event){case _events2.default.FRAG_PARSING_INIT_SEGMENT:var obj={};obj.tracks=data.tracks;obj.unique=data.unique;this.hls.trigger(_events2.default.FRAG_PARSING_INIT_SEGMENT,obj);break;case _events2.default.FRAG_PARSING_DATA:this.hls.trigger(_events2.default.FRAG_PARSING_DATA,{data1:new Uint8Array(data.data1),data2:new Uint8Array(data.data2),startPTS:data.startPTS,endPTS:data.endPTS,startDTS:data.startDTS,endDTS:data.endDTS,type:data.type,nb:data.nb,dropped:data.dropped,deltaPTS:data.deltaPTS});break;case _events2.default.FRAG_PARSING_METADATA:this.hls.trigger(_events2.default.FRAG_PARSING_METADATA,{samples:data.samples});break;case _events2.default.FRAG_PARSING_USERDATA:this.hls.trigger(_events2.default.FRAG_PARSING_USERDATA,{samples:data.samples});break;default:this.hls.trigger(data.event,data.data);break}}},{key:"waitQueue",value:function waitQueue(){if(this.w){this.w.postMessage({cmd:"empty"})}}}]);return Demuxer}();exports.default=Demuxer},{"../crypt/decrypter":12,"../demux/demuxer-inline":15,"../demux/demuxer-worker":16,"../events":23,"../utils/logger":39,webworkify:2}],18:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _logger=_dereq_("../utils/logger");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ExpGolomb=function(){function ExpGolomb(data){_classCallCheck(this,ExpGolomb);this.data=data;this.bytesAvailable=this.data.byteLength;this.word=0;this.bitsAvailable=0}_createClass(ExpGolomb,[{key:"wholeBytesAvailable",value:function wholeBytesAvailable(){return this.bytesAvailable+(this.bitsAvailable>>3)}},{key:"loadWord",value:function loadWord(){var position=this.data.byteLength-this.bytesAvailable,workingBytes=new Uint8Array(4),availableBytes=Math.min(4,this.bytesAvailable);if(availableBytes===0){throw new Error("no bytes available")}workingBytes.set(this.data.subarray(position,position+availableBytes));this.word=new DataView(workingBytes.buffer).getUint32(0);this.bitsAvailable=availableBytes*8;this.bytesAvailable-=availableBytes}},{key:"skipBits",value:function skipBits(count){var skipBytes;if(this.bitsAvailable>count){this.word<<=count;this.bitsAvailable-=count}else{count-=this.bitsAvailable;skipBytes=count>>3;count-=skipBytes>>3;this.bytesAvailable-=skipBytes;this.loadWord();this.word<<=count;this.bitsAvailable-=count}}},{key:"readBits",value:function readBits(size){var bits=Math.min(this.bitsAvailable,size),valu=this.word>>>32-bits;if(size>32){_logger.logger.error("Cannot read more than 32 bits at a time")}this.bitsAvailable-=bits;if(this.bitsAvailable>0){this.word<<=bits}else if(this.bytesAvailable>0){this.loadWord()}bits=size-bits;return bits>0&&this.bitsAvailable?valu<<bits|this.readBits(bits):valu}},{key:"skipLZ",value:function skipLZ(){var leadingZeroCount;for(leadingZeroCount=0;leadingZeroCount<this.bitsAvailable;++leadingZeroCount){if(0!==(this.word&2147483648>>>leadingZeroCount)){this.word<<=leadingZeroCount;this.bitsAvailable-=leadingZeroCount;return leadingZeroCount}}this.loadWord();return leadingZeroCount+this.skipLZ()}},{key:"skipUEG",value:function skipUEG(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function skipEG(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function readUEG(){var clz=this.skipLZ();return this.readBits(clz+1)-1}},{key:"readEG",value:function readEG(){var valu=this.readUEG();if(1&valu){return 1+valu>>>1}else{return-1*(valu>>>1)}}},{key:"readBoolean",value:function readBoolean(){return 1===this.readBits(1)}},{key:"readUByte",value:function readUByte(){return this.readBits(8)}},{key:"readUShort",value:function readUShort(){return this.readBits(16)}},{key:"readUInt",value:function readUInt(){return this.readBits(32)}},{key:"skipScalingList",value:function skipScalingList(count){var lastScale=8,nextScale=8,j,deltaScale;for(j=0;j<count;j++){if(nextScale!==0){deltaScale=this.readEG();nextScale=(lastScale+deltaScale+256)%256}lastScale=nextScale===0?lastScale:nextScale}}},{key:"readSPS",value:function readSPS(){var frameCropLeftOffset=0,frameCropRightOffset=0,frameCropTopOffset=0,frameCropBottomOffset=0,sarScale=1,profileIdc,profileCompat,levelIdc,numRefFramesInPicOrderCntCycle,picWidthInMbsMinus1,picHeightInMapUnitsMinus1,frameMbsOnlyFlag,scalingListCount,i;this.readUByte();profileIdc=this.readUByte();profileCompat=this.readBits(5);this.skipBits(3);levelIdc=this.readUByte();this.skipUEG();if(profileIdc===100||profileIdc===110||profileIdc===122||profileIdc===244||profileIdc===44||profileIdc===83||profileIdc===86||profileIdc===118||profileIdc===128){var chromaFormatIdc=this.readUEG();if(chromaFormatIdc===3){this.skipBits(1)}this.skipUEG();this.skipUEG();this.skipBits(1);if(this.readBoolean()){scalingListCount=chromaFormatIdc!==3?8:12;for(i=0;i<scalingListCount;i++){if(this.readBoolean()){if(i<6){this.skipScalingList(16)}else{this.skipScalingList(64)}}}}}this.skipUEG();var picOrderCntType=this.readUEG();if(picOrderCntType===0){this.readUEG()}else if(picOrderCntType===1){this.skipBits(1);this.skipEG();this.skipEG();numRefFramesInPicOrderCntCycle=this.readUEG();for(i=0;i<numRefFramesInPicOrderCntCycle;i++){this.skipEG()}}this.skipUEG();this.skipBits(1);picWidthInMbsMinus1=this.readUEG();picHeightInMapUnitsMinus1=this.readUEG();frameMbsOnlyFlag=this.readBits(1);if(frameMbsOnlyFlag===0){this.skipBits(1)}this.skipBits(1);if(this.readBoolean()){frameCropLeftOffset=this.readUEG();frameCropRightOffset=this.readUEG();frameCropTopOffset=this.readUEG();frameCropBottomOffset=this.readUEG()}if(this.readBoolean()){if(this.readBoolean()){var sarRatio=void 0;var aspectRatioIdc=this.readUByte();switch(aspectRatioIdc){case 1:sarRatio=[1,1];break;case 2:sarRatio=[12,11];break;case 3:sarRatio=[10,11];break;case 4:sarRatio=[16,11];break;case 5:sarRatio=[40,33];break;case 6:sarRatio=[24,11];break;case 7:sarRatio=[20,11];break;case 8:sarRatio=[32,11];break;case 9:sarRatio=[80,33];break;case 10:sarRatio=[18,11];break;case 11:sarRatio=[15,11];break;case 12:sarRatio=[64,33];break;case 13:sarRatio=[160,99];break;case 14:sarRatio=[4,3];break;case 15:sarRatio=[3,2];break;case 16:sarRatio=[2,1];break;case 255:{sarRatio=[this.readUByte()<<8|this.readUByte(),this.readUByte()<<8|this.readUByte()];break}}if(sarRatio){sarScale=sarRatio[0]/sarRatio[1]}}}return{width:Math.ceil(((picWidthInMbsMinus1+1)*16-frameCropLeftOffset*2-frameCropRightOffset*2)*sarScale),height:(2-frameMbsOnlyFlag)*(picHeightInMapUnitsMinus1+1)*16-(frameMbsOnlyFlag?2:4)*(frameCropTopOffset+frameCropBottomOffset)}}},{key:"readSliceType",value:function readSliceType(){this.readUByte();this.readUEG();return this.readUEG()}}]);return ExpGolomb}();exports.default=ExpGolomb},{"../utils/logger":39}],19:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _logger=_dereq_("../utils/logger");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ID3=function(){function ID3(data){_classCallCheck(this,ID3);this._hasTimeStamp=false;var offset=0,byte1,byte2,byte3,byte4,tagSize,endPos,header,len;do{header=this.readUTF(data,offset,3);offset+=3;if(header==="ID3"){offset+=3;byte1=data[offset++]&127;byte2=data[offset++]&127;byte3=data[offset++]&127;byte4=data[offset++]&127;tagSize=(byte1<<21)+(byte2<<14)+(byte3<<7)+byte4;endPos=offset+tagSize;this._parseID3Frames(data,offset,endPos);offset=endPos}else if(header==="3DI"){offset+=7;_logger.logger.log("3DI footer found, end: "+offset)}else{offset-=3;len=offset;if(len){if(!this.hasTimeStamp){_logger.logger.warn("ID3 tag found, but no timestamp")}this._length=len;this._payload=data.subarray(0,len)}return}}while(true)}_createClass(ID3,[{key:"readUTF",value:function readUTF(data,start,len){var result="",offset=start,end=start+len;do{result+=String.fromCharCode(data[offset++])}while(offset<end);return result}},{key:"_parseID3Frames",value:function _parseID3Frames(data,offset,endPos){var tagId,tagLen,tagStart,tagFlags,timestamp;while(offset+8<=endPos){tagId=this.readUTF(data,offset,4);offset+=4;tagLen=data[offset++]<<24+data[offset++]<<16+data[offset++]<<8+data[offset++];tagFlags=data[offset++]<<8+data[offset++];tagStart=offset;switch(tagId){case"PRIV":if(this.readUTF(data,offset,44)==="com.apple.streaming.transportStreamTimestamp"){offset+=44;offset+=4;var pts33Bit=data[offset++]&1;this._hasTimeStamp=true;timestamp=((data[offset++]<<23)+(data[offset++]<<15)+(data[offset++]<<7)+data[offset++])/45;if(pts33Bit){timestamp+=47721858.84}timestamp=Math.round(timestamp);_logger.logger.trace("ID3 timestamp found: "+timestamp);this._timeStamp=timestamp}break;default:break}}}},{key:"hasTimeStamp",get:function get(){return this._hasTimeStamp}},{key:"timeStamp",get:function get(){return this._timeStamp}},{key:"length",get:function get(){return this._length}},{key:"payload",get:function get(){return this._payload}}]);return ID3}();exports.default=ID3},{"../utils/logger":39}],20:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _adts=_dereq_("./adts");var _adts2=_interopRequireDefault(_adts);var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _expGolomb=_dereq_("./exp-golomb");var _expGolomb2=_interopRequireDefault(_expGolomb);var _logger=_dereq_("../utils/logger");var _errors=_dereq_("../errors");_dereq_("../utils/polyfill");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TSDemuxer=function(){function TSDemuxer(observer,remuxerClass,config){_classCallCheck(this,TSDemuxer);this.observer=observer;this.remuxerClass=remuxerClass;this.config=config;this.lastCC=0;this._setEmptyTracks();this._clearAllData();this.remuxer=new this.remuxerClass(observer,config)}_createClass(TSDemuxer,[{key:"_setEmptyTracks",value:function _setEmptyTracks(){this._avcTrack=Object.assign({},this._avcTrack,{container:"video/mp2t",type:"video",samples:[],len:0,nbNalu:0,sps:undefined,pps:undefined});this._aacTrack=Object.assign({},this._aacTrack,{container:"video/mp2t",type:"audio",samples:[],len:0});this._id3Track=Object.assign({},this._id3Track,{type:"id3",samples:[],len:0});this._txtTrack=Object.assign({},this._txtTrack,{type:"text",samples:[],len:0});this._avcTrack.sequenceNumber=this._avcTrack.sequenceNumber|0;this._aacTrack.sequenceNumber=this._aacTrack.sequenceNumber|0;this._id3Track.sequenceNumber=this._id3Track.sequenceNumber|0;this._txtTrack.sequenceNumber=this._txtTrack.sequenceNumber|0}},{key:"_clearIDs",value:function _clearIDs(){this._aacTrack.id=this._avcTrack.id=this._id3Track.id=this._txtTrack.id=-1}},{key:"switchLevel",value:function switchLevel(){if(this._avcTrack.samples.length){this.remux(null,false,true,false)}this.pmtParsed=false;this._pmtId=-1;this._setEmptyTracks();this._clearAllData();this._clearIDs();this.aacOverFlow=null;this.lastAacPTS=null;this.remuxer.switchLevel()}},{key:"_clearAvcData",value:function _clearAvcData(){return this._avcData={data:[],size:0}}},{key:"_clearAacData",value:function _clearAacData(){return this._aacData={data:[],size:0}}},{key:"_clearID3Data",value:function _clearID3Data(){return this._id3Data={data:[],size:0}}},{key:"_clearAllData",value:function _clearAllData(){this._clearAvcData();this._clearAacData();this._clearID3Data()}},{key:"insertDiscontinuity",value:function insertDiscontinuity(){this.switchLevel();this.remuxer.insertDiscontinuity()}},{key:"push",value:function push(data,audioCodec,videoCodec,timeOffset,cc,level,sn,duration,accurate,first,final,lastSN){var avcData=this._avcData,aacData=this._aacData,pes,id3Data=this._id3Data,start,len=data.length,stt,pid,atf,offset,codecsOnly=this.remuxer.passthrough,unknownPIDs=false;this.audioCodec=audioCodec;this.videoCodec=videoCodec;this.timeOffset=timeOffset;this.accurate=accurate;this._duration=duration;this.contiguous=false;if(cc!==this.lastCC){_logger.logger.log("discontinuity detected");this.insertDiscontinuity();this.lastCC=cc}if(level!==this.lastLevel){_logger.logger.log("level switch detected");this.switchLevel();this.lastLevel=level}if(sn===this.lastSN+1||!first){this.contiguous=true}else{if(this._avcTrack.samples.length){this.remux(null,false,true,false)}this.aacOverFlow=null;this._clearAllData();this._setEmptyTracks()}if(first){this.lastContiguous=sn===this.lastSN+1;this.fragStats={keyFrames:0,dropped:0,segment:sn,level:level};this.remuxAVCCount=this.remuxAACCount=0;this.fragStartPts=this.fragStartDts=this.gopStartDTS=undefined;this.fragStartAVCPos=this._avcTrack.samples.length;this.fragStartAACPos=this._aacTrack.samples.length;this.nextAvcDts=this.contiguous?this.remuxer.nextAvcDts:this.timeOffset*this.remuxer.PES_TIMESCALE}this.currentSN=sn;var avcId=this._avcTrack.id,aacId=this._aacTrack.id,id3Id=this._id3Track.id;len-=len%188;for(start=0;start<len;start+=188){if(data[start]===71){stt=!!(data[start+1]&64);pid=((data[start+1]&31)<<8)+data[start+2];atf=(data[start+3]&48)>>4;if(atf>1){offset=start+5+data[start+4];if(offset===start+188){continue}}else{offset=start+4}switch(pid){case avcId:if(stt){if(pes=this._parsePES(avcData)){this._parseAVCPES(pes);if(codecsOnly){if(this._avcTrack.codec&&(aacId===-1||this._aacTrack.codec)){this.remux(data);return}}}avcData=this._clearAvcData()}avcData.data.push(data.subarray(offset,start+188));avcData.size+=start+188-offset;break;case aacId:if(stt){if(pes=this._parsePES(aacData)){this._parseAACPES(pes);if(codecsOnly){if(this._aacTrack.codec&&(avcId===-1||this._avcTrack.codec)){this.remux(data);return}}}aacData=this._clearAacData()}aacData.data.push(data.subarray(offset,start+188));aacData.size+=start+188-offset;break;case id3Id:if(stt){if(pes=this._parsePES(id3Data)){this._parseID3PES(pes)}id3Data=this._clearID3Data()}id3Data.data.push(data.subarray(offset,start+188));id3Data.size+=start+188-offset;break;case 0:if(stt){offset+=data[offset]+1}this._parsePAT(data,offset);break;case this._pmtId:if(stt){offset+=data[offset]+1}this._parsePMT(data,offset);avcId=this._avcTrack.id;aacId=this._aacTrack.id;id3Id=this._id3Track.id;if(unknownPIDs&&!this.pmtParsed){_logger.logger.log("reparse from beginning");unknownPIDs=false;start=-188}this.pmtParsed=true;break;case 17:case 8191:break;default:unknownPIDs=true;break}}else{this.observer.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.FRAG_PARSING_ERROR,fatal:false,reason:"TS packet did not start with 0x47"})}}if(final){if(avcData.size){this._parseAVCPES(this._parsePES(avcData));this._clearAvcData()}if(aacData.size){this._parseAACPES(this._parsePES(aacData));this._clearAacData()}if(id3Data.size){this._parseID3PES(this._parsePES(id3Data));this._clearID3Data()}this.lastSN=sn}if(this.fragStartPts===undefined&&this._avcTrack.samples.length>this.fragStartAVCPos){this.fragStartPts=this._avcTrack.samples[this.fragStartAVCPos].pts;this.fragStartDts=this._avcTrack.samples[this.fragStartAVCPos].dts}if(this.gopStartDTS===undefined&&this._avcTrack.samples.length){this.gopStartDTS=this._avcTrack.samples[0].dts}this.remux(null,final,final&&sn===lastSN,true);if(final){this.observer.trigger(_events2.default.FRAG_STATISTICS,this.fragStats)}}},{key:"_recalcTrack",value:function _recalcTrack(track){if(track.hasOwnProperty("nbNalu")){track.nbNalu=0}track.len=0;for(var i=0;i<track.samples.length;i++){var sample=track.samples[i];track.len+=((sample.units&&sample.units.length)|0)+((sample.unit&&sample.unit.length)|0)+(sample.len|0)+((sample.bytes&&sample.bytes.length)|0);if(track.hasOwnProperty("nbNalu")){track.nbNalu+=sample.units.units.length}}}},{key:"_filterSamples",value:function _filterSamples(track,end,_save){var _new=[];for(var i=0;i<track.samples.length;i++){var sample=track.samples[i];var sampleTime=sample.dts||sample.pts;if(sampleTime<=end){_new.push(sample)}else{_save.push(sample)}}track.samples=_new;this._recalcTrack(track)}},{key:"remux",value:function remux(data,final,flush,lastSegment){var _saveAVCSamples=[],_saveAACSamples=[],_saveID3Samples=[],_saveTextSamples=[],maxk,samples=this._avcTrack.samples,startPTS,endPTS,gopEndDTS,initDTS;var timescale=this.remuxer.PES_TIMESCALE;if(samples.length&&final){this.fragStats.PTSDTSshift=((this.fragStartPts===undefined?samples[0].pts:this.fragStartPts)-(this.fragStartDts===undefined?samples[0].dts:this.fragStartDts))/timescale;initDTS=this.remuxer._initDTS===undefined?samples[0].dts-timescale*this.timeOffset:this.remuxer._initDTS;var startDTS=Math.max(this.remuxer._PTSNormalize((this.gopStartDTS===undefined?samples[0].dts:this.gopStartDTS)-initDTS,this.nextAvcDts),0);var sample=samples[samples.length-1];var videoStartPTS=Math.max(this.remuxer._PTSNormalize((this.fragStartPts===undefined?samples[0].pts:this.fragStartPts)-initDTS,this.nextAvcDts),0)/timescale;var videoEndPTS=Math.max(this.remuxer._PTSNormalize(sample.pts-initDTS,this.nextAvcDts),0)/timescale;if(this.accurate&&Math.abs(startDTS-this.nextAvcDts)>90){videoStartPTS-=(startDTS-this.nextAvcDts)/timescale}if(samples.length+this.remuxAVCCount>this.fragStartAVCPos+1&&this.fragStartDts!==undefined){videoEndPTS+=(sample.dts-this.fragStartDts)/(samples.length+this.remuxAVCCount-this.fragStartAVCPos-1)/timescale}startPTS=videoStartPTS;endPTS=videoEndPTS;if(this._aacTrack.audiosamplerate){var expectedSampleDuration=1024/this._aacTrack.audiosamplerate;var remuxAACCount=this._aacTrack.samples.length;var nextAacPTS=(this.lastContiguous!==undefined&&this.lastContiguous||this.contiguous&&this.remuxAACCount)&&this.remuxer.nextAacPts?this.remuxer.nextAacPts/timescale:this.accurate?this.timeOffset:startPTS;startPTS=Math.max(startPTS,nextAacPTS+(this.fragStartAACPos-this.remuxAACCount)*expectedSampleDuration);if(remuxAACCount){endPTS=Math.min(endPTS,nextAacPTS+expectedSampleDuration*remuxAACCount)}var AVUnsync=void 0;if((AVUnsync=endPTS-startPTS+videoStartPTS-videoEndPTS)>.2){this.fragStats.AVUnsync=AVUnsync}}}if(!flush){for(maxk=samples.length-1;maxk>0;maxk--){if(samples[maxk].key){if(maxk&&(samples[maxk-1].dts-initDTS)/timescale<startPTS){
maxk=0}break}}if(maxk>0){_saveAVCSamples=samples.slice(maxk);this._avcTrack.samples=samples.slice(0,maxk);gopEndDTS=this._avcTrack.samples[maxk-1].dts;this._recalcTrack(this._avcTrack);this._filterSamples(this._aacTrack,gopEndDTS,_saveAACSamples);this._filterSamples(this._id3Track,gopEndDTS,_saveID3Samples);this._filterSamples(this._txtTrack,gopEndDTS,_saveTextSamples)}}if((flush||final&&!this.remuxAVCCount)&&this._avcTrack.samples.length+this._aacTrack.samples.length||maxk>0){this.remuxAVCCount+=this._avcTrack.samples.length;this.remuxAACCount+=this._aacTrack.samples.length;this.remuxer.remux(this._aacTrack,this._avcTrack,this._id3Track,this._txtTrack,flush&&this.nextStartPts?this.nextStartPts:this.timeOffset,flush&&!lastSegment||(this.lastContiguous!==undefined?this.lastContiguous:this.contiguous),this.accurate,data,flush,this.fragStats);this.lastContiguous=undefined;this.nextStartPts=this.remuxer.endPTS;this._avcTrack.samples=_saveAVCSamples;this._aacTrack.samples=_saveAACSamples;this._id3Track.samples=_saveID3Samples;this._txtTrack.samples=_saveTextSamples;this._recalcTrack(this._avcTrack);this._recalcTrack(this._aacTrack);this._recalcTrack(this._id3Track);this._recalcTrack(this._txtTrack)}if(final){var lastGopPTS=Math.min(this.remuxer.nextAvcDts,this.remuxer.nextAacPts)/timescale;this.observer.trigger(_events2.default.FRAG_PARSED,{startPTS:startPTS,endPTS:endPTS,PTSDTSshift:this.fragStats.PTSDTSshift,lastGopPTS:lastGopPTS})}}},{key:"destroy",value:function destroy(){this.switchLevel();this._initPTS=this._initDTS=undefined;this._duration=0}},{key:"_parsePAT",value:function _parsePAT(data,offset){this._pmtId=(data[offset+10]&31)<<8|data[offset+11]}},{key:"_parsePMT",value:function _parsePMT(data,offset){var sectionLength,tableEnd,programInfoLength,pid;sectionLength=(data[offset+1]&15)<<8|data[offset+2];tableEnd=offset+3+sectionLength-4;programInfoLength=(data[offset+10]&15)<<8|data[offset+11];offset+=12+programInfoLength;while(offset<tableEnd){pid=(data[offset+1]&31)<<8|data[offset+2];switch(data[offset]){case 15:if(this._aacTrack.id===-1){this._aacTrack.id=pid}break;case 21:if(this._id3Track.id===-1){this._id3Track.id=pid}break;case 27:if(this._avcTrack.id===-1){this._avcTrack.id=pid}break;case 36:this.fragStats.HEVC=(this.fragStats.HEVC|0)+1;_logger.logger.warn("HEVC stream type found, not supported for now");break;default:this.fragStats.unknownStream=(this.fragStats.unknownStream|0)+1;_logger.logger.log("unkown stream type:"+data[offset]);break}offset+=((data[offset+3]&15)<<8|data[offset+4])+5}}},{key:"_parsePES",value:function _parsePES(stream){var i=0,frag,pesFlags,pesPrefix,pesLen,pesHdrLen,pesData,pesPts,pesDts,payloadStartOffset,data=stream.data;if(!stream||stream.size===0){return null}while(data[0].length<19&&data.length>1){var newData=new Uint8Array(data[0].length+data[1].length);newData.set(data[0]);newData.set(data[1],data[0].length);data[0]=newData;data.splice(1,1)}frag=data[0];pesPrefix=(frag[0]<<16)+(frag[1]<<8)+frag[2];if(pesPrefix===1){pesLen=(frag[4]<<8)+frag[5];if(pesLen&&pesLen>stream.size-6){return null}pesFlags=frag[7];if(pesFlags&192){pesPts=(frag[9]&14)*536870912+(frag[10]&255)*4194304+(frag[11]&254)*16384+(frag[12]&255)*128+(frag[13]&254)/2;if(pesPts>4294967295){pesPts-=8589934592}if(pesFlags&64){pesDts=(frag[14]&14)*536870912+(frag[15]&255)*4194304+(frag[16]&254)*16384+(frag[17]&255)*128+(frag[18]&254)/2;if(pesDts>4294967295){pesDts-=8589934592}if(pesPts-pesDts>60*9e4){_logger.logger.warn(Math.round((pesPts-pesDts)/9e4)+"s delta between PTS and DTS, align them");pesPts=pesDts}}else{pesDts=pesPts}}pesHdrLen=frag[8];payloadStartOffset=pesHdrLen+9;stream.size-=payloadStartOffset;pesData=new Uint8Array(stream.size);while(data.length){frag=data.shift();var len=frag.byteLength;if(payloadStartOffset){if(payloadStartOffset>len){payloadStartOffset-=len;continue}else{frag=frag.subarray(payloadStartOffset);len-=payloadStartOffset;payloadStartOffset=0}}pesData.set(frag,i);i+=len}if(pesLen){pesLen-=pesHdrLen+3}return{data:pesData,pts:pesPts,dts:pesDts,len:pesLen}}else{return null}}},{key:"_parseAVCPES",value:function _parseAVCPES(pes){var _this=this;var track=this._avcTrack,samples=track.samples,units=this._parseAVCNALu(pes.data),units2=[],debug=false,key=false,length=0,expGolombDecoder,avcSample,push,hlsConfig=this.config,i;if(units.length===0&&samples.length>0){var lastavcSample=samples[samples.length-1];var lastUnit=lastavcSample.units.units[lastavcSample.units.units.length-1];var tmp=new Uint8Array(lastUnit.data.byteLength+pes.data.byteLength);tmp.set(lastUnit.data,0);tmp.set(pes.data,lastUnit.data.byteLength);lastUnit.data=tmp;lastavcSample.units.length+=pes.data.byteLength;track.len+=pes.data.byteLength}pes.data=null;var debugString="";units.forEach(function(unit){switch(unit.type){case 1:push=true;if(debug){debugString+="NDR "}var data=unit.data;if(data.length>1){var sliceType=new _expGolomb2.default(data).readSliceType();if(sliceType===2||sliceType===4||sliceType===7||sliceType===9){key=true}}break;case 5:push=true;if(debug){debugString+="IDR "}key=true;break;case 6:push=true;if(debug){debugString+="SEI "}expGolombDecoder=new _expGolomb2.default(_this.discardEPB(unit.data));expGolombDecoder.readUByte();var payloadType=0;var payloadSize=0;var endOfCaptions=false;var b=0;while(!endOfCaptions&&expGolombDecoder.wholeBytesAvailable()>1){payloadType=0;do{b=expGolombDecoder.readUByte();payloadType+=b}while(b===255);payloadSize=0;do{b=expGolombDecoder.readUByte();payloadSize+=b}while(b===255);if(!hlsConfig.disableSEIkeyframes){key=key||payloadType===6}if(payloadType===4&&expGolombDecoder.wholeBytesAvailable()!==0){endOfCaptions=true;var countryCode=expGolombDecoder.readUByte();if(countryCode===181){var providerCode=expGolombDecoder.readUShort();if(providerCode===49){var userStructure=expGolombDecoder.readUInt();if(userStructure===1195456820){var userDataType=expGolombDecoder.readUByte();if(userDataType===3){var firstByte=expGolombDecoder.readUByte();var secondByte=expGolombDecoder.readUByte();var totalCCs=31&firstByte;var byteArray=[firstByte,secondByte];for(i=0;i<totalCCs;i++){byteArray.push(expGolombDecoder.readUByte());byteArray.push(expGolombDecoder.readUByte());byteArray.push(expGolombDecoder.readUByte())}_this._insertSampleInOrder(_this._txtTrack.samples,{type:3,pts:pes.pts,bytes:byteArray})}}}}}else if(payloadSize<expGolombDecoder.wholeBytesAvailable()){for(i=0;i<payloadSize;i++){expGolombDecoder.readUByte()}}}break;case 7:push=true;if(debug){debugString+="SPS "}if(!track.sps){expGolombDecoder=new _expGolomb2.default(unit.data);var config=expGolombDecoder.readSPS();track.width=config.width;track.height=config.height;track.sps=[unit.data];track.duration=_this._duration;var codecarray=unit.data.subarray(1,4);var codecstring="avc1.";for(i=0;i<3;i++){var h=codecarray[i].toString(16);if(h.length<2){h="0"+h}codecstring+=h}track.codec=codecstring}break;case 8:push=true;if(debug){debugString+="PPS "}if(!track.pps){track.pps=[unit.data]}break;case 9:push=false;if(debug){debugString+="AUD "}break;case 12:push=false;break;default:push=false;debugString+="unknown NAL "+unit.type+" ";break}if(push){units2.push(unit);length+=unit.data.byteLength}});if(debug||debugString.length){_logger.logger.log(debugString)}if(units2.length){if(key===true||track.sps&&(samples.length||this.contiguous)){avcSample={units:{units:units2,length:length},pts:pes.pts,dts:pes.dts,key:key};if(key){this.fragStats.keyFrames++}samples.push(avcSample);track.len+=length;track.nbNalu+=units2.length}else{this.fragStats.dropped++}}}},{key:"_insertSampleInOrder",value:function _insertSampleInOrder(arr,data){var len=arr.length;if(len>0){if(data.pts>=arr[len-1].pts){arr.push(data)}else{for(var pos=len-1;pos>=0;pos--){if(data.pts<arr[pos].pts){arr.splice(pos,0,data);break}}}}else{arr.push(data)}}},{key:"_parseAVCNALu",value:function _parseAVCNALu(array){var i=0,len=array.byteLength,value,overflow,state=0;var units=[],unit,unitType,lastUnitStart,lastUnitType;while(i<len){value=array[i++];switch(state){case 0:if(value===0){state=1}break;case 1:if(value===0){state=2}else{state=0}break;case 2:case 3:if(value===0){state=3}else if(value===1&&i<len){unitType=array[i]&31;if(lastUnitStart){unit={data:array.subarray(lastUnitStart,i-state-1),type:lastUnitType};units.push(unit)}else{overflow=i-state-1;if(overflow){var track=this._avcTrack,samples=track.samples;if(samples.length){var lastavcSample=samples[samples.length-1],lastUnits=lastavcSample.units.units,lastUnit=lastUnits[lastUnits.length-1],tmp=new Uint8Array(lastUnit.data.byteLength+overflow);tmp.set(lastUnit.data,0);tmp.set(array.subarray(0,overflow),lastUnit.data.byteLength);lastUnit.data=tmp;lastavcSample.units.length+=overflow;track.len+=overflow}}}lastUnitStart=i;lastUnitType=unitType;state=0}else{state=0}break;default:break}}if(lastUnitStart){unit={data:array.subarray(lastUnitStart,len),type:lastUnitType};units.push(unit)}return units}},{key:"discardEPB",value:function discardEPB(data){var length=data.byteLength,EPBPositions=[],i=1,newLength,newData;while(i<length-2){if(data[i]===0&&data[i+1]===0&&data[i+2]===3){EPBPositions.push(i+2);i+=2}else{i++}}if(EPBPositions.length===0){return data}newLength=length-EPBPositions.length;newData=new Uint8Array(newLength);var sourceIndex=0;for(i=0;i<newLength;sourceIndex++,i++){if(sourceIndex===EPBPositions[0]){sourceIndex++;EPBPositions.shift()}newData[i]=data[sourceIndex]}return newData}},{key:"_parseAACPES",value:function _parseAACPES(pes){var track=this._aacTrack,data=pes.data,pts=pes.pts,startOffset=0,duration=this._duration,audioCodec=this.audioCodec,aacOverFlow=this.aacOverFlow,lastAacPTS=this.lastAacPTS,config,frameLength,frameDuration,frameIndex,offset,headerLength,stamp,len,aacSample;if(aacOverFlow){var tmp=new Uint8Array(aacOverFlow.byteLength+data.byteLength);tmp.set(aacOverFlow,0);tmp.set(data,aacOverFlow.byteLength);data=tmp}for(offset=startOffset,len=data.length;offset<len-1;offset++){if(data[offset]===255&&(data[offset+1]&240)===240){break}}if(offset){var reason,fatal;if(offset<len-1){reason="AAC PES did not start with ADTS header,offset:"+offset;fatal=false}else{reason="no ADTS header found in AAC PES";fatal=true}this.observer.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.FRAG_PARSING_ERROR,fatal:fatal,reason:reason});if(fatal){return}}config=_adts2.default.getAudioConfig(this.observer,data,offset,audioCodec);if(track.audiosamplerate!==config.samplerate||track.codec!==config.codec){track.config=config.config;track.audiosamplerate=config.samplerate;track.channelCount=config.channelCount;track.codec=config.codec;track.duration=duration;_logger.logger.log("parsed codec:"+track.codec+",rate:"+config.samplerate+",nb channel:"+config.channelCount)}frameIndex=0;frameDuration=1024*9e4/track.audiosamplerate;if(aacOverFlow&&lastAacPTS){var newPTS=lastAacPTS+frameDuration;if(Math.abs(newPTS-pts)>1){_logger.logger.log("AAC: align PTS for overlapping frames by "+Math.round((newPTS-pts)/90));pts=newPTS}}while(offset+5<len){headerLength=!!(data[offset+1]&1)?7:9;frameLength=(data[offset+3]&3)<<11|data[offset+4]<<3|(data[offset+5]&224)>>>5;frameLength-=headerLength;if(frameLength>0&&offset+headerLength+frameLength<=len){stamp=pts+frameIndex*frameDuration;aacSample={unit:data.subarray(offset+headerLength,offset+headerLength+frameLength),pts:stamp,dts:stamp};track.samples.push(aacSample);track.len+=frameLength;offset+=frameLength+headerLength;frameIndex++;for(;offset<len-1;offset++){if(data[offset]===255&&(data[offset+1]&240)===240){break}}}else{break}}if(offset<len){aacOverFlow=data.subarray(offset,len)}else{aacOverFlow=null}this.aacOverFlow=aacOverFlow;this.lastAacPTS=stamp}},{key:"_parseID3PES",value:function _parseID3PES(pes){this._id3Track.samples.push(pes)}}],[{key:"probe",value:function probe(data){return data.length>=3*188&&data[0]===71&&data[188]===71&&data[2*188]===71}}]);return TSDemuxer}();exports.default=TSDemuxer},{"../errors":21,"../events":23,"../utils/logger":39,"../utils/polyfill":40,"./adts":14,"./exp-golomb":18}],21:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var ErrorTypes=exports.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",OTHER_ERROR:"otherError"};var ErrorDetails=exports.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",INTERNAL_EXCEPTION:"internalException"}},{}],22:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _logger=_dereq_("./utils/logger");var _errors=_dereq_("./errors");var _events=_dereq_("./events");var _events2=_interopRequireDefault(_events);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var EventHandler=function(){function EventHandler(hls){_classCallCheck(this,EventHandler);this.hls=hls;this.onEvent=this.onEvent.bind(this);for(var _len=arguments.length,events=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){events[_key-1]=arguments[_key]}this.handledEvents=events;this.useGenericHandler=true;this.registerListeners()}_createClass(EventHandler,[{key:"destroy",value:function destroy(){this.unregisterListeners()}},{key:"isEventHandler",value:function isEventHandler(){return _typeof(this.handledEvents)==="object"&&this.handledEvents.length&&typeof this.onEvent==="function"}},{key:"registerListeners",value:function registerListeners(){if(this.isEventHandler()){this.handledEvents.forEach(function(event){if(event==="hlsEventGeneric"){throw new Error("Forbidden event name: "+event)}this.hls.on(event,this.onEvent)}.bind(this))}}},{key:"unregisterListeners",value:function unregisterListeners(){if(this.isEventHandler()){this.handledEvents.forEach(function(event){this.hls.off(event,this.onEvent)}.bind(this))}}},{key:"onEvent",value:function onEvent(event,data){this.onEventGeneric(event,data)}},{key:"onEventGeneric",value:function onEventGeneric(event,data){var eventToFunction=function eventToFunction(event,data){var funcName="on"+event.replace("hls","");if(typeof this[funcName]!=="function"){throw new Error("Event "+event+" has no generic handler in this "+this.constructor.name+" class (tried "+funcName+")")}return this[funcName].bind(this,data)};try{eventToFunction.call(this,event,data).call()}catch(err){_logger.logger.error("internal error happened while processing "+event+":"+err.message);this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.OTHER_ERROR,details:_errors.ErrorDetails.INTERNAL_EXCEPTION,fatal:false,event:event,err:err})}}}]);return EventHandler}();exports.default=EventHandler},{"./errors":21,"./events":23,"./utils/logger":39}],23:[function(_dereq_,module,exports){module.exports={PLAYER_CREATED:"hlsPlayerCreated",PLAYER_DESTROYED:"hlsPlayerDestroyed",MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVEL_SWITCH:"hlsLevelSwitch",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_CHUNK_LOADED:"hlsFragChunkLoaded",FRAG_LOADED:"hlsFragLoaded",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_STATISTICS:"hlsFragStatistics",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FRAG_APPENDING:"hlsFragAppending",FRAG_APPENDED:"hlsFragAppended",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",DEMUXER_QUEUE_EMPTY:"hlsDemuxerQueueEmpty"}},{}],24:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AAC=function(){function AAC(){_classCallCheck(this,AAC)}_createClass(AAC,null,[{key:"getSilentFrame",value:function getSilentFrame(channelCount){if(channelCount===1){return new Uint8Array([0,200,0,128,35,128])}else if(channelCount===2){return new Uint8Array([33,0,73,144,2,25,0,35,128])}else if(channelCount===3){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142])}else if(channelCount===4){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56])}else if(channelCount===5){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56])}else if(channelCount===6){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}return null}}]);return AAC}();exports.default=AAC},{}],25:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var BufferHelper=function(){function BufferHelper(){_classCallCheck(this,BufferHelper)}_createClass(BufferHelper,null,[{key:"isBuffered",value:function isBuffered(media,position){if(media){var buffered=media.buffered;for(var i=0;i<buffered.length;i++){if(position>=buffered.start(i)&&position<=buffered.end(i)){return true}}}return false}},{key:"bufferInfo",value:function bufferInfo(media,pos,maxHoleDuration){if(media){var vbuffered=media.buffered,buffered=[],i;for(i=0;i<vbuffered.length;i++){buffered.push({start:vbuffered.start(i),end:vbuffered.end(i)})}return this.bufferedInfo(buffered,pos,maxHoleDuration)}else{return{len:0,start:0,end:0,nextStart:undefined}}}},{key:"bufferedInfo",value:function bufferedInfo(buffered,pos,maxHoleDuration){var buffered2=[],bufferLen,bufferStart,bufferEnd,bufferStartNext,i;buffered.sort(function(a,b){var diff=a.start-b.start;if(diff){return diff}else{return b.end-a.end}});for(i=0;i<buffered.length;i++){var buf2len=buffered2.length;if(buf2len){var buf2end=buffered2[buf2len-1].end;if(buffered[i].start-buf2end<maxHoleDuration){if(buffered[i].end>buf2end){buffered2[buf2len-1].end=buffered[i].end}}else{buffered2.push(buffered[i])}}else{buffered2.push(buffered[i])}}for(i=0,bufferLen=0,bufferStart=bufferEnd=pos;i<buffered2.length;i++){var start=buffered2[i].start,end=buffered2[i].end;if(pos+maxHoleDuration>=start&&pos<end){bufferStart=start;bufferEnd=end;bufferLen=bufferEnd-pos}else if(pos+maxHoleDuration<start){bufferStartNext=start;break}}return{len:bufferLen,start:bufferStart,end:bufferEnd,nextStart:bufferStartNext}}}]);return BufferHelper}();exports.default=BufferHelper},{}],26:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _logger=_dereq_("../utils/logger");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var LevelHelper=function(){function LevelHelper(){_classCallCheck(this,LevelHelper)}_createClass(LevelHelper,null,[{key:"probeDetails",value:function probeDetails(oldDetails,newDetails){function getTimes(details){var startTS=0,endTS=0,i=0;for(;i<details.fragments.length;i++){if(details.fragments[i].programDateTime){break}}if(i!==details.fragments.length){startTS=endTS=details.fragments[i].programDateTime.getTime();for(var j=0;j<details.fragments.length-1;j++){if(j<i){startTS-=details.fragments[j].duration*1e3}else{endTS+=details.fragments[j].duration*1e3}}return{start:startTS,end:endTS}}}var start=Math.max(oldDetails.startSN,newDetails.startSN)-newDetails.startSN;var end=Math.min(oldDetails.endSN,newDetails.endSN)-newDetails.startSN;var delta=newDetails.startSN-oldDetails.startSN;if(end>=start){return{start:start,end:end,delta:delta}}var oldTimes=getTimes(oldDetails),newTimes=getTimes(newDetails);if(oldTimes&&newTimes&&oldTimes.start<=newTimes.start&&oldTimes.end>=newTimes.start){start=delta=0;end=Math.min(newDetails.fragments.length,oldDetails.fragments.length)-1;var ts=oldTimes.start;while(newTimes.start-ts>100){ts+=oldDetails.fragments[delta++].duration*1e3;end--}return{start:start,end:end,delta:delta}}return{start:1,end:0,delta:0}}},{key:"mergeDetails",value:function mergeDetails(oldDetails,newDetails){var oldfragments=oldDetails.fragments,newfragments=newDetails.fragments,ccOffset=0,PTSFrag;var _LevelHelper$probeDet=LevelHelper.probeDetails(oldDetails,newDetails),start=_LevelHelper$probeDet.start,end=_LevelHelper$probeDet.end,delta=_LevelHelper$probeDet.delta;if(end<start){newDetails.PTSKnown=false;return}for(var i=start;i<=end;i++){var oldFrag=oldfragments[delta+i],newFrag=newfragments[i];ccOffset=oldFrag.cc-newFrag.cc;if(!isNaN(oldFrag.startPTS)){newFrag.start=newFrag.startPTS=oldFrag.startPTS;newFrag.endPTS=oldFrag.endPTS;newFrag.duration=oldFrag.duration;newFrag.PTSDTSshift=oldFrag.PTSDTSshift;newFrag.lastGop=oldFrag.lastGop;PTSFrag=newFrag}if(oldFrag.firstGop){newFrag.firstGop=oldFrag.firstGop}}if(ccOffset){_logger.logger.log("discontinuity sliding from playlist, take drift into account");for(i=0;i<newfragments.length;i++){newfragments[i].cc+=ccOffset}}if(PTSFrag){LevelHelper.updateFragPTS(newDetails,PTSFrag.sn,PTSFrag.startPTS,PTSFrag.endPTS,PTSFrag.PTSDTSshift||0,PTSFrag.lastGop)}else{if(delta>=0&&delta<oldfragments.length){var sliding=oldfragments[delta].start;for(i=0;i<newfragments.length;i++){newfragments[i].start+=sliding}}}newDetails.PTSKnown=oldDetails.PTSKnown;return}},{key:"updateFragPTS",value:function updateFragPTS(details,sn,startPTS,endPTS,PTSDTSshift,lastGop){var fragIdx,fragments,frag,i;if(sn<details.startSN||sn>details.endSN){return 0}fragIdx=sn-details.startSN;fragments=details.fragments;frag=fragments[fragIdx];if(!isNaN(frag.startPTS)){startPTS=Math.min(startPTS,frag.startPTS);endPTS=Math.max(endPTS,frag.endPTS)}var drift=startPTS-frag.start;frag.start=frag.startPTS=startPTS;frag.endPTS=endPTS;frag.duration=endPTS-startPTS;frag.PTSDTSshift=PTSDTSshift||0;if(lastGop){frag.lastGop=lastGop}for(i=fragIdx;i>0;i--){LevelHelper.updatePTS(fragments,i,i-1)}for(i=fragIdx;i<fragments.length-1;i++){LevelHelper.updatePTS(fragments,i,i+1)}details.PTSKnown=true;return drift}},{key:"updatePTS",value:function updatePTS(fragments,fromIdx,toIdx){var fragFrom=fragments[fromIdx],fragTo=fragments[toIdx],fragToPTS=fragTo.startPTS;if(!isNaN(fragToPTS)){if(toIdx>fromIdx){fragFrom.duration=fragToPTS-fragFrom.start;if(fragFrom.duration<0){_logger.logger.error("negative duration computed for frag "+fragFrom.sn+",level "+fragFrom.level+", there should be some duration drift between playlist and fragment!")}}else{fragTo.duration=fragFrom.start-fragToPTS;if(fragTo.duration<0){_logger.logger.error("negative duration computed for frag "+fragTo.sn+",level "+fragTo.level+", there should be some duration drift between playlist and fragment!")}}}else{if(toIdx>fromIdx){fragTo.start=fragFrom.start+fragFrom.duration}else{fragTo.start=fragFrom.start-fragTo.duration}}if(toIdx>fromIdx){if(!fragTo.PTSDTSshift){fragTo.PTSDTSshift=fragFrom.PTSDTSshift||0}if(fragFrom.lastGop){fragTo.firstGop=fragFrom.lastGop}}}}]);return LevelHelper}();exports.default=LevelHelper},{"../utils/logger":39}],27:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("./events");var _events2=_interopRequireDefault(_events);var _errors=_dereq_("./errors");var _playlistLoader=_dereq_("./loader/playlist-loader");var _playlistLoader2=_interopRequireDefault(_playlistLoader);var _fragmentLoader=_dereq_("./loader/fragment-loader");var _fragmentLoader2=_interopRequireDefault(_fragmentLoader);var _abrController=_dereq_("./controller/abr-controller");var _abrController2=_interopRequireDefault(_abrController);var _bufferController=_dereq_("./controller/buffer-controller");var _bufferController2=_interopRequireDefault(_bufferController);var _capLevelController=_dereq_("./controller/cap-level-controller");var _capLevelController2=_interopRequireDefault(_capLevelController);var _streamController=_dereq_("./controller/stream-controller");var _streamController2=_interopRequireDefault(_streamController);var _levelController=_dereq_("./controller/level-controller");var _levelController2=_interopRequireDefault(_levelController);var _timelineController=_dereq_("./controller/timeline-controller");var _timelineController2=_interopRequireDefault(_timelineController);var _fpsController=_dereq_("./controller/fps-controller");var _fpsController2=_interopRequireDefault(_fpsController);var _logger=_dereq_("./utils/logger");var _xhrLoader=_dereq_("./utils/xhr-loader");var _xhrLoader2=_interopRequireDefault(_xhrLoader);var _events3=_dereq_("events");var _events4=_interopRequireDefault(_events3);var _keyLoader=_dereq_("./loader/key-loader");var _keyLoader2=_interopRequireDefault(_keyLoader);var _cues=_dereq_("./utils/cues");var _cues2=_interopRequireDefault(_cues);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Hls=function(){_createClass(Hls,null,[{key:"isSupported",value:function isSupported(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"version",get:function get(){return"0.6.1-82"}},{key:"Events",get:function get(){return _events2.default}},{key:"ErrorTypes",get:function get(){return _errors.ErrorTypes}},{key:"ErrorDetails",get:function get(){return _errors.ErrorDetails}},{key:"DefaultConfig",get:function get(){if(!Hls.defaultConfig){Hls.defaultConfig={autoStartLoad:true,debug:false,capLevelOnFPSDrop:false,capLevelToPlayerSize:false,maxBufferLength:40,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,maxSeekHole:2,seekHoleNudgeDuration:.01,stalledInBufferedNudgeThreshold:10,maxFragLookUpTolerance:.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:undefined,liveMaxLatencyDuration:undefined,maxMaxBufferLength:40,enableWorker:true,enableSoftwareAES:true,manifestLoadingTimeOut:2e4,manifestLoadingMaxRetry:4,manifestLoadingRetryDelay:1e3,levelLoadingTimeOut:2e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingLoopThreshold:1e3,startFragPrefetch:false,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:_xhrLoader2.default,fLoader:undefined,pLoader:undefined,abrController:_abrController2.default,bufferController:_bufferController2.default,capLevelController:_capLevelController2.default,fpsController:_fpsController2.default,streamController:_streamController2.default,timelineController:_timelineController2.default,cueHandler:_cues2.default,enableCEA708Captions:true,enableMP2TPassThrough:false,stretchShortVideoTrack:false}}return Hls.defaultConfig},set:function set(defaultConfig){Hls.defaultConfig=defaultConfig}}]);function Hls(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Hls);var defaultConfig=Hls.DefaultConfig;if((config.liveSyncDurationCount||config.liveMaxLatencyDurationCount)&&(config.liveSyncDuration||config.liveMaxLatencyDuration)){throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration")}for(var prop in defaultConfig){if(prop in config){continue}config[prop]=defaultConfig[prop]}if(config.liveMaxLatencyDurationCount!==undefined&&config.liveMaxLatencyDurationCount<=config.liveSyncDurationCount){throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"')}if(config.liveMaxLatencyDuration!==undefined&&(config.liveMaxLatencyDuration<=config.liveSyncDuration||config.liveSyncDuration===undefined)){throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');
}(0,_logger.enableLogs)(config.debug);this.config=config;var observer=this.observer=new _events4.default;observer.trigger=function trigger(event){for(var _len=arguments.length,data=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){data[_key-1]=arguments[_key]}observer.emit.apply(observer,[event,event].concat(data))};observer.off=function off(event){for(var _len2=arguments.length,data=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){data[_key2-1]=arguments[_key2]}observer.removeListener.apply(observer,[event].concat(data))};this.on=observer.on.bind(observer);this.off=observer.off.bind(observer);this.trigger=observer.trigger.bind(observer);this.playlistLoader=new _playlistLoader2.default(this);this.fragmentLoader=new _fragmentLoader2.default(this);this.levelController=new _levelController2.default(this);this.abrController=new config.abrController(this);this.bufferController=new config.bufferController(this);this.capLevelController=new config.capLevelController(this);this.fpsController=new config.fpsController(this);this.streamController=new config.streamController(this);this.timelineController=new config.timelineController(this);this.keyLoader=new _keyLoader2.default(this);Hls.api.players.push(this);Hls.api.emit(_events2.default.PLAYER_CREATED,this)}_createClass(Hls,[{key:"destroy",value:function destroy(){_logger.logger.log("destroy");this.trigger(_events2.default.DESTROYING);this.detachMedia();this.playlistLoader.destroy();this.fragmentLoader.destroy();this.levelController.destroy();this.abrController.destroy();this.bufferController.destroy();this.capLevelController.destroy();this.fpsController.destroy();this.streamController.destroy();this.timelineController.destroy();this.keyLoader.destroy();this.url=null;this.observer.removeAllListeners();var globalId=Hls.api.players.indexOf(this);if(globalId<0){return}Hls.api.players.splice(globalId,1);Hls.api.emit(_events2.default.PLAYER_DESTROYED,this)}},{key:"attachMedia",value:function attachMedia(media){_logger.logger.log("attachMedia");this.media=media;this.trigger(_events2.default.MEDIA_ATTACHING,{media:media})}},{key:"detachMedia",value:function detachMedia(){_logger.logger.log("detachMedia");this.trigger(_events2.default.MEDIA_DETACHING);this.media=null}},{key:"loadSource",value:function loadSource(url){_logger.logger.log("loadSource:"+url);this.url=url;this.trigger(_events2.default.MANIFEST_LOADING,{url:url})}},{key:"startLoad",value:function startLoad(){var startPosition=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;_logger.logger.log("startLoad");this.levelController.startLoad();this.streamController.startLoad(startPosition)}},{key:"stopLoad",value:function stopLoad(){_logger.logger.log("stopLoad");this.levelController.stopLoad();this.streamController.stopLoad()}},{key:"swapAudioCodec",value:function swapAudioCodec(){_logger.logger.log("swapAudioCodec");this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function recoverMediaError(){_logger.logger.log("recoverMediaError");var media=this.media;this.detachMedia();this.attachMedia(media)}},{key:"levels",get:function get(){return this.levelController.levels}},{key:"currentLevel",get:function get(){return this.streamController.currentLevel},set:function set(newLevel){_logger.logger.log("set currentLevel:"+newLevel);this.loadLevel=newLevel;this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function get(){return this.streamController.nextLevel},set:function set(newLevel){_logger.logger.log("set nextLevel:"+newLevel);this.levelController.manualLevel=newLevel;this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function get(){return this.levelController.level},set:function set(newLevel){_logger.logger.log("set loadLevel:"+newLevel);this.levelController.manualLevel=newLevel}},{key:"nextLoadLevel",get:function get(){return this.levelController.nextLoadLevel},set:function set(level){this.levelController.nextLoadLevel=level}},{key:"firstLevel",get:function get(){return this.levelController.firstLevel},set:function set(newLevel){_logger.logger.log("set firstLevel:"+newLevel);this.levelController.firstLevel=newLevel}},{key:"startLevel",get:function get(){return this.levelController.startLevel},set:function set(newLevel){_logger.logger.log("set startLevel:"+newLevel);this.levelController.startLevel=newLevel}},{key:"autoLevelCapping",get:function get(){return this.abrController.autoLevelCapping},set:function set(newLevel){_logger.logger.log("set autoLevelCapping:"+newLevel);this.abrController.autoLevelCapping=newLevel}},{key:"autoLevelEnabled",get:function get(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function get(){return this.levelController.manualLevel}}]);return Hls}();Hls.api=new _events4.default;Hls.api.players=[];exports.default=Hls},{"./controller/abr-controller":3,"./controller/buffer-controller":4,"./controller/cap-level-controller":5,"./controller/fps-controller":6,"./controller/level-controller":7,"./controller/stream-controller":8,"./controller/timeline-controller":9,"./errors":21,"./events":23,"./loader/fragment-loader":29,"./loader/key-loader":30,"./loader/playlist-loader":31,"./utils/cues":38,"./utils/logger":39,"./utils/xhr-loader":42,events:1}],28:[function(_dereq_,module,exports){module.exports=_dereq_("./hls.js").default},{"./hls.js":27}],29:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);var _errors=_dereq_("../errors");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var FragmentLoader=function(_EventHandler){_inherits(FragmentLoader,_EventHandler);function FragmentLoader(hls){_classCallCheck(this,FragmentLoader);return _possibleConstructorReturn(this,(FragmentLoader.__proto__||Object.getPrototypeOf(FragmentLoader)).call(this,hls,_events2.default.FRAG_LOADING))}_createClass(FragmentLoader,[{key:"destroy",value:function destroy(){if(this.loader){this.loader.destroy();this.loader=null}this.firstChunk=true;_eventHandler2.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function onFragLoading(data){var frag=data.frag;this.frag=frag;this.frag.loaded=0;this.firstChunk=true;var config=this.hls.config;frag.loader=this.loader=typeof config.fLoader!=="undefined"?new config.fLoader(config):new config.loader(config);this.loader.load(frag.url,"arraybuffer",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),config.fragLoadingTimeOut,1,0,this.loadprogress.bind(this),frag,this.loadchunk.bind(this))}},{key:"loadchunk",value:function loadchunk(event,stats){var payload=event.currentTarget.response;payload.first=this.firstChunk;this.firstChunk=false;this.hls.trigger(_events2.default.FRAG_CHUNK_LOADED,{payload:payload,frag:this.frag,stats:stats})}},{key:"loadsuccess",value:function loadsuccess(event,stats){var payload=event.currentTarget.response;payload.final=true;stats.length=payload.byteLength;this.hls.trigger(_events2.default.FRAG_LOADED,{frag:this.frag,stats:stats});this.loadchunk({currentTarget:{response:payload}},stats);this.firstChunk=true;this.frag.loader=undefined}},{key:"loaderror",value:function loaderror(event){if(this.loader){this.loader.abort()}this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.NETWORK_ERROR,details:_errors.ErrorDetails.FRAG_LOAD_ERROR,fatal:false,frag:this.frag,response:event})}},{key:"loadtimeout",value:function loadtimeout(){if(this.loader){this.loader.abort()}this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.NETWORK_ERROR,details:_errors.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:false,frag:this.frag})}},{key:"loadprogress",value:function loadprogress(stats){this.frag.loaded=stats.loaded;this.hls.trigger(_events2.default.FRAG_LOAD_PROGRESS,{frag:this.frag,stats:stats})}}]);return FragmentLoader}(_eventHandler2.default);exports.default=FragmentLoader},{"../errors":21,"../event-handler":22,"../events":23}],30:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);var _errors=_dereq_("../errors");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var KeyLoader=function(_EventHandler){_inherits(KeyLoader,_EventHandler);function KeyLoader(hls){_classCallCheck(this,KeyLoader);var _this=_possibleConstructorReturn(this,(KeyLoader.__proto__||Object.getPrototypeOf(KeyLoader)).call(this,hls,_events2.default.KEY_LOADING));_this.decryptkey=null;_this.decrypturl=null;return _this}_createClass(KeyLoader,[{key:"destroy",value:function destroy(){if(this.loader){this.loader.destroy();this.loader=null}_eventHandler2.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function onKeyLoading(data){var frag=this.frag=data.frag,decryptdata=frag.decryptdata,uri=decryptdata.uri;if(uri!==this.decrypturl||this.decryptkey===null){var config=this.hls.config;frag.loader=this.loader=new config.loader(config);this.decrypturl=uri;this.decryptkey=null;frag.loader.load(uri,"arraybuffer",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),config.fragLoadingTimeOut,config.fragLoadingMaxRetry,config.fragLoadingRetryDelay,this.loadprogress.bind(this),frag)}else if(this.decryptkey){decryptdata.key=this.decryptkey;this.hls.trigger(_events2.default.KEY_LOADED,{frag:frag})}}},{key:"loadsuccess",value:function loadsuccess(event){var frag=this.frag;this.decryptkey=frag.decryptdata.key=new Uint8Array(event.currentTarget.response);frag.loader=undefined;this.hls.trigger(_events2.default.KEY_LOADED,{frag:frag})}},{key:"loaderror",value:function loaderror(event){if(this.loader){this.loader.abort()}this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.NETWORK_ERROR,details:_errors.ErrorDetails.KEY_LOAD_ERROR,fatal:false,frag:this.frag,response:event.currentTarget})}},{key:"loadtimeout",value:function loadtimeout(){if(this.loader){this.loader.abort()}this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.NETWORK_ERROR,details:_errors.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:false,frag:this.frag})}},{key:"loadprogress",value:function loadprogress(){}}]);return KeyLoader}(_eventHandler2.default);exports.default=KeyLoader},{"../errors":21,"../event-handler":22,"../events":23}],31:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _eventHandler=_dereq_("../event-handler");var _eventHandler2=_interopRequireDefault(_eventHandler);var _errors=_dereq_("../errors");var _url=_dereq_("../utils/url");var _url2=_interopRequireDefault(_url);var _attrList=_dereq_("../utils/attr-list");var _attrList2=_interopRequireDefault(_attrList);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var PlaylistLoader=function(_EventHandler){_inherits(PlaylistLoader,_EventHandler);function PlaylistLoader(hls){_classCallCheck(this,PlaylistLoader);return _possibleConstructorReturn(this,(PlaylistLoader.__proto__||Object.getPrototypeOf(PlaylistLoader)).call(this,hls,_events2.default.MANIFEST_LOADING,_events2.default.LEVEL_LOADING))}_createClass(PlaylistLoader,[{key:"destroy",value:function destroy(){if(this.loader){this.loader.destroy();this.loader=null}this.url=this.id=null;_eventHandler2.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function onManifestLoading(data){this.load(data.url,null)}},{key:"onLevelLoading",value:function onLevelLoading(data){this.load(data.url,data.level,data.id)}},{key:"load",value:function load(url,id1,id2){var config=this.hls.config,retry,timeout,retryDelay;if(this.loading&&this.loader){if(this.url===url&&this.id===id1&&this.id2===id2){return}else{this.loader.abort()}}this.url=url;this.id=id1;this.id2=id2;if(this.id===null){retry=config.manifestLoadingMaxRetry;timeout=config.manifestLoadingTimeOut;retryDelay=config.manifestLoadingRetryDelay}else{retry=config.levelLoadingMaxRetry;timeout=config.levelLoadingTimeOut;retryDelay=config.levelLoadingRetryDelay}this.loader=typeof config.pLoader!=="undefined"?new config.pLoader(config):new config.loader(config);this.loading=true;this.loader.load(url,"",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),timeout,retry,retryDelay)}},{key:"resolve",value:function resolve(url,baseUrl){return _url2.default.buildAbsoluteURL(baseUrl,url)}},{key:"parseMasterPlaylist",value:function parseMasterPlaylist(string,baseurl){var levels=[],result=void 0;var re=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g;while((result=re.exec(string))!=null){var level={};var attrs=level.attrs=new _attrList2.default(result[1]);level.url=this.resolve(result[2],baseurl);var resolution=attrs.decimalResolution("RESOLUTION");if(resolution){level.width=resolution.width;level.height=resolution.height}level.bitrate=attrs.decimalInteger("AVERAGE-BANDWIDTH")||attrs.decimalInteger("BANDWIDTH");level.name=attrs.NAME;var closedCaptions=attrs.enumeratedString("CLOSED-CAPTIONS");if(closedCaptions){level.closedCaptions=closedCaptions}var codecs=attrs.CODECS;if(codecs){codecs=codecs.split(",");for(var i=0;i<codecs.length;i++){var codec=codecs[i];if(codec.indexOf("avc1")!==-1){level.videoCodec=this.avc1toavcoti(codec)}else{level.audioCodec=codec}}}levels.push(level)}return levels}},{key:"createInitializationVector",value:function createInitializationVector(segmentNumber){var uint8View=new Uint8Array(16);for(var i=12;i<16;i++){uint8View[i]=segmentNumber>>8*(15-i)&255}return uint8View}},{key:"fragmentDecryptdataFromLevelkey",value:function fragmentDecryptdataFromLevelkey(levelkey,segmentNumber){var decryptdata=levelkey;if(levelkey&&levelkey.method&&levelkey.uri&&!levelkey.iv){decryptdata=this.cloneObj(levelkey);decryptdata.iv=this.createInitializationVector(segmentNumber)}return decryptdata}},{key:"avc1toavcoti",value:function avc1toavcoti(codec){var result,avcdata=codec.split(".");if(avcdata.length>2){result=avcdata.shift()+".";result+=parseInt(avcdata.shift()).toString(16);result+=("000"+parseInt(avcdata.shift()).toString(16)).substr(-4)}else{result=codec}return result}},{key:"cloneObj",value:function cloneObj(obj){return JSON.parse(JSON.stringify(obj))}},{key:"parseLevelPlaylist",value:function parseLevelPlaylist(string,baseurl,id){var currentSN=0,fragdecryptdata,totalduration=0,level={url:baseurl,fragments:[],live:true,startSN:0},levelkey={method:null,key:null,iv:null,uri:null},cc=0,programDateTime=null,frag=null,result,regexp,byteRangeEndOffset,byteRangeStartOffset,tagList=[];regexp=/(?:#EXT-X-(MEDIA-SEQUENCE):(\d+))|(?:#EXT-X-(TARGETDURATION):(\d+))|(?:#EXT-X-(KEY):(.*)[\r\n]+([^#|\r\n]+)?)|(?:#EXT(INF):([\d\.]+)[^\r\n]*([\r\n]+[^#|\r\n]+)?)|(?:#EXT-X-(BYTERANGE):([\d]+[@[\d]*)]*[\r\n]+([^#|\r\n]+)?|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(PROGRAM-DATE-TIME):(.*))|(?:#EXT-X-(VERSION):(.*))|(?:#(.*):(.*))|(?:#(.*))/g;while((result=regexp.exec(string))!==null){result.shift();result=result.filter(function(n){return n!==undefined});switch(result[0]){case"MEDIA-SEQUENCE":currentSN=level.startSN=parseInt(result[1]);break;case"TARGETDURATION":level.targetduration=parseFloat(result[1]);break;case"VERSION":break;case"EXTM3U":break;case"ENDLIST":level.live=false;break;case"DIS":cc++;tagList.push(result.map(function(e){return(" "+e).slice(1)}));break;case"BYTERANGE":var params=result[1].split("@");if(params.length===1){byteRangeStartOffset=byteRangeEndOffset}else{byteRangeStartOffset=parseInt(params[1])}byteRangeEndOffset=parseInt(params[0])+byteRangeStartOffset;if(frag&&!frag.url){frag.byteRangeStartOffset=byteRangeStartOffset;frag.byteRangeEndOffset=byteRangeEndOffset;frag.url=this.resolve(result[2],baseurl);tagList.push(result.map(function(e){return(" "+e).slice(1)}))}break;case"INF":var duration=parseFloat(result[1]);if(!isNaN(duration)){var sn=currentSN++;fragdecryptdata=this.fragmentDecryptdataFromLevelkey(levelkey,sn);var url=result[2]?this.resolve(result[2],baseurl):null;tagList.push(result.map(function(e){return(" "+e).slice(1)}));frag={url:url,duration:duration,start:totalduration,sn:sn,level:id,cc:cc,byteRangeStartOffset:byteRangeStartOffset,byteRangeEndOffset:byteRangeEndOffset,decryptdata:fragdecryptdata,programDateTime:programDateTime,tagList:tagList,PTSDTSshift:0};level.fragments.push(frag);totalduration+=duration;byteRangeStartOffset=null;programDateTime=null;tagList=[]}break;case"KEY":var decryptparams=result[1];var keyAttrs=new _attrList2.default(decryptparams);var decryptmethod=keyAttrs.enumeratedString("METHOD"),decrypturi=keyAttrs.URI,decryptiv=keyAttrs.hexadecimalInteger("IV");if(decryptmethod){levelkey={method:null,key:null,iv:null,uri:null};if(decrypturi&&decryptmethod==="AES-128"){levelkey.method=decryptmethod;levelkey.uri=this.resolve(decrypturi,baseurl);levelkey.key=null;levelkey.iv=decryptiv}}if(frag&&!frag.url&&result.length>=3){frag.url=this.resolve(result[2],baseurl);fragdecryptdata=this.fragmentDecryptdataFromLevelkey(levelkey,currentSN-1);frag.decryptdata=fragdecryptdata;tagList.push(result.map(function(e){return(" "+e).slice(1)}))}break;case"PROGRAM-DATE-TIME":programDateTime=new Date(Date.parse(result[1]));tagList.push(result.map(function(e){return(" "+e).slice(1)}));break;default:tagList.push(result.map(function(e){return(" "+e).slice(1)}));break}}if(frag&&!frag.url){level.fragments.pop();totalduration-=frag.duration}level.totalduration=totalduration;level.averagetargetduration=totalduration/level.fragments.length;level.endSN=currentSN-1;return level}},{key:"loadsuccess",value:function loadsuccess(event,stats){var target=event.currentTarget,string=target.responseText,url=target.responseURL,id=this.id,id2=this.id2,hls=this.hls,levels;this.loading=false;if(url===undefined||url.indexOf("data:")===0){url=this.url}stats.tload=performance.now();stats.mtime=new Date(target.getResponseHeader("Last-Modified"));if(string.indexOf("#EXTM3U")===0){if(string.indexOf("#EXTINF:")>0){if(this.id===null){hls.trigger(_events2.default.MANIFEST_LOADED,{levels:[{url:url}],url:url,stats:stats})}else{var levelDetails=this.parseLevelPlaylist(string,url,id);stats.tparsed=performance.now();hls.trigger(_events2.default.LEVEL_LOADED,{details:levelDetails,level:id,id:id2,stats:stats})}}else{levels=this.parseMasterPlaylist(string,url);if(levels.length){hls.trigger(_events2.default.MANIFEST_LOADED,{levels:levels,url:url,stats:stats})}else{hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.NETWORK_ERROR,details:_errors.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:true,url:url,reason:"no level found in manifest"})}}}else{hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.NETWORK_ERROR,details:_errors.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:true,url:url,reason:"no EXTM3U delimiter"})}}},{key:"loaderror",value:function loaderror(event){var details,fatal;if(this.id===null){details=_errors.ErrorDetails.MANIFEST_LOAD_ERROR;fatal=true}else{details=_errors.ErrorDetails.LEVEL_LOAD_ERROR;fatal=false}if(this.loader){this.loader.abort()}this.loading=false;this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.NETWORK_ERROR,details:details,fatal:fatal,url:this.url,loader:this.loader,response:event.currentTarget,level:this.id,id:this.id2})}},{key:"loadtimeout",value:function loadtimeout(){var details,fatal;if(this.id===null){details=_errors.ErrorDetails.MANIFEST_LOAD_TIMEOUT;fatal=true}else{details=_errors.ErrorDetails.LEVEL_LOAD_TIMEOUT;fatal=false}if(this.loader){this.loader.abort()}this.loading=false;this.hls.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.NETWORK_ERROR,details:details,fatal:fatal,url:this.url,loader:this.loader,level:this.id,id:this.id2})}}]);return PlaylistLoader}(_eventHandler2.default);exports.default=PlaylistLoader},{"../errors":21,"../event-handler":22,"../events":23,"../utils/attr-list":35,"../utils/url":41}],32:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MP4=function(){function MP4(){_classCallCheck(this,MP4)}_createClass(MP4,null,[{key:"init",value:function init(){MP4.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var i;for(i in MP4.types){if(MP4.types.hasOwnProperty(i)){MP4.types[i]=[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3)]}}var videoHdlr=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);var audioHdlr=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:videoHdlr,audio:audioHdlr};var dref=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);var stco=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=stco;MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var majorBrand=new Uint8Array([105,115,111,109]);var avc1Brand=new Uint8Array([97,118,99,49]);var minorVersion=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,majorBrand,minorVersion,majorBrand,avc1Brand);MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,dref))}},{key:"box",value:function box(type){var payload=Array.prototype.slice.call(arguments,1),size=8,i=payload.length,len=i,result;while(i--){size+=payload[i].byteLength}result=new Uint8Array(size);result[0]=size>>24&255;result[1]=size>>16&255;result[2]=size>>8&255;result[3]=size&255;result.set(type,4);for(i=0,size=8;i<len;i++){result.set(payload[i],size);size+=payload[i].byteLength}return result}},{key:"hdlr",value:function hdlr(type){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[type])}},{key:"mdat",value:function mdat(data){return MP4.box(MP4.types.mdat,data)}},{key:"mdhd",value:function mdhd(timescale,duration){duration*=timescale;return MP4.box(MP4.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,timescale>>24&255,timescale>>16&255,timescale>>8&255,timescale&255,duration>>24,duration>>16&255,duration>>8&255,duration&255,85,196,0,0]))}},{key:"mdia",value:function mdia(track){return MP4.box(MP4.types.mdia,MP4.mdhd(track.timescale,track.duration),MP4.hdlr(track.type),MP4.minf(track))}},{key:"mfhd",value:function mfhd(sequenceNumber){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,sequenceNumber>>24,sequenceNumber>>16&255,sequenceNumber>>8&255,sequenceNumber&255]))}},{key:"minf",value:function minf(track){if(track.type==="audio"){return MP4.box(MP4.types.minf,MP4.box(MP4.types.smhd,MP4.SMHD),MP4.DINF,MP4.stbl(track))}else{return MP4.box(MP4.types.minf,MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(track))}}},{key:"moof",value:function moof(sn,baseMediaDecodeTime,track){return MP4.box(MP4.types.moof,MP4.mfhd(sn),MP4.traf(track,baseMediaDecodeTime))}},{key:"moov",value:function moov(tracks){var i=tracks.length,boxes=[];while(i--){boxes[i]=MP4.trak(tracks[i])}return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(tracks[0].timescale,tracks[0].duration)].concat(boxes).concat(MP4.mvex(tracks)))}},{key:"mvex",value:function mvex(tracks){var i=tracks.length,boxes=[];while(i--){boxes[i]=MP4.trex(tracks[i])}return MP4.box.apply(null,[MP4.types.mvex].concat(boxes))}},{key:"mvhd",value:function mvhd(timescale,duration){duration*=timescale;var bytes=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,timescale>>24&255,timescale>>16&255,timescale>>8&255,timescale&255,duration>>24&255,duration>>16&255,duration>>8&255,duration&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,bytes)}},{key:"sdtp",value:function sdtp(track){var samples=track.samples||[],bytes=new Uint8Array(4+samples.length),flags,i;for(i=0;i<samples.length;i++){flags=samples[i].flags;bytes[i+4]=flags.dependsOn<<4|flags.isDependedOn<<2|flags.hasRedundancy}return MP4.box(MP4.types.sdtp,bytes)}},{key:"stbl",value:function stbl(track){return MP4.box(MP4.types.stbl,MP4.stsd(track),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))}},{key:"avc1",value:function avc1(track){var sps=[],pps=[],i,data,len;for(i=0;i<track.sps.length;i++){data=track.sps[i];len=data.byteLength;sps.push(len>>>8&255);sps.push(len&255);sps=sps.concat(Array.prototype.slice.call(data))}for(i=0;i<track.pps.length;i++){data=track.pps[i];len=data.byteLength;pps.push(len>>>8&255);pps.push(len&255);pps=pps.concat(Array.prototype.slice.call(data))}var avcc=MP4.box(MP4.types.avcC,new Uint8Array([1,sps[3],sps[4],sps[5],252|3,224|track.sps.length].concat(sps).concat([track.pps.length]).concat(pps))),width=track.width,height=track.height;return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,width>>8&255,width&255,height>>8&255,height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),avcc,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function esds(track){var configlen=track.config.length;return new Uint8Array([0,0,0,0,3,23+configlen,0,1,0,4,15+configlen,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([configlen]).concat(track.config).concat([6,1,2]))}},{key:"mp4a",value:function mp4a(track){var audiosamplerate=track.audiosamplerate;return MP4.box(MP4.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,track.channelCount,0,16,0,0,0,0,audiosamplerate>>8&255,audiosamplerate&255,0,0]),MP4.box(MP4.types.esds,MP4.esds(track)))}},{key:"stsd",value:function stsd(track){if(track.type==="audio"){return MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp4a(track))}else{return MP4.box(MP4.types.stsd,MP4.STSD,MP4.avc1(track))}}},{key:"tkhd",value:function tkhd(track){var id=track.id,duration=track.duration*track.timescale,width=track.width,height=track.height;return MP4.box(MP4.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,id>>24&255,id>>16&255,id>>8&255,id&255,0,0,0,0,duration>>24,duration>>16&255,duration>>8&255,duration&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,width>>8&255,width&255,0,0,height>>8&255,height&255,0,0]))}},{key:"traf",value:function traf(track,baseMediaDecodeTime){var sampleDependencyTable=MP4.sdtp(track),id=track.id;return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,id>>24,id>>16&255,id>>8&255,id&255])),MP4.box(MP4.types.tfdt,new Uint8Array([0,0,0,0,baseMediaDecodeTime>>24,baseMediaDecodeTime>>16&255,baseMediaDecodeTime>>8&255,baseMediaDecodeTime&255])),MP4.trun(track,sampleDependencyTable.length+16+16+8+16+8+8),sampleDependencyTable)}},{key:"trak",value:function trak(track){track.duration=track.duration||4294967295;return MP4.box(MP4.types.trak,MP4.tkhd(track),MP4.mdia(track))}},{key:"trex",
value:function trex(track){var id=track.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,id>>24,id>>16&255,id>>8&255,id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function trun(track,offset){var samples=track.samples||[],len=samples.length,arraylen=12+16*len,array=new Uint8Array(arraylen),i,sample,duration,size,flags,cts;offset+=8+arraylen;array.set([0,0,15,1,len>>>24&255,len>>>16&255,len>>>8&255,len&255,offset>>>24&255,offset>>>16&255,offset>>>8&255,offset&255],0);for(i=0;i<len;i++){sample=samples[i];duration=sample.duration;size=sample.size;flags=sample.flags;cts=sample.cts;array.set([duration>>>24&255,duration>>>16&255,duration>>>8&255,duration&255,size>>>24&255,size>>>16&255,size>>>8&255,size&255,flags.isLeading<<2|flags.dependsOn,flags.isDependedOn<<6|flags.hasRedundancy<<4|flags.paddingValue<<1|flags.isNonSync,flags.degradPrio&240<<8,flags.degradPrio&15,cts>>>24&255,cts>>>16&255,cts>>>8&255,cts&255],12+16*i)}return MP4.box(MP4.types.trun,array)}},{key:"initSegment",value:function initSegment(tracks){if(!MP4.types){MP4.init()}var movie=MP4.moov(tracks),result;result=new Uint8Array(MP4.FTYP.byteLength+movie.byteLength);result.set(MP4.FTYP);result.set(movie,MP4.FTYP.byteLength);return result}}]);return MP4}();exports.default=MP4},{}],33:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _aac=_dereq_("../helper/aac");var _aac2=_interopRequireDefault(_aac);var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);var _logger=_dereq_("../utils/logger");var _mp4Generator=_dereq_("../remux/mp4-generator");var _mp4Generator2=_interopRequireDefault(_mp4Generator);var _errors=_dereq_("../errors");_dereq_("../utils/polyfill");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MP4Remuxer=function(){function MP4Remuxer(observer,config){_classCallCheck(this,MP4Remuxer);this.observer=observer;this.config=config;this.ISGenerated=false;this.PES2MP4SCALEFACTOR=4;this.PES_TIMESCALE=9e4;this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR}_createClass(MP4Remuxer,[{key:"destroy",value:function destroy(){}},{key:"insertDiscontinuity",value:function insertDiscontinuity(){this._initPTS=this._initDTS=this.nextAacPts=this.nextAvcDts=undefined}},{key:"switchLevel",value:function switchLevel(){this.ISGenerated=false}},{key:"remux",value:function remux(audioTrack,videoTrack,id3Track,textTrack,timeOffset,contiguous,accurate,data,flush,stats){data=null;if(!this.ISGenerated){this.generateIS(audioTrack,videoTrack,timeOffset)}if(this.ISGenerated){if(audioTrack.samples.length){var audioData=this.remuxAudio(audioTrack,timeOffset,contiguous,accurate,stats);if(videoTrack.samples.length){var audioTrackLength=void 0,audioStartPTS=void 0;if(audioData){audioStartPTS=audioData.startPTS;audioTrackLength=audioData.endPTS-audioStartPTS}this.remuxVideo(videoTrack,timeOffset,contiguous,audioTrackLength,audioStartPTS,flush,stats)}else if(!contiguous){this.nextAvcDts=undefined}}else{var videoData=void 0;if(videoTrack.samples.length){videoData=this.remuxVideo(videoTrack,timeOffset,contiguous,undefined,undefined,flush,stats)}if(videoData&&audioTrack.codec){this.remuxEmptyAudio(audioTrack,timeOffset,contiguous,videoData,stats)}}}if(id3Track.samples.length){this.remuxID3(id3Track,timeOffset)}if(textTrack.samples.length){this.remuxText(textTrack,timeOffset)}}},{key:"generateIS",value:function generateIS(audioTrack,videoTrack,timeOffset){var observer=this.observer,audioSamples=audioTrack.samples,videoSamples=videoTrack.samples,pesTimeScale=this.PES_TIMESCALE,tracks={},data={tracks:tracks,unique:false},computePTSDTS=this._initPTS===undefined,initPTS,initDTS;if(computePTSDTS){initPTS=initDTS=Infinity}if(audioTrack.config&&audioSamples.length){audioTrack.timescale=audioTrack.audiosamplerate;if(audioTrack.timescale*audioTrack.duration>Math.pow(2,32)){(function(){var greatestCommonDivisor=function greatestCommonDivisor(a,b){if(!b){return a}return greatestCommonDivisor(b,a%b)};audioTrack.timescale=audioTrack.audiosamplerate/greatestCommonDivisor(audioTrack.audiosamplerate,1024)})()}_logger.logger.log("audio mp4 timescale :"+audioTrack.timescale);tracks.audio={container:"audio/mp4",codec:audioTrack.codec,initSegment:_mp4Generator2.default.initSegment([audioTrack]),metadata:{channelCount:audioTrack.channelCount}};if(computePTSDTS){initPTS=initDTS=audioSamples[0].pts-pesTimeScale*timeOffset}}if(videoTrack.sps&&videoTrack.pps&&videoSamples.length){videoTrack.timescale=this.MP4_TIMESCALE;tracks.video={container:"video/mp4",codec:videoTrack.codec,initSegment:_mp4Generator2.default.initSegment([videoTrack]),metadata:{width:videoTrack.width,height:videoTrack.height}};if(computePTSDTS){initPTS=Math.min(initPTS,videoSamples[0].pts-pesTimeScale*timeOffset);initDTS=Math.min(initDTS,videoSamples[0].dts-pesTimeScale*timeOffset)}}if(Object.keys(tracks).length){observer.trigger(_events2.default.FRAG_PARSING_INIT_SEGMENT,data);this.ISGenerated=true;if(computePTSDTS){this._initPTS=initPTS;this._initDTS=initDTS}}else{observer.trigger(_events2.default.ERROR,{type:_errors.ErrorTypes.MEDIA_ERROR,details:_errors.ErrorDetails.FRAG_PARSING_ERROR,fatal:false,reason:"no audio/video samples found"})}}},{key:"remuxVideo",value:function remuxVideo(track,timeOffset,contiguous,audioTrackLength,audioStartPTS,flush,stats){var offset=8,pesTimeScale=this.PES_TIMESCALE,pes2mp4ScaleFactor=this.PES2MP4SCALEFACTOR,mp4SampleDuration,mdat,moof,firstPTS,firstDTS,nextDTS,lastPTS,lastDTS,inputSamples=track.samples,outputSamples=[];var PTSDTSshift=inputSamples.reduce(function(prev,curr){return Math.max(Math.min(prev,curr.pts-curr.dts),-18e3)},0);if(PTSDTSshift<0){_logger.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(PTSDTSshift/90)+" ms to overcome this issue");for(var i=0;i<inputSamples.length;i++){inputSamples[i].dts+=PTSDTSshift}}contiguous|=inputSamples.length&&this.nextAvcDts&&Math.abs(timeOffset-this.nextAvcDts/pesTimeScale)<.1;var nextAvcDts=contiguous?this.nextAvcDts:timeOffset*pesTimeScale;var sample=inputSamples[0];firstDTS=Math.max(this._PTSNormalize(sample.dts-this._initDTS,nextAvcDts),0);firstPTS=Math.max(this._PTSNormalize(sample.pts-this._initDTS,nextAvcDts),0);var delta=Math.round((firstDTS-nextAvcDts)/90);if(contiguous&&delta){_logger.logger.log("AVC:"+Math.abs(delta)+" ms "+(delta>0?"hole":"overlapping")+" between fragments detected");firstDTS=nextAvcDts;inputSamples[0].dts=firstDTS+this._initDTS;firstPTS=Math.max(firstPTS-delta*90,nextAvcDts);inputSamples[0].pts=firstPTS+this._initDTS;_logger.logger.log("Video/PTS/DTS adjusted: "+firstPTS+"/"+firstDTS+",delta:"+delta);stats.videoGap=stats.videoGap||[];stats.videoGap.push(delta)}nextDTS=firstDTS;sample=inputSamples[inputSamples.length-1];lastDTS=Math.max(this._PTSNormalize(sample.dts-this._initDTS,nextAvcDts),0);lastPTS=Math.max(this._PTSNormalize(sample.pts-this._initDTS,nextAvcDts),0);lastPTS=Math.max(lastPTS,lastDTS);var vendor=navigator.vendor,userAgent=navigator.userAgent,isSafari=vendor&&vendor.indexOf("Apple")>-1&&userAgent&&!userAgent.match("CriOS");if(isSafari){mp4SampleDuration=Math.round((lastDTS-firstDTS)/(pes2mp4ScaleFactor*(inputSamples.length-1)))}for(var _i=0;_i<inputSamples.length;_i++){var _sample=inputSamples[_i];if(isSafari){_sample.dts=firstDTS+_i*pes2mp4ScaleFactor*mp4SampleDuration}else{_sample.dts=Math.max(this._PTSNormalize(_sample.dts-this._initDTS,nextAvcDts),firstDTS);_sample.dts=Math.round(_sample.dts/pes2mp4ScaleFactor)*pes2mp4ScaleFactor}_sample.pts=Math.max(this._PTSNormalize(_sample.pts-this._initDTS,nextAvcDts),_sample.dts);_sample.pts=Math.round(_sample.pts/pes2mp4ScaleFactor)*pes2mp4ScaleFactor}mdat=new Uint8Array(track.len+4*track.nbNalu+8);var view=new DataView(mdat.buffer);view.setUint32(0,mdat.byteLength);mdat.set(_mp4Generator2.default.types.mdat,4);for(var _i2=0;_i2<inputSamples.length;_i2++){var avcSample=inputSamples[_i2],mp4SampleLength=0,compositionTimeOffset=void 0;while(avcSample.units.units.length){var unit=avcSample.units.units.shift();view.setUint32(offset,unit.data.byteLength);offset+=4;mdat.set(unit.data,offset);offset+=unit.data.byteLength;mp4SampleLength+=4+unit.data.byteLength}if(!isSafari){if(_i2<inputSamples.length-1){mp4SampleDuration=inputSamples[_i2+1].dts-avcSample.dts}else{var config=this.config,lastFrameDuration=avcSample.dts-inputSamples[_i2>0?_i2-1:_i2].dts;if(config.stretchShortVideoTrack){var maxBufferHole=config.maxBufferHole,maxSeekHole=config.maxSeekHole,gapTolerance=Math.floor(Math.min(maxBufferHole,maxSeekHole)*pesTimeScale),deltaToFrameEnd=(audioTrackLength?firstPTS+audioTrackLength*pesTimeScale:this.nextAacPts)-avcSample.pts;if(deltaToFrameEnd>gapTolerance){mp4SampleDuration=deltaToFrameEnd-lastFrameDuration;if(mp4SampleDuration<0){mp4SampleDuration=lastFrameDuration}_logger.logger.log("It is approximately "+deltaToFrameEnd/90+" ms to the next segment; using duration "+mp4SampleDuration/90+" ms for the last video frame.")}else{mp4SampleDuration=lastFrameDuration}}else{mp4SampleDuration=lastFrameDuration}}mp4SampleDuration/=pes2mp4ScaleFactor;compositionTimeOffset=Math.round((avcSample.pts-avcSample.dts)/pes2mp4ScaleFactor)}else{compositionTimeOffset=Math.max(0,mp4SampleDuration*Math.round((avcSample.pts-avcSample.dts)/(pes2mp4ScaleFactor*mp4SampleDuration)))}outputSamples.push({size:mp4SampleLength,duration:mp4SampleDuration,cts:compositionTimeOffset,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:avcSample.key?2:1,isNonSync:avcSample.key?0:1}})}this.nextAvcDts=lastDTS+mp4SampleDuration*pes2mp4ScaleFactor;track.len=0;track.nbNalu=0;if(outputSamples.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var flags=outputSamples[0].flags;flags.dependsOn=2;flags.isNonSync=0}track.samples=outputSamples;moof=_mp4Generator2.default.moof(track.sequenceNumber++,firstDTS/pes2mp4ScaleFactor,track);track.samples=[];var data={data1:moof,data2:mdat,startPTS:firstPTS/pesTimeScale,endPTS:(lastPTS+pes2mp4ScaleFactor*mp4SampleDuration)/pesTimeScale,startDTS:firstDTS/pesTimeScale,endDTS:this.nextAvcDts/pesTimeScale,type:"video",flush:flush,nb:outputSamples.length,dropped:stats.dropped};data.deltaPTS=Math.abs(data.startPTS-audioStartPTS);this.observer.trigger(_events2.default.FRAG_PARSING_DATA,data);return data}},{key:"remuxAudio",value:function remuxAudio(track,timeOffset,contiguous,accurate,stats){var pesTimeScale=this.PES_TIMESCALE,mp4timeScale=track.timescale,pes2mp4ScaleFactor=pesTimeScale/mp4timeScale,expectedSampleDuration=track.timescale*1024/track.audiosamplerate;var view,offset=8,aacSample,mp4Sample,unit,mdat,moof,firstPTS,firstDTS,lastDTS,pts,dts,ptsnorm,dtsnorm,samples=[],samples0=[],fillFrame,newStamp;track.samples.sort(function(a,b){return a.pts-b.pts});samples0=track.samples;contiguous|=samples0.length&&this.nextAacPts&&Math.abs(timeOffset-this.nextAacPts/pesTimeScale)<.1;var nextAacPts=contiguous?this.nextAacPts:timeOffset*pesTimeScale;var pesFrameDuration=expectedSampleDuration*pes2mp4ScaleFactor;var nextPtsNorm=nextAacPts;if(accurate){for(var i=0;i<samples0.length;){var sample=samples0[i],ptsNorm=this._PTSNormalize(sample.pts-this._initDTS,nextAacPts),delta=ptsNorm-nextPtsNorm;if(Math.abs(delta)>pesFrameDuration/2){stats.audioGap=stats.audioGap||[];stats.audioGap.push(delta/90)}if(delta<-pesFrameDuration){_logger.logger.log("Dropping frame due to "+Math.abs(delta/90)+" ms overlap.");samples0.splice(i,1);track.len-=sample.unit.length}else if(delta>pesFrameDuration){var missing=Math.round(delta/pesFrameDuration);_logger.logger.log("Injecting "+missing+" frame"+(missing>1?"s":"")+" of missing audio due to "+Math.round(delta/90)+" ms gap.");for(var j=0;j<missing;j++){newStamp=nextPtsNorm+this._initDTS;newStamp=Math.max(newStamp,this._initDTS);fillFrame=_aac2.default.getSilentFrame(track.channelCount);if(!fillFrame){_logger.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead.");fillFrame=sample.unit.slice(0)}samples0.splice(i,0,{unit:fillFrame,pts:newStamp,dts:newStamp});track.len+=fillFrame.length;nextPtsNorm+=pesFrameDuration;i+=1}sample.pts=sample.dts=nextPtsNorm+this._initDTS;nextPtsNorm+=pesFrameDuration;i+=1}else{nextPtsNorm+=pesFrameDuration;if(i===0){sample.pts=sample.dts=this._initDTS+nextAacPts}else{sample.pts=sample.dts=samples0[i-1].pts+pesFrameDuration}i+=1}}}while(samples0.length){aacSample=samples0.shift();unit=aacSample.unit;pts=aacSample.pts-this._initDTS;dts=aacSample.dts-this._initDTS;if(lastDTS!==undefined){ptsnorm=this._PTSNormalize(pts,lastDTS);dtsnorm=this._PTSNormalize(dts,lastDTS);mp4Sample.duration=Math.round((dtsnorm-lastDTS)/pes2mp4ScaleFactor)}else{ptsnorm=this._PTSNormalize(pts,nextAacPts);dtsnorm=this._PTSNormalize(dts,nextAacPts);var _delta=Math.round(1e3*(ptsnorm-nextAacPts)/pesTimeScale),numMissingFrames=0;if(contiguous&&_delta){if(_delta>0){numMissingFrames=Math.round((ptsnorm-nextAacPts)/pesFrameDuration);_logger.logger.log(_delta+" ms hole between AAC samples detected,filling it");if(numMissingFrames>0){fillFrame=_aac2.default.getSilentFrame(track.channelCount);if(!fillFrame){fillFrame=unit.slice(0)}track.len+=numMissingFrames*fillFrame.length}}else if(_delta<-12){_logger.logger.log(-_delta+" ms overlapping between AAC samples detected, drop frame");track.len-=unit.byteLength;continue}ptsnorm=dtsnorm=nextAacPts}firstPTS=Math.max(0,ptsnorm);firstDTS=Math.max(0,dtsnorm);if(track.len<=0){return}mdat=new Uint8Array(track.len+8);view=new DataView(mdat.buffer);view.setUint32(0,mdat.byteLength);mdat.set(_mp4Generator2.default.types.mdat,4);for(var _i3=0;_i3<numMissingFrames;_i3++){newStamp=ptsnorm-(numMissingFrames-_i3)*pesFrameDuration;fillFrame=_aac2.default.getSilentFrame(track.channelCount);if(!fillFrame){_logger.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead.");fillFrame=unit.slice(0)}mdat.set(fillFrame,offset);offset+=fillFrame.byteLength;mp4Sample={size:fillFrame.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};samples.push(mp4Sample)}}mdat.set(unit,offset);offset+=unit.byteLength;mp4Sample={size:unit.byteLength,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};samples.push(mp4Sample);lastDTS=dtsnorm}var lastSampleDuration=0;var nbSamples=samples.length;if(nbSamples>=2){lastSampleDuration=samples[nbSamples-2].duration;mp4Sample.duration=lastSampleDuration}if(nbSamples){this.nextAacPts=ptsnorm+pes2mp4ScaleFactor*lastSampleDuration;track.len=0;track.samples=samples;moof=_mp4Generator2.default.moof(track.sequenceNumber++,firstDTS/pes2mp4ScaleFactor,track);track.samples=[];var audioData={data1:moof,data2:mdat,startPTS:firstPTS/pesTimeScale,endPTS:this.nextAacPts/pesTimeScale,startDTS:firstDTS/pesTimeScale,endDTS:(dtsnorm+pes2mp4ScaleFactor*lastSampleDuration)/pesTimeScale,type:"audio",nb:nbSamples};this.observer.trigger(_events2.default.FRAG_PARSING_DATA,audioData);return audioData}return null}},{key:"remuxEmptyAudio",value:function remuxEmptyAudio(track,timeOffset,contiguous,videoData,stats){var pesTimeScale=this.PES_TIMESCALE,mp4timeScale=track.timescale?track.timescale:track.audiosamplerate,pes2mp4ScaleFactor=pesTimeScale/mp4timeScale,startDTS=(contiguous?this.nextAacPts:videoData.startDTS*pesTimeScale)+this._initDTS,endDTS=videoData.endDTS*pesTimeScale+this._initDTS,sampleDuration=1024,frameDuration=pes2mp4ScaleFactor*sampleDuration,nbSamples=Math.ceil((endDTS-startDTS)/frameDuration),silentFrame=_aac2.default.getSilentFrame(track.channelCount);if(!silentFrame){stats.noSilentFrame=(stats.noSilentFrame|0)+1;_logger.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");return}var samples=[];for(var i=0;i<nbSamples;i++){var stamp=startDTS+i*frameDuration;samples.push({unit:silentFrame.slice(0),pts:stamp,dts:stamp});track.len+=silentFrame.length}track.samples=samples;this.remuxAudio(track,timeOffset,contiguous,undefined,stats)}},{key:"remuxID3",value:function remuxID3(track,timeOffset){var length=track.samples.length,sample;if(length){for(var index=0;index<length;index++){sample=track.samples[index];sample.pts=(sample.pts-this._initPTS)/this.PES_TIMESCALE;sample.dts=(sample.dts-this._initDTS)/this.PES_TIMESCALE}this.observer.trigger(_events2.default.FRAG_PARSING_METADATA,{samples:track.samples})}track.samples=[];timeOffset=timeOffset}},{key:"remuxText",value:function remuxText(track,timeOffset){track.samples.sort(function(a,b){return a.pts-b.pts});var length=track.samples.length,sample;if(length){for(var index=0;index<length;index++){sample=track.samples[index];sample.pts=(sample.pts-this._initPTS)/this.PES_TIMESCALE}this.observer.trigger(_events2.default.FRAG_PARSING_USERDATA,{samples:track.samples})}track.samples=[];timeOffset=timeOffset}},{key:"_PTSNormalize",value:function _PTSNormalize(value,reference){var offset;if(reference===undefined){return value}if(reference<value){offset=-8589934592}else{offset=8589934592}while(Math.abs(value-reference)>4294967296){value+=offset}return value}},{key:"passthrough",get:function get(){return false}}]);return MP4Remuxer}();exports.default=MP4Remuxer},{"../errors":21,"../events":23,"../helper/aac":24,"../remux/mp4-generator":32,"../utils/logger":39,"../utils/polyfill":40}],34:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("../events");var _events2=_interopRequireDefault(_events);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PassThroughRemuxer=function(){function PassThroughRemuxer(observer){_classCallCheck(this,PassThroughRemuxer);this.observer=observer;this.ISGenerated=false}_createClass(PassThroughRemuxer,[{key:"destroy",value:function destroy(){}},{key:"insertDiscontinuity",value:function insertDiscontinuity(){}},{key:"switchLevel",value:function switchLevel(){this.ISGenerated=false}},{key:"remux",value:function remux(audioTrack,videoTrack,id3Track,textTrack,timeOffset,contiguous,rawData){var observer=this.observer;if(!this.ISGenerated){var tracks={},data={tracks:tracks,unique:true},track=videoTrack,codec=track.codec;if(codec){data.tracks.video={container:track.container,codec:codec,metadata:{width:track.width,height:track.height}}}track=audioTrack;codec=track.codec;if(codec){data.tracks.audio={container:track.container,codec:codec,metadata:{channelCount:track.channelCount}}}this.ISGenerated=true;observer.trigger(_events2.default.FRAG_PARSING_INIT_SEGMENT,data)}observer.trigger(_events2.default.FRAG_PARSING_DATA,{data1:rawData,startPTS:timeOffset,startDTS:timeOffset,type:"audiovideo",nb:1,dropped:0,deltaPTS:0})}},{key:"passthrough",get:function get(){return true}}]);return PassThroughRemuxer}();exports.default=PassThroughRemuxer},{"../events":23}],35:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var AttrList=function(){function AttrList(attrs){_classCallCheck(this,AttrList);if(typeof attrs==="string"){attrs=AttrList.parseAttrList(attrs)}for(var attr in attrs){if(attrs.hasOwnProperty(attr)){this[attr]=attrs[attr]}}}_createClass(AttrList,[{key:"decimalInteger",value:function decimalInteger(attrName){var intValue=parseInt(this[attrName],10);if(intValue>Number.MAX_SAFE_INTEGER){return Infinity}return intValue}},{key:"hexadecimalInteger",value:function hexadecimalInteger(attrName){if(this[attrName]){var stringValue=(this[attrName]||"0x").slice(2);stringValue=(stringValue.length&1?"0":"")+stringValue;var value=new Uint8Array(stringValue.length/2);for(var i=0;i<stringValue.length/2;i++){value[i]=parseInt(stringValue.slice(i*2,i*2+2),16)}return value}else{return null}}},{key:"hexadecimalIntegerAsNumber",value:function hexadecimalIntegerAsNumber(attrName){var intValue=parseInt(this[attrName],16);if(intValue>Number.MAX_SAFE_INTEGER){return Infinity}return intValue}},{key:"decimalFloatingPoint",value:function decimalFloatingPoint(attrName){return parseFloat(this[attrName])}},{key:"enumeratedString",value:function enumeratedString(attrName){return this[attrName]}},{key:"decimalResolution",value:function decimalResolution(attrName){var res=/^(\d+)x(\d+)$/.exec(this[attrName]);if(res===null){return undefined}return{width:parseInt(res[1],10),height:parseInt(res[2],10)}}}],[{key:"parseAttrList",value:function parseAttrList(input){var re=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g;var match,attrs={};while((match=re.exec(input))!==null){var value=match[2],quote='"';if(value.indexOf(quote)===0&&value.lastIndexOf(quote)===value.length-1){value=value.slice(1,-1)}attrs[match[1]]=value}return attrs}}]);return AttrList}();exports.default=AttrList},{}],36:[function(_dereq_,module,exports){var BinarySearch={search:function search(list,comparisonFunction){var minIndex=0;var maxIndex=list.length-1;var currentIndex=null;var currentElement=null;while(minIndex<=maxIndex){currentIndex=(minIndex+maxIndex)/2|0;currentElement=list[currentIndex];var comparisonResult=comparisonFunction(currentElement);if(comparisonResult>0){minIndex=currentIndex+1}else if(comparisonResult<0){maxIndex=currentIndex-1}else{return currentElement}}return null}};module.exports=BinarySearch},{}],37:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499};var getCharForByte=function getCharForByte(byte){var charCode=byte;if(specialCea608CharsCodes.hasOwnProperty(byte)){charCode=specialCea608CharsCodes[byte]}return String.fromCharCode(charCode)};var NR_ROWS=15,NR_COLS=32;var rowsLowCh1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14};var rowsHighCh1={17:2,18:4,21:6,22:8,23:10,19:13,20:15};var rowsLowCh2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14};var rowsHighCh2={25:2,26:4,29:6,30:8,31:10,27:13,28:15};var backgroundColors=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];var logger={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function setTime(newTime){this.time=newTime},log:function log(severity,msg){var minLevel=this.verboseFilter[severity];if(this.verboseLevel>=minLevel){console.log(this.time+" ["+severity+"] "+msg)}}};var numArrayToHexArray=function numArrayToHexArray(numArray){var hexArray=[];for(var j=0;j<numArray.length;j++){hexArray.push(numArray[j].toString(16))}return hexArray};var PenState=function(){function PenState(foreground,underline,italics,background,flash){_classCallCheck(this,PenState);this.foreground=foreground||"white";this.underline=underline||false;this.italics=italics||false;this.background=background||"black";this.flash=flash||false}_createClass(PenState,[{key:"reset",value:function reset(){this.foreground="white";this.underline=false;this.italics=false;this.background="black";this.flash=false}},{key:"setStyles",value:function setStyles(styles){var attribs=["foreground","underline","italics","background","flash"];for(var i=0;i<attribs.length;i++){var style=attribs[i];if(styles.hasOwnProperty(style)){this[style]=styles[style]}}}},{key:"isDefault",value:function isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}},{key:"equals",value:function equals(other){return this.foreground===other.foreground&&this.underline===other.underline&&this.italics===other.italics&&this.background===other.background&&this.flash===other.flash}},{key:"copy",value:function copy(newPenState){this.foreground=newPenState.foreground;this.underline=newPenState.underline;this.italics=newPenState.italics;this.background=newPenState.background;this.flash=newPenState.flash}},{key:"toString",value:function toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]);return PenState}();var StyledUnicodeChar=function(){function StyledUnicodeChar(uchar,foreground,underline,italics,background,flash){_classCallCheck(this,StyledUnicodeChar);this.uchar=uchar||" ";this.penState=new PenState(foreground,underline,italics,background,flash)}_createClass(StyledUnicodeChar,[{key:"reset",value:function reset(){this.uchar=" ";this.penState.reset()}},{key:"setChar",value:function setChar(uchar,newPenState){this.uchar=uchar;this.penState.copy(newPenState)}},{key:"setPenState",value:function setPenState(newPenState){this.penState.copy(newPenState)}},{key:"equals",value:function equals(other){return this.uchar===other.uchar&&this.penState.equals(other.penState)}},{key:"copy",value:function copy(newChar){this.uchar=newChar.uchar;this.penState.copy(newChar.penState)}},{key:"isEmpty",value:function isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}]);return StyledUnicodeChar}();var Row=function(){function Row(){_classCallCheck(this,Row);this.chars=[];for(var i=0;i<NR_COLS;i++){this.chars.push(new StyledUnicodeChar)}this.pos=0;this.currPenState=new PenState}_createClass(Row,[{key:"equals",value:function equals(other){var equal=true;for(var i=0;i<NR_COLS;i++){if(!this.chars[i].equals(other.chars[i])){equal=false;break}}return equal}},{key:"copy",value:function copy(other){for(var i=0;i<NR_COLS;i++){this.chars[i].copy(other.chars[i])}}},{key:"isEmpty",value:function isEmpty(){var empty=true;for(var i=0;i<NR_COLS;i++){if(!this.chars[i].isEmpty()){empty=false;break}}return empty}},{key:"setCursor",value:function setCursor(absPos){if(this.pos!==absPos){this.pos=absPos}if(this.pos<0){logger.log("ERROR","Negative cursor position "+this.pos);this.pos=0}else if(this.pos>NR_COLS){logger.log("ERROR","Too large cursor position "+this.pos);this.pos=NR_COLS}}},{key:"moveCursor",value:function moveCursor(relPos){var newPos=this.pos+relPos;if(relPos>1){for(var i=this.pos+1;i<newPos+1;i++){this.chars[i].setPenState(this.currPenState)}}this.setCursor(newPos)}},{key:"backSpace",value:function backSpace(){this.moveCursor(-1);this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function insertChar(byte){if(byte>=144){this.backSpace()}var char=getCharForByte(byte);if(this.pos>=NR_COLS){logger.log("ERROR","Cannot insert "+byte.toString(16)+" ("+char+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(char,this.currPenState);this.moveCursor(1)}},{key:"clearFromPos",value:function clearFromPos(startPos){var i;for(i=startPos;i<NR_COLS;i++){this.chars[i].reset()}}},{key:"clear",value:function clear(){this.clearFromPos(0);this.pos=0;this.currPenState.reset()}},{key:"clearToEndOfRow",value:function clearToEndOfRow(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function getTextString(){var chars=[];var empty=true;for(var i=0;i<NR_COLS;i++){var char=this.chars[i].uchar;if(char!==" "){empty=false}chars.push(char)}if(empty){return""}else{return chars.join("")}}},{key:"setPenStyles",value:function setPenStyles(styles){this.currPenState.setStyles(styles);var currChar=this.chars[this.pos];currChar.setPenState(this.currPenState)}}]);return Row}();var CaptionScreen=function(){function CaptionScreen(){_classCallCheck(this,CaptionScreen);this.rows=[];for(var i=0;i<NR_ROWS;i++){this.rows.push(new Row)}this.currRow=NR_ROWS-1;this.nrRollUpRows=null;this.reset()}_createClass(CaptionScreen,[{key:"reset",value:function reset(){for(var i=0;i<NR_ROWS;i++){this.rows[i].clear()}this.currRow=NR_ROWS-1}},{key:"equals",value:function equals(other){var equal=true;for(var i=0;i<NR_ROWS;i++){if(!this.rows[i].equals(other.rows[i])){equal=false;break}}return equal}},{key:"copy",value:function copy(other){for(var i=0;i<NR_ROWS;i++){this.rows[i].copy(other.rows[i])}}},{key:"isEmpty",value:function isEmpty(){var empty=true;for(var i=0;i<NR_ROWS;i++){if(!this.rows[i].isEmpty()){empty=false;break}}return empty}},{key:"backSpace",value:function backSpace(){var row=this.rows[this.currRow];row.backSpace()}},{key:"clearToEndOfRow",value:function clearToEndOfRow(){var row=this.rows[this.currRow];row.clearToEndOfRow()}},{key:"insertChar",value:function insertChar(char){var row=this.rows[this.currRow];row.insertChar(char)}},{key:"setPen",value:function setPen(styles){var row=this.rows[this.currRow];row.setPenStyles(styles)}},{key:"moveCursor",value:function moveCursor(relPos){var row=this.rows[this.currRow];row.moveCursor(relPos)}},{key:"setCursor",value:function setCursor(absPos){logger.log("INFO","setCursor: "+absPos);var row=this.rows[this.currRow];row.setCursor(absPos)}},{key:"setPAC",value:function setPAC(pacData){logger.log("INFO","pacData = "+JSON.stringify(pacData));var newRow=pacData.row-1;if(this.nrRollUpRows&&newRow<this.nrRollUpRows-1){newRow=this.nrRollUpRows-1}this.currRow=newRow;var row=this.rows[this.currRow];
if(pacData.indent!==null){var indent=pacData.indent;var prevPos=Math.max(indent-1,0);row.setCursor(pacData.indent);pacData.color=row.chars[prevPos].penState.foreground}var styles={foreground:pacData.color,underline:pacData.underline,italics:pacData.italics,background:"black",flash:false};this.setPen(styles)}},{key:"setBkgData",value:function setBkgData(bkgData){logger.log("INFO","bkgData = "+JSON.stringify(bkgData));this.backSpace();this.setPen(bkgData);this.insertChar(32)}},{key:"setRollUpRows",value:function setRollUpRows(nrRows){this.nrRollUpRows=nrRows}},{key:"rollUp",value:function rollUp(){if(this.nrRollUpRows===null){logger.log("DEBUG","roll_up but nrRollUpRows not set yet");return}logger.log("TEXT",this.getDisplayText());var topRowIndex=this.currRow+1-this.nrRollUpRows;var topRow=this.rows.splice(topRowIndex,1)[0];topRow.clear();this.rows.splice(this.currRow,0,topRow);logger.log("INFO","Rolling up")}},{key:"getDisplayText",value:function getDisplayText(asOneRow){asOneRow=asOneRow||false;var displayText=[];var text="";var rowNr=-1;for(var i=0;i<NR_ROWS;i++){var rowText=this.rows[i].getTextString();if(rowText){rowNr=i+1;if(asOneRow){displayText.push("Row "+rowNr+": '"+rowText+"'")}else{displayText.push(rowText.trim())}}}if(displayText.length>0){if(asOneRow){text="["+displayText.join(" | ")+"]"}else{text=displayText.join("\n")}}return text}},{key:"getTextAndFormat",value:function getTextAndFormat(){return this.rows}}]);return CaptionScreen}();var Cea608Channel=function(){function Cea608Channel(channelNumber,outputFilter){_classCallCheck(this,Cea608Channel);this.chNr=channelNumber;this.outputFilter=outputFilter;this.mode=null;this.verbose=0;this.displayedMemory=new CaptionScreen;this.nonDisplayedMemory=new CaptionScreen;this.lastOutputScreen=new CaptionScreen;this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null}_createClass(Cea608Channel,[{key:"reset",value:function reset(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null;this.lastCueEndTime=null}},{key:"getHandler",value:function getHandler(){return this.outputFilter}},{key:"setHandler",value:function setHandler(newHandler){this.outputFilter=newHandler}},{key:"setPAC",value:function setPAC(pacData){this.writeScreen.setPAC(pacData)}},{key:"setBkgData",value:function setBkgData(bkgData){this.writeScreen.setBkgData(bkgData)}},{key:"setMode",value:function setMode(newMode){if(newMode===this.mode){return}this.mode=newMode;logger.log("INFO","MODE="+newMode);if(this.mode==="MODE_POP-ON"){this.writeScreen=this.nonDisplayedMemory}else{this.writeScreen=this.displayedMemory;this.writeScreen.reset()}if(this.mode!=="MODE_ROLL-UP"){this.displayedMemory.nrRollUpRows=null;this.nonDisplayedMemory.nrRollUpRows=null}this.mode=newMode}},{key:"insertChars",value:function insertChars(chars){for(var i=0;i<chars.length;i++){this.writeScreen.insertChar(chars[i])}var screen=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";logger.log("INFO",screen+": "+this.writeScreen.getDisplayText(true));if(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP"){logger.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(true));this.outputDataUpdate()}}},{key:"ccRCL",value:function ccRCL(){logger.log("INFO","RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function ccBS(){logger.log("INFO","BS - BackSpace");if(this.mode==="MODE_TEXT"){return}this.writeScreen.backSpace();if(this.writeScreen===this.displayedMemory){this.outputDataUpdate()}}},{key:"ccAOF",value:function ccAOF(){return}},{key:"ccAON",value:function ccAON(){return}},{key:"ccDER",value:function ccDER(){logger.log("INFO","DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()}},{key:"ccRU",value:function ccRU(nrRows){logger.log("INFO","RU("+nrRows+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(nrRows)}},{key:"ccFON",value:function ccFON(){logger.log("INFO","FON - Flash On");this.writeScreen.setPen({flash:true})}},{key:"ccRDC",value:function ccRDC(){logger.log("INFO","RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function ccTR(){logger.log("INFO","TR");this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function ccRTD(){logger.log("INFO","RTD");this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function ccEDM(){logger.log("INFO","EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate()}},{key:"ccCR",value:function ccCR(){logger.log("CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate()}},{key:"ccENM",value:function ccENM(){logger.log("INFO","ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function ccEOC(){logger.log("INFO","EOC - End Of Caption");if(this.mode==="MODE_POP-ON"){var tmp=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory;this.nonDisplayedMemory=tmp;this.writeScreen=this.nonDisplayedMemory;logger.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()}},{key:"ccTO",value:function ccTO(nrCols){logger.log("INFO","TO("+nrCols+") - Tab Offset");this.writeScreen.moveCursor(nrCols)}},{key:"ccMIDROW",value:function ccMIDROW(secondByte){var styles={flash:false};styles.underline=secondByte%2===1;styles.italics=secondByte>=46;if(!styles.italics){var colorIndex=Math.floor(secondByte/2)-16;var colors=["white","green","blue","cyan","red","yellow","magenta"];styles.foreground=colors[colorIndex]}else{styles.foreground="white"}logger.log("INFO","MIDROW: "+JSON.stringify(styles));this.writeScreen.setPen(styles)}},{key:"outputDataUpdate",value:function outputDataUpdate(){var t=logger.time;if(t===null){return}if(this.outputFilter){if(this.outputFilter.updateData){this.outputFilter.updateData(t,this.displayedMemory)}if(this.cueStartTime===null&&!this.displayedMemory.isEmpty()){this.cueStartTime=t}else{if(!this.displayedMemory.equals(this.lastOutputScreen)){if(this.outputFilter.newCue){this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen)}this.cueStartTime=this.displayedMemory.isEmpty()?null:t}}this.lastOutputScreen.copy(this.displayedMemory)}}},{key:"cueSplitAtTime",value:function cueSplitAtTime(t){if(this.outputFilter){if(!this.displayedMemory.isEmpty()){if(this.outputFilter.newCue){this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory)}this.cueStartTime=t}}}}]);return Cea608Channel}();var Cea608Parser=function(){function Cea608Parser(field,out1,out2){_classCallCheck(this,Cea608Parser);this.field=field||1;this.outputs=[out1,out2];this.channels=[new Cea608Channel(1,out1),new Cea608Channel(2,out2)];this.currChNr=-1;this.lastCmdA=null;this.lastCmdB=null;this.bufferedData=[];this.startTime=null;this.lastTime=null;this.dataCounters={padding:0,"char":0,cmd:0,other:0}}_createClass(Cea608Parser,[{key:"getHandler",value:function getHandler(index){return this.channels[index].getHandler()}},{key:"setHandler",value:function setHandler(index,newHandler){this.channels[index].setHandler(newHandler)}},{key:"addData",value:function addData(t,byteList){var cmdFound,a,b,charsFound=false;this.lastTime=t;logger.setTime(t);for(var i=0;i<byteList.length;i+=2){a=byteList[i]&127;b=byteList[i+1]&127;if(a===0&&b===0){this.dataCounters.padding+=2;continue}else{logger.log("DATA","["+numArrayToHexArray([byteList[i],byteList[i+1]])+"] -> ("+numArrayToHexArray([a,b])+")")}cmdFound=this.parseCmd(a,b);if(!cmdFound){cmdFound=this.parseMidrow(a,b)}if(!cmdFound){cmdFound=this.parsePAC(a,b)}if(!cmdFound){cmdFound=this.parseBackgroundAttributes(a,b)}if(!cmdFound){charsFound=this.parseChars(a,b);if(charsFound){if(this.currChNr&&this.currChNr>=0){var channel=this.channels[this.currChNr-1];channel.insertChars(charsFound)}else{logger.log("WARNING","No channel found yet. TEXT-MODE?")}}}if(cmdFound){this.dataCounters.cmd+=2}else if(charsFound){this.dataCounters.char+=2}else{this.dataCounters.other+=2;logger.log("WARNING","Couldn't parse cleaned data "+numArrayToHexArray([a,b])+" orig: "+numArrayToHexArray([byteList[i],byteList[i+1]]))}}}},{key:"parseCmd",value:function parseCmd(a,b){var chNr=null;var cond1=(a===20||a===28)&&32<=b&&b<=47;var cond2=(a===23||a===31)&&33<=b&&b<=35;if(!(cond1||cond2)){return false}if(a===this.lastCmdA&&b===this.lastCmdB){this.lastCmdA=null;this.lastCmdB=null;logger.log("DEBUG","Repeated command ("+numArrayToHexArray([a,b])+") is dropped");return true}if(a===20||a===23){chNr=1}else{chNr=2}var channel=this.channels[chNr-1];if(a===20||a===28){if(b===32){channel.ccRCL()}else if(b===33){channel.ccBS()}else if(b===34){channel.ccAOF()}else if(b===35){channel.ccAON()}else if(b===36){channel.ccDER()}else if(b===37){channel.ccRU(2)}else if(b===38){channel.ccRU(3)}else if(b===39){channel.ccRU(4)}else if(b===40){channel.ccFON()}else if(b===41){channel.ccRDC()}else if(b===42){channel.ccTR()}else if(b===43){channel.ccRTD()}else if(b===44){channel.ccEDM()}else if(b===45){channel.ccCR()}else if(b===46){channel.ccENM()}else if(b===47){channel.ccEOC()}}else{channel.ccTO(b-32)}this.lastCmdA=a;this.lastCmdB=b;this.currChNr=chNr;return true}},{key:"parseMidrow",value:function parseMidrow(a,b){var chNr=null;if((a===17||a===25)&&32<=b&&b<=47){if(a===17){chNr=1}else{chNr=2}if(chNr!==this.currChNr){logger.log("ERROR","Mismatch channel in midrow parsing");return false}var channel=this.channels[chNr-1];channel.ccMIDROW(b);logger.log("DEBUG","MIDROW ("+numArrayToHexArray([a,b])+")");return true}return false}},{key:"parsePAC",value:function parsePAC(a,b){var chNr=null;var row=null;var case1=(17<=a&&a<=23||25<=a&&a<=31)&&64<=b&&b<=127;var case2=(a===16||a===24)&&64<=b&&b<=95;if(!(case1||case2)){return false}if(a===this.lastCmdA&&b===this.lastCmdB){this.lastCmdA=null;this.lastCmdB=null;return true}chNr=a<=23?1:2;if(64<=b&&b<=95){row=chNr===1?rowsLowCh1[a]:rowsLowCh2[a]}else{row=chNr===1?rowsHighCh1[a]:rowsHighCh2[a]}var pacData=this.interpretPAC(row,b);var channel=this.channels[chNr-1];channel.setPAC(pacData);this.lastCmdA=a;this.lastCmdB=b;this.currChNr=chNr;return true}},{key:"interpretPAC",value:function interpretPAC(row,byte){var pacIndex=byte;var pacData={color:null,italics:false,indent:null,underline:false,row:row};if(byte>95){pacIndex=byte-96}else{pacIndex=byte-64}pacData.underline=(pacIndex&1)===1;if(pacIndex<=13){pacData.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(pacIndex/2)]}else if(pacIndex<=15){pacData.italics=true;pacData.color="white"}else{pacData.indent=Math.floor((pacIndex-16)/2)*4}return pacData}},{key:"parseChars",value:function parseChars(a,b){var channelNr=null,charCodes=null,charCode1=null;if(a>=25){channelNr=2;charCode1=a-8}else{channelNr=1;charCode1=a}if(17<=charCode1&&charCode1<=19){var oneCode=b;if(charCode1===17){oneCode=b+80}else if(charCode1===18){oneCode=b+112}else{oneCode=b+144}logger.log("INFO","Special char '"+getCharForByte(oneCode)+"' in channel "+channelNr);charCodes=[oneCode]}else if(32<=a&&a<=127){charCodes=b===0?[a]:[a,b]}if(charCodes){var hexCodes=numArrayToHexArray(charCodes);logger.log("DEBUG","Char codes =  "+hexCodes.join(","));this.lastCmdA=null;this.lastCmdB=null}return charCodes}},{key:"parseBackgroundAttributes",value:function parseBackgroundAttributes(a,b){var bkgData,index,chNr,channel;var case1=(a===16||a===24)&&32<=b&&b<=47;var case2=(a===23||a===31)&&45<=b&&b<=47;if(!(case1||case2)){return false}bkgData={};if(a===16||a===24){index=Math.floor((b-32)/2);bkgData.background=backgroundColors[index];if(b%2===1){bkgData.background=bkgData.background+"_semi"}}else if(b===45){bkgData.background="transparent"}else{bkgData.foreground="black";if(b===47){bkgData.underline=true}}chNr=a<24?1:2;channel=this.channels[chNr-1];channel.setBkgData(bkgData);this.lastCmdA=null;this.lastCmdB=null;return true}},{key:"reset",value:function reset(){for(var i=0;i<this.channels.length;i++){if(this.channels[i]){this.channels[i].reset()}}this.lastCmdA=null;this.lastCmdB=null}},{key:"cueSplitAtTime",value:function cueSplitAtTime(t){for(var i=0;i<this.channels.length;i++){if(this.channels[i]){this.channels[i].cueSplitAtTime(t)}}}}]);return Cea608Parser}();exports.default=Cea608Parser},{}],38:[function(_dereq_,module,exports){var Cues={newCue:function newCue(track,startTime,endTime,captionScreen){var row;var cue;var indenting;var indent;var text;var VTTCue=window.VTTCue||window.TextTrackCue;for(var r=0;r<captionScreen.rows.length;r++){row=captionScreen.rows[r];indenting=true;indent=0;text="";if(!row.isEmpty()){for(var c=0;c<row.chars.length;c++){if(row.chars[c].uchar.match(/\s/)&&indenting){indent++}else{text+=row.chars[c].uchar;indenting=false}}cue=new VTTCue(startTime,endTime,text.trim());if(indent>=16){indent--}else{indent++}if(navigator.userAgent.match(/Firefox\//)){cue.line=r+1}else{cue.line=r>7?r-2:r+1}cue.align="left";cue.position=100*(indent/32)+(navigator.userAgent.match(/Firefox\//)?50:0);track.addCue(cue)}}}};module.exports=Cues},{}],39:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function noop(){}var fakeLogger={trace:noop,debug:noop,log:noop,warn:noop,info:noop,error:noop};var exportedLogger=fakeLogger;function formatMsg(type,msg){msg="["+type+"] > "+msg;return msg}function consolePrintFn(type){var func=window.console[type];if(func){return function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}if(args[0]){args[0]=formatMsg(type,args[0])}func.apply(window.console,args)}}return noop}function exportLoggerFunctions(debugConfig){for(var _len2=arguments.length,functions=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){functions[_key2-1]=arguments[_key2]}functions.forEach(function(type){exportedLogger[type]=debugConfig[type]?debugConfig[type].bind(debugConfig):consolePrintFn(type)})}var enableLogs=exports.enableLogs=function enableLogs(debugConfig){if(debugConfig===true||(typeof debugConfig==="undefined"?"undefined":_typeof(debugConfig))==="object"){exportLoggerFunctions(debugConfig,"debug","log","info","warn","error");try{exportedLogger.log()}catch(e){exportedLogger=fakeLogger}}else{exportedLogger=fakeLogger}};var logger=exports.logger=exportedLogger},{}],40:[function(_dereq_,module,exports){if(!ArrayBuffer.prototype.slice){ArrayBuffer.prototype.slice=function(start,end){var that=new Uint8Array(this);if(end===undefined){end=that.length}var result=new ArrayBuffer(end-start);var resultArray=new Uint8Array(result);for(var i=0;i<resultArray.length;i++){resultArray[i]=that[i+start]}return result}}if(!Object.assign){Object.assign=function(obj){for(var i=1;i<arguments.length;i++){var source=arguments[i];if(!source){continue}for(var prop in source){if(source.hasOwnProperty(prop)){obj[prop]=source[prop]}}}return obj}}},{}],41:[function(_dereq_,module,exports){var URLHelper={buildAbsoluteURL:function buildAbsoluteURL(baseURL,relativeURL){relativeURL=relativeURL.trim();if(/^[a-z]+:/i.test(relativeURL)){return(" "+relativeURL).slice(1)}var relativeURLQuery=null;var relativeURLHash=null;var relativeURLHashSplit=/^([^#]*)(.*)$/.exec(relativeURL);if(relativeURLHashSplit){relativeURLHash=relativeURLHashSplit[2];relativeURL=relativeURLHashSplit[1]}var relativeURLQuerySplit=/^([^\?]*)(.*)$/.exec(relativeURL);if(relativeURLQuerySplit){relativeURLQuery=relativeURLQuerySplit[2];relativeURL=relativeURLQuerySplit[1]}var baseURLHashSplit=/^([^#]*)(.*)$/.exec(baseURL);if(baseURLHashSplit){baseURL=baseURLHashSplit[1]}var baseURLQuerySplit=/^([^\?]*)(.*)$/.exec(baseURL);if(baseURLQuerySplit){baseURL=baseURLQuerySplit[1]}var baseURLDomainSplit=/^(([a-z]+:)?\/\/[a-z0-9\.\-_~]+(:[0-9]+)?)?(\/.*)$/i.exec(baseURL);if(!baseURLDomainSplit){throw new Error("Error trying to parse base URL.")}var baseURLProtocol=baseURLDomainSplit[2]||"";var baseURLProtocolDomain=baseURLDomainSplit[1]||"";var baseURLPath=baseURLDomainSplit[4];var builtURL=null;if(/^\/\//.test(relativeURL)){builtURL=baseURLProtocol+"//"+URLHelper.buildAbsolutePath("",relativeURL.substring(2))}else if(/^\//.test(relativeURL)){builtURL=baseURLProtocolDomain+"/"+URLHelper.buildAbsolutePath("",relativeURL.substring(1))}else{builtURL=URLHelper.buildAbsolutePath(baseURLProtocolDomain+baseURLPath,relativeURL)}if(relativeURLQuery){builtURL+=relativeURLQuery}if(relativeURLHash){builtURL+=relativeURLHash}return builtURL},buildAbsolutePath:function buildAbsolutePath(basePath,relativePath){var sRelPath=relativePath;var nUpLn,sDir="",sPath=basePath.replace(/[^\/]*$/,sRelPath.replace(/(\/|^)(?:\.?\/+)+/g,"$1"));for(var nEnd,nStart=0;nEnd=sPath.indexOf("/../",nStart),nEnd>-1;nStart=nEnd+nUpLn){nUpLn=/^\/(?:\.\.\/)*/.exec(sPath.slice(nEnd))[0].length;sDir=(sDir+sPath.substring(nStart,nEnd)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(nUpLn-1)/3+"}$"),"/")}return sDir+sPath.substr(nStart)}};module.exports=URLHelper},{}],42:[function(_dereq_,module,exports){Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _logger=_dereq_("../utils/logger");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var XhrLoader=function(){function XhrLoader(config){_classCallCheck(this,XhrLoader);if(config&&config.xhrSetup){this.xhrSetup=config.xhrSetup}}_createClass(XhrLoader,[{key:"destroy",value:function destroy(){this.abort();this.loader=null}},{key:"abort",value:function abort(){var loader=this.loader,timeoutHandle=this.timeoutHandle;if(loader&&loader.readyState!==4){this.stats.aborted=true;loader.abort()}if(timeoutHandle){window.clearTimeout(timeoutHandle)}}},{key:"load",value:function load(url,responseType,onSuccess,onError,onTimeout,timeout,maxRetry,retryDelay){var onProgress=arguments.length>8&&arguments[8]!==undefined?arguments[8]:null;var frag=arguments.length>9&&arguments[9]!==undefined?arguments[9]:null;this.url=url;if(frag&&!isNaN(frag.byteRangeStartOffset)&&!isNaN(frag.byteRangeEndOffset)){this.byteRange=frag.byteRangeStartOffset+"-"+(frag.byteRangeEndOffset-1)}this.responseType=responseType;this.onSuccess=onSuccess;this.onProgress=onProgress;this.onTimeout=onTimeout;this.onError=onError;this.stats={trequest:performance.now(),retry:0};this.timeout=timeout;this.maxRetry=maxRetry;this.retryDelay=retryDelay;this.loadInternal()}},{key:"loadInternal",value:function loadInternal(){var xhr;if(typeof XDomainRequest!=="undefined"){xhr=this.loader=new XDomainRequest}else{xhr=this.loader=new XMLHttpRequest}xhr.onloadend=this.loadend.bind(this);xhr.onprogress=this.loadprogress.bind(this);var url=this.url;if(location.protocol==="https:"&&/^http:\/\//.test(url)){url=url.replace(/^http:\/\//,"https://")}xhr.open("GET",url,true);if(this.byteRange){xhr.setRequestHeader("Range","bytes="+this.byteRange)}xhr.responseType=this.responseType;this.stats.tfirst=null;this.stats.loaded=0;if(this.xhrSetup){this.xhrSetup(xhr,url)}this.timeoutHandle=window.setTimeout(this.loadtimeout.bind(this),this.timeout);xhr.send()}},{key:"loadend",value:function loadend(event){var xhr=event.currentTarget,status=xhr.status,stats=this.stats;if(!stats.aborted){if(status>=200&&status<300){window.clearTimeout(this.timeoutHandle);stats.tload=performance.now();this.onSuccess(event,stats)}else{if(stats.retry<this.maxRetry){_logger.logger.warn(status+" while loading "+this.url+", retrying in "+this.retryDelay+"...");this.destroy();window.setTimeout(this.loadInternal.bind(this),this.retryDelay);this.retryDelay=Math.min(2*this.retryDelay,64e3);stats.retry++}else{window.clearTimeout(this.timeoutHandle);_logger.logger.error(status+" while loading "+this.url);this.onError(event)}}}}},{key:"loadtimeout",value:function loadtimeout(event){_logger.logger.warn("timeout while loading "+this.url);this.onTimeout(event,this.stats)}},{key:"loadprogress",value:function loadprogress(event){var stats=this.stats;if(stats.tfirst===null){stats.tfirst=performance.now()}stats.loaded=event.loaded;if(event.lengthComputable){stats.total=event.total}if(this.onProgress){this.onProgress(stats)}}}]);return XhrLoader}();exports.default=XhrLoader},{"../utils/logger":39}]},{},[28])(28)})})();
define("vjs5_10",[],function(){var define;(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.videojs=f()}})(function(){var __hola_stub_define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){},{}],2:[function(_dereq_,module,exports){var keys=_dereq_("object-keys");var foreach=_dereq_("foreach");var hasSymbols=typeof Symbol==="function"&&typeof Symbol()==="symbol";var toStr=Object.prototype.toString;var isFunction=function(fn){return typeof fn==="function"&&toStr.call(fn)==="[object Function]"};var arePropertyDescriptorsSupported=function(){var obj={};try{Object.defineProperty(obj,"x",{enumerable:false,value:obj});for(var _ in obj){return false}return obj.x===obj}catch(e){return false}};var supportsDescriptors=Object.defineProperty&&arePropertyDescriptorsSupported();var defineProperty=function(object,name,value,predicate){if(name in object&&(!isFunction(predicate)||!predicate())){return}if(supportsDescriptors){Object.defineProperty(object,name,{configurable:true,enumerable:false,value:value,writable:true})}else{object[name]=value}};var defineProperties=function(object,map){var predicates=arguments.length>2?arguments[2]:{};var props=keys(map);if(hasSymbols){props=props.concat(Object.getOwnPropertySymbols(map))}foreach(props,function(name){defineProperty(object,name,map[name],predicates[name])})};defineProperties.supportsDescriptors=!!supportsDescriptors;module.exports=defineProperties},{foreach:6,"object-keys":3}],3:[function(_dereq_,module,exports){var has=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var slice=Array.prototype.slice;var isArgs=_dereq_("./isArguments");var isEnumerable=Object.prototype.propertyIsEnumerable;var hasDontEnumBug=!isEnumerable.call({toString:null},"toString");var hasProtoEnumBug=isEnumerable.call(function(){},"prototype");var dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o};var excludedKeys={$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true};var hasAutomationEqualityBug=function(){if(typeof window==="undefined"){return false}for(var k in window){try{if(!excludedKeys["$"+k]&&has.call(window,k)&&window[k]!==null&&typeof window[k]==="object"){try{equalsConstructorPrototype(window[k])}catch(e){return true}}}catch(e){return true}}return false}();var equalsConstructorPrototypeIfNotBuggy=function(o){if(typeof window==="undefined"||!hasAutomationEqualityBug){return equalsConstructorPrototype(o)}try{return equalsConstructorPrototype(o)}catch(e){return false}};var keysShim=function keys(object){var isObject=object!==null&&typeof object==="object";var isFunction=toStr.call(object)==="[object Function]";var isArguments=isArgs(object);var isString=isObject&&toStr.call(object)==="[object String]";var theKeys=[];if(!isObject&&!isFunction&&!isArguments){throw new TypeError("Object.keys called on a non-object")}var skipProto=hasProtoEnumBug&&isFunction;if(isString&&object.length>0&&!has.call(object,0)){for(var i=0;i<object.length;++i){theKeys.push(String(i))}}if(isArguments&&object.length>0){for(var j=0;j<object.length;++j){theKeys.push(String(j))}}else{for(var name in object){if(!(skipProto&&name==="prototype")&&has.call(object,name)){theKeys.push(String(name))}}}if(hasDontEnumBug){var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object);for(var k=0;k<dontEnums.length;++k){if(!(skipConstructor&&dontEnums[k]==="constructor")&&has.call(object,dontEnums[k])){theKeys.push(dontEnums[k])}}}return theKeys};keysShim.shim=function shimObjectKeys(){if(Object.keys){var keysWorksWithArguments=function(){return(Object.keys(arguments)||"").length===2}(1,2);if(!keysWorksWithArguments){var originalKeys=Object.keys;Object.keys=function keys(object){if(isArgs(object)){return originalKeys(slice.call(object))}else{return originalKeys(object)}}}}else{Object.keys=keysShim}return Object.keys||keysShim};module.exports=keysShim},{"./isArguments":4}],4:[function(_dereq_,module,exports){var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value);var isArgs=str==="[object Arguments]";if(!isArgs){isArgs=str!=="[object Array]"&&value!==null&&typeof value==="object"&&typeof value.length==="number"&&value.length>=0&&toStr.call(value.callee)==="[object Function]"}return isArgs}},{}],5:[function(_dereq_,module,exports){var isFunction=_dereq_("is-function");module.exports=forEach;var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;function forEach(list,iterator,context){if(!isFunction(iterator)){throw new TypeError("iterator must be a function")}if(arguments.length<3){context=this}if(toString.call(list)==="[object Array]")forEachArray(list,iterator,context);else if(typeof list==="string")forEachString(list,iterator,context);else forEachObject(list,iterator,context)}function forEachArray(array,iterator,context){for(var i=0,len=array.length;i<len;i++){if(hasOwnProperty.call(array,i)){iterator.call(context,array[i],i,array)}}}function forEachString(string,iterator,context){for(var i=0,len=string.length;i<len;i++){iterator.call(context,string.charAt(i),i,string)}}function forEachObject(object,iterator,context){for(var k in object){if(hasOwnProperty.call(object,k)){iterator.call(context,object[k],k,object)}}}},{"is-function":11}],6:[function(_dereq_,module,exports){var hasOwn=Object.prototype.hasOwnProperty;var toString=Object.prototype.toString;module.exports=function forEach(obj,fn,ctx){if(toString.call(fn)!=="[object Function]"){throw new TypeError("iterator must be a function")}var l=obj.length;if(l===+l){for(var i=0;i<l;i++){fn.call(ctx,obj[i],i,obj)}}else{for(var k in obj){if(hasOwn.call(obj,k)){fn.call(ctx,obj[k],k,obj)}}}}},{}],7:[function(_dereq_,module,exports){var ERROR_MESSAGE="Function.prototype.bind called on incompatible ";var slice=Array.prototype.slice;var toStr=Object.prototype.toString;var funcType="[object Function]";module.exports=function bind(that){var target=this;if(typeof target!=="function"||toStr.call(target)!==funcType){throw new TypeError(ERROR_MESSAGE+target)}var args=slice.call(arguments,1);var bound;var binder=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));if(Object(result)===result){return result}return this}else{return target.apply(that,args.concat(slice.call(arguments)))}};var boundLength=Math.max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs.push("$"+i)}bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(binder);if(target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype;bound.prototype=new Empty;Empty.prototype=null}return bound}},{}],8:[function(_dereq_,module,exports){var implementation=_dereq_("./implementation");module.exports=Function.prototype.bind||implementation},{"./implementation":7}],9:[function(_dereq_,module,exports){(function(global){var topLevel=typeof global!=="undefined"?global:typeof window!=="undefined"?window:{};var minDoc=_dereq_("min-document");if(typeof document!=="undefined"){module.exports=document}else{var doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"];if(!doccy){doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"]=minDoc}module.exports=doccy}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"min-document":1}],10:[function(_dereq_,module,exports){(function(global){if(typeof window!=="undefined"){module.exports=window}else if(typeof global!=="undefined"){module.exports=global}else if(typeof self!=="undefined"){module.exports=self}else{module.exports={}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],11:[function(_dereq_,module,exports){module.exports=isFunction;var toString=Object.prototype.toString;function isFunction(fn){var string=toString.call(fn);return string==="[object Function]"||typeof fn==="function"&&string!=="[object RegExp]"||typeof window!=="undefined"&&(fn===window.setTimeout||fn===window.alert||fn===window.confirm||fn===window.prompt)}},{}],12:[function(_dereq_,module,exports){var getNative=_dereq_("../internal/getNative");var nativeNow=getNative(Date,"now");var now=nativeNow||function(){return(new Date).getTime()};module.exports=now},{"../internal/getNative":28}],13:[function(_dereq_,module,exports){var isObject=_dereq_("../lang/isObject"),now=_dereq_("../date/now");var FUNC_ERROR_TEXT="Expected a function";var nativeMax=Math.max;function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=false,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}wait=wait<0?0:+wait||0;if(options===true){var leading=true;trailing=false}else if(isObject(options)){leading=!!options.leading;maxWait="maxWait"in options&&nativeMax(+options.maxWait||0,wait);trailing="trailing"in options?!!options.trailing:trailing}function cancel(){if(timeoutId){clearTimeout(timeoutId)}if(maxTimeoutId){clearTimeout(maxTimeoutId)}lastCalled=0;maxTimeoutId=timeoutId=trailingCall=undefined}function complete(isCalled,id){if(id){clearTimeout(id)}maxTimeoutId=timeoutId=trailingCall=undefined;if(isCalled){lastCalled=now();result=func.apply(thisArg,args);if(!timeoutId&&!maxTimeoutId){args=thisArg=undefined}}}function delayed(){var remaining=wait-(now()-stamp);if(remaining<=0||remaining>wait){complete(trailingCall,maxTimeoutId)}else{timeoutId=setTimeout(delayed,remaining)}}function maxDelayed(){complete(trailing,timeoutId)}function debounced(){args=arguments;stamp=now();thisArg=this;trailingCall=trailing&&(timeoutId||!leading);if(maxWait===false){var leadingCall=leading&&!timeoutId}else{if(!maxTimeoutId&&!leading){lastCalled=stamp}var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0||remaining>maxWait;if(isCalled){if(maxTimeoutId){maxTimeoutId=clearTimeout(maxTimeoutId)}lastCalled=stamp;result=func.apply(thisArg,args)}else if(!maxTimeoutId){maxTimeoutId=setTimeout(maxDelayed,remaining)}}if(isCalled&&timeoutId){timeoutId=clearTimeout(timeoutId)}else if(!timeoutId&&wait!==maxWait){timeoutId=setTimeout(delayed,wait)}if(leadingCall){isCalled=true;result=func.apply(thisArg,args)}if(isCalled&&!timeoutId&&!maxTimeoutId){args=thisArg=undefined}return result}debounced.cancel=cancel;return debounced}module.exports=debounce},{"../date/now":12,"../lang/isObject":41}],14:[function(_dereq_,module,exports){var FUNC_ERROR_TEXT="Expected a function";var nativeMax=Math.max;function restParam(func,start){if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}start=nativeMax(start===undefined?func.length-1:+start||0,0);return function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);while(++index<length){rest[index]=args[start+index]}switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest)}var otherArgs=Array(start+1);index=-1;while(++index<start){otherArgs[index]=args[index]}otherArgs[start]=rest;return func.apply(this,otherArgs)}}module.exports=restParam},{}],15:[function(_dereq_,module,exports){var debounce=_dereq_("./debounce"),isObject=_dereq_("../lang/isObject");var FUNC_ERROR_TEXT="Expected a function";function throttle(func,wait,options){var leading=true,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}if(options===false){leading=false}else if(isObject(options)){leading="leading"in options?!!options.leading:leading;trailing="trailing"in options?!!options.trailing:trailing}return debounce(func,wait,{leading:leading,maxWait:+wait,trailing:trailing})}module.exports=throttle},{"../lang/isObject":41,"./debounce":13}],16:[function(_dereq_,module,exports){function arrayCopy(source,array){var index=-1,length=source.length;array||(array=Array(length));while(++index<length){array[index]=source[index]}return array}module.exports=arrayCopy},{}],17:[function(_dereq_,module,exports){function arrayEach(array,iteratee){var index=-1,length=array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break}}return array}module.exports=arrayEach},{}],18:[function(_dereq_,module,exports){function baseCopy(source,props,object){object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];object[key]=source[key]}return object}module.exports=baseCopy},{}],19:[function(_dereq_,module,exports){var createBaseFor=_dereq_("./createBaseFor");var baseFor=createBaseFor();module.exports=baseFor},{"./createBaseFor":26}],20:[function(_dereq_,module,exports){var baseFor=_dereq_("./baseFor"),keysIn=_dereq_("../object/keysIn");function baseForIn(object,iteratee){return baseFor(object,iteratee,keysIn)}module.exports=baseForIn},{"../object/keysIn":47,"./baseFor":19}],21:[function(_dereq_,module,exports){var arrayEach=_dereq_("./arrayEach"),baseMergeDeep=_dereq_("./baseMergeDeep"),isArray=_dereq_("../lang/isArray"),isArrayLike=_dereq_("./isArrayLike"),isObject=_dereq_("../lang/isObject"),isObjectLike=_dereq_("./isObjectLike"),isTypedArray=_dereq_("../lang/isTypedArray"),keys=_dereq_("../object/keys");function baseMerge(object,source,customizer,stackA,stackB){if(!isObject(object)){return object}var isSrcArr=isArrayLike(source)&&(isArray(source)||isTypedArray(source)),props=isSrcArr?undefined:keys(source);arrayEach(props||source,function(srcValue,key){if(props){key=srcValue;srcValue=source[key]}if(isObjectLike(srcValue)){stackA||(stackA=[]);stackB||(stackB=[]);baseMergeDeep(object,source,key,baseMerge,customizer,stackA,stackB)}else{var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;if(isCommon){result=srcValue}if((result!==undefined||isSrcArr&&!(key in object))&&(isCommon||(result===result?result!==value:value===value))){object[key]=result}}});return object}module.exports=baseMerge},{"../lang/isArray":38,"../lang/isObject":41,"../lang/isTypedArray":44,"../object/keys":46,"./arrayEach":17,"./baseMergeDeep":22,"./isArrayLike":29,"./isObjectLike":34}],22:[function(_dereq_,module,exports){var arrayCopy=_dereq_("./arrayCopy"),isArguments=_dereq_("../lang/isArguments"),isArray=_dereq_("../lang/isArray"),isArrayLike=_dereq_("./isArrayLike"),isPlainObject=_dereq_("../lang/isPlainObject"),isTypedArray=_dereq_("../lang/isTypedArray"),toPlainObject=_dereq_("../lang/toPlainObject");function baseMergeDeep(object,source,key,mergeFunc,customizer,stackA,stackB){var length=stackA.length,srcValue=source[key];while(length--){if(stackA[length]==srcValue){object[key]=stackB[length];return}}var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;if(isCommon){result=srcValue;if(isArrayLike(srcValue)&&(isArray(srcValue)||isTypedArray(srcValue))){result=isArray(value)?value:isArrayLike(value)?arrayCopy(value):[]}else if(isPlainObject(srcValue)||isArguments(srcValue)){result=isArguments(value)?toPlainObject(value):isPlainObject(value)?value:{}}else{isCommon=false}}stackA.push(srcValue);stackB.push(result);if(isCommon){object[key]=mergeFunc(result,srcValue,customizer,stackA,stackB)}else if(result===result?result!==value:value===value){object[key]=result}}module.exports=baseMergeDeep},{"../lang/isArguments":37,"../lang/isArray":38,"../lang/isPlainObject":42,"../lang/isTypedArray":44,"../lang/toPlainObject":45,"./arrayCopy":16,"./isArrayLike":29}],23:[function(_dereq_,module,exports){var toObject=_dereq_("./toObject");function baseProperty(key){return function(object){return object==null?undefined:toObject(object)[key]}}module.exports=baseProperty},{"./toObject":36}],24:[function(_dereq_,module,exports){var identity=_dereq_("../utility/identity");function bindCallback(func,thisArg,argCount){if(typeof func!="function"){return identity}if(thisArg===undefined){return func}switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source)}}return function(){return func.apply(thisArg,arguments)}}module.exports=bindCallback},{"../utility/identity":50}],25:[function(_dereq_,module,exports){var bindCallback=_dereq_("./bindCallback"),isIterateeCall=_dereq_("./isIterateeCall"),restParam=_dereq_("../function/restParam");function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=object==null?0:sources.length,customizer=length>2?sources[length-2]:undefined,guard=length>2?sources[2]:undefined,thisArg=length>1?sources[length-1]:undefined;if(typeof customizer=="function"){customizer=bindCallback(customizer,thisArg,5);length-=2}else{customizer=typeof thisArg=="function"?thisArg:undefined;length-=customizer?1:0}if(guard&&isIterateeCall(sources[0],sources[1],guard)){customizer=length<3?undefined:customizer;length=1}while(++index<length){var source=sources[index];if(source){assigner(object,source,customizer)}}return object})}module.exports=createAssigner},{"../function/restParam":14,"./bindCallback":24,"./isIterateeCall":32}],26:[function(_dereq_,module,exports){var toObject=_dereq_("./toObject");function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;while(fromRight?index--:++index<length){var key=props[index];if(iteratee(iterable[key],key,iterable)===false){break}}return object}}module.exports=createBaseFor},{"./toObject":36}],27:[function(_dereq_,module,exports){var baseProperty=_dereq_("./baseProperty");var getLength=baseProperty("length");module.exports=getLength},{"./baseProperty":23}],28:[function(_dereq_,module,exports){var isNative=_dereq_("../lang/isNative");function getNative(object,key){var value=object==null?undefined:object[key];return isNative(value)?value:undefined}module.exports=getNative},{"../lang/isNative":40}],29:[function(_dereq_,module,exports){var getLength=_dereq_("./getLength"),isLength=_dereq_("./isLength");function isArrayLike(value){return value!=null&&isLength(getLength(value))}module.exports=isArrayLike},{"./getLength":27,"./isLength":33}],30:[function(_dereq_,module,exports){var isHostObject=function(){try{Object({toString:0}+"")}catch(e){return function(){return false}}return function(value){return typeof value.toString!="function"&&typeof(value+"")=="string"}}();module.exports=isHostObject},{}],31:[function(_dereq_,module,exports){var reIsUint=/^\d+$/;var MAX_SAFE_INTEGER=9007199254740991;function isIndex(value,length){value=typeof value=="number"||reIsUint.test(value)?+value:-1;length=length==null?MAX_SAFE_INTEGER:length;return value>-1&&value%1==0&&value<length}module.exports=isIndex},{}],32:[function(_dereq_,module,exports){var isArrayLike=_dereq_("./isArrayLike"),isIndex=_dereq_("./isIndex"),isObject=_dereq_("../lang/isObject");function isIterateeCall(value,index,object){if(!isObject(object)){return false}var type=typeof index;if(type=="number"?isArrayLike(object)&&isIndex(index,object.length):type=="string"&&index in object){var other=object[index];return value===value?value===other:other!==other}return false}module.exports=isIterateeCall},{"../lang/isObject":41,"./isArrayLike":29,"./isIndex":31}],33:[function(_dereq_,module,exports){var MAX_SAFE_INTEGER=9007199254740991;function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}module.exports=isLength},{}],34:[function(_dereq_,module,exports){function isObjectLike(value){return!!value&&typeof value=="object"}module.exports=isObjectLike},{}],35:[function(_dereq_,module,exports){var isArguments=_dereq_("../lang/isArguments"),isArray=_dereq_("../lang/isArray"),isIndex=_dereq_("./isIndex"),isLength=_dereq_("./isLength"),isString=_dereq_("../lang/isString"),keysIn=_dereq_("../object/keysIn");var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;function shimKeys(object){var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length;var allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object)||isString(object));var index=-1,result=[];while(++index<propsLength){var key=props[index];if(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key)){result.push(key)}}return result}module.exports=shimKeys},{"../lang/isArguments":37,"../lang/isArray":38,"../lang/isString":43,"../object/keysIn":47,"./isIndex":31,"./isLength":33}],36:[function(_dereq_,module,exports){var isObject=_dereq_("../lang/isObject"),isString=_dereq_("../lang/isString"),support=_dereq_("../support");function toObject(value){if(support.unindexedChars&&isString(value)){var index=-1,length=value.length,result=Object(value);while(++index<length){result[index]=value.charAt(index)}return result}return isObject(value)?value:Object(value)}module.exports=toObject},{"../lang/isObject":41,"../lang/isString":43,"../support":49}],37:[function(_dereq_,module,exports){var isArrayLike=_dereq_("../internal/isArrayLike"),isObjectLike=_dereq_("../internal/isObjectLike");var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var propertyIsEnumerable=objectProto.propertyIsEnumerable;function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")}module.exports=isArguments},{"../internal/isArrayLike":29,"../internal/isObjectLike":34}],38:[function(_dereq_,module,exports){var getNative=_dereq_("../internal/getNative"),isLength=_dereq_("../internal/isLength"),isObjectLike=_dereq_("../internal/isObjectLike");var arrayTag="[object Array]";var objectProto=Object.prototype;var objToString=objectProto.toString;var nativeIsArray=getNative(Array,"isArray");var isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&objToString.call(value)==arrayTag};module.exports=isArray},{"../internal/getNative":28,"../internal/isLength":33,"../internal/isObjectLike":34}],39:[function(_dereq_,module,exports){var isObject=_dereq_("./isObject");var funcTag="[object Function]";var objectProto=Object.prototype;var objToString=objectProto.toString;function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag}module.exports=isFunction},{"./isObject":41}],40:[function(_dereq_,module,exports){var isFunction=_dereq_("./isFunction"),isHostObject=_dereq_("../internal/isHostObject"),isObjectLike=_dereq_("../internal/isObjectLike");var reIsHostCtor=/^\[object .+?Constructor\]$/;var objectProto=Object.prototype;var fnToString=Function.prototype.toString;var hasOwnProperty=objectProto.hasOwnProperty;var reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function isNative(value){if(value==null){return false}if(isFunction(value)){return reIsNative.test(fnToString.call(value))}return isObjectLike(value)&&(isHostObject(value)?reIsNative:reIsHostCtor).test(value)}module.exports=isNative},{"../internal/isHostObject":30,"../internal/isObjectLike":34,"./isFunction":39}],41:[function(_dereq_,module,exports){function isObject(value){var type=typeof value;return!!value&&(type=="object"||type=="function")}module.exports=isObject},{}],42:[function(_dereq_,module,exports){var baseForIn=_dereq_("../internal/baseForIn"),isArguments=_dereq_("./isArguments"),isHostObject=_dereq_("../internal/isHostObject"),isObjectLike=_dereq_("../internal/isObjectLike"),support=_dereq_("../support");var objectTag="[object Object]";var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var objToString=objectProto.toString;function isPlainObject(value){var Ctor;if(!(isObjectLike(value)&&objToString.call(value)==objectTag&&!isHostObject(value)&&!isArguments(value))||!hasOwnProperty.call(value,"constructor")&&(Ctor=value.constructor,typeof Ctor=="function"&&!(Ctor instanceof Ctor))){return false}var result;if(support.ownLast){baseForIn(value,function(subValue,key,object){result=hasOwnProperty.call(object,key);return false});return result!==false}baseForIn(value,function(subValue,key){result=key});return result===undefined||hasOwnProperty.call(value,result)}module.exports=isPlainObject},{"../internal/baseForIn":20,"../internal/isHostObject":30,"../internal/isObjectLike":34,"../support":49,"./isArguments":37}],43:[function(_dereq_,module,exports){var isObjectLike=_dereq_("../internal/isObjectLike");var stringTag="[object String]";var objectProto=Object.prototype;var objToString=objectProto.toString;function isString(value){return typeof value=="string"||isObjectLike(value)&&objToString.call(value)==stringTag}module.exports=isString},{"../internal/isObjectLike":34}],44:[function(_dereq_,module,exports){var isLength=_dereq_("../internal/isLength"),isObjectLike=_dereq_("../internal/isObjectLike");var argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]";var arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";var typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=true;typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=false;var objectProto=Object.prototype;var objToString=objectProto.toString;function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)]}module.exports=isTypedArray},{"../internal/isLength":33,"../internal/isObjectLike":34}],45:[function(_dereq_,module,exports){var baseCopy=_dereq_("../internal/baseCopy"),keysIn=_dereq_("../object/keysIn");function toPlainObject(value){return baseCopy(value,keysIn(value))}module.exports=toPlainObject},{"../internal/baseCopy":18,"../object/keysIn":47}],46:[function(_dereq_,module,exports){var getNative=_dereq_("../internal/getNative"),isArrayLike=_dereq_("../internal/isArrayLike"),isObject=_dereq_("../lang/isObject"),shimKeys=_dereq_("../internal/shimKeys"),support=_dereq_("../support");var nativeKeys=getNative(Object,"keys");var keys=!nativeKeys?shimKeys:function(object){var Ctor=object==null?undefined:object.constructor;if(typeof Ctor=="function"&&Ctor.prototype===object||(typeof object=="function"?support.enumPrototypes:isArrayLike(object))){return shimKeys(object)}return isObject(object)?nativeKeys(object):[]};module.exports=keys},{"../internal/getNative":28,"../internal/isArrayLike":29,"../internal/shimKeys":35,"../lang/isObject":41,"../support":49}],47:[function(_dereq_,module,exports){var arrayEach=_dereq_("../internal/arrayEach"),isArguments=_dereq_("../lang/isArguments"),isArray=_dereq_("../lang/isArray"),isFunction=_dereq_("../lang/isFunction"),isIndex=_dereq_("../internal/isIndex"),isLength=_dereq_("../internal/isLength"),isObject=_dereq_("../lang/isObject"),isString=_dereq_("../lang/isString"),support=_dereq_("../support");var arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",stringTag="[object String]";var shadowProps=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var errorProto=Error.prototype,objectProto=Object.prototype,stringProto=String.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var objToString=objectProto.toString;var nonEnumProps={};nonEnumProps[arrayTag]=nonEnumProps[dateTag]=nonEnumProps[numberTag]={constructor:true,toLocaleString:true,toString:true,valueOf:true};nonEnumProps[boolTag]=nonEnumProps[stringTag]={constructor:true,toString:true,valueOf:true};nonEnumProps[errorTag]=nonEnumProps[funcTag]=nonEnumProps[regexpTag]={constructor:true,toString:true};nonEnumProps[objectTag]={constructor:true};arrayEach(shadowProps,function(key){for(var tag in nonEnumProps){if(hasOwnProperty.call(nonEnumProps,tag)){var props=nonEnumProps[tag];props[key]=hasOwnProperty.call(props,key)}}});function keysIn(object){if(object==null){return[]}if(!isObject(object)){object=Object(object)}var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object)||isString(object))&&length||0;var Ctor=object.constructor,index=-1,proto=isFunction(Ctor)&&Ctor.prototype||objectProto,isProto=proto===object,result=Array(length),skipIndexes=length>0,skipErrorProps=support.enumErrorProps&&(object===errorProto||object instanceof Error),skipProto=support.enumPrototypes&&isFunction(object);while(++index<length){result[index]=index+""}for(var key in object){if(!(skipProto&&key=="prototype")&&!(skipErrorProps&&(key=="message"||key=="name"))&&!(skipIndexes&&isIndex(key,length))&&!(key=="constructor"&&(isProto||!hasOwnProperty.call(object,key)))){result.push(key)}}if(support.nonEnumShadows&&object!==objectProto){var tag=object===stringProto?stringTag:object===errorProto?errorTag:objToString.call(object),nonEnums=nonEnumProps[tag]||nonEnumProps[objectTag];if(tag==objectTag){proto=objectProto}length=shadowProps.length;while(length--){key=shadowProps[length];var nonEnum=nonEnums[key];if(!(isProto&&nonEnum)&&(nonEnum?hasOwnProperty.call(object,key):object[key]!==proto[key])){result.push(key)}}}return result}module.exports=keysIn},{"../internal/arrayEach":17,"../internal/isIndex":31,"../internal/isLength":33,"../lang/isArguments":37,"../lang/isArray":38,"../lang/isFunction":39,"../lang/isObject":41,"../lang/isString":43,"../support":49}],48:[function(_dereq_,module,exports){var baseMerge=_dereq_("../internal/baseMerge"),createAssigner=_dereq_("../internal/createAssigner");var merge=createAssigner(baseMerge);module.exports=merge;
},{"../internal/baseMerge":21,"../internal/createAssigner":25}],49:[function(_dereq_,module,exports){var arrayProto=Array.prototype,errorProto=Error.prototype,objectProto=Object.prototype;var propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice;var support={};(function(x){var Ctor=function(){this.x=x},object={0:x,length:x},props=[];Ctor.prototype={valueOf:x,y:x};for(var key in new Ctor){props.push(key)}support.enumErrorProps=propertyIsEnumerable.call(errorProto,"message")||propertyIsEnumerable.call(errorProto,"name");support.enumPrototypes=propertyIsEnumerable.call(Ctor,"prototype");support.nonEnumShadows=!/valueOf/.test(props);support.ownLast=props[0]!="x";support.spliceObjects=(splice.call(object,0,1),!object[0]);support.unindexedChars="x"[0]+Object("x")[0]!="xx"})(1,0);module.exports=support},{}],50:[function(_dereq_,module,exports){function identity(value){return value}module.exports=identity},{}],51:[function(_dereq_,module,exports){var keys=_dereq_("object-keys");module.exports=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false}if(typeof Symbol.iterator==="symbol"){return true}var obj={};var sym=Symbol("test");var symObj=Object(sym);if(typeof sym==="string"){return false}if(Object.prototype.toString.call(sym)!=="[object Symbol]"){return false}if(Object.prototype.toString.call(symObj)!=="[object Symbol]"){return false}var symVal=42;obj[sym]=symVal;for(sym in obj){return false}if(keys(obj).length!==0){return false}if(typeof Object.keys==="function"&&Object.keys(obj).length!==0){return false}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(obj).length!==0){return false}var syms=Object.getOwnPropertySymbols(obj);if(syms.length!==1||syms[0]!==sym){return false}if(!Object.prototype.propertyIsEnumerable.call(obj,sym)){return false}if(typeof Object.getOwnPropertyDescriptor==="function"){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(descriptor.value!==symVal||descriptor.enumerable!==true){return false}}return true}},{"object-keys":54}],52:[function(_dereq_,module,exports){var keys=_dereq_("object-keys");var bind=_dereq_("function-bind");var canBeObject=function(obj){return typeof obj!=="undefined"&&obj!==null};var hasSymbols=_dereq_("./hasSymbols")();var toObject=Object;var push=bind.call(Function.call,Array.prototype.push);var propIsEnumerable=bind.call(Function.call,Object.prototype.propertyIsEnumerable);var originalGetSymbols=hasSymbols?Object.getOwnPropertySymbols:null;module.exports=function assign(target,source1){if(!canBeObject(target)){throw new TypeError("target must be an object")}var objTarget=toObject(target);var s,source,i,props,syms,value,key;for(s=1;s<arguments.length;++s){source=toObject(arguments[s]);props=keys(source);var getSymbols=hasSymbols&&(Object.getOwnPropertySymbols||originalGetSymbols);if(getSymbols){syms=getSymbols(source);for(i=0;i<syms.length;++i){key=syms[i];if(propIsEnumerable(source,key)){push(props,key)}}}for(i=0;i<props.length;++i){key=props[i];value=source[key];if(propIsEnumerable(source,key)){objTarget[key]=value}}}return objTarget}},{"./hasSymbols":51,"function-bind":8,"object-keys":54}],53:[function(_dereq_,module,exports){var defineProperties=_dereq_("define-properties");var implementation=_dereq_("./implementation");var getPolyfill=_dereq_("./polyfill");var shim=_dereq_("./shim");var polyfill=getPolyfill();defineProperties(polyfill,{implementation:implementation,getPolyfill:getPolyfill,shim:shim});module.exports=polyfill},{"./implementation":52,"./polyfill":56,"./shim":57,"define-properties":2}],54:[function(_dereq_,module,exports){arguments[4][3][0].apply(exports,arguments)},{"./isArguments":55,dup:3}],55:[function(_dereq_,module,exports){arguments[4][4][0].apply(exports,arguments)},{dup:4}],56:[function(_dereq_,module,exports){var implementation=_dereq_("./implementation");var lacksProperEnumerationOrder=function(){if(!Object.assign){return false}var str="abcdefghijklmnopqrst";var letters=str.split("");var map={};for(var i=0;i<letters.length;++i){map[letters[i]]=letters[i]}var obj=Object.assign({},map);var actual="";for(var k in obj){actual+=k}return str!==actual};var assignHasPendingExceptions=function(){if(!Object.assign||!Object.preventExtensions){return false}var thrower=Object.preventExtensions({1:2});try{Object.assign(thrower,"xy")}catch(e){return thrower[1]==="y"}return false};module.exports=function getPolyfill(){if(!Object.assign){return implementation}if(lacksProperEnumerationOrder()){return implementation}if(assignHasPendingExceptions()){return implementation}return Object.assign}},{"./implementation":52}],57:[function(_dereq_,module,exports){var __hola_stub_define=_dereq_("define-properties");var getPolyfill=_dereq_("./polyfill");module.exports=function shimAssign(){var polyfill=getPolyfill();define(Object,{assign:polyfill},{assign:function(){return Object.assign!==polyfill}});return polyfill}},{"./polyfill":56,"define-properties":2}],58:[function(_dereq_,module,exports){var trim=_dereq_("trim"),forEach=_dereq_("for-each"),isArray=function(arg){return Object.prototype.toString.call(arg)==="[object Array]"};module.exports=function(headers){if(!headers)return{};var result={};forEach(trim(headers).split("\n"),function(row){var index=row.indexOf(":"),key=trim(row.slice(0,index)).toLowerCase(),value=trim(row.slice(index+1));if(typeof result[key]==="undefined"){result[key]=value}else if(isArray(result[key])){result[key].push(value)}else{result[key]=[result[key],value]}});return result}},{"for-each":5,trim:60}],59:[function(_dereq_,module,exports){module.exports=SafeParseTuple;function SafeParseTuple(obj,reviver){var json;var error=null;try{json=JSON.parse(obj,reviver)}catch(err){error=err}return[error,json]}},{}],60:[function(_dereq_,module,exports){exports=module.exports=trim;function trim(str){return str.replace(/^\s*|\s*$/g,"")}exports.left=function(str){return str.replace(/^\s*/,"")};exports.right=function(str){return str.replace(/\s*$/,"")}},{}],61:[function(_dereq_,module,exports){function clean(s){return s.replace(/\n\r?\s*/g,"")}module.exports=function tsml(sa){var s="",i=0;for(;i<arguments.length;i++)s+=clean(sa[i])+(arguments[i+1]||"");return s}},{}],62:[function(_dereq_,module,exports){var window=_dereq_("global/window");var isFunction=_dereq_("is-function");var parseHeaders=_dereq_("parse-headers");var xtend=_dereq_("xtend");module.exports=createXHR;createXHR.XMLHttpRequest=window.XMLHttpRequest||noop;createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:window.XDomainRequest;forEachArray(["get","put","post","patch","head","delete"],function(method){createXHR[method==="delete"?"del":method]=function(uri,options,callback){options=initParams(uri,options,callback);options.method=method.toUpperCase();return _createXHR(options)}});function forEachArray(array,iterator){for(var i=0;i<array.length;i++){iterator(array[i])}}function isEmpty(obj){for(var i in obj){if(obj.hasOwnProperty(i))return false}return true}function initParams(uri,options,callback){var params=uri;if(isFunction(options)){callback=options;if(typeof uri==="string"){params={uri:uri}}}else{params=xtend(options,{uri:uri})}params.callback=callback;return params}function createXHR(uri,options,callback){options=initParams(uri,options,callback);return _createXHR(options)}function _createXHR(options){if(typeof options.callback==="undefined"){throw new Error("callback argument missing")}var called=false;var callback=function cbOnce(err,response,body){if(!called){called=true;options.callback(err,response,body)}};function readystatechange(){if(xhr.readyState===4){loadFunc()}}function getBody(){var body=undefined;if(xhr.response){body=xhr.response}else{body=xhr.responseText||getXml(xhr)}if(isJson){try{body=JSON.parse(body)}catch(e){}}return body}var failureResponse={body:undefined,headers:{},statusCode:0,method:method,url:uri,rawRequest:xhr};function errorFunc(evt){clearTimeout(timeoutTimer);if(!(evt instanceof Error)){evt=new Error(""+(evt||"Unknown XMLHttpRequest Error"))}evt.statusCode=0;return callback(evt,failureResponse)}function loadFunc(){if(aborted)return;var status;clearTimeout(timeoutTimer);if(options.useXDR&&xhr.status===undefined){status=200}else{status=xhr.status===1223?204:xhr.status}var response=failureResponse;var err=null;if(status!==0){response={body:getBody(),statusCode:status,method:method,headers:{},url:uri,rawRequest:xhr};if(xhr.getAllResponseHeaders){response.headers=parseHeaders(xhr.getAllResponseHeaders())}}else{err=new Error("Internal XMLHttpRequest Error")}return callback(err,response,response.body)}var xhr=options.xhr||null;if(!xhr){if(options.cors||options.useXDR){xhr=new createXHR.XDomainRequest}else{xhr=new createXHR.XMLHttpRequest}}var key;var aborted;var uri=xhr.url=options.uri||options.url;var method=xhr.method=options.method||"GET";var body=options.body||options.data||null;var headers=xhr.headers=options.headers||{};var sync=!!options.sync;var isJson=false;var timeoutTimer;if("json"in options){isJson=true;headers["accept"]||headers["Accept"]||(headers["Accept"]="application/json");if(method!=="GET"&&method!=="HEAD"){headers["content-type"]||headers["Content-Type"]||(headers["Content-Type"]="application/json");body=JSON.stringify(options.json)}}xhr.onreadystatechange=readystatechange;xhr.onload=loadFunc;xhr.onerror=errorFunc;xhr.onprogress=function(){};xhr.ontimeout=errorFunc;xhr.open(method,uri,!sync,options.username,options.password);if(!sync){xhr.withCredentials=!!options.withCredentials}if(!sync&&options.timeout>0){timeoutTimer=setTimeout(function(){aborted=true;xhr.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT";errorFunc(e)},options.timeout)}if(xhr.setRequestHeader){for(key in headers){if(headers.hasOwnProperty(key)){xhr.setRequestHeader(key,headers[key])}}}else if(options.headers&&!isEmpty(options.headers)){throw new Error("Headers cannot be set on an XDomainRequest object")}if("responseType"in options){xhr.responseType=options.responseType}if("beforeSend"in options&&typeof options.beforeSend==="function"){options.beforeSend(xhr)}xhr.send(body);return xhr}function getXml(xhr){if(xhr.responseType==="document"){return xhr.responseXML}var firefoxBugTakenEffect=xhr.status===204&&xhr.responseXML&&xhr.responseXML.documentElement.nodeName==="parsererror";if(xhr.responseType===""&&!firefoxBugTakenEffect){return xhr.responseXML}return null}function noop(){}},{"global/window":10,"is-function":11,"parse-headers":58,xtend:63}],63:[function(_dereq_,module,exports){module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target}},{}],64:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _buttonJs=_dereq_("./button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("./component.js");var _componentJs2=_interopRequireDefault(_componentJs);var BigPlayButton=function(_Button){_inherits(BigPlayButton,_Button);function BigPlayButton(player,options){_classCallCheck(this,BigPlayButton);_Button.call(this,player,options)}BigPlayButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-big-play-button"};BigPlayButton.prototype.handleClick=function handleClick(){this.player_.play()};BigPlayButton.prototype.tooltipHandler=function tooltipHandler(){if(this.options_.tooltip!==undefined){return _Button.prototype.tooltipHandler.call(this)}};return BigPlayButton}(_buttonJs2["default"]);BigPlayButton.prototype.controlText_="Play Video";_componentJs2["default"].registerComponent("BigPlayButton",BigPlayButton);exports["default"]=BigPlayButton;module.exports=exports["default"]},{"./button.js":65,"./component.js":68}],65:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _clickableComponentJs=_dereq_("./clickable-component.js");var _clickableComponentJs2=_interopRequireDefault(_clickableComponentJs);var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsLogJs=_dereq_("./utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var Button=function(_ClickableComponent){_inherits(Button,_ClickableComponent);function Button(player,options){_classCallCheck(this,Button);_ClickableComponent.call(this,player,options)}Button.prototype.createEl=function createEl(){var tag=arguments.length<=0||arguments[0]===undefined?"button":arguments[0];var props=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var attributes=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];props=_objectAssign2["default"]({className:this.buildCSSClass()},props);if(tag!=="button"){_utilsLogJs2["default"].warn("Creating a Button with an HTML element of "+tag+" is deprecated; use ClickableComponent instead.");props=_objectAssign2["default"]({tabIndex:0},props);attributes=_objectAssign2["default"]({role:"button"},attributes)}attributes=_objectAssign2["default"]({type:"button","aria-live":"polite"},attributes);var el=_component2["default"].prototype.createEl.call(this,tag,props,attributes);this.createControlTextEl(el);return el};Button.prototype.addChild=function addChild(child){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var className=this.constructor.name;_utilsLogJs2["default"].warn("Adding an actionable (user controllable) child to a Button ("+className+") is not supported; use a ClickableComponent instead.");return _component2["default"].prototype.addChild.call(this,child,options)};Button.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===32||event.which===13){}else{_ClickableComponent.prototype.handleKeyPress.call(this,event)}};return Button}(_clickableComponentJs2["default"]);_component2["default"].registerComponent("Button",Button);exports["default"]=Button;module.exports=exports["default"]},{"./clickable-component.js":66,"./component":68,"./utils/events.js":147,"./utils/fn.js":148,"./utils/log.js":151,"global/document":9,"object.assign":53}],66:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsLogJs=_dereq_("./utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var _tooltip=_dereq_("./tooltip");var _tooltip2=_interopRequireDefault(_tooltip);var ClickableComponent=function(_Component){_inherits(ClickableComponent,_Component);function ClickableComponent(player,options){_classCallCheck(this,ClickableComponent);_Component.call(this,player,options);this.appendTooltip();this.emitTapEvents();this.on("tap",this.handleClick);this.on("click",this.handleClick);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur)}ClickableComponent.prototype.createEl=function createEl(){var tag=arguments.length<=0||arguments[0]===undefined?"div":arguments[0];var props=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var attributes=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];props=_objectAssign2["default"]({className:this.buildCSSClass(),tabIndex:0},props);if(tag==="button"){_utilsLogJs2["default"].error("Creating a ClickableComponent with an HTML element of "+tag+" is not supported; use a Button instead.")}attributes=_objectAssign2["default"]({role:"button","aria-live":"polite"},attributes);var el=_Component.prototype.createEl.call(this,tag,props,attributes);this.createControlTextEl(el);return el};ClickableComponent.prototype.createControlTextEl=function createControlTextEl(el){this.controlTextEl_=Dom.createEl("span",{className:"vjs-control-text"});if(el){el.appendChild(this.controlTextEl_)}this.controlText(this.controlText_);return this.controlTextEl_};ClickableComponent.prototype.controlText=function controlText(text){if(!text)return this.controlText_||"Need Text";this.controlText_=text;this.controlTextEl_.innerHTML=this.localize(this.controlText_);if(this.tooltip){this.tooltip.text(this.controlText_)}else{this.appendTooltip()}return this};ClickableComponent.prototype.buildCSSClass=function buildCSSClass(){return"vjs-control vjs-button "+_Component.prototype.buildCSSClass.call(this)};ClickableComponent.prototype.addChild=function addChild(child){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];return _Component.prototype.addChild.call(this,child,options)};ClickableComponent.prototype.enable=function enable(){this.removeClass("vjs-disabled");this.el_.setAttribute("aria-disabled","false");return this};ClickableComponent.prototype.disable=function disable(){this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");return this};ClickableComponent.prototype.handleClick=function handleClick(){};ClickableComponent.prototype.handleFocus=function handleFocus(){Events.on(_globalDocument2["default"],"keydown",Fn.bind(this,this.handleKeyPress))};ClickableComponent.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===32||event.which===13){event.preventDefault();this.handleClick(event)}else if(_Component.prototype.handleKeyPress){_Component.prototype.handleKeyPress.call(this,event)}};ClickableComponent.prototype.handleBlur=function handleBlur(){Events.off(_globalDocument2["default"],"keydown",Fn.bind(this,this.handleKeyPress))};ClickableComponent.prototype.appendTooltip=function appendTooltip(){if(this.tooltip||!this.controlText_||!this.el()){return}var tooltipHandler=this.tooltipHandler();if(tooltipHandler){this.tooltip=new _tooltip2["default"](this.player_);this.el().appendChild(this.tooltip.el());this.tooltip.text(this.controlText_);this.tooltip.handler(tooltipHandler)}};ClickableComponent.prototype.tooltipHandler=function tooltipHandler(){var handler=this.options_.tooltip;if(handler===false){return}if(handler===true||this.player_.options_&&this.player_.options_.tooltips){return this.el()}if(typeof handler==="string"){return Dom.getEl(handler)}if(handler&&typeof handler.el==="function"){return handler.el()}return handler};return ClickableComponent}(_component2["default"]);_component2["default"].registerComponent("ClickableComponent",ClickableComponent);exports["default"]=ClickableComponent;module.exports=exports["default"]},{"./component":68,"./tooltip":127,"./utils/dom.js":146,"./utils/events.js":147,"./utils/fn.js":148,"./utils/log.js":151,"global/document":9,"object.assign":53}],67:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _button=_dereq_("./button");var _button2=_interopRequireDefault(_button);var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var CloseButton=function(_Button){_inherits(CloseButton,_Button);function CloseButton(player,options){_classCallCheck(this,CloseButton);_Button.call(this,player,options);this.controlText(options&&options.controlText||this.localize("Close"))}CloseButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-close-button "+_Button.prototype.buildCSSClass.call(this)};CloseButton.prototype.handleClick=function handleClick(){this.trigger({type:"close",bubbles:false})};return CloseButton}(_button2["default"]);_component2["default"].registerComponent("CloseButton",CloseButton);exports["default"]=CloseButton;module.exports=exports["default"]},{"./button":65,"./component":68}],68:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsGuidJs=_dereq_("./utils/guid.js");var Guid=_interopRequireWildcard(_utilsGuidJs);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsLogJs=_dereq_("./utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _utilsToTitleCaseJs=_dereq_("./utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var _utilsMergeOptionsJs=_dereq_("./utils/merge-options.js");var _utilsMergeOptionsJs2=_interopRequireDefault(_utilsMergeOptionsJs);var Component=function(){function Component(player,options,ready){_classCallCheck(this,Component);if(!player&&this.play){this.player_=player=this}else{this.player_=player}this.options_=_utilsMergeOptionsJs2["default"]({},this.options_);options=this.options_=_utilsMergeOptionsJs2["default"](this.options_,options);this.id_=options.id||options.el&&options.el.id;if(!this.id_){var id=player&&player.id&&player.id()||"no_player";this.id_=id+"_component_"+Guid.newGUID()}this.name_=options.name||null;if(options.el){this.el_=options.el}else if(options.createEl!==false){this.el_=this.createEl()}this.children_=[];this.childIndex_={};this.childNameIndex_={};if(options.initChildren!==false){this.initChildren()}this.ready(ready);if(options.reportTouchActivity!==false){this.enableTouchActivity()}}Component.prototype.dispose=function dispose(){this.trigger({type:"dispose",bubbles:false});if(this.children_){for(var i=this.children_.length-1;i>=0;i--){if(this.children_[i].dispose){this.children_[i].dispose()}}}this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.off();if(this.el_.parentNode){this.el_.parentNode.removeChild(this.el_)}Dom.removeElData(this.el_);this.el_=null};Component.prototype.player=function player(){return this.player_};Component.prototype.options=function options(obj){_utilsLogJs2["default"].warn("this.options() has been deprecated and will be moved to the constructor in 6.0");if(!obj){return this.options_}this.options_=_utilsMergeOptionsJs2["default"](this.options_,obj);return this.options_};Component.prototype.el=function el(){return this.el_};Component.prototype.createEl=function createEl(tagName,properties,attributes){return Dom.createEl(tagName,properties,attributes)};Component.prototype.localize=function localize(string){var code=this.player_.language&&this.player_.language();var languages=this.player_.languages&&this.player_.languages();if(!code||!languages){return string}var language=languages[code];if(language&&language[string]){return language[string]}var primaryCode=code.split("-")[0];var primaryLang=languages[primaryCode];if(primaryLang&&primaryLang[string]){return primaryLang[string]}return string};Component.prototype.contentEl=function contentEl(){return this.contentEl_||this.el_};Component.prototype.id=function id(){return this.id_};Component.prototype.name=function name(){return this.name_};Component.prototype.children=function children(){return this.children_};Component.prototype.getChildById=function getChildById(id){return this.childIndex_[id]};Component.prototype.getChild=function getChild(name){return this.childNameIndex_[name]};Component.prototype.addChild=function addChild(child){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var index=arguments.length<=2||arguments[2]===undefined?this.children_.length:arguments[2];var component=undefined;var componentName=undefined;if(typeof child==="string"){componentName=child;if(!options){options={}}if(options===true){_utilsLogJs2["default"].warn("Initializing a child component with `true` is deprecated. Children should be defined in an array when possible, but if necessary use an object instead of `true`.");options={}}var componentClassName=options.componentClass||_utilsToTitleCaseJs2["default"](componentName);options.name=componentName;var ComponentClass=Component.getComponent(componentClassName);if(!ComponentClass){throw new Error("Component "+componentClassName+" does not exist")}if(typeof ComponentClass!=="function"){return null}component=new ComponentClass(this.player_||this,options)}else{component=child}this.children_.splice(index,0,component);if(typeof component.id==="function"){this.childIndex_[component.id()]=component}componentName=componentName||component.name&&component.name();if(componentName){this.childNameIndex_[componentName]=component}if(typeof component.el==="function"&&component.el()){var childNodes=this.contentEl().children;var refNode=childNodes[index]||null;this.contentEl().insertBefore(component.el(),refNode)}return component};Component.prototype.removeChild=function removeChild(component){if(typeof component==="string"){component=this.getChild(component)}if(!component||!this.children_){return}var childFound=false;for(var i=this.children_.length-1;i>=0;i--){if(this.children_[i]===component){childFound=true;this.children_.splice(i,1);break}}if(!childFound){return}this.childIndex_[component.id()]=null;this.childNameIndex_[component.name()]=null;var compEl=component.el();if(compEl&&compEl.parentNode===this.contentEl()){this.contentEl().removeChild(component.el())}};Component.prototype.initChildren=function initChildren(){var _this=this;var children=this.options_.children;if(children){(function(){var parentOptions=_this.options_;var handleAdd=function handleAdd(child){var name=child.name;var opts=child.opts;if(parentOptions[name]!==undefined){opts=parentOptions[name]}if(opts===false){return}if(opts===true){opts={}}opts.playerOptions=_this.options_.playerOptions;var newChild=_this.addChild(name,opts);if(newChild){_this[name]=newChild}};var workingChildren=undefined;var Tech=Component.getComponent("Tech");if(Array.isArray(children)){workingChildren=children}else{workingChildren=Object.keys(children)}workingChildren.concat(Object.keys(_this.options_).filter(function(child){return!workingChildren.some(function(wchild){if(typeof wchild==="string"){return child===wchild}else{return child===wchild.name}})})).map(function(child){var name=undefined,opts=undefined;if(typeof child==="string"){name=child;opts=children[name]||_this.options_[name]||{}}else{name=child.name;opts=child}return{name:name,opts:opts}}).filter(function(child){var c=Component.getComponent(child.opts.componentClass||_utilsToTitleCaseJs2["default"](child.name));return c&&!Tech.isTech(c)}).forEach(handleAdd)})()}};Component.prototype.buildCSSClass=function buildCSSClass(){return""};Component.prototype.on=function on(first,second,third){var _this2=this;if(typeof first==="string"||Array.isArray(first)){Events.on(this.el_,first,Fn.bind(this,second))}else{(function(){var target=first;var type=second;var fn=Fn.bind(_this2,third);var removeOnDispose=function removeOnDispose(){return _this2.off(target,type,fn)};removeOnDispose.guid=fn.guid;_this2.on("dispose",removeOnDispose);var cleanRemover=function cleanRemover(){return _this2.off("dispose",removeOnDispose)};cleanRemover.guid=fn.guid;if(first.nodeName){Events.on(target,type,fn);Events.on(target,"dispose",cleanRemover)}else if(typeof first.on==="function"){target.on(type,fn);target.on("dispose",cleanRemover)}})()}return this};Component.prototype.off=function off(first,second,third){if(!first||typeof first==="string"||Array.isArray(first)){Events.off(this.el_,first,second)}else{var target=first;var type=second;var fn=Fn.bind(this,third);this.off("dispose",fn);if(first.nodeName){Events.off(target,type,fn);Events.off(target,"dispose",fn)}else{target.off(type,fn);target.off("dispose",fn)}}return this};Component.prototype.one=function one(first,second,third){var _this3=this,_arguments=arguments;if(typeof first==="string"||Array.isArray(first)){Events.one(this.el_,first,Fn.bind(this,second));
}else{(function(){var target=first;var type=second;var fn=Fn.bind(_this3,third);var newFunc=function newFunc(){_this3.off(target,type,newFunc);fn.apply(null,_arguments)};newFunc.guid=fn.guid;_this3.on(target,type,newFunc)})()}return this};Component.prototype.trigger=function trigger(event,hash){Events.trigger(this.el_,event,hash);return this};Component.prototype.ready=function ready(fn){var sync=arguments.length<=1||arguments[1]===undefined?false:arguments[1];if(fn){if(this.isReady_){if(sync){fn.call(this)}else{this.setTimeout(fn,1)}}else{this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(fn)}}return this};Component.prototype.triggerReady=function triggerReady(){this.isReady_=true;this.setTimeout(function(){var readyQueue=this.readyQueue_;this.readyQueue_=[];if(readyQueue&&readyQueue.length>0){readyQueue.forEach(function(fn){fn.call(this)},this)}this.trigger("ready")},1)};Component.prototype.$=function $(selector,context){return Dom.$(selector,context||this.contentEl())};Component.prototype.$$=function $$(selector,context){return Dom.$$(selector,context||this.contentEl())};Component.prototype.hasClass=function hasClass(classToCheck){return Dom.hasElClass(this.el_,classToCheck)};Component.prototype.addClass=function addClass(classToAdd){Dom.addElClass(this.el_,classToAdd);return this};Component.prototype.removeClass=function removeClass(classToRemove){Dom.removeElClass(this.el_,classToRemove);return this};Component.prototype.toggleClass=function toggleClass(classToToggle,predicate){Dom.toggleElClass(this.el_,classToToggle,predicate);return this};Component.prototype.show=function show(){this.removeClass("vjs-hidden");return this};Component.prototype.hide=function hide(){this.addClass("vjs-hidden");return this};Component.prototype.lockShowing=function lockShowing(){this.addClass("vjs-lock-showing");return this};Component.prototype.unlockShowing=function unlockShowing(){this.removeClass("vjs-lock-showing");return this};Component.prototype.width=function width(num,skipListeners){return this.dimension("width",num,skipListeners)};Component.prototype.height=function height(num,skipListeners){return this.dimension("height",num,skipListeners)};Component.prototype.dimensions=function dimensions(width,height){return this.width(width,true).height(height)};Component.prototype.dimension=function dimension(widthOrHeight,num,skipListeners){if(num!==undefined){if(num===null||num!==num){num=0}if((""+num).indexOf("%")!==-1||(""+num).indexOf("px")!==-1){this.el_.style[widthOrHeight]=num}else if(num==="auto"){this.el_.style[widthOrHeight]=""}else{this.el_.style[widthOrHeight]=num+"px"}if(!skipListeners){this.trigger("resize")}return this}if(!this.el_){return 0}var val=this.el_.style[widthOrHeight];var pxIndex=val.indexOf("px");if(pxIndex!==-1){return parseInt(val.slice(0,pxIndex),10)}return parseInt(this.el_["offset"+_utilsToTitleCaseJs2["default"](widthOrHeight)],10)};Component.prototype.currentDimension=function currentDimension(widthOrHeight){var computedWidthOrHeight=0;if(widthOrHeight!=="width"&&widthOrHeight!=="height"){throw new Error("currentDimension only accepts width or height value")}if(typeof _globalWindow2["default"].getComputedStyle==="function"){var computedStyle=_globalWindow2["default"].getComputedStyle(this.el_);computedWidthOrHeight=computedStyle.getPropertyValue(widthOrHeight)||computedStyle[widthOrHeight]}else if(this.el_.currentStyle){var rule="offset"+_utilsToTitleCaseJs2["default"](widthOrHeight);computedWidthOrHeight=this.el_[rule]}computedWidthOrHeight=parseFloat(computedWidthOrHeight);return computedWidthOrHeight};Component.prototype.currentDimensions=function currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}};Component.prototype.currentWidth=function currentWidth(){return this.currentDimension("width")};Component.prototype.currentHeight=function currentHeight(){return this.currentDimension("height")};Component.prototype.emitTapEvents=function emitTapEvents(){var touchStart=0;var firstTouch=null;var tapMovementThreshold=10;var touchTimeThreshold=200;var couldBeTap=undefined;this.on("touchstart",function(event){if(event.touches.length===1){firstTouch=_objectAssign2["default"]({},event.touches[0]);touchStart=(new Date).getTime();couldBeTap=true}});this.on("touchmove",function(event){if(event.touches.length>1){couldBeTap=false}else if(firstTouch){var xdiff=event.touches[0].pageX-firstTouch.pageX;var ydiff=event.touches[0].pageY-firstTouch.pageY;var touchDistance=Math.sqrt(xdiff*xdiff+ydiff*ydiff);if(touchDistance>tapMovementThreshold){couldBeTap=false}}});var noTap=function noTap(){couldBeTap=false};this.on("touchleave",noTap);this.on("touchcancel",noTap);this.on("touchend",function(event){firstTouch=null;if(couldBeTap===true){var touchTime=(new Date).getTime()-touchStart;if(touchTime<touchTimeThreshold){event.preventDefault();this.trigger("tap")}}})};Component.prototype.enableTouchActivity=function enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity){return}var report=Fn.bind(this.player(),this.player().reportUserActivity);var touchHolding=undefined;this.on("touchstart",function(){report();this.clearInterval(touchHolding);touchHolding=this.setInterval(report,250)});var touchEnd=function touchEnd(event){report();this.clearInterval(touchHolding)};this.on("touchmove",report);this.on("touchend",touchEnd);this.on("touchcancel",touchEnd)};Component.prototype.setTimeout=function setTimeout(fn,timeout){fn=Fn.bind(this,fn);var timeoutId=_globalWindow2["default"].setTimeout(fn,timeout);var disposeFn=function disposeFn(){this.clearTimeout(timeoutId)};disposeFn.guid="vjs-timeout-"+timeoutId;this.on("dispose",disposeFn);return timeoutId};Component.prototype.clearTimeout=function clearTimeout(timeoutId){_globalWindow2["default"].clearTimeout(timeoutId);var disposeFn=function disposeFn(){};disposeFn.guid="vjs-timeout-"+timeoutId;this.off("dispose",disposeFn);return timeoutId};Component.prototype.setInterval=function setInterval(fn,interval){fn=Fn.bind(this,fn);var intervalId=_globalWindow2["default"].setInterval(fn,interval);var disposeFn=function disposeFn(){this.clearInterval(intervalId)};disposeFn.guid="vjs-interval-"+intervalId;this.on("dispose",disposeFn);return intervalId};Component.prototype.clearInterval=function clearInterval(intervalId){_globalWindow2["default"].clearInterval(intervalId);var disposeFn=function disposeFn(){};disposeFn.guid="vjs-interval-"+intervalId;this.off("dispose",disposeFn);return intervalId};Component.registerComponent=function registerComponent(name,comp){if(!Component.components_){Component.components_={}}Component.components_[name]=comp;return comp};Component.getComponent=function getComponent(name){if(Component.components_&&Component.components_[name]){return Component.components_[name]}if(_globalWindow2["default"]&&_globalWindow2["default"].videojs&&_globalWindow2["default"].videojs[name]){_utilsLogJs2["default"].warn("The "+name+" component was added to the videojs object when it should be registered using videojs.registerComponent(name, component)");return _globalWindow2["default"].videojs[name]}};Component.extend=function extend(props){props=props||{};_utilsLogJs2["default"].warn("Component.extend({}) has been deprecated, use videojs.extend(Component, {}) instead");var init=props.init||props.init||this.prototype.init||this.prototype.init||function(){};var subObj=function subObj(){init.apply(this,arguments)};subObj.prototype=Object.create(this.prototype);subObj.prototype.constructor=subObj;subObj.extend=Component.extend;for(var _name in props){if(props.hasOwnProperty(_name)){subObj.prototype[_name]=props[_name]}}return subObj};return Component}();Component.registerComponent("Component",Component);exports["default"]=Component;module.exports=exports["default"]},{"./utils/dom.js":146,"./utils/events.js":147,"./utils/fn.js":148,"./utils/guid.js":150,"./utils/log.js":151,"./utils/merge-options.js":152,"./utils/to-title-case.js":155,"global/window":10,"object.assign":53}],69:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _trackButtonJs=_dereq_("../track-button.js");var _trackButtonJs2=_interopRequireDefault(_trackButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _audioTrackMenuItemJs=_dereq_("./audio-track-menu-item.js");var _audioTrackMenuItemJs2=_interopRequireDefault(_audioTrackMenuItemJs);var AudioTrackButton=function(_TrackButton){_inherits(AudioTrackButton,_TrackButton);function AudioTrackButton(player){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];_classCallCheck(this,AudioTrackButton);options.tracks=player.audioTracks&&player.audioTracks();_TrackButton.call(this,player,options);this.el_.setAttribute("aria-label","Audio Menu")}AudioTrackButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-audio-button "+_TrackButton.prototype.buildCSSClass.call(this)};AudioTrackButton.prototype.createItems=function createItems(){var items=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];var tracks=this.player_.audioTracks&&this.player_.audioTracks();if(!tracks){return items}for(var i=0;i<tracks.length;i++){var track=tracks[i];items.push(new _audioTrackMenuItemJs2["default"](this.player_,{selectable:true,track:track}))}return items};return AudioTrackButton}(_trackButtonJs2["default"]);_componentJs2["default"].registerComponent("AudioTrackButton",AudioTrackButton);exports["default"]=AudioTrackButton;module.exports=exports["default"]},{"../../component.js":68,"../../utils/fn.js":148,"../track-button.js":99,"./audio-track-menu-item.js":70}],70:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _menuMenuItemJs=_dereq_("../../menu/menu-item.js");var _menuMenuItemJs2=_interopRequireDefault(_menuMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var AudioTrackMenuItem=function(_MenuItem){_inherits(AudioTrackMenuItem,_MenuItem);function AudioTrackMenuItem(player,options){var _this=this;_classCallCheck(this,AudioTrackMenuItem);var track=options.track;var tracks=player.audioTracks();options.label=track.label||track.language||"Unknown";options.selected=track.enabled;_MenuItem.call(this,player,options);this.track=track;if(tracks){(function(){var changeHandler=Fn.bind(_this,_this.handleTracksChange);tracks.addEventListener("change",changeHandler);_this.on("dispose",function(){tracks.removeEventListener("change",changeHandler)})})()}}AudioTrackMenuItem.prototype.handleClick=function handleClick(event){var tracks=this.player_.audioTracks();_MenuItem.prototype.handleClick.call(this,event);if(!tracks)return;for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track===this.track){track.enabled=true}}};AudioTrackMenuItem.prototype.handleTracksChange=function handleTracksChange(event){this.selected(this.track.enabled)};return AudioTrackMenuItem}(_menuMenuItemJs2["default"]);_componentJs2["default"].registerComponent("AudioTrackMenuItem",AudioTrackMenuItem);exports["default"]=AudioTrackMenuItem;module.exports=exports["default"]},{"../../component.js":68,"../../menu/menu-item.js":112,"../../utils/fn.js":148}],71:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _playToggleJs=_dereq_("./play-toggle.js");var _playToggleJs2=_interopRequireDefault(_playToggleJs);var _timeControlsCurrentTimeDisplayJs=_dereq_("./time-controls/current-time-display.js");var _timeControlsCurrentTimeDisplayJs2=_interopRequireDefault(_timeControlsCurrentTimeDisplayJs);var _timeControlsDurationDisplayJs=_dereq_("./time-controls/duration-display.js");var _timeControlsDurationDisplayJs2=_interopRequireDefault(_timeControlsDurationDisplayJs);var _timeControlsTimeDividerJs=_dereq_("./time-controls/time-divider.js");var _timeControlsTimeDividerJs2=_interopRequireDefault(_timeControlsTimeDividerJs);var _timeControlsRemainingTimeDisplayJs=_dereq_("./time-controls/remaining-time-display.js");var _timeControlsRemainingTimeDisplayJs2=_interopRequireDefault(_timeControlsRemainingTimeDisplayJs);var _liveDisplayJs=_dereq_("./live-display.js");var _liveDisplayJs2=_interopRequireDefault(_liveDisplayJs);var _progressControlProgressControlJs=_dereq_("./progress-control/progress-control.js");var _progressControlProgressControlJs2=_interopRequireDefault(_progressControlProgressControlJs);var _fullscreenToggleJs=_dereq_("./fullscreen-toggle.js");var _fullscreenToggleJs2=_interopRequireDefault(_fullscreenToggleJs);var _volumeControlVolumeControlJs=_dereq_("./volume-control/volume-control.js");var _volumeControlVolumeControlJs2=_interopRequireDefault(_volumeControlVolumeControlJs);var _volumeMenuButtonJs=_dereq_("./volume-menu-button.js");var _volumeMenuButtonJs2=_interopRequireDefault(_volumeMenuButtonJs);var _muteToggleJs=_dereq_("./mute-toggle.js");var _muteToggleJs2=_interopRequireDefault(_muteToggleJs);var _textTrackControlsChaptersButtonJs=_dereq_("./text-track-controls/chapters-button.js");var _textTrackControlsChaptersButtonJs2=_interopRequireDefault(_textTrackControlsChaptersButtonJs);var _textTrackControlsDescriptionsButtonJs=_dereq_("./text-track-controls/descriptions-button.js");var _textTrackControlsDescriptionsButtonJs2=_interopRequireDefault(_textTrackControlsDescriptionsButtonJs);var _textTrackControlsSubtitlesButtonJs=_dereq_("./text-track-controls/subtitles-button.js");var _textTrackControlsSubtitlesButtonJs2=_interopRequireDefault(_textTrackControlsSubtitlesButtonJs);var _textTrackControlsCaptionsButtonJs=_dereq_("./text-track-controls/captions-button.js");var _textTrackControlsCaptionsButtonJs2=_interopRequireDefault(_textTrackControlsCaptionsButtonJs);var _audioTrackControlsAudioTrackButtonJs=_dereq_("./audio-track-controls/audio-track-button.js");var _audioTrackControlsAudioTrackButtonJs2=_interopRequireDefault(_audioTrackControlsAudioTrackButtonJs);var _playbackRateMenuPlaybackRateMenuButtonJs=_dereq_("./playback-rate-menu/playback-rate-menu-button.js");var _playbackRateMenuPlaybackRateMenuButtonJs2=_interopRequireDefault(_playbackRateMenuPlaybackRateMenuButtonJs);var _spacerControlsCustomControlSpacerJs=_dereq_("./spacer-controls/custom-control-spacer.js");var _spacerControlsCustomControlSpacerJs2=_interopRequireDefault(_spacerControlsCustomControlSpacerJs);var ControlBar=function(_Component){_inherits(ControlBar,_Component);function ControlBar(){_classCallCheck(this,ControlBar);_Component.apply(this,arguments)}ControlBar.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"},{role:"group"})};return ControlBar}(_componentJs2["default"]);ControlBar.prototype.options_={loadEvent:"play",children:["playToggle","volumeMenuButton","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subtitlesButton","captionsButton","audioTrackButton","fullscreenToggle"]};_componentJs2["default"].registerComponent("ControlBar",ControlBar);exports["default"]=ControlBar;module.exports=exports["default"]},{"../component.js":68,"./audio-track-controls/audio-track-button.js":69,"./fullscreen-toggle.js":72,"./live-display.js":73,"./mute-toggle.js":74,"./play-toggle.js":75,"./playback-rate-menu/playback-rate-menu-button.js":76,"./progress-control/progress-control.js":81,"./spacer-controls/custom-control-spacer.js":84,"./text-track-controls/captions-button.js":87,"./text-track-controls/chapters-button.js":88,"./text-track-controls/descriptions-button.js":90,"./text-track-controls/subtitles-button.js":92,"./time-controls/current-time-display.js":95,"./time-controls/duration-display.js":96,"./time-controls/remaining-time-display.js":97,"./time-controls/time-divider.js":98,"./volume-control/volume-control.js":101,"./volume-menu-button.js":104}],72:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _buttonJs=_dereq_("../button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var FullscreenToggle=function(_Button){_inherits(FullscreenToggle,_Button);function FullscreenToggle(player,options){var _this=this;_classCallCheck(this,FullscreenToggle);_Button.call(this,player,options);player.on("ready",function(){_this.player_.on("fullscreenchange",Fn.bind(_this,_this.updateHint))})}FullscreenToggle.prototype.buildCSSClass=function buildCSSClass(){return"vjs-fullscreen-control "+_Button.prototype.buildCSSClass.call(this)};FullscreenToggle.prototype.handleClick=function handleClick(){if(!this.player_.isFullscreen()){this.player_.requestFullscreen()}else{this.player_.exitFullscreen()}this.updateHint()};FullscreenToggle.prototype.updateHint=function updateHint(){if(this.player_.isFullscreen()){this.controlText("Exit fullscreen")}else{this.controlText("Fullscreen")}};return FullscreenToggle}(_buttonJs2["default"]);FullscreenToggle.prototype.controlText_="Fullscreen";_componentJs2["default"].registerComponent("FullscreenToggle",FullscreenToggle);exports["default"]=FullscreenToggle;module.exports=exports["default"]},{"../button.js":65,"../component.js":68,"../utils/fn.js":148}],73:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var LiveDisplay=function(_Component){_inherits(LiveDisplay,_Component);function LiveDisplay(player,options){_classCallCheck(this,LiveDisplay);_Component.call(this,player,options);this.updateShowing();this.on(this.player(),"durationchange",this.updateShowing)}LiveDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"});el.appendChild(this.contentEl_);return el};LiveDisplay.prototype.updateShowing=function updateShowing(){if(this.player().duration()===Infinity){this.show()}else{this.hide()}};return LiveDisplay}(_component2["default"]);_component2["default"].registerComponent("LiveDisplay",LiveDisplay);exports["default"]=LiveDisplay;module.exports=exports["default"]},{"../component":68,"../utils/dom.js":146}],74:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _button=_dereq_("../button");var _button2=_interopRequireDefault(_button);var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var MuteToggle=function(_Button){_inherits(MuteToggle,_Button);function MuteToggle(player,options){_classCallCheck(this,MuteToggle);_Button.call(this,player,options);this.on(player,"volumechange",this.update);if(player.tech_&&player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden")}this.on(player,"loadstart",function(){this.update();if(player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden")}else{this.removeClass("vjs-hidden")}})}MuteToggle.prototype.buildCSSClass=function buildCSSClass(){return"vjs-mute-control "+_Button.prototype.buildCSSClass.call(this)};MuteToggle.prototype.handleClick=function handleClick(){this.player_.muted(this.player_.muted()?false:true)};MuteToggle.prototype.update=function update(){var vol=this.player_.volume(),level=3;if(vol===0||this.player_.muted()){level=0}else if(vol<.33){level=1}else if(vol<.67){level=2}var toMute=this.player_.muted()?"Unmute":"Mute";if(this.controlText()!==toMute){this.controlText(toMute)}for(var i=0;i<4;i++){Dom.removeElClass(this.el_,"vjs-vol-"+i)}Dom.addElClass(this.el_,"vjs-vol-"+level)};return MuteToggle}(_button2["default"]);MuteToggle.prototype.controlText_="Mute";_component2["default"].registerComponent("MuteToggle",MuteToggle);exports["default"]=MuteToggle;module.exports=exports["default"]},{"../button":65,"../component":68,"../utils/dom.js":146}],75:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _buttonJs=_dereq_("../button.js");var _buttonJs2=_interopRequireDefault(_buttonJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var PlayToggle=function(_Button){_inherits(PlayToggle,_Button);function PlayToggle(player,options){_classCallCheck(this,PlayToggle);_Button.call(this,player,options);this.on(player,"play",this.handlePlay);this.on(player,"pause",this.handlePause)}PlayToggle.prototype.buildCSSClass=function buildCSSClass(){return"vjs-play-control "+_Button.prototype.buildCSSClass.call(this)};PlayToggle.prototype.handleClick=function handleClick(){if(this.player_.paused()){this.player_.play()}else{this.player_.pause()}};PlayToggle.prototype.handlePlay=function handlePlay(){this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")};PlayToggle.prototype.handlePause=function handlePause(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")};return PlayToggle}(_buttonJs2["default"]);PlayToggle.prototype.controlText_="Play";_componentJs2["default"].registerComponent("PlayToggle",PlayToggle);exports["default"]=PlayToggle;module.exports=exports["default"]},{"../button.js":65,"../component.js":68}],76:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _menuMenuButtonJs=_dereq_("../../menu/menu-button.js");var _menuMenuButtonJs2=_interopRequireDefault(_menuMenuButtonJs);var _menuMenuJs=_dereq_("../../menu/menu.js");var _menuMenuJs2=_interopRequireDefault(_menuMenuJs);var _playbackRateMenuItemJs=_dereq_("./playback-rate-menu-item.js");var _playbackRateMenuItemJs2=_interopRequireDefault(_playbackRateMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var PlaybackRateMenuButton=function(_MenuButton){_inherits(PlaybackRateMenuButton,_MenuButton);function PlaybackRateMenuButton(player,options){_classCallCheck(this,PlaybackRateMenuButton);_MenuButton.call(this,player,options);this.updateVisibility();this.updateLabel();this.on(player,"loadstart",this.updateVisibility);this.on(player,"ratechange",this.updateLabel)}PlaybackRateMenuButton.prototype.createEl=function createEl(){var el=_MenuButton.prototype.createEl.call(this);this.labelEl_=Dom.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1});el.appendChild(this.labelEl_);return el};PlaybackRateMenuButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-playback-rate "+_MenuButton.prototype.buildCSSClass.call(this)};PlaybackRateMenuButton.prototype.createMenu=function createMenu(){var menu=new _menuMenuJs2["default"](this.player());var rates=this.playbackRates();if(rates){for(var i=rates.length-1;i>=0;i--){menu.addChild(new _playbackRateMenuItemJs2["default"](this.player(),{rate:rates[i]+"x"}))}}return menu};PlaybackRateMenuButton.prototype.updateARIAAttributes=function updateARIAAttributes(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())};PlaybackRateMenuButton.prototype.handleClick=function handleClick(){var currentRate=this.player().playbackRate();var rates=this.playbackRates();var newRate=rates[0];for(var i=0;i<rates.length;i++){if(rates[i]>currentRate){newRate=rates[i];break}}this.player().playbackRate(newRate)};PlaybackRateMenuButton.prototype.playbackRates=function playbackRates(){return this.options_["playbackRates"]||this.options_.playerOptions&&this.options_.playerOptions["playbackRates"]};PlaybackRateMenuButton.prototype.playbackRateSupported=function playbackRateSupported(){return this.player().tech_&&this.player().tech_["featuresPlaybackRate"]&&this.playbackRates()&&this.playbackRates().length>0};PlaybackRateMenuButton.prototype.updateVisibility=function updateVisibility(){if(this.playbackRateSupported()){this.removeClass("vjs-hidden")}else{this.addClass("vjs-hidden")}};PlaybackRateMenuButton.prototype.updateLabel=function updateLabel(){if(this.playbackRateSupported()){this.labelEl_.innerHTML=this.player().playbackRate()+"x"}};return PlaybackRateMenuButton}(_menuMenuButtonJs2["default"]);PlaybackRateMenuButton.prototype.controlText_="Playback Rate";_componentJs2["default"].registerComponent("PlaybackRateMenuButton",PlaybackRateMenuButton);exports["default"]=PlaybackRateMenuButton;module.exports=exports["default"]},{"../../component.js":68,"../../menu/menu-button.js":111,"../../menu/menu.js":113,"../../utils/dom.js":146,"./playback-rate-menu-item.js":77}],77:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){
return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _menuMenuItemJs=_dereq_("../../menu/menu-item.js");var _menuMenuItemJs2=_interopRequireDefault(_menuMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var PlaybackRateMenuItem=function(_MenuItem){_inherits(PlaybackRateMenuItem,_MenuItem);function PlaybackRateMenuItem(player,options){_classCallCheck(this,PlaybackRateMenuItem);var label=options["rate"];var rate=parseFloat(label,10);options["label"]=label;options["selected"]=rate===1;_MenuItem.call(this,player,options);this.label=label;this.rate=rate;this.on(player,"ratechange",this.update)}PlaybackRateMenuItem.prototype.handleClick=function handleClick(){_MenuItem.prototype.handleClick.call(this);this.player().playbackRate(this.rate)};PlaybackRateMenuItem.prototype.update=function update(){this.selected(this.player().playbackRate()===this.rate)};return PlaybackRateMenuItem}(_menuMenuItemJs2["default"]);PlaybackRateMenuItem.prototype.contentElType="button";_componentJs2["default"].registerComponent("PlaybackRateMenuItem",PlaybackRateMenuItem);exports["default"]=PlaybackRateMenuItem;module.exports=exports["default"]},{"../../component.js":68,"../../menu/menu-item.js":112}],78:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var LoadProgressBar=function(_Component){_inherits(LoadProgressBar,_Component);function LoadProgressBar(player,options){_classCallCheck(this,LoadProgressBar);_Component.call(this,player,options);this.on(player,"progress",this.update)}LoadProgressBar.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})};LoadProgressBar.prototype.update=function update(){var buffered=this.player_.buffered();var duration=this.player_.duration();var bufferedEnd=this.player_.bufferedEnd();var children=this.el_.children;var percentify=function percentify(time,end){var percent=time/end||0;return(percent>=1?1:percent)*100+"%"};this.el_.style.width=percentify(bufferedEnd,duration);for(var i=0;i<buffered.length;i++){var start=buffered.start(i);var end=buffered.end(i);var part=children[i];if(!part){part=this.el_.appendChild(Dom.createEl())}part.style.left=percentify(start,bufferedEnd);part.style.width=percentify(end-start,bufferedEnd)}for(var i=children.length;i>buffered.length;i--){this.el_.removeChild(children[i-1])}};return LoadProgressBar}(_componentJs2["default"]);_componentJs2["default"].registerComponent("LoadProgressBar",LoadProgressBar);exports["default"]=LoadProgressBar;module.exports=exports["default"]},{"../../component.js":68,"../../utils/dom.js":146}],79:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var _lodashCompatFunctionThrottle=_dereq_("lodash-compat/function/throttle");var _lodashCompatFunctionThrottle2=_interopRequireDefault(_lodashCompatFunctionThrottle);var MouseTimeDisplay=function(_Component){_inherits(MouseTimeDisplay,_Component);function MouseTimeDisplay(player,options){var _this=this;_classCallCheck(this,MouseTimeDisplay);_Component.call(this,player,options);if(options.playerOptions&&options.playerOptions.controlBar&&options.playerOptions.controlBar.progressControl&&options.playerOptions.controlBar.progressControl.keepTooltipsInside){this.keepTooltipsInside=options.playerOptions.controlBar.progressControl.keepTooltipsInside}if(this.keepTooltipsInside){this.tooltip=Dom.createEl("div",{className:"vjs-time-tooltip"});this.el().appendChild(this.tooltip);this.addClass("vjs-keep-tooltips-inside")}this.update(0,0,0);player.on("ready",function(){var progressEl=_this.player_.controlBar.progressControl.el();progressEl.appendChild(_this.tooltip);_this.on(progressEl,"mousemove",_lodashCompatFunctionThrottle2["default"](Fn.bind(_this,_this.handleMouseMove),25))})}MouseTimeDisplay.prototype.createEl=function createEl(){this.tooltip=Dom.createEl("div",{className:"vjs-mouse-display-tooltip"});var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"});return el};MouseTimeDisplay.prototype.dispose=function dispose(){if(this.tooltip.parentNode){this.tooltip.parentNode.removeChild(this.tooltip)}Dom.removeElData(this.tooltip);this.tooltip=null;_Component.prototype.dispose.call(this)};MouseTimeDisplay.prototype.handleMouseMove=function handleMouseMove(event){var isPercent=false;var duration=this.player_.duration();if(!duration){isPercent=true;duration=100}var newTime=this.calculateDistance(event)*duration;var maxLeft=this.player().controlBar.progressControl.seekBar.width()-this.width();var position=event.pageX-Dom.findElPosition(this.el().parentNode).left;position=Math.min(Math.max(0,position),maxLeft);var tooltipWidth=this.tooltip.offsetWidth;var maxTooltipLeft=this.tooltip.parentNode.offsetWidth-tooltipWidth;var tooltipPosition=event.pageX-Dom.findElPosition(this.tooltip.parentNode).left-tooltipWidth/2;tooltipPosition=Math.min(Math.max(0,tooltipPosition),maxTooltipLeft);this.update(newTime,position,tooltipPosition,isPercent)};MouseTimeDisplay.prototype.update=function update(newTime,position,tooltipPosition,isPercent){var time=isPercent?Math.round(newTime)+"%":_utilsFormatTimeJs2["default"](newTime,this.player_.duration());this.el().style.left=position+"px";this.tooltip.innerHTML=time;if(this.keepTooltipsInside){var clampedPosition=this.clampPosition_(position);var difference=position-clampedPosition+1;var tooltipWidth=parseFloat(_globalWindow2["default"].getComputedStyle(this.tooltip).width);var tooltipWidthHalf=tooltipWidth/2;this.tooltip.style.left="auto";this.tooltip.style.right="-"+(tooltipWidthHalf-difference)+"px"}else{this.tooltip.style.right="auto";this.tooltip.style.left=tooltipPosition+"px"}};MouseTimeDisplay.prototype.calculateDistance=function calculateDistance(event){return Dom.getPointerPosition(this.el().parentNode,event).x};MouseTimeDisplay.prototype.clampPosition_=function clampPosition_(position){if(!this.keepTooltipsInside){return position}var playerWidth=parseFloat(_globalWindow2["default"].getComputedStyle(this.player().el()).width);var tooltipWidth=parseFloat(_globalWindow2["default"].getComputedStyle(this.tooltip).width);var tooltipWidthHalf=tooltipWidth/2;var actualPosition=position;if(position<tooltipWidthHalf){actualPosition=Math.ceil(tooltipWidthHalf)}else if(position>playerWidth-tooltipWidthHalf){actualPosition=Math.floor(playerWidth-tooltipWidthHalf)}return actualPosition};return MouseTimeDisplay}(_componentJs2["default"]);_componentJs2["default"].registerComponent("MouseTimeDisplay",MouseTimeDisplay);exports["default"]=MouseTimeDisplay;module.exports=exports["default"]},{"../../component.js":68,"../../utils/dom.js":146,"../../utils/fn.js":148,"../../utils/format-time.js":149,"global/window":10,"lodash-compat/function/throttle":15}],80:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var PlayProgressBar=function(_Component){_inherits(PlayProgressBar,_Component);function PlayProgressBar(player,options){_classCallCheck(this,PlayProgressBar);_Component.call(this,player,options);this.updateDataAttr();this.on(player,"timeupdate",this.updateDataAttr);player.ready(Fn.bind(this,this.updateDataAttr));if(options.playerOptions&&options.playerOptions.controlBar&&options.playerOptions.controlBar.progressControl&&options.playerOptions.controlBar.progressControl.keepTooltipsInside){this.keepTooltipsInside=options.playerOptions.controlBar.progressControl.keepTooltipsInside}if(this.keepTooltipsInside){this.addClass("vjs-keep-tooltips-inside")}}PlayProgressBar.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})};PlayProgressBar.prototype.updateDataAttr=function updateDataAttr(){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("data-current-time",_utilsFormatTimeJs2["default"](time,this.player_.duration()))};return PlayProgressBar}(_componentJs2["default"]);_componentJs2["default"].registerComponent("PlayProgressBar",PlayProgressBar);exports["default"]=PlayProgressBar;module.exports=exports["default"]},{"../../component.js":68,"../../utils/dom.js":146,"../../utils/fn.js":148,"../../utils/format-time.js":149}],81:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _seekBarJs=_dereq_("./seek-bar.js");var _seekBarJs2=_interopRequireDefault(_seekBarJs);var _mouseTimeDisplayJs=_dereq_("./mouse-time-display.js");var _mouseTimeDisplayJs2=_interopRequireDefault(_mouseTimeDisplayJs);var ProgressControl=function(_Component){_inherits(ProgressControl,_Component);function ProgressControl(){_classCallCheck(this,ProgressControl);_Component.apply(this,arguments)}ProgressControl.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})};return ProgressControl}(_componentJs2["default"]);ProgressControl.prototype.options_={children:["seekBar"]};_componentJs2["default"].registerComponent("ProgressControl",ProgressControl);exports["default"]=ProgressControl;module.exports=exports["default"]},{"../../component.js":68,"./mouse-time-display.js":79,"./seek-bar.js":82}],82:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _sliderSliderJs=_dereq_("../../slider/slider.js");var _sliderSliderJs2=_interopRequireDefault(_sliderSliderJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _loadProgressBarJs=_dereq_("./load-progress-bar.js");var _loadProgressBarJs2=_interopRequireDefault(_loadProgressBarJs);var _playProgressBarJs=_dereq_("./play-progress-bar.js");var _playProgressBarJs2=_interopRequireDefault(_playProgressBarJs);var _tooltipProgressBarJs=_dereq_("./tooltip-progress-bar.js");var _tooltipProgressBarJs2=_interopRequireDefault(_tooltipProgressBarJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var SeekBar=function(_Slider){_inherits(SeekBar,_Slider);function SeekBar(player,options){_classCallCheck(this,SeekBar);_Slider.call(this,player,options);this.on(player,"timeupdate",this.updateProgress);this.on(player,"ended",this.updateProgress);player.ready(Fn.bind(this,this.updateProgress));if(options.playerOptions&&options.playerOptions.controlBar&&options.playerOptions.controlBar.progressControl&&options.playerOptions.controlBar.progressControl.keepTooltipsInside){this.keepTooltipsInside=options.playerOptions.controlBar.progressControl.keepTooltipsInside}if(this.keepTooltipsInside){this.tooltipProgressBar=this.addChild("TooltipProgressBar")}}SeekBar.prototype.createEl=function createEl(){return _Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":"progress bar"})};SeekBar.prototype.updateProgress=function updateProgress(){this.updateAriaAttributes(this.el_);if(this.keepTooltipsInside){this.updateAriaAttributes(this.tooltipProgressBar.el_);this.tooltipProgressBar.el_.style.width=this.bar.el_.style.width;var playerWidth=parseFloat(_globalWindow2["default"].getComputedStyle(this.player().el()).width);var tooltipWidth=parseFloat(_globalWindow2["default"].getComputedStyle(this.tooltipProgressBar.tooltip).width);var tooltipStyle=this.tooltipProgressBar.el().style;tooltipStyle.maxWidth=Math.floor(playerWidth-tooltipWidth/2)+"px";tooltipStyle.minWidth=Math.ceil(tooltipWidth/2)+"px";tooltipStyle.right="-"+tooltipWidth/2+"px"}};SeekBar.prototype.updateAriaAttributes=function updateAriaAttributes(el){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();el.setAttribute("aria-valuenow",(this.getPercent()*100).toFixed(2));el.setAttribute("aria-valuetext",_utilsFormatTimeJs2["default"](time,this.player_.duration()))};SeekBar.prototype.getPercent=function getPercent(){var percent=this.player_.currentTime()/this.player_.duration();return percent>=1?1:percent};SeekBar.prototype.handleMouseDown=function handleMouseDown(event){this.player_.scrubbing(true);this.videoWasPlaying=!this.player_.paused();this.player_.pause();_Slider.prototype.handleMouseDown.call(this,event)};SeekBar.prototype.handleMouseMove=function handleMouseMove(event){var newTime=this.calculateDistance(event)*this.player_.duration();if(newTime===this.player_.duration()){newTime=newTime-.1}this.player_.currentTime(newTime)};SeekBar.prototype.handleMouseUp=function handleMouseUp(event){_Slider.prototype.handleMouseUp.call(this,event);this.player_.scrubbing(false);if(this.videoWasPlaying){this.player_.play()}};SeekBar.prototype.stepForward=function stepForward(){this.player_.currentTime(this.player_.currentTime()+5)};SeekBar.prototype.stepBack=function stepBack(){this.player_.currentTime(this.player_.currentTime()-5)};return SeekBar}(_sliderSliderJs2["default"]);SeekBar.prototype.options_={children:["loadProgressBar","mouseTimeDisplay","playProgressBar"],barName:"playProgressBar"};SeekBar.prototype.playerEvent="timeupdate";_componentJs2["default"].registerComponent("SeekBar",SeekBar);exports["default"]=SeekBar;module.exports=exports["default"]},{"../../component.js":68,"../../slider/slider.js":121,"../../utils/fn.js":148,"../../utils/format-time.js":149,"./load-progress-bar.js":78,"./play-progress-bar.js":80,"./tooltip-progress-bar.js":83,"global/window":10,"object.assign":53}],83:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var TooltipProgressBar=function(_Component){_inherits(TooltipProgressBar,_Component);function TooltipProgressBar(player,options){_classCallCheck(this,TooltipProgressBar);_Component.call(this,player,options);this.updateDataAttr();this.on(player,"timeupdate",this.updateDataAttr);player.ready(Fn.bind(this,this.updateDataAttr))}TooltipProgressBar.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-tooltip-progress-bar vjs-slider-bar",innerHTML:'<div class="vjs-time-tooltip"></div>\n        <span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"});this.tooltip=el.querySelector(".vjs-time-tooltip");return el};TooltipProgressBar.prototype.updateDataAttr=function updateDataAttr(){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();var formattedTime=_utilsFormatTimeJs2["default"](time,this.player_.duration());this.el_.setAttribute("data-current-time",formattedTime);this.tooltip.innerHTML=formattedTime};return TooltipProgressBar}(_componentJs2["default"]);_componentJs2["default"].registerComponent("TooltipProgressBar",TooltipProgressBar);exports["default"]=TooltipProgressBar;module.exports=exports["default"]},{"../../component.js":68,"../../utils/dom.js":146,"../../utils/fn.js":148,"../../utils/format-time.js":149}],84:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _spacerJs=_dereq_("./spacer.js");var _spacerJs2=_interopRequireDefault(_spacerJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var CustomControlSpacer=function(_Spacer){_inherits(CustomControlSpacer,_Spacer);function CustomControlSpacer(){_classCallCheck(this,CustomControlSpacer);_Spacer.apply(this,arguments)}CustomControlSpacer.prototype.buildCSSClass=function buildCSSClass(){return"vjs-custom-control-spacer "+_Spacer.prototype.buildCSSClass.call(this)};CustomControlSpacer.prototype.createEl=function createEl(){var el=_Spacer.prototype.createEl.call(this,{className:this.buildCSSClass()});el.innerHTML="&nbsp;";return el};return CustomControlSpacer}(_spacerJs2["default"]);_componentJs2["default"].registerComponent("CustomControlSpacer",CustomControlSpacer);exports["default"]=CustomControlSpacer;module.exports=exports["default"]},{"../../component.js":68,"./spacer.js":85}],85:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var Spacer=function(_Component){_inherits(Spacer,_Component);function Spacer(){_classCallCheck(this,Spacer);_Component.apply(this,arguments)}Spacer.prototype.buildCSSClass=function buildCSSClass(){return"vjs-spacer "+_Component.prototype.buildCSSClass.call(this)};Spacer.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})};return Spacer}(_componentJs2["default"]);_componentJs2["default"].registerComponent("Spacer",Spacer);exports["default"]=Spacer;module.exports=exports["default"]},{"../../component.js":68}],86:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _textTrackMenuItemJs=_dereq_("./text-track-menu-item.js");var _textTrackMenuItemJs2=_interopRequireDefault(_textTrackMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var CaptionSettingsMenuItem=function(_TextTrackMenuItem){_inherits(CaptionSettingsMenuItem,_TextTrackMenuItem);function CaptionSettingsMenuItem(player,options){_classCallCheck(this,CaptionSettingsMenuItem);options["track"]={kind:options["kind"],player:player,label:options["kind"]+" settings",selectable:false,"default":false,mode:"disabled"};options["selectable"]=false;_TextTrackMenuItem.call(this,player,options);this.addClass("vjs-texttrack-settings");this.controlText(", opens "+options["kind"]+" settings dialog")}CaptionSettingsMenuItem.prototype.handleClick=function handleClick(){this.player().getChild("textTrackSettings").show();this.player().getChild("textTrackSettings").el_.focus()};return CaptionSettingsMenuItem}(_textTrackMenuItemJs2["default"]);_componentJs2["default"].registerComponent("CaptionSettingsMenuItem",CaptionSettingsMenuItem);exports["default"]=CaptionSettingsMenuItem;module.exports=exports["default"]},{"../../component.js":68,"./text-track-menu-item.js":94}],87:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _textTrackButtonJs=_dereq_("./text-track-button.js");var _textTrackButtonJs2=_interopRequireDefault(_textTrackButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _captionSettingsMenuItemJs=_dereq_("./caption-settings-menu-item.js");var _captionSettingsMenuItemJs2=_interopRequireDefault(_captionSettingsMenuItemJs);var CaptionsButton=function(_TextTrackButton){_inherits(CaptionsButton,_TextTrackButton);function CaptionsButton(player,options,ready){_classCallCheck(this,CaptionsButton);_TextTrackButton.call(this,player,options,ready);this.el_.setAttribute("aria-label","Captions Menu")}CaptionsButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-captions-button "+_TextTrackButton.prototype.buildCSSClass.call(this)};CaptionsButton.prototype.update=function update(){var threshold=2;_TextTrackButton.prototype.update.call(this);if(this.player().tech_&&this.player().tech_["featuresNativeTextTracks"]){threshold=1}if(this.items&&this.items.length>threshold){this.show()}else{this.hide()}};CaptionsButton.prototype.createItems=function createItems(){var items=[];if(!(this.player().tech_&&this.player().tech_["featuresNativeTextTracks"])){items.push(new _captionSettingsMenuItemJs2["default"](this.player_,{kind:this.kind_}))}return _TextTrackButton.prototype.createItems.call(this,items)};return CaptionsButton}(_textTrackButtonJs2["default"]);CaptionsButton.prototype.kind_="captions";CaptionsButton.prototype.controlText_="Captions";_componentJs2["default"].registerComponent("CaptionsButton",CaptionsButton);exports["default"]=CaptionsButton;module.exports=exports["default"]},{"../../component.js":68,"./caption-settings-menu-item.js":86,"./text-track-button.js":93}],88:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _textTrackButtonJs=_dereq_("./text-track-button.js");var _textTrackButtonJs2=_interopRequireDefault(_textTrackButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _textTrackMenuItemJs=_dereq_("./text-track-menu-item.js");var _textTrackMenuItemJs2=_interopRequireDefault(_textTrackMenuItemJs);var _chaptersTrackMenuItemJs=_dereq_("./chapters-track-menu-item.js");var _chaptersTrackMenuItemJs2=_interopRequireDefault(_chaptersTrackMenuItemJs);var _menuMenuJs=_dereq_("../../menu/menu.js");var _menuMenuJs2=_interopRequireDefault(_menuMenuJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsToTitleCaseJs=_dereq_("../../utils/to-title-case.js");
var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var ChaptersButton=function(_TextTrackButton){_inherits(ChaptersButton,_TextTrackButton);function ChaptersButton(player,options,ready){_classCallCheck(this,ChaptersButton);_TextTrackButton.call(this,player,options,ready);this.el_.setAttribute("aria-label","Chapters Menu")}ChaptersButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-chapters-button "+_TextTrackButton.prototype.buildCSSClass.call(this)};ChaptersButton.prototype.createItems=function createItems(){var items=[];var tracks=this.player_.textTracks();if(!tracks){return items}for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track["kind"]===this.kind_){items.push(new _textTrackMenuItemJs2["default"](this.player_,{track:track}))}}return items};ChaptersButton.prototype.createMenu=function createMenu(){var _this=this;var tracks=this.player_.textTracks()||[];var chaptersTrack=undefined;var items=this.items=[];for(var i=0,_length=tracks.length;i<_length;i++){var track=tracks[i];if(track["kind"]===this.kind_){chaptersTrack=track;break}}var menu=this.menu;if(menu===undefined){menu=new _menuMenuJs2["default"](this.player_);var title=Dom.createEl("li",{className:"vjs-menu-title",innerHTML:_utilsToTitleCaseJs2["default"](this.kind_),tabIndex:-1});menu.children_.unshift(title);Dom.insertElFirst(title,menu.contentEl())}if(chaptersTrack&&chaptersTrack.cues==null){chaptersTrack["mode"]="hidden";var remoteTextTrackEl=this.player_.remoteTextTrackEls().getTrackElementByTrack_(chaptersTrack);if(remoteTextTrackEl){remoteTextTrackEl.addEventListener("load",function(event){return _this.update()})}}if(chaptersTrack&&chaptersTrack.cues&&chaptersTrack.cues.length>0){var cues=chaptersTrack["cues"],cue=undefined;for(var i=0,l=cues.length;i<l;i++){cue=cues[i];var mi=new _chaptersTrackMenuItemJs2["default"](this.player_,{track:chaptersTrack,cue:cue});items.push(mi);menu.addChild(mi)}this.addChild(menu)}if(this.items.length>0){this.show()}return menu};return ChaptersButton}(_textTrackButtonJs2["default"]);ChaptersButton.prototype.kind_="chapters";ChaptersButton.prototype.controlText_="Chapters";_componentJs2["default"].registerComponent("ChaptersButton",ChaptersButton);exports["default"]=ChaptersButton;module.exports=exports["default"]},{"../../component.js":68,"../../menu/menu.js":113,"../../utils/dom.js":146,"../../utils/fn.js":148,"../../utils/to-title-case.js":155,"./chapters-track-menu-item.js":89,"./text-track-button.js":93,"./text-track-menu-item.js":94,"global/window":10}],89:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _menuMenuItemJs=_dereq_("../../menu/menu-item.js");var _menuMenuItemJs2=_interopRequireDefault(_menuMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var ChaptersTrackMenuItem=function(_MenuItem){_inherits(ChaptersTrackMenuItem,_MenuItem);function ChaptersTrackMenuItem(player,options){_classCallCheck(this,ChaptersTrackMenuItem);var track=options["track"];var cue=options["cue"];var currentTime=player.currentTime();options["label"]=cue.text;options["selected"]=cue["startTime"]<=currentTime&&currentTime<cue["endTime"];_MenuItem.call(this,player,options);this.track=track;this.cue=cue;track.addEventListener("cuechange",Fn.bind(this,this.update))}ChaptersTrackMenuItem.prototype.handleClick=function handleClick(){_MenuItem.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)};ChaptersTrackMenuItem.prototype.update=function update(){var cue=this.cue;var currentTime=this.player_.currentTime();this.selected(cue["startTime"]<=currentTime&&currentTime<cue["endTime"])};return ChaptersTrackMenuItem}(_menuMenuItemJs2["default"]);_componentJs2["default"].registerComponent("ChaptersTrackMenuItem",ChaptersTrackMenuItem);exports["default"]=ChaptersTrackMenuItem;module.exports=exports["default"]},{"../../component.js":68,"../../menu/menu-item.js":112,"../../utils/fn.js":148}],90:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _textTrackButtonJs=_dereq_("./text-track-button.js");var _textTrackButtonJs2=_interopRequireDefault(_textTrackButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var DescriptionsButton=function(_TextTrackButton){_inherits(DescriptionsButton,_TextTrackButton);function DescriptionsButton(player,options,ready){var _this=this;_classCallCheck(this,DescriptionsButton);_TextTrackButton.call(this,player,options,ready);this.el_.setAttribute("aria-label","Descriptions Menu");var tracks=player.textTracks();if(tracks){(function(){var changeHandler=Fn.bind(_this,_this.handleTracksChange);tracks.addEventListener("change",changeHandler);_this.on("dispose",function(){tracks.removeEventListener("change",changeHandler)})})()}}DescriptionsButton.prototype.handleTracksChange=function handleTracksChange(event){var tracks=this.player().textTracks();var disabled=false;for(var i=0,l=tracks.length;i<l;i++){var track=tracks[i];if(track["kind"]!==this.kind_&&track["mode"]==="showing"){disabled=true;break}}if(disabled){this.disable()}else{this.enable()}};DescriptionsButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-descriptions-button "+_TextTrackButton.prototype.buildCSSClass.call(this)};return DescriptionsButton}(_textTrackButtonJs2["default"]);DescriptionsButton.prototype.kind_="descriptions";DescriptionsButton.prototype.controlText_="Descriptions";_componentJs2["default"].registerComponent("DescriptionsButton",DescriptionsButton);exports["default"]=DescriptionsButton;module.exports=exports["default"]},{"../../component.js":68,"../../utils/fn.js":148,"./text-track-button.js":93}],91:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _textTrackMenuItemJs=_dereq_("./text-track-menu-item.js");var _textTrackMenuItemJs2=_interopRequireDefault(_textTrackMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var OffTextTrackMenuItem=function(_TextTrackMenuItem){_inherits(OffTextTrackMenuItem,_TextTrackMenuItem);function OffTextTrackMenuItem(player,options){_classCallCheck(this,OffTextTrackMenuItem);options["track"]={kind:options["kind"],player:player,label:options["kind"]+" off","default":false,mode:"disabled"};options["selectable"]=true;_TextTrackMenuItem.call(this,player,options);this.selected(true)}OffTextTrackMenuItem.prototype.handleTracksChange=function handleTracksChange(event){var tracks=this.player().textTracks();var selected=true;for(var i=0,l=tracks.length;i<l;i++){var track=tracks[i];if(track["kind"]===this.track["kind"]&&track["mode"]==="showing"){selected=false;break}}this.selected(selected)};return OffTextTrackMenuItem}(_textTrackMenuItemJs2["default"]);_componentJs2["default"].registerComponent("OffTextTrackMenuItem",OffTextTrackMenuItem);exports["default"]=OffTextTrackMenuItem;module.exports=exports["default"]},{"../../component.js":68,"./text-track-menu-item.js":94}],92:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _textTrackButtonJs=_dereq_("./text-track-button.js");var _textTrackButtonJs2=_interopRequireDefault(_textTrackButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var SubtitlesButton=function(_TextTrackButton){_inherits(SubtitlesButton,_TextTrackButton);function SubtitlesButton(player,options,ready){_classCallCheck(this,SubtitlesButton);_TextTrackButton.call(this,player,options,ready);this.el_.setAttribute("aria-label","Subtitles Menu")}SubtitlesButton.prototype.buildCSSClass=function buildCSSClass(){return"vjs-subtitles-button "+_TextTrackButton.prototype.buildCSSClass.call(this)};return SubtitlesButton}(_textTrackButtonJs2["default"]);SubtitlesButton.prototype.kind_="subtitles";SubtitlesButton.prototype.controlText_="Subtitles";_componentJs2["default"].registerComponent("SubtitlesButton",SubtitlesButton);exports["default"]=SubtitlesButton;module.exports=exports["default"]},{"../../component.js":68,"./text-track-button.js":93}],93:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _trackButtonJs=_dereq_("../track-button.js");var _trackButtonJs2=_interopRequireDefault(_trackButtonJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _textTrackMenuItemJs=_dereq_("./text-track-menu-item.js");var _textTrackMenuItemJs2=_interopRequireDefault(_textTrackMenuItemJs);var _offTextTrackMenuItemJs=_dereq_("./off-text-track-menu-item.js");var _offTextTrackMenuItemJs2=_interopRequireDefault(_offTextTrackMenuItemJs);var TextTrackButton=function(_TrackButton){_inherits(TextTrackButton,_TrackButton);function TextTrackButton(player){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];_classCallCheck(this,TextTrackButton);options.tracks=player.textTracks();_TrackButton.call(this,player,options)}TextTrackButton.prototype.createItems=function createItems(){var items=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];items.push(new _offTextTrackMenuItemJs2["default"](this.player_,{kind:this.kind_}));var tracks=this.player_.textTracks();if(!tracks){return items}for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track["kind"]===this.kind_){items.push(new _textTrackMenuItemJs2["default"](this.player_,{selectable:true,track:track}))}}return items};return TextTrackButton}(_trackButtonJs2["default"]);_componentJs2["default"].registerComponent("TextTrackButton",TextTrackButton);exports["default"]=TextTrackButton;module.exports=exports["default"]},{"../../component.js":68,"../../utils/fn.js":148,"../track-button.js":99,"./off-text-track-menu-item.js":91,"./text-track-menu-item.js":94}],94:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _menuMenuItemJs=_dereq_("../../menu/menu-item.js");var _menuMenuItemJs2=_interopRequireDefault(_menuMenuItemJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var TextTrackMenuItem=function(_MenuItem){_inherits(TextTrackMenuItem,_MenuItem);function TextTrackMenuItem(player,options){var _this=this;_classCallCheck(this,TextTrackMenuItem);var track=options["track"];var tracks=player.textTracks();options["label"]=track["label"]||track["language"]||"Unknown";options["selected"]=track["default"]||track["mode"]==="showing";_MenuItem.call(this,player,options);this.track=track;if(tracks){(function(){var changeHandler=Fn.bind(_this,_this.handleTracksChange);tracks.addEventListener("change",changeHandler);_this.on("dispose",function(){tracks.removeEventListener("change",changeHandler)})})()}if(tracks&&tracks.onchange===undefined){(function(){var event=undefined;_this.on(["tap","click"],function(){if(typeof _globalWindow2["default"].Event!=="object"){try{event=new _globalWindow2["default"].Event("change")}catch(err){}}if(!event){event=_globalDocument2["default"].createEvent("Event");event.initEvent("change",true,true)}tracks.dispatchEvent(event)})})()}}TextTrackMenuItem.prototype.handleClick=function handleClick(event){var kind=this.track["kind"];var tracks=this.player_.textTracks();_MenuItem.prototype.handleClick.call(this,event);if(!tracks)return;for(var i=0;i<tracks.length;i++){var track=tracks[i];if(track["kind"]!==kind){continue}if(track===this.track){track["mode"]="showing"}else{track["mode"]="disabled"}}};TextTrackMenuItem.prototype.handleTracksChange=function handleTracksChange(event){this.selected(this.track["mode"]==="showing")};return TextTrackMenuItem}(_menuMenuItemJs2["default"]);_componentJs2["default"].registerComponent("TextTrackMenuItem",TextTrackMenuItem);exports["default"]=TextTrackMenuItem;module.exports=exports["default"]},{"../../component.js":68,"../../menu/menu-item.js":112,"../../utils/fn.js":148,"global/document":9,"global/window":10}],95:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var CurrentTimeDisplay=function(_Component){_inherits(CurrentTimeDisplay,_Component);function CurrentTimeDisplay(player,options){_classCallCheck(this,CurrentTimeDisplay);_Component.call(this,player,options);this.on(player,"timeupdate",this.updateContent)}CurrentTimeDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>'+"0:00"},{"aria-live":"off"});el.appendChild(this.contentEl_);return el};CurrentTimeDisplay.prototype.updateContent=function updateContent(){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();var localizedText=this.localize("Current Time");var formattedTime=_utilsFormatTimeJs2["default"](time,this.player_.duration());if(formattedTime!==this.formattedTime_){this.formattedTime_=formattedTime;this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span> "+formattedTime}};return CurrentTimeDisplay}(_componentJs2["default"]);_componentJs2["default"].registerComponent("CurrentTimeDisplay",CurrentTimeDisplay);exports["default"]=CurrentTimeDisplay;module.exports=exports["default"]},{"../../component.js":68,"../../utils/dom.js":146,"../../utils/format-time.js":149}],96:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var DurationDisplay=function(_Component){_inherits(DurationDisplay,_Component);function DurationDisplay(player,options){_classCallCheck(this,DurationDisplay);_Component.call(this,player,options);this.on(player,"timeupdate",this.updateContent);this.on(player,"loadedmetadata",this.updateContent)}DurationDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> 0:00"},{"aria-live":"off"});el.appendChild(this.contentEl_);return el};DurationDisplay.prototype.updateContent=function updateContent(){var duration=this.player_.duration();if(duration&&this.duration_!==duration){this.duration_=duration;var localizedText=this.localize("Duration Time");var formattedTime=_utilsFormatTimeJs2["default"](duration);this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span> "+formattedTime}};return DurationDisplay}(_componentJs2["default"]);_componentJs2["default"].registerComponent("DurationDisplay",DurationDisplay);exports["default"]=DurationDisplay;module.exports=exports["default"]},{"../../component.js":68,"../../utils/dom.js":146,"../../utils/format-time.js":149}],97:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFormatTimeJs=_dereq_("../../utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var RemainingTimeDisplay=function(_Component){_inherits(RemainingTimeDisplay,_Component);function RemainingTimeDisplay(player,options){_classCallCheck(this,RemainingTimeDisplay);_Component.call(this,player,options);this.on(player,"timeupdate",this.updateContent)}RemainingTimeDisplay.prototype.createEl=function createEl(){var el=_Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-control vjs-control"});this.contentEl_=Dom.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -0:00"},{"aria-live":"off"});el.appendChild(this.contentEl_);return el};RemainingTimeDisplay.prototype.updateContent=function updateContent(){if(this.player_.duration()){var localizedText=this.localize("Remaining Time");var formattedTime=_utilsFormatTimeJs2["default"](this.player_.remainingTime());if(formattedTime!==this.formattedTime_){this.formattedTime_=formattedTime;this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span> -"+formattedTime}}};return RemainingTimeDisplay}(_componentJs2["default"]);_componentJs2["default"].registerComponent("RemainingTimeDisplay",RemainingTimeDisplay);exports["default"]=RemainingTimeDisplay;module.exports=exports["default"]},{"../../component.js":68,"../../utils/dom.js":146,"../../utils/format-time.js":149}],98:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var TimeDivider=function(_Component){_inherits(TimeDivider,_Component);function TimeDivider(){_classCallCheck(this,TimeDivider);_Component.apply(this,arguments)}TimeDivider.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"})};return TimeDivider}(_componentJs2["default"]);_componentJs2["default"].registerComponent("TimeDivider",TimeDivider);exports["default"]=TimeDivider;module.exports=exports["default"]},{"../../component.js":68}],99:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _menuMenuButtonJs=_dereq_("../menu/menu-button.js");var _menuMenuButtonJs2=_interopRequireDefault(_menuMenuButtonJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var TrackButton=function(_MenuButton){_inherits(TrackButton,_MenuButton);function TrackButton(player,options){_classCallCheck(this,TrackButton);var tracks=options.tracks;_MenuButton.call(this,player,options);if(this.items.length<=1){this.hide()}if(!tracks){return}var updateHandler=Fn.bind(this,this.update);tracks.addEventListener("removetrack",updateHandler);tracks.addEventListener("addtrack",updateHandler);this.player_.on("dispose",function(){tracks.removeEventListener("removetrack",updateHandler);tracks.removeEventListener("addtrack",updateHandler)})}return TrackButton}(_menuMenuButtonJs2["default"]);_componentJs2["default"].registerComponent("TrackButton",TrackButton);exports["default"]=TrackButton;module.exports=exports["default"]},{"../component.js":68,"../menu/menu-button.js":111,"../utils/fn.js":148}],100:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _sliderSliderJs=_dereq_("../../slider/slider.js");var _sliderSliderJs2=_interopRequireDefault(_sliderSliderJs);var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _volumeLevelJs=_dereq_("./volume-level.js");var _volumeLevelJs2=_interopRequireDefault(_volumeLevelJs);var _volumeDisplayJs=_dereq_("./volume-display.js");var _volumeDisplayJs2=_interopRequireDefault(_volumeDisplayJs);var VolumeBar=function(_Slider){_inherits(VolumeBar,_Slider);function VolumeBar(player,options){_classCallCheck(this,VolumeBar);_Slider.call(this,player,options);this.on(player,"volumechange",this.updateARIAAttributes);player.ready(Fn.bind(this,this.updateARIAAttributes))}VolumeBar.prototype.createEl=function createEl(){return _Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":"volume level"})};VolumeBar.prototype.handleMouseMove=function handleMouseMove(event){this.checkMuted();this.player_.volume(this.calculateDistance(event))};VolumeBar.prototype.checkMuted=function checkMuted(){if(this.player_.muted()){this.player_.muted(false)}};VolumeBar.prototype.getPercent=function getPercent(){if(this.player_.muted()){return 0}else{return this.player_.volume()}};VolumeBar.prototype.stepForward=function stepForward(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)};VolumeBar.prototype.stepBack=function stepBack(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)};VolumeBar.prototype.updateARIAAttributes=function updateARIAAttributes(){var volume=(this.player_.volume()*100).toFixed(2);this.el_.setAttribute("aria-valuenow",volume);this.el_.setAttribute("aria-valuetext",volume+"%")};return VolumeBar}(_sliderSliderJs2["default"]);VolumeBar.prototype.options_={children:["volumeLevel","volumeDisplay"],barName:"volumeLevel"};VolumeBar.prototype.playerEvent="volumechange";_componentJs2["default"].registerComponent("VolumeBar",VolumeBar);
exports["default"]=VolumeBar;module.exports=exports["default"]},{"../../component.js":68,"../../slider/slider.js":121,"../../utils/fn.js":148,"./volume-display.js":102,"./volume-level.js":103}],101:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _volumeBarJs=_dereq_("./volume-bar.js");var _volumeBarJs2=_interopRequireDefault(_volumeBarJs);var VolumeControl=function(_Component){_inherits(VolumeControl,_Component);function VolumeControl(player,options){_classCallCheck(this,VolumeControl);_Component.call(this,player,options);if(player.tech_&&player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden")}this.on(player,"loadstart",function(){if(player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden")}else{this.removeClass("vjs-hidden")}})}VolumeControl.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"})};return VolumeControl}(_componentJs2["default"]);VolumeControl.prototype.options_={children:["volumeBar"]};_componentJs2["default"].registerComponent("VolumeControl",VolumeControl);exports["default"]=VolumeControl;module.exports=exports["default"]},{"../../component.js":68,"./volume-bar.js":100}],102:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _lodashCompatFunctionThrottle=_dereq_("lodash-compat/function/throttle");var _lodashCompatFunctionThrottle2=_interopRequireDefault(_lodashCompatFunctionThrottle);var VolumeDisplay=function(_Component){_inherits(VolumeDisplay,_Component);function VolumeDisplay(player,options){var _this=this;_classCallCheck(this,VolumeDisplay);_Component.call(this,player,options);this.update(0,0,0);player.on("ready",function(){player.controlBar.progressControl.el().appendChild(_this.tooltip);_this.parent=player.controlBar.volumeMenuButton.volumeBar;_this.on(_this.parent.el(),"mousemove",_lodashCompatFunctionThrottle2["default"](Fn.bind(_this,_this.handleMouseMove),25));_this.on(_this.parent.el(),"mouseover",_lodashCompatFunctionThrottle2["default"](Fn.bind(_this,_this.handleHover),25));_this.on(_this.parent.el(),"mouseout",_lodashCompatFunctionThrottle2["default"](Fn.bind(_this,_this.handleLeave),25))})}VolumeDisplay.prototype.createEl=function createEl(){this.className="vjs-volume-display";this.tooltipClassName=this.className+"-tooltip";this.tooltip=Dom.createEl("div",{className:this.tooltipClassName});return _Component.prototype.createEl.call(this,"div",{className:this.className})};VolumeDisplay.prototype.dispose=function dispose(){if(this.tooltip.parentNode){this.tooltip.parentNode.removeChild(this.tooltip)}Dom.removeElData(this.tooltip);this.tooltip=null;_Component.prototype.dispose.call(this)};VolumeDisplay.prototype.handleMouseMove=function handleMouseMove(event){var newValue=this.calculateDistance(event)*100;var maxLeft=this.parent.width()-this.width();var position=event.pageX-Dom.findElPosition(this.el().parentNode).left;position=Math.min(Math.max(0,position),maxLeft);var tooltipWidth=this.tooltip.offsetWidth;var tooltipParentLeft=Dom.findElPosition(this.tooltip.parentNode).left;var minTooltipLeft=Dom.findElPosition(this.parent.el()).left-tooltipParentLeft-tooltipWidth/2;var maxTooltipLeft=minTooltipLeft+this.parent.width();var tooltipPosition=event.pageX-tooltipParentLeft-tooltipWidth/2;tooltipPosition=Math.min(Math.max(minTooltipLeft,tooltipPosition),maxTooltipLeft);this.update(newValue,position,tooltipPosition)};VolumeDisplay.prototype.handleHover=function handleHover(event){this.player_.trigger("tooltipShown");Dom.addElClass(this.tooltip,this.tooltipClassName+"-active")};VolumeDisplay.prototype.handleLeave=function handleLeave(event){Dom.removeElClass(this.tooltip,this.tooltipClassName+"-active")};VolumeDisplay.prototype.update=function update(newValue,position,tooltipPosition){var value=Math.round(newValue)+"%";this.el().style.left=position+"px";this.tooltip.style.left=tooltipPosition+"px";this.tooltip.innerHTML=value};VolumeDisplay.prototype.calculateDistance=function calculateDistance(event){return Dom.getPointerPosition(this.el().parentNode,event).x};return VolumeDisplay}(_componentJs2["default"]);_componentJs2["default"].registerComponent("VolumeDisplay",VolumeDisplay);exports["default"]=VolumeDisplay;module.exports=exports["default"]},{"../../component.js":68,"../../utils/dom.js":146,"../../utils/fn.js":148,"lodash-compat/function/throttle":15}],103:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var VolumeLevel=function(_Component){_inherits(VolumeLevel,_Component);function VolumeLevel(){_classCallCheck(this,VolumeLevel);_Component.apply(this,arguments)}VolumeLevel.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})};return VolumeLevel}(_componentJs2["default"]);_componentJs2["default"].registerComponent("VolumeLevel",VolumeLevel);exports["default"]=VolumeLevel;module.exports=exports["default"]},{"../../component.js":68}],104:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _popupPopupJs=_dereq_("../popup/popup.js");var _popupPopupJs2=_interopRequireDefault(_popupPopupJs);var _popupPopupButtonJs=_dereq_("../popup/popup-button.js");var _popupPopupButtonJs2=_interopRequireDefault(_popupPopupButtonJs);var _muteToggleJs=_dereq_("./mute-toggle.js");var _muteToggleJs2=_interopRequireDefault(_muteToggleJs);var _volumeControlVolumeBarJs=_dereq_("./volume-control/volume-bar.js");var _volumeControlVolumeBarJs2=_interopRequireDefault(_volumeControlVolumeBarJs);var VolumeMenuButton=function(_PopupButton){_inherits(VolumeMenuButton,_PopupButton);function VolumeMenuButton(player){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];_classCallCheck(this,VolumeMenuButton);if(options.inline===undefined){options.inline=true}if(options.vertical===undefined){if(options.inline){options.vertical=false}else{options.vertical=true}}options.volumeBar=options.volumeBar||{};options.volumeBar.vertical=!!options.vertical;_PopupButton.call(this,player,options);this.on(player,"volumechange",this.volumeUpdate);this.on(player,"loadstart",this.volumeUpdate);function updateVisibility(){if(player.tech_&&player.tech_["featuresVolumeControl"]===false){this.addClass("vjs-hidden")}else{this.removeClass("vjs-hidden")}}updateVisibility.call(this);this.on(player,"loadstart",updateVisibility);this.on(this.volumeBar,["slideractive","focus"],function(){this.addClass("vjs-slider-active")});this.on(this.volumeBar,["sliderinactive","blur"],function(){this.removeClass("vjs-slider-active")});this.on(this.volumeBar,["focus"],function(){this.addClass("vjs-lock-showing")});this.on(this.volumeBar,["blur"],function(){this.removeClass("vjs-lock-showing")})}VolumeMenuButton.prototype.buildCSSClass=function buildCSSClass(){var orientationClass="";if(!!this.options_.vertical){orientationClass="vjs-volume-menu-button-vertical"}else{orientationClass="vjs-volume-menu-button-horizontal"}return"vjs-volume-menu-button "+_PopupButton.prototype.buildCSSClass.call(this)+" "+orientationClass};VolumeMenuButton.prototype.createPopup=function createPopup(){var popup=new _popupPopupJs2["default"](this.player_,{contentElType:"div"});var vb=new _volumeControlVolumeBarJs2["default"](this.player_,this.options_.volumeBar);popup.addChild(vb);this.menuContent=popup;this.volumeBar=vb;this.attachVolumeBarEvents();return popup};VolumeMenuButton.prototype.handleClick=function handleClick(){_muteToggleJs2["default"].prototype.handleClick.call(this);_PopupButton.prototype.handleClick.call(this)};VolumeMenuButton.prototype.attachVolumeBarEvents=function attachVolumeBarEvents(){this.menuContent.on(["mousedown","touchdown"],Fn.bind(this,this.handleMouseDown))};VolumeMenuButton.prototype.handleMouseDown=function handleMouseDown(event){this.on(["mousemove","touchmove"],Fn.bind(this.volumeBar,this.volumeBar.handleMouseMove));this.on(this.el_.ownerDocument,["mouseup","touchend"],this.handleMouseUp)};VolumeMenuButton.prototype.handleMouseUp=function handleMouseUp(event){this.off(["mousemove","touchmove"],Fn.bind(this.volumeBar,this.volumeBar.handleMouseMove))};return VolumeMenuButton}(_popupPopupButtonJs2["default"]);VolumeMenuButton.prototype.volumeUpdate=_muteToggleJs2["default"].prototype.update;VolumeMenuButton.prototype.controlText_="Mute";_componentJs2["default"].registerComponent("VolumeMenuButton",VolumeMenuButton);exports["default"]=VolumeMenuButton;module.exports=exports["default"]},{"../component.js":68,"../popup/popup-button.js":117,"../popup/popup.js":118,"../utils/fn.js":148,"./mute-toggle.js":74,"./volume-control/volume-bar.js":100}],105:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _modalDialog=_dereq_("./modal-dialog");var _modalDialog2=_interopRequireDefault(_modalDialog);var _utilsDom=_dereq_("./utils/dom");var Dom=_interopRequireWildcard(_utilsDom);var _utilsMergeOptions=_dereq_("./utils/merge-options");var _utilsMergeOptions2=_interopRequireDefault(_utilsMergeOptions);var ErrorDisplay=function(_ModalDialog){_inherits(ErrorDisplay,_ModalDialog);function ErrorDisplay(player,options){_classCallCheck(this,ErrorDisplay);_ModalDialog.call(this,player,options);this.on(player,"error",this.open)}ErrorDisplay.prototype.buildCSSClass=function buildCSSClass(){return"vjs-error-display "+_ModalDialog.prototype.buildCSSClass.call(this)};ErrorDisplay.prototype.content=function content(){var error=this.player().error();return error?this.localize(error.message):""};return ErrorDisplay}(_modalDialog2["default"]);ErrorDisplay.prototype.options_=_utilsMergeOptions2["default"](_modalDialog2["default"].prototype.options_,{fillAlways:true,temporary:false,uncloseable:true});_component2["default"].registerComponent("ErrorDisplay",ErrorDisplay);exports["default"]=ErrorDisplay;module.exports=exports["default"]},{"./component":68,"./modal-dialog":114,"./utils/dom":146,"./utils/merge-options":152}],106:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var EventTarget=function EventTarget(){};EventTarget.prototype.allowedEvents_={};EventTarget.prototype.on=function(type,fn){var ael=this.addEventListener;this.addEventListener=function(){};Events.on(this,type,fn);this.addEventListener=ael};EventTarget.prototype.addEventListener=EventTarget.prototype.on;EventTarget.prototype.off=function(type,fn){Events.off(this,type,fn)};EventTarget.prototype.removeEventListener=EventTarget.prototype.off;EventTarget.prototype.one=function(type,fn){var ael=this.addEventListener;this.addEventListener=function(){};Events.one(this,type,fn);this.addEventListener=ael};EventTarget.prototype.trigger=function(event){var type=event.type||event;if(typeof event==="string"){event={type:type}}event=Events.fixEvent(event);if(this.allowedEvents_[type]&&this["on"+type]){this["on"+type](event)}Events.trigger(this,event)};EventTarget.prototype.dispatchEvent=EventTarget.prototype.trigger;exports["default"]=EventTarget;module.exports=exports["default"]},{"./utils/events.js":147}],107:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _utilsLog=_dereq_("./utils/log");var _utilsLog2=_interopRequireDefault(_utilsLog);var _inherits=function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass){subClass.super_=superClass}};var extendFn=function extendFn(superClass){var subClassMethods=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var subClass=function subClass(){superClass.apply(this,arguments)};var methods={};if(typeof subClassMethods==="object"){if(typeof subClassMethods.init==="function"){_utilsLog2["default"].warn("Constructor logic via init() is deprecated; please use constructor() instead.");subClassMethods.constructor=subClassMethods.init}if(subClassMethods.constructor!==Object.prototype.constructor){subClass=subClassMethods.constructor}methods=subClassMethods}else if(typeof subClassMethods==="function"){subClass=subClassMethods}_inherits(subClass,superClass);for(var name in methods){if(methods.hasOwnProperty(name)){subClass.prototype[name]=methods[name]}}return subClass};exports["default"]=extendFn;module.exports=exports["default"]},{"./utils/log":151}],108:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var FullscreenApi={};var apiMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var specApi=apiMap[0];var browserApi=undefined;for(var i=0;i<apiMap.length;i++){if(apiMap[i][1]in _globalDocument2["default"]){browserApi=apiMap[i];break}}if(browserApi){for(var i=0;i<browserApi.length;i++){FullscreenApi[specApi[i]]=browserApi[i]}}exports["default"]=FullscreenApi;module.exports=exports["default"]},{"global/document":9}],109:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var LoadingSpinner=function(_Component){_inherits(LoadingSpinner,_Component);function LoadingSpinner(){_classCallCheck(this,LoadingSpinner);_Component.apply(this,arguments)}LoadingSpinner.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"})};return LoadingSpinner}(_component2["default"]);_component2["default"].registerComponent("LoadingSpinner",LoadingSpinner);exports["default"]=LoadingSpinner;module.exports=exports["default"]},{"./component":68}],110:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var MediaError=function MediaError(code){if(typeof code==="number"){this.code=code}else if(typeof code==="string"){this.message=code}else if(typeof code==="object"){_objectAssign2["default"](this,code)}if(!this.message){this.message=MediaError.defaultMessages[this.code]||""}};MediaError.prototype.code=0;MediaError.prototype.message="";MediaError.prototype.status=null;MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];MediaError.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var errNum=0;errNum<MediaError.errorTypes.length;errNum++){MediaError[MediaError.errorTypes[errNum]]=errNum;MediaError.prototype[MediaError.errorTypes[errNum]]=errNum}exports["default"]=MediaError;module.exports=exports["default"]},{"object.assign":53}],111:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _clickableComponentJs=_dereq_("../clickable-component.js");var _clickableComponentJs2=_interopRequireDefault(_clickableComponentJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _menuJs=_dereq_("./menu.js");var _menuJs2=_interopRequireDefault(_menuJs);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsToTitleCaseJs=_dereq_("../utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var MenuButton=function(_ClickableComponent){_inherits(MenuButton,_ClickableComponent);function MenuButton(player){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];_classCallCheck(this,MenuButton);_ClickableComponent.call(this,player,options);this.update();this.enabled_=true;this.el_.setAttribute("aria-haspopup","true");this.el_.setAttribute("role","menuitem");this.on("keydown",this.handleSubmenuKeyPress)}MenuButton.prototype.update=function update(){var menu=this.createMenu();if(this.menu){this.removeChild(this.menu)}this.menu=menu;this.addChild(menu);this.buttonPressed_=false;this.el_.setAttribute("aria-expanded","false");if(this.items&&this.items.length===0){this.hide()}else if(this.items&&this.items.length>1){this.show()}};MenuButton.prototype.createMenu=function createMenu(){var menu=new _menuJs2["default"](this.player_);if(this.options_.title){var title=Dom.createEl("li",{className:"vjs-menu-title",innerHTML:_utilsToTitleCaseJs2["default"](this.options_.title),tabIndex:-1});menu.children_.unshift(title);Dom.insertElFirst(title,menu.contentEl())}this.items=this["createItems"]();if(this.items){for(var i=0;i<this.items.length;i++){menu.addItem(this.items[i])}}return menu};MenuButton.prototype.createItems=function createItems(){};MenuButton.prototype.createEl=function createEl(){return _ClickableComponent.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})};MenuButton.prototype.buildCSSClass=function buildCSSClass(){var menuButtonClass="vjs-menu-button";if(this.options_.inline===true){menuButtonClass+="-inline"}else{menuButtonClass+="-popup"}return"vjs-menu-button "+menuButtonClass+" "+_ClickableComponent.prototype.buildCSSClass.call(this)};MenuButton.prototype.handleClick=function handleClick(){this.one("mouseout",Fn.bind(this,function(){this.menu.unlockShowing();this.el_.blur()}));if(this.buttonPressed_){this.unpressButton()}else{this.pressButton()}};MenuButton.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===27||event.which===9){if(this.buttonPressed_){this.unpressButton()}if(event.which!==9){event.preventDefault()}}else if(event.which===38||event.which===40){if(!this.buttonPressed_){this.pressButton();event.preventDefault()}}else{_ClickableComponent.prototype.handleKeyPress.call(this,event)}};MenuButton.prototype.handleSubmenuKeyPress=function handleSubmenuKeyPress(event){if(event.which===27||event.which===9){if(this.buttonPressed_){this.unpressButton()}if(event.which!==9){event.preventDefault()}}};MenuButton.prototype.pressButton=function pressButton(){if(this.enabled_){this.buttonPressed_=true;this.menu.lockShowing();this.el_.setAttribute("aria-expanded","true");this.menu.focus()}};MenuButton.prototype.unpressButton=function unpressButton(){if(this.enabled_){this.buttonPressed_=false;this.menu.unlockShowing();this.el_.setAttribute("aria-expanded","false");this.el_.focus()}};MenuButton.prototype.disable=function disable(){this.buttonPressed_=false;this.menu.unlockShowing();this.el_.setAttribute("aria-expanded","false");this.enabled_=false;return _ClickableComponent.prototype.disable.call(this)};MenuButton.prototype.enable=function enable(){this.enabled_=true;return _ClickableComponent.prototype.enable.call(this)};MenuButton.prototype.tooltipHandler=function tooltipHandler(){return};return MenuButton}(_clickableComponentJs2["default"]);_componentJs2["default"].registerComponent("MenuButton",MenuButton);exports["default"]=MenuButton;module.exports=exports["default"]},{"../clickable-component.js":66,"../component.js":68,"../utils/dom.js":146,"../utils/fn.js":148,"../utils/to-title-case.js":155,"./menu.js":113}],112:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _clickableComponentJs=_dereq_("../clickable-component.js");var _clickableComponentJs2=_interopRequireDefault(_clickableComponentJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var MenuItem=function(_ClickableComponent){_inherits(MenuItem,_ClickableComponent);function MenuItem(player,options){_classCallCheck(this,MenuItem);_ClickableComponent.call(this,player,options);this.selectable=options["selectable"];this.selected(options["selected"]);if(this.selectable){this.el_.setAttribute("role","menuitemcheckbox")}else{this.el_.setAttribute("role","menuitem")}}MenuItem.prototype.createEl=function createEl(type,props,attrs){return _ClickableComponent.prototype.createEl.call(this,"li",_objectAssign2["default"]({className:"vjs-menu-item",innerHTML:this.localize(this.options_["label"]),tabIndex:-1},props),attrs)};MenuItem.prototype.handleClick=function handleClick(){this.selected(true)};MenuItem.prototype.selected=function selected(_selected){if(this.selectable){if(_selected){this.addClass("vjs-selected");this.el_.setAttribute("aria-checked","true");this.controlText(", selected")}else{this.removeClass("vjs-selected");this.el_.setAttribute("aria-checked","false");this.controlText(" ")}}};MenuItem.prototype.tooltipHandler=function tooltipHandler(){if(this.options_.tooltip!==undefined){return _ClickableComponent.prototype.tooltipHandler.call(this)}};return MenuItem}(_clickableComponentJs2["default"]);_componentJs2["default"].registerComponent("MenuItem",MenuItem);exports["default"]=MenuItem;module.exports=exports["default"]},{"../clickable-component.js":66,"../component.js":68,"object.assign":53}],113:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsEventsJs=_dereq_("../utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var Menu=function(_Component){_inherits(Menu,_Component);function Menu(player,options){_classCallCheck(this,Menu);_Component.call(this,player,options);this.focusedChild_=-1;this.on("keydown",this.handleKeyPress)}Menu.prototype.addItem=function addItem(component){this.addChild(component);component.on("click",Fn.bind(this,function(){this.unlockShowing()}))};Menu.prototype.createEl=function createEl(){var contentElType=this.options_.contentElType||"ul";this.contentEl_=Dom.createEl(contentElType,{className:"vjs-menu-content"});this.contentEl_.setAttribute("role","menu");var el=_Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});el.setAttribute("role","presentation");el.appendChild(this.contentEl_);Events.on(el,"click",function(event){event.preventDefault();event.stopImmediatePropagation()});return el};Menu.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===37||event.which===40){event.preventDefault();this.stepForward()}else if(event.which===38||event.which===39){event.preventDefault();this.stepBack()}};
Menu.prototype.stepForward=function stepForward(){var stepChild=0;if(this.focusedChild_!==undefined){stepChild=this.focusedChild_+1}this.focus(stepChild)};Menu.prototype.stepBack=function stepBack(){var stepChild=0;if(this.focusedChild_!==undefined){stepChild=this.focusedChild_-1}this.focus(stepChild)};Menu.prototype.focus=function focus(){var item=arguments.length<=0||arguments[0]===undefined?0:arguments[0];var children=this.children().slice();var haveTitle=children.length&&children[0].className&&/vjs-menu-title/.test(children[0].className);if(haveTitle){children.shift()}if(children.length>0){if(item<0){item=0}else if(item>=children.length){item=children.length-1}this.focusedChild_=item;children[item].el_.focus()}};return Menu}(_componentJs2["default"]);_componentJs2["default"].registerComponent("Menu",Menu);exports["default"]=Menu;module.exports=exports["default"]},{"../component.js":68,"../utils/dom.js":146,"../utils/events.js":147,"../utils/fn.js":148}],114:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _utilsDom=_dereq_("./utils/dom");var Dom=_interopRequireWildcard(_utilsDom);var _utilsFn=_dereq_("./utils/fn");var Fn=_interopRequireWildcard(_utilsFn);var _utilsLog=_dereq_("./utils/log");var _utilsLog2=_interopRequireDefault(_utilsLog);var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _closeButton=_dereq_("./close-button");var _closeButton2=_interopRequireDefault(_closeButton);var MODAL_CLASS_NAME="vjs-modal-dialog";var ESC=27;var ModalDialog=function(_Component){_inherits(ModalDialog,_Component);function ModalDialog(player,options){_classCallCheck(this,ModalDialog);_Component.call(this,player,options);this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=false;this.closeable(!this.options_.uncloseable);this.content(this.options_.content);this.contentEl_=Dom.createEl("div",{className:MODAL_CLASS_NAME+"-content"},{role:"document"});this.descEl_=Dom.createEl("p",{className:MODAL_CLASS_NAME+"-description vjs-offscreen",id:this.el().getAttribute("aria-describedby")});Dom.textContent(this.descEl_,this.description());this.el_.appendChild(this.descEl_);this.el_.appendChild(this.contentEl_)}ModalDialog.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})};ModalDialog.prototype.buildCSSClass=function buildCSSClass(){return MODAL_CLASS_NAME+" vjs-hidden "+_Component.prototype.buildCSSClass.call(this)};ModalDialog.prototype.handleKeyPress=function handleKeyPress(e){if(e.which===ESC&&this.closeable()){this.close()}};ModalDialog.prototype.label=function label(){return this.options_.label||this.localize("Modal Window")};ModalDialog.prototype.description=function description(){var desc=this.options_.description||this.localize("This is a modal window.");if(this.closeable()){desc+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")}return desc};ModalDialog.prototype.open=function open(){if(!this.opened_){var player=this.player();this.trigger("beforemodalopen");this.opened_=true;if(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_){this.fill()}this.wasPlaying_=!player.paused();if(this.wasPlaying_){player.pause()}if(this.closeable()){this.on(this.el_.ownerDocument,"keydown",Fn.bind(this,this.handleKeyPress))}player.controls(false);this.show();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=true}return this};ModalDialog.prototype.opened=function opened(value){if(typeof value==="boolean"){this[value?"open":"close"]()}return this.opened_};ModalDialog.prototype.close=function close(){if(this.opened_){var player=this.player();this.trigger("beforemodalclose");this.opened_=false;if(this.wasPlaying_){player.play()}if(this.closeable()){this.off(this.el_.ownerDocument,"keydown",Fn.bind(this,this.handleKeyPress))}player.controls(true);this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");if(this.options_.temporary){this.dispose()}}return this};ModalDialog.prototype.closeable=function closeable(value){if(typeof value==="boolean"){var closeable=this.closeable_=!!value;var _close=this.getChild("closeButton");if(closeable&&!_close){var temp=this.contentEl_;this.contentEl_=this.el_;_close=this.addChild("closeButton");this.contentEl_=temp;this.on(_close,"close",this.close)}if(!closeable&&_close){this.off(_close,"close",this.close);this.removeChild(_close);_close.dispose()}}return this.closeable_};ModalDialog.prototype.fill=function fill(){return this.fillWith(this.content())};ModalDialog.prototype.fillWith=function fillWith(content){var contentEl=this.contentEl();var parentEl=contentEl.parentNode;var nextSiblingEl=contentEl.nextSibling;this.trigger("beforemodalfill");this.hasBeenFilled_=true;parentEl.removeChild(contentEl);this.empty();Dom.insertContent(contentEl,content);this.trigger("modalfill");if(nextSiblingEl){parentEl.insertBefore(contentEl,nextSiblingEl)}else{parentEl.appendChild(contentEl)}return this};ModalDialog.prototype.empty=function empty(){this.trigger("beforemodalempty");Dom.emptyEl(this.contentEl());this.trigger("modalempty");return this};ModalDialog.prototype.content=function content(value){if(typeof value!=="undefined"){this.content_=value}return this.content_};return ModalDialog}(_component2["default"]);ModalDialog.prototype.options_={temporary:true};_component2["default"].registerComponent("ModalDialog",ModalDialog);exports["default"]=ModalDialog;module.exports=exports["default"]},{"./close-button":67,"./component":68,"./utils/dom":146,"./utils/fn":148,"./utils/log":151}],115:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("./component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsGuidJs=_dereq_("./utils/guid.js");var Guid=_interopRequireWildcard(_utilsGuidJs);var _utilsBrowserJs=_dereq_("./utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _utilsLogJs=_dereq_("./utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _utilsToTitleCaseJs=_dereq_("./utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var _utilsTimeRangesJs=_dereq_("./utils/time-ranges.js");var _utilsBufferJs=_dereq_("./utils/buffer.js");var _utilsStylesheetJs=_dereq_("./utils/stylesheet.js");var stylesheet=_interopRequireWildcard(_utilsStylesheetJs);var _fullscreenApiJs=_dereq_("./fullscreen-api.js");var _fullscreenApiJs2=_interopRequireDefault(_fullscreenApiJs);var _mediaErrorJs=_dereq_("./media-error.js");var _mediaErrorJs2=_interopRequireDefault(_mediaErrorJs);var _safeJsonParseTuple=_dereq_("safe-json-parse/tuple");var _safeJsonParseTuple2=_interopRequireDefault(_safeJsonParseTuple);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var _utilsMergeOptionsJs=_dereq_("./utils/merge-options.js");var _utilsMergeOptionsJs2=_interopRequireDefault(_utilsMergeOptionsJs);var _tracksTextTrackListConverterJs=_dereq_("./tracks/text-track-list-converter.js");var _tracksTextTrackListConverterJs2=_interopRequireDefault(_tracksTextTrackListConverterJs);var _tracksAudioTrackListJs=_dereq_("./tracks/audio-track-list.js");var _tracksAudioTrackListJs2=_interopRequireDefault(_tracksAudioTrackListJs);var _tracksVideoTrackListJs=_dereq_("./tracks/video-track-list.js");var _tracksVideoTrackListJs2=_interopRequireDefault(_tracksVideoTrackListJs);var _techLoaderJs=_dereq_("./tech/loader.js");var _techLoaderJs2=_interopRequireDefault(_techLoaderJs);var _posterImageJs=_dereq_("./poster-image.js");var _posterImageJs2=_interopRequireDefault(_posterImageJs);var _tracksTextTrackDisplayJs=_dereq_("./tracks/text-track-display.js");var _tracksTextTrackDisplayJs2=_interopRequireDefault(_tracksTextTrackDisplayJs);var _loadingSpinnerJs=_dereq_("./loading-spinner.js");var _loadingSpinnerJs2=_interopRequireDefault(_loadingSpinnerJs);var _bigPlayButtonJs=_dereq_("./big-play-button.js");var _bigPlayButtonJs2=_interopRequireDefault(_bigPlayButtonJs);var _controlBarControlBarJs=_dereq_("./control-bar/control-bar.js");var _controlBarControlBarJs2=_interopRequireDefault(_controlBarControlBarJs);var _errorDisplayJs=_dereq_("./error-display.js");var _errorDisplayJs2=_interopRequireDefault(_errorDisplayJs);var _tracksTextTrackSettingsJs=_dereq_("./tracks/text-track-settings.js");var _tracksTextTrackSettingsJs2=_interopRequireDefault(_tracksTextTrackSettingsJs);var _modalDialog=_dereq_("./modal-dialog");var _modalDialog2=_interopRequireDefault(_modalDialog);var _techTechJs=_dereq_("./tech/tech.js");var _techTechJs2=_interopRequireDefault(_techTechJs);var _techHtml5Js=_dereq_("./tech/html5.js");var _techHtml5Js2=_interopRequireDefault(_techHtml5Js);var Player=function(_Component){_inherits(Player,_Component);function Player(tag,options,ready){var _this=this;_classCallCheck(this,Player);tag.id=tag.id||"vjs_video_"+Guid.newGUID();options=_objectAssign2["default"](Player.getTagSettings(tag),options);options.initChildren=false;options.createEl=false;options.reportTouchActivity=false;_Component.call(this,null,options,ready);if(!this.options_||!this.options_.techOrder||!this.options_.techOrder.length){throw new Error("No techOrder specified. Did you overwrite "+"videojs.options instead of just changing the "+"properties you want to override?")}this.tag=tag;this.tagAttributes=tag&&Dom.getElAttributes(tag);this.language(this.options_.language);if(options.languages){(function(){var languagesToLower={};Object.getOwnPropertyNames(options.languages).forEach(function(name){languagesToLower[name.toLowerCase()]=options.languages[name]});_this.languages_=languagesToLower})()}else{this.languages_=Player.prototype.options_.languages}this.cache_={};this.poster_=options.poster||"";this.controls_=!!options.controls;tag.controls=false;this.scrubbing_=false;this.el_=this.createEl();var playerOptionsCopy=_utilsMergeOptionsJs2["default"](this.options_);if(options.plugins){(function(){var plugins=options.plugins;Object.getOwnPropertyNames(plugins).forEach(function(name){if(typeof this[name]==="function"){this[name](plugins[name])}else{_utilsLogJs2["default"].error("Unable to find plugin:",name)}},_this)})()}this.options_.playerOptions=playerOptionsCopy;this.initChildren();this.isAudio(tag.nodeName.toLowerCase()==="audio");if(this.controls()){this.addClass("vjs-controls-enabled")}else{this.addClass("vjs-controls-disabled")}this.el_.setAttribute("role","region");if(this.isAudio()){this.el_.setAttribute("aria-label","audio player")}else{this.el_.setAttribute("aria-label","video player")}if(this.isAudio()){this.addClass("vjs-audio")}if(this.flexNotSupported_()){this.addClass("vjs-no-flex")}if(!browser.IS_IOS){this.addClass("vjs-workinghover")}Player.players[this.id_]=this;this.userActive(true);this.reportUserActivity();this.listenForUserActivity_();this.on("fullscreenchange",this.handleFullscreenChange_);this.on("stageclick",this.handleStageClick_)}Player.prototype.dispose=function dispose(){this.trigger("dispose");this.off("dispose");if(this.styleEl_&&this.styleEl_.parentNode){this.styleEl_.parentNode.removeChild(this.styleEl_)}Player.players[this.id_]=null;if(this.tag&&this.tag.player){this.tag.player=null}if(this.el_&&this.el_.player){this.el_.player=null}if(this.tech_){this.tech_.dispose()}_Component.prototype.dispose.call(this)};Player.prototype.createEl=function createEl(){var el=this.el_=_Component.prototype.createEl.call(this,"div");var tag=this.tag;tag.removeAttribute("width");tag.removeAttribute("height");var attrs=Dom.getElAttributes(tag);Object.getOwnPropertyNames(attrs).forEach(function(attr){if(attr==="class"){el.className=attrs[attr]}else{el.setAttribute(attr,attrs[attr])}});tag.playerId=tag.id;tag.id+="_html5_api";tag.className="vjs-tech";tag.player=el.player=this;this.addClass("vjs-paused");if(_globalWindow2["default"].VIDEOJS_NO_DYNAMIC_STYLE!==true){this.styleEl_=stylesheet.createStyleElement("vjs-styles-dimensions");var defaultsStyleEl=Dom.$(".vjs-styles-defaults");var head=Dom.$("head");head.insertBefore(this.styleEl_,defaultsStyleEl?defaultsStyleEl.nextSibling:head.firstChild)}this.width(this.options_.width);this.height(this.options_.height);this.fluid(this.options_.fluid);this.aspectRatio(this.options_.aspectRatio);var links=tag.getElementsByTagName("a");for(var i=0;i<links.length;i++){var linkEl=links.item(i);Dom.addElClass(linkEl,"vjs-hidden");linkEl.setAttribute("hidden","hidden")}tag.initNetworkState_=tag.networkState;if(tag.parentNode){tag.parentNode.insertBefore(el,tag)}Dom.insertElFirst(tag,el);this.children_.unshift(tag);this.el_=el;return el};Player.prototype.width=function width(value){return this.dimension("width",value)};Player.prototype.height=function height(value){return this.dimension("height",value)};Player.prototype.dimension=function dimension(_dimension,value){var privDimension=_dimension+"_";if(value===undefined){return this[privDimension]||0}if(value===""){this[privDimension]=undefined}else{var parsedVal=parseFloat(value);if(isNaN(parsedVal)){_utilsLogJs2["default"].error('Improper value "'+value+'" supplied for for '+_dimension);return this}this[privDimension]=parsedVal}this.updateStyleEl_();return this};Player.prototype.fluid=function fluid(bool){if(bool===undefined){return!!this.fluid_}this.fluid_=!!bool;if(bool){this.addClass("vjs-fluid")}else{this.removeClass("vjs-fluid")}};Player.prototype.aspectRatio=function aspectRatio(ratio){if(ratio===undefined){return this.aspectRatio_}if(!/^\d+\:\d+$/.test(ratio)){throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.")}this.aspectRatio_=ratio;this.fluid(true);this.updateStyleEl_()};Player.prototype.updateStyleEl_=function updateStyleEl_(){if(_globalWindow2["default"].VIDEOJS_NO_DYNAMIC_STYLE===true){var _width=typeof this.width_==="number"?this.width_:this.options_.width;var _height=typeof this.height_==="number"?this.height_:this.options_.height;var techEl=this.tech_&&this.tech_.el();if(techEl){if(_width>=0){techEl.width=_width}if(_height>=0){techEl.height=_height}}return}var width=undefined;var height=undefined;var aspectRatio=undefined;var idClass=undefined;if(this.aspectRatio_!==undefined&&this.aspectRatio_!=="auto"){aspectRatio=this.aspectRatio_}else if(this.videoWidth()){aspectRatio=this.videoWidth()+":"+this.videoHeight()}else{aspectRatio="16:9"}var ratioParts=aspectRatio.split(":");var ratioMultiplier=ratioParts[1]/ratioParts[0];if(this.width_!==undefined){width=this.width_}else if(this.height_!==undefined){width=this.height_/ratioMultiplier}else{width=this.videoWidth()||300}if(this.height_!==undefined){height=this.height_}else{height=width*ratioMultiplier}if(/^[^a-zA-Z]/.test(this.id())){idClass="dimensions-"+this.id()}else{idClass=this.id()+"-dimensions"}this.addClass(idClass);stylesheet.setTextContent(this.styleEl_,"\n      ."+idClass+" {\n        width: "+width+"px;\n        height: "+height+"px;\n      }\n\n      ."+idClass+".vjs-fluid {\n        padding-top: "+ratioMultiplier*100+"%;\n      }\n    ")};Player.prototype.loadTech_=function loadTech_(techName,source){if(this.tech_){this.unloadTech_()}if(techName!=="Html5"&&this.tag){_techTechJs2["default"].getTech("Html5").disposeMediaElement(this.tag);this.tag.player=null;this.tag=null}this.techName_=techName;this.isReady_=false;var techOptions=_objectAssign2["default"]({nativeControlsForTouch:this.options_.nativeControlsForTouch,source:source,playerId:this.id(),techId:this.id()+"_"+techName+"_api",videoTracks:this.videoTracks_,textTracks:this.textTracks_,audioTracks:this.audioTracks_,autoplay:this.options_.autoplay,controls:this.options_.controls,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),"vtt.js":this.options_["vtt.js"]},this.options_[techName.toLowerCase()]);if(this.tag){techOptions.tag=this.tag}if(source){this.currentType_=source.type;if(source.src===this.cache_.src&&this.cache_.currentTime>0){techOptions.startTime=this.cache_.currentTime}this.cache_.src=source.src}var techComponent=_techTechJs2["default"].getTech(techName);if(!techComponent){techComponent=_componentJs2["default"].getComponent(techName)}this.tech_=new techComponent(techOptions);this.tech_.ready(Fn.bind(this,this.handleTechReady_),true);_tracksTextTrackListConverterJs2["default"].jsonToTextTracks(this.textTracksJson_||[],this.tech_);this.on(this.tech_,"loadstart",this.handleTechLoadStart_);this.on(this.tech_,"waiting",this.handleTechWaiting_);this.on(this.tech_,"canplay",this.handleTechCanPlay_);this.on(this.tech_,"canplaythrough",this.handleTechCanPlayThrough_);this.on(this.tech_,"playing",this.handleTechPlaying_);this.on(this.tech_,"ended",this.handleTechEnded_);this.on(this.tech_,"seeking",this.handleTechSeeking_);this.on(this.tech_,"seeked",this.handleTechSeeked_);this.on(this.tech_,"play",this.handleTechPlay_);this.on(this.tech_,"firstplay",this.handleTechFirstPlay_);this.on(this.tech_,"pause",this.handleTechPause_);this.on(this.tech_,"progress",this.handleTechProgress_);this.on(this.tech_,"durationchange",this.handleTechDurationChange_);this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_);this.on(this.tech_,"error",this.handleTechError_);this.on(this.tech_,"suspend",this.handleTechSuspend_);this.on(this.tech_,"abort",this.handleTechAbort_);this.on(this.tech_,"emptied",this.handleTechEmptied_);this.on(this.tech_,"stalled",this.handleTechStalled_);this.on(this.tech_,"loadedmetadata",this.handleTechLoadedMetaData_);this.on(this.tech_,"loadeddata",this.handleTechLoadedData_);this.on(this.tech_,"timeupdate",this.handleTechTimeUpdate_);this.on(this.tech_,"ratechange",this.handleTechRateChange_);this.on(this.tech_,"volumechange",this.handleTechVolumeChange_);this.on(this.tech_,"texttrackchange",this.handleTechTextTrackChange_);this.on(this.tech_,"loadedmetadata",this.updateStyleEl_);this.on(this.tech_,"posterchange",this.handleTechPosterChange_);if(this.tech_.el().parentNode!==this.el()&&(techName!=="Html5"||!this.tag)){Dom.insertElFirst(this.tech_.el(),this.el())}if(this.tag){this.tag.player=null;this.tag=null}};Player.prototype.unloadTech_=function unloadTech_(){this.videoTracks_=this.videoTracks();this.textTracks_=this.textTracks();this.audioTracks_=this.audioTracks();this.textTracksJson_=_tracksTextTrackListConverterJs2["default"].textTracksToJson(this.tech_);this.isReady_=false;this.tech_.dispose();this.tech_=false};Player.prototype.tech=function tech(safety){if(safety&&safety.IWillNotUseThisInPlugins){return this.tech_}var errorText="\n      Please make sure that you are not using this inside of a plugin.\n      To disable this alert and error, please pass in an object with\n      `IWillNotUseThisInPlugins` to the `tech` method. See\n      https://github.com/videojs/video.js/issues/2617 for more info.\n    ";_globalWindow2["default"].alert(errorText);throw new Error(errorText)};Player.prototype.addTechControlsListeners_=function addTechControlsListeners_(){this.removeTechControlsListeners_();this.on(this.tech_,"mousedown",this.handleTechClick_);this.on(this.tech_,"touchstart",this.handleTechTouchStart_);this.on(this.tech_,"touchmove",this.handleTechTouchMove_);this.on(this.tech_,"touchend",this.handleTechTouchEnd_);this.on(this.tech_,"tap",this.handleTechTap_)};Player.prototype.removeTechControlsListeners_=function removeTechControlsListeners_(){this.off(this.tech_,"tap",this.handleTechTap_);this.off(this.tech_,"touchstart",this.handleTechTouchStart_);this.off(this.tech_,"touchmove",this.handleTechTouchMove_);this.off(this.tech_,"touchend",this.handleTechTouchEnd_);this.off(this.tech_,"mousedown",this.handleTechClick_)};Player.prototype.handleTechReady_=function handleTechReady_(){this.usingNativeControls(this.techGet_("controls"));if(this.controls()&&!this.usingNativeControls()){this.addTechControlsListeners_()}this.triggerReady();if(this.cache_.volume){this.techCall_("setVolume",this.cache_.volume)}this.handleTechPosterChange_();this.handleTechDurationChange_();if(this.src()&&this.tag&&this.options_.autoplay&&this.paused()){delete this.tag.poster;this.play()}};Player.prototype.handleTechLoadStart_=function handleTechLoadStart_(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);if(!this.paused()){this.trigger("loadstart");this.trigger("firstplay")}else{this.hasStarted(false);this.trigger("loadstart")}};Player.prototype.hasStarted=function hasStarted(_hasStarted){if(_hasStarted!==undefined){if(this.hasStarted_!==_hasStarted){this.hasStarted_=_hasStarted;if(_hasStarted){this.addClass("vjs-has-started");this.trigger("firstplay")}else{this.removeClass("vjs-has-started")}}return this}return!!this.hasStarted_};Player.prototype.handleTechPlay_=function handleTechPlay_(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(true);this.trigger("play")};Player.prototype.handleTechWaiting_=function handleTechWaiting_(){var _this2=this;this.addClass("vjs-waiting");this.trigger("waiting");this.one("timeupdate",function(){return _this2.removeClass("vjs-waiting")})};Player.prototype.handleTechCanPlay_=function handleTechCanPlay_(){this.removeClass("vjs-waiting");this.trigger("canplay")};Player.prototype.handleTechCanPlayThrough_=function handleTechCanPlayThrough_(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")};Player.prototype.handleTechPlaying_=function handleTechPlaying_(){this.removeClass("vjs-waiting");this.trigger("playing")};Player.prototype.handleTechSeeking_=function handleTechSeeking_(){this.addClass("vjs-seeking");this.trigger("seeking")};Player.prototype.handleTechSeeked_=function handleTechSeeked_(){this.removeClass("vjs-seeking");this.trigger("seeked")};Player.prototype.handleTechFirstPlay_=function handleTechFirstPlay_(){if(this.options_.starttime){this.currentTime(this.options_.starttime)}this.addClass("vjs-has-started");this.trigger("firstplay")};Player.prototype.handleTechPause_=function handleTechPause_(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause")};Player.prototype.handleTechProgress_=function handleTechProgress_(){this.trigger("progress")};Player.prototype.handleTechEnded_=function handleTechEnded_(){this.addClass("vjs-ended");if(this.options_.loop){this.currentTime(0);this.play()}else if(!this.paused()){this.pause()}this.trigger("ended")};Player.prototype.handleTechDurationChange_=function handleTechDurationChange_(){this.duration(this.techGet_("duration"))};Player.prototype.handleTechClick_=function handleTechClick_(event){if(event.button!==0)return;if(this.controls()){if(this.paused()){this.play()}else{this.pause()}}};Player.prototype.handleTechTap_=function handleTechTap_(){this.userActive(!this.userActive())};Player.prototype.handleTechTouchStart_=function handleTechTouchStart_(){this.userWasActive=this.userActive()};Player.prototype.handleTechTouchMove_=function handleTechTouchMove_(){if(this.userWasActive){this.reportUserActivity()}};Player.prototype.handleTechTouchEnd_=function handleTechTouchEnd_(event){event.preventDefault()};Player.prototype.handleFullscreenChange_=function handleFullscreenChange_(){if(this.isFullscreen()){this.addClass("vjs-fullscreen")}else{this.removeClass("vjs-fullscreen")}};Player.prototype.handleStageClick_=function handleStageClick_(){this.reportUserActivity()};Player.prototype.handleTechFullscreenChange_=function handleTechFullscreenChange_(event,data){if(data){this.isFullscreen(data.isFullscreen)}this.trigger("fullscreenchange")};Player.prototype.handleTechError_=function handleTechError_(){var error=this.tech_.error();this.error(error&&error.code)};Player.prototype.handleTechSuspend_=function handleTechSuspend_(){this.trigger("suspend")};Player.prototype.handleTechAbort_=function handleTechAbort_(){this.trigger("abort")};Player.prototype.handleTechEmptied_=function handleTechEmptied_(){this.trigger("emptied")};Player.prototype.handleTechStalled_=function handleTechStalled_(){this.trigger("stalled")};Player.prototype.handleTechLoadedMetaData_=function handleTechLoadedMetaData_(){this.trigger("loadedmetadata")};Player.prototype.handleTechLoadedData_=function handleTechLoadedData_(){this.trigger("loadeddata")};Player.prototype.handleTechTimeUpdate_=function handleTechTimeUpdate_(){this.trigger("timeupdate")};Player.prototype.handleTechRateChange_=function handleTechRateChange_(){this.trigger("ratechange")};Player.prototype.handleTechVolumeChange_=function handleTechVolumeChange_(){this.trigger("volumechange")};Player.prototype.handleTechTextTrackChange_=function handleTechTextTrackChange_(){this.trigger("texttrackchange")};Player.prototype.getCache=function getCache(){return this.cache_};Player.prototype.techCall_=function techCall_(method,arg){if(this.tech_&&!this.tech_.isReady_){this.tech_.ready(function(){this[method](arg)},true)}else{try{this.tech_[method](arg)}catch(e){_utilsLogJs2["default"](e);throw e}}};Player.prototype.techGet_=function techGet_(method){if(this.tech_&&this.tech_.isReady_){try{return this.tech_[method]()}catch(e){if(this.tech_[method]===undefined){_utilsLogJs2["default"]("Video.js: "+method+" method not defined for "+this.techName_+" playback technology.",e)}else{if(e.name==="TypeError"){_utilsLogJs2["default"]("Video.js: "+method+" unavailable on "+this.techName_+" playback technology element.",e);this.tech_.isReady_=false}else{_utilsLogJs2["default"](e)}}throw e}}return};Player.prototype.play=function play(){this.techCall_("play");return this};Player.prototype.pause=function pause(){this.techCall_("pause");return this};Player.prototype.paused=function paused(){return this.techGet_("paused")===false?false:true};Player.prototype.scrubbing=function scrubbing(isScrubbing){if(isScrubbing!==undefined){this.scrubbing_=!!isScrubbing;if(isScrubbing){this.addClass("vjs-scrubbing")}else{this.removeClass("vjs-scrubbing")}return this}return this.scrubbing_};Player.prototype.currentTime=function currentTime(seconds){if(seconds!==undefined){this.techCall_("setCurrentTime",seconds);return this}return this.cache_.currentTime=this.techGet_("currentTime")||0};Player.prototype.duration=function duration(seconds){if(seconds===undefined){return this.cache_.duration||0}seconds=parseFloat(seconds)||0;if(seconds<0){seconds=Infinity}if(seconds!==this.cache_.duration){this.cache_.duration=seconds;if(seconds===Infinity){this.addClass("vjs-live")}else{this.removeClass("vjs-live")}this.trigger("durationchange")}return this};Player.prototype.remainingTime=function remainingTime(){return this.duration()-this.currentTime()};Player.prototype.buffered=function buffered(){var buffered=this.techGet_("buffered");if(!buffered||!buffered.length){buffered=_utilsTimeRangesJs.createTimeRange(0,0)}return buffered};Player.prototype.bufferedPercent=function bufferedPercent(){return _utilsBufferJs.bufferedPercent(this.buffered(),this.duration())};Player.prototype.bufferedEnd=function bufferedEnd(){var buffered=this.buffered(),duration=this.duration(),end=buffered.end(buffered.length-1);if(end>duration){end=duration}return end};Player.prototype.volume=function volume(percentAsDecimal){var vol=undefined;if(percentAsDecimal!==undefined){vol=Math.max(0,Math.min(1,parseFloat(percentAsDecimal)));this.cache_.volume=vol;this.techCall_("setVolume",vol);return this}vol=parseFloat(this.techGet_("volume"));return isNaN(vol)?1:vol};Player.prototype.muted=function muted(_muted){if(_muted!==undefined){this.techCall_("setMuted",_muted);return this}return this.techGet_("muted")||false};Player.prototype.supportsFullScreen=function supportsFullScreen(){return this.techGet_("supportsFullScreen")||false};Player.prototype.isFullscreen=function isFullscreen(isFS){if(isFS!==undefined){this.isFullscreen_=!!isFS;return this}return!!this.isFullscreen_};Player.prototype.requestFullscreen=function requestFullscreen(){var fsApi=_fullscreenApiJs2["default"];this.isFullscreen(true);if(fsApi.requestFullscreen){Events.on(_globalDocument2["default"],fsApi.fullscreenchange,Fn.bind(this,function documentFullscreenChange(e){this.isFullscreen(_globalDocument2["default"][fsApi.fullscreenElement]);if(this.isFullscreen()===false){Events.off(_globalDocument2["default"],fsApi.fullscreenchange,documentFullscreenChange)}this.trigger("fullscreenchange")}));this.el_[fsApi.requestFullscreen]()}else if(this.tech_.supportsFullScreen()){this.techCall_("enterFullScreen")}else{this.enterFullWindow();this.trigger("fullscreenchange")}return this};Player.prototype.exitFullscreen=function exitFullscreen(){var fsApi=_fullscreenApiJs2["default"];this.isFullscreen(false);if(fsApi.requestFullscreen){_globalDocument2["default"][fsApi.exitFullscreen]()}else if(this.tech_.supportsFullScreen()){this.techCall_("exitFullScreen")}else{this.exitFullWindow();this.trigger("fullscreenchange")}return this};Player.prototype.enterFullWindow=function enterFullWindow(){this.isFullWindow=true;this.docOrigOverflow=_globalDocument2["default"].documentElement.style.overflow;Events.on(_globalDocument2["default"],"keydown",Fn.bind(this,this.fullWindowOnEscKey));_globalDocument2["default"].documentElement.style.overflow="hidden";Dom.addElClass(_globalDocument2["default"].body,"vjs-full-window");this.trigger("enterFullWindow")};Player.prototype.fullWindowOnEscKey=function fullWindowOnEscKey(event){if(event.keyCode===27){if(this.isFullscreen()===true){this.exitFullscreen()}else{this.exitFullWindow()}}};Player.prototype.exitFullWindow=function exitFullWindow(){this.isFullWindow=false;Events.off(_globalDocument2["default"],"keydown",this.fullWindowOnEscKey);
_globalDocument2["default"].documentElement.style.overflow=this.docOrigOverflow;Dom.removeElClass(_globalDocument2["default"].body,"vjs-full-window");this.trigger("exitFullWindow")};Player.prototype.canPlayType=function canPlayType(type){var can=undefined;for(var i=0,j=this.options_.techOrder;i<j.length;i++){var techName=_utilsToTitleCaseJs2["default"](j[i]);var tech=_techTechJs2["default"].getTech(techName);if(!tech){tech=_componentJs2["default"].getComponent(techName)}if(!tech){_utilsLogJs2["default"].error('The "'+techName+'" tech is undefined. Skipped browser support check for that tech.');continue}if(tech.isSupported()){can=tech.canPlayType(type);if(can){return can}}}return""};Player.prototype.selectSource=function selectSource(sources){var techs=this.options_.techOrder.map(_utilsToTitleCaseJs2["default"]).map(function(techName){return[techName,_techTechJs2["default"].getTech(techName)||_componentJs2["default"].getComponent(techName)]}).filter(function(_ref){var techName=_ref[0];var tech=_ref[1];if(tech){return tech.isSupported()}_utilsLogJs2["default"].error('The "'+techName+'" tech is undefined. Skipped browser support check for that tech.');return false});var findFirstPassingTechSourcePair=function findFirstPassingTechSourcePair(outerArray,innerArray,tester){var found=undefined;outerArray.some(function(outerChoice){return innerArray.some(function(innerChoice){found=tester(outerChoice,innerChoice);if(found){return true}})});return found};var foundSourceAndTech=undefined;var flip=function flip(fn){return function(a,b){return fn(b,a)}};var finder=function finder(_ref2,source){var techName=_ref2[0];var tech=_ref2[1];if(tech.canPlaySource(source)){return{source:source,tech:techName}}};if(this.options_.sourceOrder){foundSourceAndTech=findFirstPassingTechSourcePair(sources,techs,flip(finder))}else{foundSourceAndTech=findFirstPassingTechSourcePair(techs,sources,finder)}return foundSourceAndTech||false};Player.prototype.src=function src(source){if(source===undefined){return this.techGet_("src")}var currentTech=_techTechJs2["default"].getTech(this.techName_);if(!currentTech){currentTech=_componentJs2["default"].getComponent(this.techName_)}if(Array.isArray(source)){this.sourceList_(source)}else if(typeof source==="string"){this.src({src:source})}else if(source instanceof Object){if(source.type&&!currentTech.canPlaySource(source)){this.sourceList_([source])}else{this.cache_.src=source.src;this.currentType_=source.type||"";this.ready(function(){if(currentTech.prototype.hasOwnProperty("setSource")){this.techCall_("setSource",source)}else{this.techCall_("src",source.src)}if(this.options_.preload==="auto"){this.load()}if(this.options_.autoplay){this.play()}},true)}}return this};Player.prototype.sourceList_=function sourceList_(sources){var sourceTech=this.selectSource(sources);if(sourceTech){if(sourceTech.tech===this.techName_){this.src(sourceTech.source)}else{this.loadTech_(sourceTech.tech,sourceTech.source)}}else{this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);this.triggerReady()}};Player.prototype.load=function load(){this.techCall_("load");return this};Player.prototype.reset=function reset(){this.loadTech_(_utilsToTitleCaseJs2["default"](this.options_.techOrder[0]),null);this.techCall_("reset");return this};Player.prototype.currentSrc=function currentSrc(){return this.techGet_("currentSrc")||this.cache_.src||""};Player.prototype.currentType=function currentType(){return this.currentType_||""};Player.prototype.preload=function preload(value){if(value!==undefined){this.techCall_("setPreload",value);this.options_.preload=value;return this}return this.techGet_("preload")};Player.prototype.autoplay=function autoplay(value){if(value!==undefined){this.techCall_("setAutoplay",value);this.options_.autoplay=value;return this}return this.techGet_("autoplay",value)};Player.prototype.loop=function loop(value){if(value!==undefined){this.techCall_("setLoop",value);this.options_["loop"]=value;return this}return this.techGet_("loop")};Player.prototype.poster=function poster(src){if(src===undefined){return this.poster_}if(!src){src=""}this.poster_=src;this.techCall_("setPoster",src);this.trigger("posterchange");return this};Player.prototype.handleTechPosterChange_=function handleTechPosterChange_(){if(!this.poster_&&this.tech_&&this.tech_.poster){this.poster_=this.tech_.poster()||"";this.trigger("posterchange")}};Player.prototype.controls=function controls(bool){if(bool!==undefined){bool=!!bool;if(this.controls_!==bool){this.controls_=bool;if(this.usingNativeControls()){this.techCall_("setControls",bool)}if(bool){this.removeClass("vjs-controls-disabled");this.addClass("vjs-controls-enabled");this.trigger("controlsenabled");if(!this.usingNativeControls()){this.addTechControlsListeners_()}}else{this.removeClass("vjs-controls-enabled");this.addClass("vjs-controls-disabled");this.trigger("controlsdisabled");if(!this.usingNativeControls()){this.removeTechControlsListeners_()}}}return this}return!!this.controls_};Player.prototype.usingNativeControls=function usingNativeControls(bool){if(bool!==undefined){bool=!!bool;if(this.usingNativeControls_!==bool){this.usingNativeControls_=bool;if(bool){this.addClass("vjs-using-native-controls");this.trigger("usingnativecontrols")}else{this.removeClass("vjs-using-native-controls");this.trigger("usingcustomcontrols")}}return this}return!!this.usingNativeControls_};Player.prototype.error=function error(err){if(err===undefined){return this.error_||null}if(err===null){this.error_=err;this.removeClass("vjs-error");this.errorDisplay.close();return this}if(err instanceof _mediaErrorJs2["default"]){this.error_=err}else{this.error_=new _mediaErrorJs2["default"](err)}this.addClass("vjs-error");_utilsLogJs2["default"].error("(CODE:"+this.error_.code+" "+_mediaErrorJs2["default"].errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error");return this};Player.prototype.ended=function ended(){return this.techGet_("ended")};Player.prototype.seeking=function seeking(){return this.techGet_("seeking")};Player.prototype.seekable=function seekable(){return this.techGet_("seekable")};Player.prototype.reportUserActivity=function reportUserActivity(event){this.userActivity_=true};Player.prototype.userActive=function userActive(bool){if(bool!==undefined){bool=!!bool;if(bool!==this.userActive_){this.userActive_=bool;if(bool){this.userActivity_=true;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive")}else{this.userActivity_=false;if(this.tech_){this.tech_.one("mousemove",function(e){e.stopPropagation();e.preventDefault()})}this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")}}return this}return this.userActive_};Player.prototype.listenForUserActivity_=function listenForUserActivity_(){var mouseInProgress=undefined,lastMoveX=undefined,lastMoveY=undefined;var handleActivity=Fn.bind(this,this.reportUserActivity);var handleMouseMove=function handleMouseMove(e){if(e.screenX!==lastMoveX||e.screenY!==lastMoveY){lastMoveX=e.screenX;lastMoveY=e.screenY;handleActivity()}};var handleMouseDown=function handleMouseDown(){handleActivity();this.clearInterval(mouseInProgress);mouseInProgress=this.setInterval(handleActivity,250)};var handleMouseUp=function handleMouseUp(event){handleActivity();this.clearInterval(mouseInProgress)};this.on("mousedown",handleMouseDown);this.on("mousemove",handleMouseMove);this.on("mouseup",handleMouseUp);this.on("keydown",handleActivity);this.on("keyup",handleActivity);var inactivityTimeout=undefined;var activityCheck=this.setInterval(function(){if(this.userActivity_){this.userActivity_=false;this.userActive(true);this.clearTimeout(inactivityTimeout);var timeout=this.options_["inactivityTimeout"];if(timeout>0){inactivityTimeout=this.setTimeout(function(){if(!this.userActivity_){this.userActive(false)}},timeout)}}},250)};Player.prototype.playbackRate=function playbackRate(rate){if(rate!==undefined){this.techCall_("setPlaybackRate",rate);return this}if(this.tech_&&this.tech_["featuresPlaybackRate"]){return this.techGet_("playbackRate")}else{return 1}};Player.prototype.isAudio=function isAudio(bool){if(bool!==undefined){this.isAudio_=!!bool;return this}return!!this.isAudio_};Player.prototype.networkState=function networkState(){return this.techGet_("networkState")};Player.prototype.readyState=function readyState(){return this.techGet_("readyState")};Player.prototype.videoTracks=function videoTracks(){if(!this.tech_){this.videoTracks_=this.videoTracks_||new _tracksVideoTrackListJs2["default"];return this.videoTracks_}return this.tech_.videoTracks()};Player.prototype.audioTracks=function audioTracks(){if(!this.tech_){this.audioTracks_=this.audioTracks_||new _tracksAudioTrackListJs2["default"];return this.audioTracks_}return this.tech_.audioTracks()};Player.prototype.textTracks=function textTracks(){return this.tech_&&this.tech_["textTracks"]()};Player.prototype.remoteTextTracks=function remoteTextTracks(){return this.tech_&&this.tech_["remoteTextTracks"]()};Player.prototype.remoteTextTrackEls=function remoteTextTrackEls(){return this.tech_&&this.tech_["remoteTextTrackEls"]()};Player.prototype.addTextTrack=function addTextTrack(kind,label,language){return this.tech_&&this.tech_["addTextTrack"](kind,label,language)};Player.prototype.addRemoteTextTrack=function addRemoteTextTrack(options){return this.tech_&&this.tech_["addRemoteTextTrack"](options)};Player.prototype.removeRemoteTextTrack=function removeRemoteTextTrack(){var _ref3=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var _ref3$track=_ref3.track;var track=_ref3$track===undefined?arguments[0]:_ref3$track;this.tech_&&this.tech_["removeRemoteTextTrack"](track)};Player.prototype.videoWidth=function videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0};Player.prototype.videoHeight=function videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0};Player.prototype.language=function language(code){if(code===undefined){return this.language_}this.language_=(""+code).toLowerCase();return this};Player.prototype.languages=function languages(){return _utilsMergeOptionsJs2["default"](Player.prototype.options_.languages,this.languages_)};Player.prototype.toJSON=function toJSON(){var options=_utilsMergeOptionsJs2["default"](this.options_);var tracks=options.tracks;options.tracks=[];for(var i=0;i<tracks.length;i++){var track=tracks[i];track=_utilsMergeOptionsJs2["default"](track);track.player=undefined;options.tracks[i]=track}return options};Player.prototype.createModal=function createModal(content,options){var player=this;options=options||{};options.content=content||"";var modal=new _modalDialog2["default"](player,options);player.addChild(modal);modal.on("dispose",function(){player.removeChild(modal)});return modal.open()};Player.getTagSettings=function getTagSettings(tag){var baseOptions={sources:[],tracks:[]};var tagOptions=Dom.getElAttributes(tag);var dataSetup=tagOptions["data-setup"];if(dataSetup!==null){var _safeParseTuple=_safeJsonParseTuple2["default"](dataSetup||"{}");var err=_safeParseTuple[0];var data=_safeParseTuple[1];if(err){_utilsLogJs2["default"].error(err)}_objectAssign2["default"](tagOptions,data)}_objectAssign2["default"](baseOptions,tagOptions);if(tag.hasChildNodes()){var children=tag.childNodes;for(var i=0,j=children.length;i<j;i++){var child=children[i];var childName=child.nodeName.toLowerCase();if(childName==="source"){baseOptions.sources.push(Dom.getElAttributes(child))}else if(childName==="track"){baseOptions.tracks.push(Dom.getElAttributes(child))}}}return baseOptions};return Player}(_componentJs2["default"]);Player.players={};var navigator=_globalWindow2["default"].navigator;Player.prototype.options_={techOrder:["html5","flash"],html5:{},flash:{},defaultVolume:0,inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:_globalDocument2["default"].getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language||"en",languages:{},notSupportedMessage:"No compatible source was found for this media."};Player.prototype.handleLoadedMetaData_;Player.prototype.handleLoadedData_;Player.prototype.handleUserActive_;Player.prototype.handleUserInactive_;Player.prototype.handleTimeUpdate_;Player.prototype.handleTechEnded_;Player.prototype.handleVolumeChange_;Player.prototype.handleError_;Player.prototype.flexNotSupported_=function(){var elem=_globalDocument2["default"].createElement("i");return!("flexBasis"in elem.style||"webkitFlexBasis"in elem.style||"mozFlexBasis"in elem.style||"msFlexBasis"in elem.style||"msFlexOrder"in elem.style)};_componentJs2["default"].registerComponent("Player",Player);exports["default"]=Player;module.exports=exports["default"]},{"./big-play-button.js":64,"./component.js":68,"./control-bar/control-bar.js":71,"./error-display.js":105,"./fullscreen-api.js":108,"./loading-spinner.js":109,"./media-error.js":110,"./modal-dialog":114,"./poster-image.js":119,"./tech/html5.js":124,"./tech/loader.js":125,"./tech/tech.js":126,"./tracks/audio-track-list.js":128,"./tracks/text-track-display.js":133,"./tracks/text-track-list-converter.js":134,"./tracks/text-track-settings.js":136,"./tracks/video-track-list.js":141,"./utils/browser.js":143,"./utils/buffer.js":144,"./utils/dom.js":146,"./utils/events.js":147,"./utils/fn.js":148,"./utils/guid.js":150,"./utils/log.js":151,"./utils/merge-options.js":152,"./utils/stylesheet.js":153,"./utils/time-ranges.js":154,"./utils/to-title-case.js":155,"global/document":9,"global/window":10,"object.assign":53,"safe-json-parse/tuple":59}],116:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _playerJs=_dereq_("./player.js");var _playerJs2=_interopRequireDefault(_playerJs);var plugin=function plugin(name,init){_playerJs2["default"].prototype[name]=init};exports["default"]=plugin;module.exports=exports["default"]},{"./player.js":115}],117:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _clickableComponentJs=_dereq_("../clickable-component.js");var _clickableComponentJs2=_interopRequireDefault(_clickableComponentJs);var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _popupJs=_dereq_("./popup.js");var _popupJs2=_interopRequireDefault(_popupJs);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsToTitleCaseJs=_dereq_("../utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var PopupButton=function(_ClickableComponent){_inherits(PopupButton,_ClickableComponent);function PopupButton(player){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];_classCallCheck(this,PopupButton);_ClickableComponent.call(this,player,options);this.update()}PopupButton.prototype.update=function update(){var popup=this.createPopup();if(this.popup){this.removeChild(this.popup)}this.popup=popup;this.addChild(popup);if(this.items&&this.items.length===0){this.hide()}else if(this.items&&this.items.length>1){this.show()}};PopupButton.prototype.createPopup=function createPopup(){};PopupButton.prototype.createEl=function createEl(){return _ClickableComponent.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})};PopupButton.prototype.buildCSSClass=function buildCSSClass(){var menuButtonClass="vjs-menu-button";if(this.options_.inline===true){menuButtonClass+="-inline"}else{menuButtonClass+="-popup"}return"vjs-menu-button "+menuButtonClass+" "+_ClickableComponent.prototype.buildCSSClass.call(this)};PopupButton.prototype.tooltipHandler=function tooltipHandler(){return};return PopupButton}(_clickableComponentJs2["default"]);_componentJs2["default"].registerComponent("PopupButton",PopupButton);exports["default"]=PopupButton;module.exports=exports["default"]},{"../clickable-component.js":66,"../component.js":68,"../utils/dom.js":146,"../utils/fn.js":148,"../utils/to-title-case.js":155,"./popup.js":118}],118:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsEventsJs=_dereq_("../utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var Popup=function(_Component){_inherits(Popup,_Component);function Popup(){_classCallCheck(this,Popup);_Component.apply(this,arguments)}Popup.prototype.addItem=function addItem(component){this.addChild(component);component.on("click",Fn.bind(this,function(){this.unlockShowing()}))};Popup.prototype.createEl=function createEl(){var contentElType=this.options_.contentElType||"ul";this.contentEl_=Dom.createEl(contentElType,{className:"vjs-menu-content"});var el=_Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});el.appendChild(this.contentEl_);Events.on(el,"click",function(event){event.preventDefault();event.stopImmediatePropagation()});return el};return Popup}(_componentJs2["default"]);_componentJs2["default"].registerComponent("Popup",Popup);exports["default"]=Popup;module.exports=exports["default"]},{"../component.js":68,"../utils/dom.js":146,"../utils/events.js":147,"../utils/fn.js":148}],119:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _clickableComponentJs=_dereq_("./clickable-component.js");var _clickableComponentJs2=_interopRequireDefault(_clickableComponentJs);var _componentJs=_dereq_("./component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsBrowserJs=_dereq_("./utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var PosterImage=function(_ClickableComponent){_inherits(PosterImage,_ClickableComponent);function PosterImage(player,options){_classCallCheck(this,PosterImage);_ClickableComponent.call(this,player,options);this.update();player.on("posterchange",Fn.bind(this,this.update))}PosterImage.prototype.dispose=function dispose(){this.player().off("posterchange",this.update);_ClickableComponent.prototype.dispose.call(this)};PosterImage.prototype.createEl=function createEl(){var el=Dom.createEl("div",{className:"vjs-poster",tabIndex:-1});if(!browser.BACKGROUND_SIZE_SUPPORTED){this.fallbackImg_=Dom.createEl("img");el.appendChild(this.fallbackImg_)}return el};PosterImage.prototype.update=function update(){var url=this.player().poster();this.setSrc(url);if(url){this.show()}else{this.hide()}};PosterImage.prototype.setSrc=function setSrc(url){if(this.fallbackImg_){this.fallbackImg_.src=url}else{var backgroundImage="";if(url){backgroundImage='url("'+url+'")'}this.el_.style.backgroundImage=backgroundImage}};PosterImage.prototype.handleClick=function handleClick(){if(this.player_.paused()){this.player_.play()}else{this.player_.pause()}};return PosterImage}(_clickableComponentJs2["default"]);_componentJs2["default"].registerComponent("PosterImage",PosterImage);exports["default"]=PosterImage;module.exports=exports["default"]},{"./clickable-component.js":66,"./component.js":68,"./utils/browser.js":143,"./utils/dom.js":146,"./utils/fn.js":148}],120:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _windowLoaded=false;var videojs=undefined;var autoSetup=function autoSetup(){var vids=_globalDocument2["default"].getElementsByTagName("video");var audios=_globalDocument2["default"].getElementsByTagName("audio");var mediaEls=[];if(vids&&vids.length>0){for(var i=0,e=vids.length;i<e;i++){mediaEls.push(vids[i])}}if(audios&&audios.length>0){for(var i=0,e=audios.length;i<e;i++){mediaEls.push(audios[i])}}if(mediaEls&&mediaEls.length>0){for(var i=0,e=mediaEls.length;i<e;i++){var mediaEl=mediaEls[i];if(mediaEl&&mediaEl.getAttribute){if(mediaEl["player"]===undefined){var options=mediaEl.getAttribute("data-setup");if(options!==null){var player=videojs(mediaEl)}}}else{autoSetupTimeout(1);break}}}else if(!_windowLoaded){autoSetupTimeout(1)}};var autoSetupTimeout=function autoSetupTimeout(wait,vjs){if(vjs){videojs=vjs}setTimeout(autoSetup,wait)};if(_globalDocument2["default"].readyState==="complete"){_windowLoaded=true}else{Events.one(_globalWindow2["default"],"load",function(){_windowLoaded=true})}var hasLoaded=function hasLoaded(){return _windowLoaded};exports.autoSetup=autoSetup;exports.autoSetupTimeout=autoSetupTimeout;exports.hasLoaded=hasLoaded},{"./utils/events.js":147,"global/document":9,"global/window":10}],121:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var Slider=function(_Component){_inherits(Slider,_Component);function Slider(player,options){_classCallCheck(this,Slider);_Component.call(this,player,options);this.bar=this.getChild(this.options_.barName);this.vertical(!!this.options_.vertical);this.on("mousedown",this.handleMouseDown);this.on("touchstart",this.handleMouseDown);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur);this.on("click",this.handleClick);this.on(player,"controlsvisible",this.update);this.on(player,this.playerEvent,this.update)}Slider.prototype.createEl=function createEl(type){var props=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var attributes=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];props.className=props.className+" vjs-slider";props=_objectAssign2["default"]({tabIndex:0},props);attributes=_objectAssign2["default"]({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},attributes);return _Component.prototype.createEl.call(this,type,props,attributes)};Slider.prototype.handleMouseDown=function handleMouseDown(event){var doc=this.bar.el_.ownerDocument;event.preventDefault();Dom.blockTextSelection();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(doc,"mousemove",this.handleMouseMove);this.on(doc,"mouseup",this.handleMouseUp);this.on(doc,"touchmove",this.handleMouseMove);this.on(doc,"touchend",this.handleMouseUp);this.handleMouseMove(event)};Slider.prototype.handleMouseMove=function handleMouseMove(){};Slider.prototype.handleMouseUp=function handleMouseUp(){var doc=this.bar.el_.ownerDocument;Dom.unblockTextSelection();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(doc,"mousemove",this.handleMouseMove);this.off(doc,"mouseup",this.handleMouseUp);this.off(doc,"touchmove",this.handleMouseMove);this.off(doc,"touchend",this.handleMouseUp);this.update()};Slider.prototype.update=function update(){if(!this.el_)return;var progress=this.getPercent();var bar=this.bar;if(!bar)return;if(typeof progress!=="number"||progress!==progress||progress<0||progress===Infinity){progress=0}var percentage=(progress*100).toFixed(2)+"%";if(this.vertical()){bar.el().style.height=percentage}else{bar.el().style.width=percentage}};Slider.prototype.calculateDistance=function calculateDistance(event){var position=Dom.getPointerPosition(this.el_,event);if(this.vertical()){return position.y}return position.x};Slider.prototype.handleFocus=function handleFocus(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)};Slider.prototype.handleKeyPress=function handleKeyPress(event){if(event.which===37||event.which===40){event.preventDefault();this.stepBack()}else if(event.which===38||event.which===39){event.preventDefault();this.stepForward()}};Slider.prototype.handleBlur=function handleBlur(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)};Slider.prototype.handleClick=function handleClick(event){event.stopImmediatePropagation();event.preventDefault()};Slider.prototype.vertical=function vertical(bool){if(bool===undefined){return this.vertical_||false}this.vertical_=!!bool;if(this.vertical_){this.addClass("vjs-slider-vertical")}else{this.addClass("vjs-slider-horizontal")}return this};return Slider}(_componentJs2["default"]);_componentJs2["default"].registerComponent("Slider",Slider);exports["default"]=Slider;module.exports=exports["default"]},{"../component.js":68,"../utils/dom.js":146,"object.assign":53}],122:[function(_dereq_,module,exports){exports.__esModule=true;function FlashRtmpDecorator(Flash){Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"};Flash.streamFromParts=function(connection,stream){return connection+"&"+stream};Flash.streamToParts=function(src){var parts={connection:"",stream:""};if(!src)return parts;var connEnd=src.search(/&(?!\w+=)/);var streamBegin=undefined;if(connEnd!==-1){streamBegin=connEnd+1}else{connEnd=streamBegin=src.lastIndexOf("/")+1;if(connEnd===0){connEnd=streamBegin=src.length}}parts.connection=src.substring(0,connEnd);parts.stream=src.substring(streamBegin,src.length);return parts};Flash.isStreamingType=function(srcType){return srcType in Flash.streamingFormats};Flash.RTMP_RE=/^rtmp[set]?:\/\//i;Flash.isStreamingSrc=function(src){return Flash.RTMP_RE.test(src)};Flash.rtmpSourceHandler={};Flash.rtmpSourceHandler.canPlayType=function(type){if(Flash.isStreamingType(type)){return"maybe"}return""};Flash.rtmpSourceHandler.canHandleSource=function(source){var can=Flash.rtmpSourceHandler.canPlayType(source.type);if(can){return can}if(Flash.isStreamingSrc(source.src)){return"maybe"}return""};Flash.rtmpSourceHandler.handleSource=function(source,tech,options){var srcParts=Flash.streamToParts(source.src);tech["setRtmpConnection"](srcParts.connection);tech["setRtmpStream"](srcParts.stream)};Flash.registerSourceHandler(Flash.rtmpSourceHandler);return Flash}exports["default"]=FlashRtmpDecorator;module.exports=exports["default"]},{}],123:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _tech=_dereq_("./tech");var _tech2=_interopRequireDefault(_tech);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsUrlJs=_dereq_("../utils/url.js");var Url=_interopRequireWildcard(_utilsUrlJs);var _utilsTimeRangesJs=_dereq_("../utils/time-ranges.js");var _flashRtmp=_dereq_("./flash-rtmp");var _flashRtmp2=_interopRequireDefault(_flashRtmp);var _component=_dereq_("../component");
var _component2=_interopRequireDefault(_component);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var navigator=_globalWindow2["default"].navigator;var Flash=function(_Tech){_inherits(Flash,_Tech);function Flash(options,ready){_classCallCheck(this,Flash);_Tech.call(this,options,ready);if(options.source){this.ready(function(){this.setSource(options.source)},true)}if(options.startTime){this.ready(function(){this.load();this.play();this.currentTime(options.startTime)},true)}_globalWindow2["default"].videojs=_globalWindow2["default"].videojs||{};_globalWindow2["default"].videojs.Flash=_globalWindow2["default"].videojs.Flash||{};_globalWindow2["default"].videojs.Flash.onReady=Flash.onReady;_globalWindow2["default"].videojs.Flash.onEvent=Flash.onEvent;_globalWindow2["default"].videojs.Flash.onError=Flash.onError;this.on("seeked",function(){this.lastSeekTarget_=undefined})}Flash.prototype.createEl=function createEl(){var options=this.options_;if(!options.swf){options.swf="//cdn.rawgit.com/hola/video-js-swf-sv/v5.1.0-4/dist/video-js.swf"}var objId=options.techId;if(options.accelerated){options.params=_objectAssign2["default"](options.params||{},{allowfullscreen:true,wmode:"direct"})}var flashVars=_objectAssign2["default"]({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",accelerated:options.accelerated,autoplay:options.autoplay,controls:options.controls,poster:options.poster,preload:options.preload,loop:options.loop,muted:options.muted},options.flashVars);var params=_objectAssign2["default"]({allowfullscreen:true,wmode:"opaque",bgcolor:"#000000"},options.params);var attributes=_objectAssign2["default"]({id:objId,name:objId,"class":"vjs-tech"},options.attributes);this.el_=Flash.embed(options.swf,flashVars,params,attributes);this.el_.tech=this;return this.el_};Flash.prototype.play=function play(){if(this.ended()){this.setCurrentTime(0)}this.el_.vjs_play()};Flash.prototype.pause=function pause(){this.el_.vjs_pause()};Flash.prototype.src=function src(_src){if(_src===undefined){return this.currentSrc()}return this.setSrc(_src)};Flash.prototype.setSrc=function setSrc(src){src=Url.getAbsoluteURL(src);this.el_.vjs_src(src);if(this.autoplay()){var tech=this;this.setTimeout(function(){tech.play()},0)}};Flash.prototype.seeking=function seeking(){return this.lastSeekTarget_!==undefined};Flash.prototype.setCurrentTime=function setCurrentTime(time){var seekable=this.seekable();if(seekable.length){time=time>seekable.start(0)?time:seekable.start(0);time=time<seekable.end(seekable.length-1)?time:seekable.end(seekable.length-1);this.lastSeekTarget_=time;this.trigger("seeking");this.el_.vjs_setProperty("currentTime",time);_Tech.prototype.setCurrentTime.call(this)}};Flash.prototype.currentTime=function currentTime(time){if(this.seeking()){return this.lastSeekTarget_||0}return this.el_.vjs_getProperty("currentTime")};Flash.prototype.currentSrc=function currentSrc(){if(this.currentSource_){return this.currentSource_.src}else{return this.el_.vjs_getProperty("currentSrc")}};Flash.prototype.load=function load(){this.el_.vjs_load()};Flash.prototype.seekable=function seekable(){var duration=this.duration();if(duration===0){return _utilsTimeRangesJs.createTimeRange()}return _utilsTimeRangesJs.createTimeRange(0,duration)};Flash.prototype.buffered=function buffered(){var ranges=this.el_.vjs_getProperty("buffered");if(ranges.length===0){return _utilsTimeRangesJs.createTimeRange()}return _utilsTimeRangesJs.createTimeRange(ranges[0][0],ranges[0][1])};Flash.prototype.supportsFullScreen=function supportsFullScreen(){return false};Flash.prototype.enterFullScreen=function enterFullScreen(){return false};return Flash}(_tech2["default"]);var _api=Flash.prototype;var _readWrite="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted,poster".split(",");var _readOnly="networkState,readyState,initialTime,duration,startOffsetTime,paused,ended,videoWidth,videoHeight".split(",");function _createSetter(attr){var attrUpper=attr.charAt(0).toUpperCase()+attr.slice(1);_api["set"+attrUpper]=function(val){return this.el_.vjs_setProperty(attr,val)}}function _createGetter(attr){_api[attr]=function(){return this.el_.vjs_getProperty(attr)}}for(var i=0;i<_readWrite.length;i++){_createGetter(_readWrite[i]);_createSetter(_readWrite[i])}for(var i=0;i<_readOnly.length;i++){_createGetter(_readOnly[i])}Flash.isSupported=function(){return Flash.version()[0]>=10};_tech2["default"].withSourceHandlers(Flash);Flash.nativeSourceHandler={};Flash.nativeSourceHandler.canPlayType=function(type){if(type in Flash.formats){return"maybe"}return""};Flash.nativeSourceHandler.canHandleSource=function(source){var type;function guessMimeType(src){var ext=Url.getFileExtension(src);if(ext){return"video/"+ext}return""}if(!source.type){type=guessMimeType(source.src)}else{type=source.type.replace(/;.*/,"").toLowerCase()}return Flash.nativeSourceHandler.canPlayType(type)};Flash.nativeSourceHandler.handleSource=function(source,tech,options){tech.setSrc(source.src)};Flash.nativeSourceHandler.dispose=function(){};Flash.registerSourceHandler(Flash.nativeSourceHandler);Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"};Flash.onReady=function(currSwf){var el=Dom.getEl(currSwf);var tech=el&&el.tech;if(tech&&tech.el()){Flash.checkReady(tech)}};Flash.checkReady=function(tech){if(!tech.el()){return}if(tech.el().vjs_getProperty){tech.triggerReady()}else{this.setTimeout(function(){Flash["checkReady"](tech)},50)}};Flash.onEvent=function(swfID,eventName){var tech=Dom.getEl(swfID).tech;tech.trigger(eventName)};Flash.onError=function(swfID,err){var tech=Dom.getEl(swfID).tech;if(err==="srcnotfound"){return tech.error(4)}tech.error("FLASH: "+err)};Flash.version=function(){var version="0,0,0";try{version=new _globalWindow2["default"].ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){version=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}}catch(err){}}return version.split(",")};Flash.embed=function(swf,flashVars,params,attributes){var code=Flash.getEmbedCode(swf,flashVars,params,attributes);var obj=Dom.createEl("div",{innerHTML:code}).childNodes[0];return obj};Flash.getEmbedCode=function(swf,flashVars,params,attributes){var objTag='<object type="application/x-shockwave-flash" ';var flashVarsString="";var paramsString="";var attrsString="";if(flashVars){Object.getOwnPropertyNames(flashVars).forEach(function(key){flashVarsString+=key+"="+flashVars[key]+"&amp;"})}params=_objectAssign2["default"]({movie:swf,flashvars:flashVarsString,allowScriptAccess:"always",allowNetworking:"all"},params);Object.getOwnPropertyNames(params).forEach(function(key){paramsString+='<param name="'+key+'" value="'+params[key]+'" />'});attributes=_objectAssign2["default"]({data:swf,width:"100%",height:"100%"},attributes);Object.getOwnPropertyNames(attributes).forEach(function(key){attrsString+=key+'="'+attributes[key]+'" '});return""+objTag+attrsString+">"+paramsString+"</object>"};_flashRtmp2["default"](Flash);_component2["default"].registerComponent("Flash",Flash);_tech2["default"].registerTech("Flash",Flash);exports["default"]=Flash;module.exports=exports["default"]},{"../component":68,"../utils/dom.js":146,"../utils/time-ranges.js":154,"../utils/url.js":156,"./flash-rtmp":122,"./tech":126,"global/window":10,"object.assign":53}],124:[function(_dereq_,module,exports){exports.__esModule=true;var _templateObject=_taggedTemplateLiteralLoose(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used. \n            This may prevent text tracks from loading."],["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used. \n            This may prevent text tracks from loading."]);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _taggedTemplateLiteralLoose(strings,raw){strings.raw=raw;return strings}var _techJs=_dereq_("./tech.js");var _techJs2=_interopRequireDefault(_techJs);var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _utilsDomJs=_dereq_("../utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsUrlJs=_dereq_("../utils/url.js");var Url=_interopRequireWildcard(_utilsUrlJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsLogJs=_dereq_("../utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _tsml=_dereq_("tsml");var _tsml2=_interopRequireDefault(_tsml);var _srcJsTracksTextTrackJs=_dereq_("../../../src/js/tracks/text-track.js");var _srcJsTracksTextTrackJs2=_interopRequireDefault(_srcJsTracksTextTrackJs);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var _utilsMergeOptionsJs=_dereq_("../utils/merge-options.js");var _utilsMergeOptionsJs2=_interopRequireDefault(_utilsMergeOptionsJs);var _utilsToTitleCaseJs=_dereq_("../utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var Html5=function(_Tech){_inherits(Html5,_Tech);function Html5(options,ready){var _this=this;_classCallCheck(this,Html5);_Tech.call(this,options,ready);var source=options.source;var crossoriginTracks=false;if(source&&(this.el_.currentSrc!==source.src||options.tag&&options.tag.initNetworkState_===3)){this.setSource(source)}else{this.handleLateInit_(this.el_)}if(this.el_.hasChildNodes()){var nodes=this.el_.childNodes;var nodesLength=nodes.length;var removeNodes=[];while(nodesLength--){var node=nodes[nodesLength];var nodeName=node.nodeName.toLowerCase();if(nodeName==="track"){if(!this.featuresNativeTextTracks){removeNodes.push(node)}else{this.remoteTextTrackEls().addTrackElement_(node);this.remoteTextTracks().addTrack_(node.track);if(!crossoriginTracks&&!this.el_.hasAttribute("crossorigin")&&Url.isCrossOrigin(node.src)){crossoriginTracks=true}}}}for(var i=0;i<removeNodes.length;i++){this.el_.removeChild(removeNodes[i])}}var trackTypes=["audio","video"];trackTypes.forEach(function(type){var capitalType=_utilsToTitleCaseJs2["default"](type);if(!_this["featuresNative"+capitalType+"Tracks"]){return}var tl=_this.el()[type+"Tracks"];if(tl&&tl.addEventListener){tl.addEventListener("change",Fn.bind(_this,_this["handle"+capitalType+"TrackChange_"]));tl.addEventListener("addtrack",Fn.bind(_this,_this["handle"+capitalType+"TrackAdd_"]));tl.addEventListener("removetrack",Fn.bind(_this,_this["handle"+capitalType+"TrackRemove_"]))}});if(this.featuresNativeTextTracks){if(crossoriginTracks){_utilsLogJs2["default"].warn(_tsml2["default"](_templateObject))}this.handleTextTrackChange_=Fn.bind(this,this.handleTextTrackChange);this.handleTextTrackAdd_=Fn.bind(this,this.handleTextTrackAdd);this.handleTextTrackRemove_=Fn.bind(this,this.handleTextTrackRemove);this.proxyNativeTextTracks_()}if(browser.TOUCH_ENABLED&&options.nativeControlsForTouch===true||browser.IS_IPHONE||browser.IS_NATIVE_ANDROID){this.setControls(true)}this.triggerReady()}Html5.prototype.dispose=function dispose(){var _this2=this;["audio","video","text"].forEach(function(type){var capitalType=_utilsToTitleCaseJs2["default"](type);var tl=_this2.el_[type+"Tracks"];if(tl&&tl.removeEventListener){tl.removeEventListener("change",_this2["handle"+capitalType+"TrackChange_"]);tl.removeEventListener("addtrack",_this2["handle"+capitalType+"TrackAdd_"]);tl.removeEventListener("removetrack",_this2["handle"+capitalType+"TrackRemove_"])}});Html5.disposeMediaElement(this.el_);_Tech.prototype.dispose.call(this)};Html5.prototype.createEl=function createEl(){var el=this.options_.tag;if(!el||this["movingMediaElementInDOM"]===false){if(el){var clone=el.cloneNode(true);el.parentNode.insertBefore(clone,el);Html5.disposeMediaElement(el);el=clone}else{el=_globalDocument2["default"].createElement("video");var tagAttributes=this.options_.tag&&Dom.getElAttributes(this.options_.tag);var attributes=_utilsMergeOptionsJs2["default"]({},tagAttributes);if(!browser.TOUCH_ENABLED||this.options_.nativeControlsForTouch!==true){delete attributes.controls}Dom.setElAttributes(el,_objectAssign2["default"](attributes,{id:this.options_.techId,"class":"vjs-tech"}))}}var settingsAttrs=["autoplay","preload","loop","muted"];for(var i=settingsAttrs.length-1;i>=0;i--){var attr=settingsAttrs[i];var overwriteAttrs={};if(typeof this.options_[attr]!=="undefined"){overwriteAttrs[attr]=this.options_[attr]}Dom.setElAttributes(el,overwriteAttrs)}return el};Html5.prototype.handleLateInit_=function handleLateInit_(el){var _this3=this;if(el.networkState===0||el.networkState===3){return}if(el.readyState===0){var _ret=function(){var loadstartFired=false;var setLoadstartFired=function setLoadstartFired(){loadstartFired=true};_this3.on("loadstart",setLoadstartFired);var triggerLoadstart=function triggerLoadstart(){if(!loadstartFired){this.trigger("loadstart")}};_this3.on("loadedmetadata",triggerLoadstart);_this3.ready(function(){this.off("loadstart",setLoadstartFired);this.off("loadedmetadata",triggerLoadstart);if(!loadstartFired){this.trigger("loadstart")}});return{v:undefined}}();if(typeof _ret==="object")return _ret.v}var eventsToTrigger=["loadstart"];eventsToTrigger.push("loadedmetadata");if(el.readyState>=2){eventsToTrigger.push("loadeddata")}if(el.readyState>=3){eventsToTrigger.push("canplay")}if(el.readyState>=4){eventsToTrigger.push("canplaythrough")}this.ready(function(){eventsToTrigger.forEach(function(type){this.trigger(type)},this)})};Html5.prototype.proxyNativeTextTracks_=function proxyNativeTextTracks_(){var tt=this.el().textTracks;if(tt){for(var i=0;i<tt.length;i++){this.textTracks().addTrack_(tt[i])}if(tt.addEventListener){tt.addEventListener("change",this.handleTextTrackChange_);tt.addEventListener("addtrack",this.handleTextTrackAdd_);tt.addEventListener("removetrack",this.handleTextTrackRemove_)}}};Html5.prototype.handleTextTrackChange=function handleTextTrackChange(e){var tt=this.textTracks();this.textTracks().trigger({type:"change",target:tt,currentTarget:tt,srcElement:tt})};Html5.prototype.handleTextTrackAdd=function handleTextTrackAdd(e){this.textTracks().addTrack_(e.track)};Html5.prototype.handleTextTrackRemove=function handleTextTrackRemove(e){this.textTracks().removeTrack_(e.track)};Html5.prototype.handleVideoTrackChange_=function handleVideoTrackChange_(e){var vt=this.videoTracks();this.videoTracks().trigger({type:"change",target:vt,currentTarget:vt,srcElement:vt})};Html5.prototype.handleVideoTrackAdd_=function handleVideoTrackAdd_(e){this.videoTracks().addTrack_(e.track)};Html5.prototype.handleVideoTrackRemove_=function handleVideoTrackRemove_(e){this.videoTracks().removeTrack_(e.track)};Html5.prototype.handleAudioTrackChange_=function handleAudioTrackChange_(e){var audioTrackList=this.audioTracks();this.audioTracks().trigger({type:"change",target:audioTrackList,currentTarget:audioTrackList,srcElement:audioTrackList})};Html5.prototype.handleAudioTrackAdd_=function handleAudioTrackAdd_(e){this.audioTracks().addTrack_(e.track)};Html5.prototype.handleAudioTrackRemove_=function handleAudioTrackRemove_(e){this.audioTracks().removeTrack_(e.track)};Html5.prototype.play=function play(){var promise=this.el_.play();if(promise)promise["catch"](function(){})};Html5.prototype.pause=function pause(){this.el_.pause()};Html5.prototype.paused=function paused(){return this.el_.paused};Html5.prototype.currentTime=function currentTime(){return this.el_.currentTime};Html5.prototype.setCurrentTime=function setCurrentTime(seconds){try{this.el_.currentTime=seconds}catch(e){_utilsLogJs2["default"](e,"Video is not ready. (Video.js)")}};Html5.prototype.duration=function duration(){return this.el_.duration||0};Html5.prototype.buffered=function buffered(){return this.el_.buffered};Html5.prototype.volume=function volume(){return this.el_.volume};Html5.prototype.setVolume=function setVolume(percentAsDecimal){this.el_.volume=percentAsDecimal};Html5.prototype.muted=function muted(){return this.el_.muted};Html5.prototype.setMuted=function setMuted(muted){this.el_.muted=muted};Html5.prototype.width=function width(){return this.el_.offsetWidth};Html5.prototype.height=function height(){return this.el_.offsetHeight};Html5.prototype.supportsFullScreen=function supportsFullScreen(){if(typeof this.el_.webkitEnterFullScreen==="function"){var userAgent=_globalWindow2["default"].navigator.userAgent;if(/Android/.test(userAgent)||!/Chrome|Mac OS X 10.5/.test(userAgent)){return true}}return false};Html5.prototype.enterFullScreen=function enterFullScreen(){var video=this.el_;if("webkitDisplayingFullscreen"in video){this.one("webkitbeginfullscreen",function(){this.one("webkitendfullscreen",function(){this.trigger("fullscreenchange",{isFullscreen:false})});this.trigger("fullscreenchange",{isFullscreen:true})})}if(video.paused&&video.networkState<=video.HAVE_METADATA){this.play();this.setTimeout(function(){video.pause();video.webkitEnterFullScreen()},0)}else{video.webkitEnterFullScreen()}};Html5.prototype.exitFullScreen=function exitFullScreen(){this.el_.webkitExitFullScreen()};Html5.prototype.src=function src(_src){if(_src===undefined){return this.el_.src}else{this.setSrc(_src)}};Html5.prototype.setSrc=function setSrc(src){this.el_.src=src};Html5.prototype.load=function load(){this.el_.load()};Html5.prototype.reset=function reset(){Html5.resetMediaElement(this.el_)};Html5.prototype.currentSrc=function currentSrc(){if(this.currentSource_){return this.currentSource_.src}else{return this.el_.currentSrc}};Html5.prototype.poster=function poster(){return this.el_.poster};Html5.prototype.setPoster=function setPoster(val){this.el_.poster=val};Html5.prototype.preload=function preload(){return this.el_.preload};Html5.prototype.setPreload=function setPreload(val){this.el_.preload=val};Html5.prototype.autoplay=function autoplay(){return this.el_.autoplay};Html5.prototype.setAutoplay=function setAutoplay(val){this.el_.autoplay=val};Html5.prototype.controls=function controls(){return this.el_.controls};Html5.prototype.setControls=function setControls(val){this.el_.controls=!!val};Html5.prototype.loop=function loop(){return this.el_.loop};Html5.prototype.setLoop=function setLoop(val){this.el_.loop=val};Html5.prototype.error=function error(){return this.el_.error};Html5.prototype.seeking=function seeking(){return this.el_.seeking};Html5.prototype.seekable=function seekable(){return this.el_.seekable};Html5.prototype.ended=function ended(){return this.el_.ended};Html5.prototype.defaultMuted=function defaultMuted(){return this.el_.defaultMuted};Html5.prototype.playbackRate=function playbackRate(){return this.el_.playbackRate};Html5.prototype.played=function played(){return this.el_.played};Html5.prototype.setPlaybackRate=function setPlaybackRate(val){this.el_.playbackRate=val};Html5.prototype.networkState=function networkState(){return this.el_.networkState};Html5.prototype.readyState=function readyState(){return this.el_.readyState};Html5.prototype.videoWidth=function videoWidth(){return this.el_.videoWidth};Html5.prototype.videoHeight=function videoHeight(){return this.el_.videoHeight};Html5.prototype.textTracks=function textTracks(){return _Tech.prototype.textTracks.call(this)};Html5.prototype.addTextTrack=function addTextTrack(kind,label,language){if(!this["featuresNativeTextTracks"]){return _Tech.prototype.addTextTrack.call(this,kind,label,language)}return this.el_.addTextTrack(kind,label,language)};Html5.prototype.addRemoteTextTrack=function addRemoteTextTrack(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];if(!this["featuresNativeTextTracks"]){return _Tech.prototype.addRemoteTextTrack.call(this,options)}var htmlTrackElement=_globalDocument2["default"].createElement("track");if(options.kind){htmlTrackElement.kind=options.kind}if(options.label){htmlTrackElement.label=options.label}if(options.language||options.srclang){htmlTrackElement.srclang=options.language||options.srclang}if(options["default"]){htmlTrackElement["default"]=options["default"]}if(options.id){htmlTrackElement.id=options.id}if(options.src){htmlTrackElement.src=options.src}this.el().appendChild(htmlTrackElement);this.remoteTextTrackEls().addTrackElement_(htmlTrackElement);this.remoteTextTracks().addTrack_(htmlTrackElement.track);return htmlTrackElement};Html5.prototype.removeRemoteTextTrack=function removeRemoteTextTrack(track){if(!this["featuresNativeTextTracks"]){return _Tech.prototype.removeRemoteTextTrack.call(this,track)}var tracks=undefined,i=undefined;var trackElement=this.remoteTextTrackEls().getTrackElementByTrack_(track);this.remoteTextTrackEls().removeTrackElement_(trackElement);this.remoteTextTracks().removeTrack_(track);tracks=this.$$("track");i=tracks.length;while(i--){if(track===tracks[i]||track===tracks[i].track){this.el().removeChild(tracks[i])}}};return Html5}(_techJs2["default"]);Html5.TEST_VID=_globalDocument2["default"].createElement("video");var track=_globalDocument2["default"].createElement("track");track.kind="captions";track.srclang="en";track.label="English";Html5.TEST_VID.appendChild(track);Html5.isSupported=function(){try{Html5.TEST_VID["volume"]=.5}catch(e){return false}return!!Html5.TEST_VID.canPlayType};_techJs2["default"].withSourceHandlers(Html5);Html5.nativeSourceHandler={};Html5.nativeSourceHandler.canPlayType=function(type){try{return Html5.TEST_VID.canPlayType(type)}catch(e){return""}};Html5.nativeSourceHandler.canHandleSource=function(source){var match,ext;if(source.type){return Html5.nativeSourceHandler.canPlayType(source.type)}else if(source.src){ext=Url.getFileExtension(source.src);return Html5.nativeSourceHandler.canPlayType("video/"+ext)}return""};Html5.nativeSourceHandler.handleSource=function(source,tech,options){tech.setSrc(source.src)};Html5.nativeSourceHandler.dispose=function(){};Html5.registerSourceHandler(Html5.nativeSourceHandler);Html5.canControlVolume=function(){var volume=Html5.TEST_VID.volume;Html5.TEST_VID.volume=volume/2+.1;return volume!==Html5.TEST_VID.volume};Html5.canControlPlaybackRate=function(){if(browser.IS_ANDROID&&browser.IS_CHROME){return false}var playbackRate=Html5.TEST_VID.playbackRate;Html5.TEST_VID.playbackRate=playbackRate/2+.1;return playbackRate!==Html5.TEST_VID.playbackRate};Html5.supportsNativeTextTracks=function(){var supportsTextTracks;supportsTextTracks=!!Html5.TEST_VID.textTracks;if(supportsTextTracks&&Html5.TEST_VID.textTracks.length>0){supportsTextTracks=typeof Html5.TEST_VID.textTracks[0]["mode"]!=="number"}if(supportsTextTracks&&browser.IS_FIREFOX){supportsTextTracks=false}if(supportsTextTracks&&!("onremovetrack"in Html5.TEST_VID.textTracks)){supportsTextTracks=false}return supportsTextTracks};Html5.supportsNativeVideoTracks=function(){var supportsVideoTracks=!!Html5.TEST_VID.videoTracks;return supportsVideoTracks};Html5.supportsNativeAudioTracks=function(){var supportsAudioTracks=!!Html5.TEST_VID.audioTracks;return supportsAudioTracks};Html5.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","volumechange"];Html5.prototype["featuresVolumeControl"]=Html5.canControlVolume();Html5.prototype["featuresPlaybackRate"]=Html5.canControlPlaybackRate();Html5.prototype["movingMediaElementInDOM"]=!browser.IS_IOS;Html5.prototype["featuresFullscreenResize"]=true;Html5.prototype["featuresProgressEvents"]=true;Html5.prototype["featuresNativeTextTracks"]=Html5.supportsNativeTextTracks();Html5.prototype["featuresNativeVideoTracks"]=Html5.supportsNativeVideoTracks();Html5.prototype["featuresNativeAudioTracks"]=Html5.supportsNativeAudioTracks();var canPlayType=undefined;var mpegurlRE=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;var mp4RE=/^video\/mp4/i;Html5.patchCanPlayType=function(){if(browser.ANDROID_VERSION>=4){if(!canPlayType){canPlayType=Html5.TEST_VID.constructor.prototype.canPlayType}Html5.TEST_VID.constructor.prototype.canPlayType=function(type){if(type&&mpegurlRE.test(type)){return"maybe"}return canPlayType.call(this,type)}}if(browser.IS_OLD_ANDROID){if(!canPlayType){canPlayType=Html5.TEST_VID.constructor.prototype.canPlayType}Html5.TEST_VID.constructor.prototype.canPlayType=function(type){if(type&&mp4RE.test(type)){return"maybe"}return canPlayType.call(this,type)}}};Html5.unpatchCanPlayType=function(){var r=Html5.TEST_VID.constructor.prototype.canPlayType;Html5.TEST_VID.constructor.prototype.canPlayType=canPlayType;canPlayType=null;return r};Html5.patchCanPlayType();Html5.disposeMediaElement=function(el){if(!el){return}if(el.parentNode){el.parentNode.removeChild(el)}while(el.hasChildNodes()){el.removeChild(el.firstChild)}el.removeAttribute("src");if(typeof el.load==="function"){(function(){try{el.load()}catch(e){}})()}};Html5.resetMediaElement=function(el){if(!el){return}var sources=el.querySelectorAll("source");var i=sources.length;while(i--){el.removeChild(sources[i])}el.removeAttribute("src");if(typeof el.load==="function"){(function(){try{el.load()}catch(e){}})()}};_component2["default"].registerComponent("Html5",Html5);_techJs2["default"].registerTech("Html5",Html5);exports["default"]=Html5;module.exports=exports["default"]},{"../../../src/js/tracks/text-track.js":137,"../component":68,"../utils/browser.js":143,"../utils/dom.js":146,"../utils/fn.js":148,"../utils/log.js":151,"../utils/merge-options.js":152,"../utils/to-title-case.js":155,"../utils/url.js":156,"./tech.js":126,"global/document":9,"global/window":10,"object.assign":53,tsml:61}],125:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _componentJs=_dereq_("../component.js");var _componentJs2=_interopRequireDefault(_componentJs);var _techJs=_dereq_("./tech.js");var _techJs2=_interopRequireDefault(_techJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _utilsToTitleCaseJs=_dereq_("../utils/to-title-case.js");var _utilsToTitleCaseJs2=_interopRequireDefault(_utilsToTitleCaseJs);var MediaLoader=function(_Component){_inherits(MediaLoader,_Component);function MediaLoader(player,options,ready){_classCallCheck(this,MediaLoader);_Component.call(this,player,options,ready);if(!options.playerOptions["sources"]||options.playerOptions["sources"].length===0){for(var i=0,j=options.playerOptions["techOrder"];i<j.length;i++){var techName=_utilsToTitleCaseJs2["default"](j[i]);var tech=_techJs2["default"].getTech(techName);if(!techName){tech=_componentJs2["default"].getComponent(techName)}if(tech&&tech.isSupported()){player.loadTech_(techName);break}}}else{player.src(options.playerOptions["sources"])}}return MediaLoader}(_componentJs2["default"]);_componentJs2["default"].registerComponent("MediaLoader",MediaLoader);exports["default"]=MediaLoader;module.exports=exports["default"]},{"../component.js":68,"../utils/to-title-case.js":155,"./tech.js":126,"global/window":10}],126:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _tracksHtmlTrackElement=_dereq_("../tracks/html-track-element");var _tracksHtmlTrackElement2=_interopRequireDefault(_tracksHtmlTrackElement);var _tracksHtmlTrackElementList=_dereq_("../tracks/html-track-element-list");var _tracksHtmlTrackElementList2=_interopRequireDefault(_tracksHtmlTrackElementList);var _utilsMergeOptionsJs=_dereq_("../utils/merge-options.js");var _utilsMergeOptionsJs2=_interopRequireDefault(_utilsMergeOptionsJs);var _tracksTextTrack=_dereq_("../tracks/text-track");var _tracksTextTrack2=_interopRequireDefault(_tracksTextTrack);var _tracksTextTrackList=_dereq_("../tracks/text-track-list");var _tracksTextTrackList2=_interopRequireDefault(_tracksTextTrackList);var _tracksVideoTrack=_dereq_("../tracks/video-track");var _tracksVideoTrack2=_interopRequireDefault(_tracksVideoTrack);var _tracksVideoTrackList=_dereq_("../tracks/video-track-list");var _tracksVideoTrackList2=_interopRequireDefault(_tracksVideoTrackList);var _tracksAudioTrackList=_dereq_("../tracks/audio-track-list");var _tracksAudioTrackList2=_interopRequireDefault(_tracksAudioTrackList);var _tracksAudioTrack=_dereq_("../tracks/audio-track");var _tracksAudioTrack2=_interopRequireDefault(_tracksAudioTrack);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsLogJs=_dereq_("../utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _utilsTimeRangesJs=_dereq_("../utils/time-ranges.js");var _utilsBufferJs=_dereq_("../utils/buffer.js");var _mediaErrorJs=_dereq_("../media-error.js");var _mediaErrorJs2=_interopRequireDefault(_mediaErrorJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);
var Tech=function(_Component){_inherits(Tech,_Component);function Tech(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var ready=arguments.length<=1||arguments[1]===undefined?function(){}:arguments[1];_classCallCheck(this,Tech);options.reportTouchActivity=false;_Component.call(this,null,options,ready);this.hasStarted_=false;this.on("playing",function(){this.hasStarted_=true});this.on("loadstart",function(){this.hasStarted_=false});this.textTracks_=options.textTracks;this.videoTracks_=options.videoTracks;this.audioTracks_=options.audioTracks;if(!this.featuresProgressEvents){this.manualProgressOn()}if(!this.featuresTimeupdateEvents){this.manualTimeUpdatesOn()}if(options.nativeCaptions===false||options.nativeTextTracks===false){this.featuresNativeTextTracks=false}if(!this.featuresNativeTextTracks){this.on("ready",this.emulateTextTracks)}this.initTextTrackListeners();this.initTrackListeners();this.emitTapEvents()}Tech.prototype.manualProgressOn=function manualProgressOn(){this.on("durationchange",this.onDurationChange);this.manualProgress=true;this.one("ready",this.trackProgress)};Tech.prototype.manualProgressOff=function manualProgressOff(){this.manualProgress=false;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange)};Tech.prototype.trackProgress=function trackProgress(){this.stopTrackingProgress();this.progressInterval=this.setInterval(Fn.bind(this,function(){var numBufferedPercent=this.bufferedPercent();if(this.bufferedPercent_!==numBufferedPercent){this.trigger("progress")}this.bufferedPercent_=numBufferedPercent;if(numBufferedPercent===1){this.stopTrackingProgress()}}),500)};Tech.prototype.onDurationChange=function onDurationChange(){this.duration_=this.duration()};Tech.prototype.buffered=function buffered(){return _utilsTimeRangesJs.createTimeRange(0,0)};Tech.prototype.bufferedPercent=function bufferedPercent(){return _utilsBufferJs.bufferedPercent(this.buffered(),this.duration_)};Tech.prototype.stopTrackingProgress=function stopTrackingProgress(){this.clearInterval(this.progressInterval)};Tech.prototype.manualTimeUpdatesOn=function manualTimeUpdatesOn(){this.manualTimeUpdates=true;this.on("play",this.trackCurrentTime);this.on("pause",this.stopTrackingCurrentTime)};Tech.prototype.manualTimeUpdatesOff=function manualTimeUpdatesOff(){this.manualTimeUpdates=false;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime)};Tech.prototype.trackCurrentTime=function trackCurrentTime(){if(this.currentTimeInterval){this.stopTrackingCurrentTime()}this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})},250)};Tech.prototype.stopTrackingCurrentTime=function stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})};Tech.prototype.dispose=function dispose(){this.clearTracks(["audio","video","text"]);if(this.manualProgress){this.manualProgressOff()}if(this.manualTimeUpdates){this.manualTimeUpdatesOff()}_Component.prototype.dispose.call(this)};Tech.prototype.clearTracks=function clearTracks(types){var _this=this;types=[].concat(types);types.forEach(function(type){var list=_this[type+"Tracks"]()||[];var i=list.length;while(i--){var track=list[i];if(type==="text"){_this.removeRemoteTextTrack(track)}list.removeTrack_(track)}})};Tech.prototype.reset=function reset(){};Tech.prototype.error=function error(err){if(err!==undefined){if(err instanceof _mediaErrorJs2["default"]){this.error_=err}else{this.error_=new _mediaErrorJs2["default"](err)}this.trigger("error")}return this.error_};Tech.prototype.played=function played(){if(this.hasStarted_){return _utilsTimeRangesJs.createTimeRange(0,0)}return _utilsTimeRangesJs.createTimeRange()};Tech.prototype.setCurrentTime=function setCurrentTime(){if(this.manualTimeUpdates){this.trigger({type:"timeupdate",target:this,manuallyTriggered:true})}};Tech.prototype.initTextTrackListeners=function initTextTrackListeners(){var textTrackListChanges=Fn.bind(this,function(){this.trigger("texttrackchange")});var tracks=this.textTracks();if(!tracks)return;tracks.addEventListener("removetrack",textTrackListChanges);tracks.addEventListener("addtrack",textTrackListChanges);this.on("dispose",Fn.bind(this,function(){tracks.removeEventListener("removetrack",textTrackListChanges);tracks.removeEventListener("addtrack",textTrackListChanges)}))};Tech.prototype.initTrackListeners=function initTrackListeners(){var _this2=this;var trackTypes=["video","audio"];trackTypes.forEach(function(type){var trackListChanges=function trackListChanges(){_this2.trigger(type+"trackchange")};var tracks=_this2[type+"Tracks"]();tracks.addEventListener("removetrack",trackListChanges);tracks.addEventListener("addtrack",trackListChanges);_this2.on("dispose",function(){tracks.removeEventListener("removetrack",trackListChanges);tracks.removeEventListener("addtrack",trackListChanges)})})};Tech.prototype.emulateTextTracks=function emulateTextTracks(){var _this3=this;var tracks=this.textTracks();if(!tracks){return}if(!_globalWindow2["default"]["WebVTT"]&&this.el().parentNode!=null){(function(){var script=_globalDocument2["default"].createElement("script");script.src=_this3.options_["vtt.js"]||"https://cdn.rawgit.com/gkatsev/vtt.js/vjs-v0.12.1/dist/vtt.min.js";script.onload=function(){_this3.trigger("vttjsloaded")};script.onerror=function(){_this3.trigger("vttjserror")};_this3.on("dispose",function(){script.onload=null;script.onerror=null});_globalWindow2["default"]["WebVTT"]=true;_this3.el().parentNode.appendChild(script)})()}var updateDisplay=function updateDisplay(){return _this3.trigger("texttrackchange")};var textTracksChanges=function textTracksChanges(){updateDisplay();for(var i=0;i<tracks.length;i++){var track=tracks[i];track.removeEventListener("cuechange",updateDisplay);if(track.mode==="showing"){track.addEventListener("cuechange",updateDisplay)}}};textTracksChanges();tracks.addEventListener("change",textTracksChanges);this.on("dispose",function(){tracks.removeEventListener("change",textTracksChanges)})};Tech.prototype.videoTracks=function videoTracks(){this.videoTracks_=this.videoTracks_||new _tracksVideoTrackList2["default"];return this.videoTracks_};Tech.prototype.audioTracks=function audioTracks(){this.audioTracks_=this.audioTracks_||new _tracksAudioTrackList2["default"];return this.audioTracks_};Tech.prototype.textTracks=function textTracks(){this.textTracks_=this.textTracks_||new _tracksTextTrackList2["default"];return this.textTracks_};Tech.prototype.remoteTextTracks=function remoteTextTracks(){this.remoteTextTracks_=this.remoteTextTracks_||new _tracksTextTrackList2["default"];return this.remoteTextTracks_};Tech.prototype.remoteTextTrackEls=function remoteTextTrackEls(){this.remoteTextTrackEls_=this.remoteTextTrackEls_||new _tracksHtmlTrackElementList2["default"];return this.remoteTextTrackEls_};Tech.prototype.addTextTrack=function addTextTrack(kind,label,language){if(!kind){throw new Error("TextTrack kind is required but was not provided")}return createTrackHelper(this,kind,label,language)};Tech.prototype.addRemoteTextTrack=function addRemoteTextTrack(options){var track=_utilsMergeOptionsJs2["default"](options,{tech:this});var htmlTrackElement=new _tracksHtmlTrackElement2["default"](track);this.remoteTextTrackEls().addTrackElement_(htmlTrackElement);this.remoteTextTracks().addTrack_(htmlTrackElement.track);this.textTracks().addTrack_(htmlTrackElement.track);return htmlTrackElement};Tech.prototype.removeRemoteTextTrack=function removeRemoteTextTrack(track){this.textTracks().removeTrack_(track);var trackElement=this.remoteTextTrackEls().getTrackElementByTrack_(track);this.remoteTextTrackEls().removeTrackElement_(trackElement);this.remoteTextTracks().removeTrack_(track)};Tech.prototype.setPoster=function setPoster(){};Tech.prototype.canPlayType=function canPlayType(){return""};Tech.isTech=function isTech(component){return component.prototype instanceof Tech||component instanceof Tech||component===Tech};Tech.registerTech=function registerTech(name,tech){if(!Tech.techs_){Tech.techs_={}}if(!Tech.isTech(tech)){throw new Error("Tech "+name+" must be a Tech")}Tech.techs_[name]=tech;return tech};Tech.getTech=function getTech(name){if(Tech.techs_&&Tech.techs_[name]){return Tech.techs_[name]}if(_globalWindow2["default"]&&_globalWindow2["default"].videojs&&_globalWindow2["default"].videojs[name]){_utilsLogJs2["default"].warn("The "+name+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)");return _globalWindow2["default"].videojs[name]}};return Tech}(_component2["default"]);Tech.prototype.textTracks_;Tech.prototype.audioTracks_;Tech.prototype.videoTracks_;var createTrackHelper=function createTrackHelper(self,kind,label,language){var options=arguments.length<=4||arguments[4]===undefined?{}:arguments[4];var tracks=self.textTracks();options.kind=kind;if(label){options.label=label}if(language){options.language=language}options.tech=self;var track=new _tracksTextTrack2["default"](options);tracks.addTrack_(track);return track};Tech.prototype.featuresVolumeControl=true;Tech.prototype.featuresFullscreenResize=false;Tech.prototype.featuresPlaybackRate=false;Tech.prototype.featuresProgressEvents=false;Tech.prototype.featuresTimeupdateEvents=false;Tech.prototype.featuresNativeTextTracks=false;Tech.withSourceHandlers=function(_Tech){_Tech.registerSourceHandler=function(handler,index){var handlers=_Tech.sourceHandlers;if(!handlers){handlers=_Tech.sourceHandlers=[]}if(index===undefined){index=handlers.length}handlers.splice(index,0,handler)};_Tech.canPlayType=function(type){var handlers=_Tech.sourceHandlers||[];var can=undefined;for(var i=0;i<handlers.length;i++){can=handlers[i].canPlayType(type);if(can){return can}}return""};_Tech.selectSourceHandler=function(source){var handlers=_Tech.sourceHandlers||[];var can=undefined;for(var i=0;i<handlers.length;i++){can=handlers[i].canHandleSource(source);if(can){return handlers[i]}}return null};_Tech.canPlaySource=function(srcObj){var sh=_Tech.selectSourceHandler(srcObj);if(sh){return sh.canHandleSource(srcObj)}return""};var deferrable=["seekable","duration"];deferrable.forEach(function(fnName){var originalFn=this[fnName];if(typeof originalFn!=="function"){return}this[fnName]=function(){if(this.sourceHandler_&&this.sourceHandler_[fnName]){return this.sourceHandler_[fnName].apply(this.sourceHandler_,arguments)}return originalFn.apply(this,arguments)}},_Tech.prototype);_Tech.prototype.setSource=function(source){var sh=_Tech.selectSourceHandler(source);if(!sh){if(_Tech.nativeSourceHandler){sh=_Tech.nativeSourceHandler}else{_utilsLogJs2["default"].error("No source hander found for the current source.")}}this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);if(this.currentSource_){this.clearTracks(["audio","video"]);this.currentSource_=null}if(sh!==_Tech.nativeSourceHandler){this.currentSource_=source;this.off(this.el_,"loadstart",_Tech.prototype.firstLoadStartListener_);this.off(this.el_,"loadstart",_Tech.prototype.successiveLoadStartListener_);this.one(this.el_,"loadstart",_Tech.prototype.firstLoadStartListener_)}this.sourceHandler_=sh.handleSource(source,this,this.options_);this.on("dispose",this.disposeSourceHandler);return this};_Tech.prototype.firstLoadStartListener_=function(){this.one(this.el_,"loadstart",_Tech.prototype.successiveLoadStartListener_)};_Tech.prototype.successiveLoadStartListener_=function(){this.currentSource_=null;this.disposeSourceHandler();this.one(this.el_,"loadstart",_Tech.prototype.successiveLoadStartListener_)};_Tech.prototype.disposeSourceHandler=function(){if(this.sourceHandler_&&this.sourceHandler_.dispose){this.off(this.el_,"loadstart",_Tech.prototype.firstLoadStartListener_);this.off(this.el_,"loadstart",_Tech.prototype.successiveLoadStartListener_);this.sourceHandler_.dispose()}}};_component2["default"].registerComponent("Tech",Tech);_component2["default"].registerComponent("MediaTechController",Tech);Tech.registerTech("Tech",Tech);exports["default"]=Tech;module.exports=exports["default"]},{"../component":68,"../media-error.js":110,"../tracks/audio-track":129,"../tracks/audio-track-list":128,"../tracks/html-track-element":131,"../tracks/html-track-element-list":130,"../tracks/text-track":137,"../tracks/text-track-list":135,"../tracks/video-track":142,"../tracks/video-track-list":141,"../utils/buffer.js":144,"../utils/fn.js":148,"../utils/log.js":151,"../utils/merge-options.js":152,"../utils/time-ranges.js":154,"global/document":9,"global/window":10}],127:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _lodashCompatFunctionThrottle=_dereq_("lodash-compat/function/throttle");var _lodashCompatFunctionThrottle2=_interopRequireDefault(_lodashCompatFunctionThrottle);var Tooltip=function(_Component){_inherits(Tooltip,_Component);function Tooltip(player,options){_classCallCheck(this,Tooltip);_Component.call(this,player,options);this.handleHover_=_lodashCompatFunctionThrottle2["default"](Fn.bind(this,this.handleHover),25);this.handleLeave_=_lodashCompatFunctionThrottle2["default"](Fn.bind(this,this.handleLeave),25)}Tooltip.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-tooltip"})};Tooltip.prototype.text=function text(_text){if(!_text)return this.text_||"";this.text_=_text;this.el_.innerHTML=this.localize(this.text_);this.update();return this};Tooltip.prototype.handler=function handler(_handler){if(!_handler)return this.handler;if(this.handler_){this.off(this.handler_,"mouseover",this.handleHover_);this.off(this.handler_,"mouseout",this.handleLeave_)}this.handler_=_handler;this.on(this.handler_,"mouseover",this.handleHover_);this.on(this.handler_,"mouseout",this.handleLeave_);return this};Tooltip.prototype.handleHover=function handleHover(){var _this=this;if(this.timeout){this.clearTimeout(this.timeout);this.timeout=0}this.timeout=this.setTimeout(function(){return _this.hide()},1e3);this.show()};Tooltip.prototype.handleLeave=function handleLeave(event){var _this2=this;if(this.timeout){this.clearTimeout(this.timeout);this.timeout=0}this.timeout=this.setTimeout(function(){return _this2.hide()},50)};Tooltip.prototype.show=function show(){var _this3=this;this.player_.trigger("tooltipShown");this.player_.on("tooltipShown",function(){return _this3.hide()});this.addClass("vjs-tooltip-active");this.update()};Tooltip.prototype.hide=function hide(){this.removeClass("vjs-tooltip-active");this.player_.off("tooltipShown")};Tooltip.prototype.update=function update(){var width=this.width();if(!width){return this}var parent_=this.handler_;var parentWidth=parent_?parent_.offsetWidth:0;var parentLeft=Dom.findElPosition(parent_).left-Dom.findElPosition(this.player_.el()).left;var skew=parentWidth/2-width/2;var minSkew=-parentLeft;var maxSkew=this.player_.el().offsetWidth-parentLeft-width;skew=Math.min(Math.max(minSkew,skew),maxSkew);this.el_.style.left=skew+"px";return this};return Tooltip}(_component2["default"]);_component2["default"].registerComponent("Tooltip",Tooltip);exports["default"]=Tooltip;module.exports=exports["default"]},{"./component":68,"./utils/dom.js":146,"./utils/events.js":147,"./utils/fn.js":148,"global/document":9,"lodash-compat/function/throttle":15}],128:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _trackList=_dereq_("./track-list");var _trackList2=_interopRequireDefault(_trackList);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var disableOthers=function disableOthers(list,track){for(var i=0;i<list.length;i++){if(track.id===list[i].id){continue}list[i].enabled=false}};var AudioTrackList=function(_TrackList){_inherits(AudioTrackList,_TrackList);function AudioTrackList(){var tracks=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];_classCallCheck(this,AudioTrackList);var list=undefined;for(var i=tracks.length-1;i>=0;i--){if(tracks[i].enabled){disableOthers(tracks,tracks[i]);break}}if(browser.IS_IE8){list=_globalDocument2["default"].createElement("custom");for(var prop in _trackList2["default"].prototype){if(prop!=="constructor"){list[prop]=_trackList2["default"].prototype[prop]}}for(var prop in AudioTrackList.prototype){if(prop!=="constructor"){list[prop]=AudioTrackList.prototype[prop]}}}list=_TrackList.call(this,tracks,list);list.changing_=false;return list}AudioTrackList.prototype.addTrack_=function addTrack_(track){var _this=this;if(track.enabled){disableOthers(this,track)}_TrackList.prototype.addTrack_.call(this,track);if(!track.addEventListener){return}track.addEventListener("enabledchange",function(){if(_this.changing_){return}_this.changing_=true;disableOthers(_this,track);_this.changing_=false;_this.trigger("change")})};AudioTrackList.prototype.addTrack=function addTrack(track){this.addTrack_(track)};AudioTrackList.prototype.removeTrack=function removeTrack(track){_TrackList.prototype.removeTrack_.call(this,track)};return AudioTrackList}(_trackList2["default"]);exports["default"]=AudioTrackList;module.exports=exports["default"]},{"../utils/browser.js":143,"./track-list":139,"global/document":9}],129:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _trackEnums=_dereq_("./track-enums");var _track=_dereq_("./track");var _track2=_interopRequireDefault(_track);var _utilsMergeOptions=_dereq_("../utils/merge-options");var _utilsMergeOptions2=_interopRequireDefault(_utilsMergeOptions);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var AudioTrack=function(_Track){_inherits(AudioTrack,_Track);function AudioTrack(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,AudioTrack);var settings=_utilsMergeOptions2["default"](options,{kind:_trackEnums.AudioTrackKind[options.kind]||""});var track=_Track.call(this,settings);var enabled=false;if(browser.IS_IE8){for(var prop in AudioTrack.prototype){if(prop!=="constructor"){track[prop]=AudioTrack.prototype[prop]}}}Object.defineProperty(track,"enabled",{get:function get(){return enabled},set:function set(newEnabled){if(typeof newEnabled!=="boolean"||newEnabled===enabled){return}enabled=newEnabled;this.trigger("enabledchange")}});if(settings.enabled){track.enabled=settings.enabled}track.loaded_=true;return track}return AudioTrack}(_track2["default"]);exports["default"]=AudioTrack;module.exports=exports["default"]},{"../utils/browser.js":143,"../utils/merge-options":152,"./track":140,"./track-enums":138}],130:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var HtmlTrackElementList=function(){function HtmlTrackElementList(){var trackElements=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];_classCallCheck(this,HtmlTrackElementList);var list=this;if(browser.IS_IE8){list=_globalDocument2["default"].createElement("custom");for(var prop in HtmlTrackElementList.prototype){if(prop!=="constructor"){list[prop]=HtmlTrackElementList.prototype[prop]}}}list.trackElements_=[];Object.defineProperty(list,"length",{get:function get(){return this.trackElements_.length}});for(var i=0,_length=trackElements.length;i<_length;i++){list.addTrackElement_(trackElements[i])}if(browser.IS_IE8){return list}}HtmlTrackElementList.prototype.addTrackElement_=function addTrackElement_(trackElement){this.trackElements_.push(trackElement)};HtmlTrackElementList.prototype.getTrackElementByTrack_=function getTrackElementByTrack_(track){var trackElement_=undefined;for(var i=0,_length2=this.trackElements_.length;i<_length2;i++){if(track===this.trackElements_[i].track){trackElement_=this.trackElements_[i];break}}return trackElement_};HtmlTrackElementList.prototype.removeTrackElement_=function removeTrackElement_(trackElement){for(var i=0,_length3=this.trackElements_.length;i<_length3;i++){if(trackElement===this.trackElements_[i]){this.trackElements_.splice(i,1);break}}};return HtmlTrackElementList}();exports["default"]=HtmlTrackElementList;module.exports=exports["default"]},{"../utils/browser.js":143,"global/document":9}],131:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _eventTarget=_dereq_("../event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var _tracksTextTrack=_dereq_("../tracks/text-track");var _tracksTextTrack2=_interopRequireDefault(_tracksTextTrack);var NONE=0;var LOADING=1;var LOADED=2;var ERROR=3;var HTMLTrackElement=function(_EventTarget){_inherits(HTMLTrackElement,_EventTarget);function HTMLTrackElement(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,HTMLTrackElement);_EventTarget.call(this);var readyState=undefined,trackElement=this;if(browser.IS_IE8){trackElement=_globalDocument2["default"].createElement("custom");for(var prop in HTMLTrackElement.prototype){if(prop!=="constructor"){trackElement[prop]=HTMLTrackElement.prototype[prop]}}}var track=new _tracksTextTrack2["default"](options);trackElement.kind=track.kind;trackElement.src=track.src;trackElement.srclang=track.language;trackElement.label=track.label;trackElement["default"]=track["default"];Object.defineProperty(trackElement,"readyState",{get:function get(){return readyState}});Object.defineProperty(trackElement,"track",{get:function get(){return track}});readyState=NONE;track.addEventListener("loadeddata",function(){readyState=LOADED;trackElement.trigger({type:"load",target:trackElement})});if(browser.IS_IE8){return trackElement}}return HTMLTrackElement}(_eventTarget2["default"]);HTMLTrackElement.prototype.allowedEvents_={load:"load"};HTMLTrackElement.NONE=NONE;HTMLTrackElement.LOADING=LOADING;HTMLTrackElement.LOADED=LOADED;HTMLTrackElement.ERROR=ERROR;exports["default"]=HTMLTrackElement;module.exports=exports["default"]},{"../event-target":106,"../tracks/text-track":137,"../utils/browser.js":143,"global/document":9}],132:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var TextTrackCueList=function(){function TextTrackCueList(cues){_classCallCheck(this,TextTrackCueList);var list=this;if(browser.IS_IE8){list=_globalDocument2["default"].createElement("custom");for(var prop in TextTrackCueList.prototype){if(prop!=="constructor"){list[prop]=TextTrackCueList.prototype[prop]}}}TextTrackCueList.prototype.setCues_.call(list,cues);Object.defineProperty(list,"length",{get:function get(){return this.length_}});if(browser.IS_IE8){return list}}TextTrackCueList.prototype.setCues_=function setCues_(cues){var oldLength=this.length||0;var i=0;var l=cues.length;this.cues_=cues;this.length_=cues.length;var defineProp=function defineProp(index){if(!(""+index in this)){Object.defineProperty(this,""+index,{get:function get(){return this.cues_[index]}})}};if(oldLength<l){i=oldLength;for(;i<l;i++){defineProp.call(this,i)}}};TextTrackCueList.prototype.getCueById=function getCueById(id){var result=null;for(var i=0,l=this.length;i<l;i++){var cue=this[i];if(cue.id===id){result=cue;break}}return result};return TextTrackCueList}();exports["default"]=TextTrackCueList;module.exports=exports["default"]},{"../utils/browser.js":143,"global/document":9}],133:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _menuMenuJs=_dereq_("../menu/menu.js");var _menuMenuJs2=_interopRequireDefault(_menuMenuJs);var _menuMenuItemJs=_dereq_("../menu/menu-item.js");var _menuMenuItemJs2=_interopRequireDefault(_menuMenuItemJs);var _menuMenuButtonJs=_dereq_("../menu/menu-button.js");var _menuMenuButtonJs2=_interopRequireDefault(_menuMenuButtonJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var darkGray="#222";var lightGray="#ccc";var fontMap={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};var TextTrackDisplay=function(_Component){_inherits(TextTrackDisplay,_Component);function TextTrackDisplay(player,options,ready){_classCallCheck(this,TextTrackDisplay);_Component.call(this,player,options,ready);player.on("loadstart",Fn.bind(this,this.toggleDisplay));player.on("texttrackchange",Fn.bind(this,this.updateDisplay));player.ready(Fn.bind(this,function(){if(player.tech_&&player.tech_["featuresNativeTextTracks"]){this.hide();return}player.on("fullscreenchange",Fn.bind(this,this.updateDisplay));var tracks=this.options_.playerOptions["tracks"]||[];for(var i=0;i<tracks.length;i++){var track=tracks[i];this.player_.addRemoteTextTrack(track)}var modes={captions:1,subtitles:1};var trackList=this.player_.textTracks();var firstDesc=undefined;var firstCaptions=undefined;if(trackList){for(var i=0;i<trackList.length;i++){var track=trackList[i];if(track["default"]){if(track.kind==="descriptions"&&!firstDesc){firstDesc=track}else if(track.kind in modes&&!firstCaptions){
firstCaptions=track}}}if(firstCaptions){firstCaptions.mode="showing"}else if(firstDesc){firstDesc.mode="showing"}}}))}TextTrackDisplay.prototype.toggleDisplay=function toggleDisplay(){if(this.player_.tech_&&this.player_.tech_["featuresNativeTextTracks"]){this.hide()}else{this.show()}};TextTrackDisplay.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"assertive","aria-atomic":"true"})};TextTrackDisplay.prototype.clearDisplay=function clearDisplay(){if(typeof _globalWindow2["default"]["WebVTT"]==="function"){_globalWindow2["default"]["WebVTT"]["processCues"](_globalWindow2["default"],[],this.el_)}};TextTrackDisplay.prototype.updateDisplay=function updateDisplay(){var tracks=this.player_.textTracks();this.clearDisplay();if(!tracks){return}var descriptionsTrack=null;var captionsSubtitlesTrack=null;var i=tracks.length;while(i--){var track=tracks[i];if(track["mode"]==="showing"){if(track["kind"]==="descriptions"){descriptionsTrack=track}else{captionsSubtitlesTrack=track}}}if(captionsSubtitlesTrack){this.updateForTrack(captionsSubtitlesTrack)}else if(descriptionsTrack){this.updateForTrack(descriptionsTrack)}};TextTrackDisplay.prototype.updateForTrack=function updateForTrack(track){if(typeof _globalWindow2["default"]["WebVTT"]!=="function"||!track["activeCues"]){return}var overrides=this.player_["textTrackSettings"].getValues();var cues=[];for(var _i=0;_i<track["activeCues"].length;_i++){cues.push(track["activeCues"][_i])}_globalWindow2["default"]["WebVTT"]["processCues"](_globalWindow2["default"],cues,this.el_);var i=cues.length;while(i--){var cue=cues[i];if(!cue){continue}var cueDiv=cue.displayState;if(overrides.color){cueDiv.firstChild.style.color=overrides.color}if(overrides.textOpacity){tryUpdateStyle(cueDiv.firstChild,"color",constructColor(overrides.color||"#fff",overrides.textOpacity))}if(overrides.backgroundColor){cueDiv.firstChild.style.backgroundColor=overrides.backgroundColor}if(overrides.backgroundOpacity){tryUpdateStyle(cueDiv.firstChild,"backgroundColor",constructColor(overrides.backgroundColor||"#000",overrides.backgroundOpacity))}if(overrides.windowColor){if(overrides.windowOpacity){tryUpdateStyle(cueDiv,"backgroundColor",constructColor(overrides.windowColor,overrides.windowOpacity))}else{cueDiv.style.backgroundColor=overrides.windowColor}}if(overrides.edgeStyle){if(overrides.edgeStyle==="dropshadow"){cueDiv.firstChild.style.textShadow="2px 2px 3px "+darkGray+", 2px 2px 4px "+darkGray+", 2px 2px 5px "+darkGray}else if(overrides.edgeStyle==="raised"){cueDiv.firstChild.style.textShadow="1px 1px "+darkGray+", 2px 2px "+darkGray+", 3px 3px "+darkGray}else if(overrides.edgeStyle==="depressed"){cueDiv.firstChild.style.textShadow="1px 1px "+lightGray+", 0 1px "+lightGray+", -1px -1px "+darkGray+", 0 -1px "+darkGray}else if(overrides.edgeStyle==="uniform"){cueDiv.firstChild.style.textShadow="0 0 4px "+darkGray+", 0 0 4px "+darkGray+", 0 0 4px "+darkGray+", 0 0 4px "+darkGray}}if(overrides.fontPercent&&overrides.fontPercent!==1){var fontSize=_globalWindow2["default"].parseFloat(cueDiv.style.fontSize);cueDiv.style.fontSize=fontSize*overrides.fontPercent+"px";cueDiv.style.height="auto";cueDiv.style.top="auto";cueDiv.style.bottom="2px"}if(overrides.fontFamily&&overrides.fontFamily!=="default"){if(overrides.fontFamily==="small-caps"){cueDiv.firstChild.style.fontVariant="small-caps"}else{cueDiv.firstChild.style.fontFamily=fontMap[overrides.fontFamily]}}}};return TextTrackDisplay}(_component2["default"]);function constructColor(color,opacity){return"rgba("+parseInt(color[1]+color[1],16)+","+parseInt(color[2]+color[2],16)+","+parseInt(color[3]+color[3],16)+","+opacity+")"}function tryUpdateStyle(el,style,rule){try{el.style[style]=rule}catch(e){}}_component2["default"].registerComponent("TextTrackDisplay",TextTrackDisplay);exports["default"]=TextTrackDisplay;module.exports=exports["default"]},{"../component":68,"../menu/menu-button.js":111,"../menu/menu-item.js":112,"../menu/menu.js":113,"../utils/fn.js":148,"global/document":9,"global/window":10}],134:[function(_dereq_,module,exports){exports.__esModule=true;var trackToJson_=function trackToJson_(track){var ret=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(acc,prop,i){if(track[prop]){acc[prop]=track[prop]}return acc},{cues:track.cues&&Array.prototype.map.call(track.cues,function(cue){return{startTime:cue.startTime,endTime:cue.endTime,text:cue.text,id:cue.id}})});return ret};var textTracksToJson=function textTracksToJson(tech){var trackEls=tech.$$("track");var trackObjs=Array.prototype.map.call(trackEls,function(t){return t.track});var tracks=Array.prototype.map.call(trackEls,function(trackEl){var json=trackToJson_(trackEl.track);if(trackEl.src){json.src=trackEl.src}return json});return tracks.concat(Array.prototype.filter.call(tech.textTracks(),function(track){return trackObjs.indexOf(track)===-1}).map(trackToJson_))};var jsonToTextTracks=function jsonToTextTracks(json,tech){json.forEach(function(track){var addedTrack=tech.addRemoteTextTrack(track).track;if(!track.src&&track.cues){track.cues.forEach(function(cue){return addedTrack.addCue(cue)})}});return tech.textTracks()};exports["default"]={textTracksToJson:textTracksToJson,jsonToTextTracks:jsonToTextTracks,trackToJson_:trackToJson_};module.exports=exports["default"]},{}],135:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _trackList=_dereq_("./track-list");var _trackList2=_interopRequireDefault(_trackList);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var TextTrackList=function(_TrackList){_inherits(TextTrackList,_TrackList);function TextTrackList(){var tracks=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];_classCallCheck(this,TextTrackList);var list=undefined;if(browser.IS_IE8){list=_globalDocument2["default"].createElement("custom");for(var prop in _trackList2["default"].prototype){if(prop!=="constructor"){list[prop]=_trackList2["default"].prototype[prop]}}for(var prop in TextTrackList.prototype){if(prop!=="constructor"){list[prop]=TextTrackList.prototype[prop]}}}list=_TrackList.call(this,tracks,list);return list}TextTrackList.prototype.addTrack_=function addTrack_(track){_TrackList.prototype.addTrack_.call(this,track);track.addEventListener("modechange",Fn.bind(this,function(){this.trigger("change")}))};TextTrackList.prototype.removeTrack_=function removeTrack_(rtrack){var track=undefined;for(var i=0,l=this.length;i<l;i++){if(this[i]===rtrack){track=this[i];if(track.off){track.off()}this.tracks_.splice(i,1);break}}if(!track){return}this.trigger({track:track,type:"removetrack"})};TextTrackList.prototype.getTrackById=function getTrackById(id){var result=null;for(var i=0,l=this.length;i<l;i++){var track=this[i];if(track.id===id){result=track;break}}return result};return TextTrackList}(_trackList2["default"]);exports["default"]=TextTrackList;module.exports=exports["default"]},{"../utils/browser.js":143,"../utils/fn.js":148,"./track-list":139,"global/document":9}],136:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _component=_dereq_("../component");var _component2=_interopRequireDefault(_component);var _utilsEventsJs=_dereq_("../utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsLogJs=_dereq_("../utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _safeJsonParseTuple=_dereq_("safe-json-parse/tuple");var _safeJsonParseTuple2=_interopRequireDefault(_safeJsonParseTuple);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var TextTrackSettings=function(_Component){_inherits(TextTrackSettings,_Component);function TextTrackSettings(player,options){_classCallCheck(this,TextTrackSettings);_Component.call(this,player,options);this.hide();if(options.persistTextTrackSettings===undefined){this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings}Events.on(this.$(".vjs-done-button"),"click",Fn.bind(this,function(){this.saveSettings();this.hide()}));Events.on(this.$(".vjs-default-button"),"click",Fn.bind(this,function(){this.$(".vjs-fg-color > select").selectedIndex=0;this.$(".vjs-bg-color > select").selectedIndex=0;this.$(".window-color > select").selectedIndex=0;this.$(".vjs-text-opacity > select").selectedIndex=0;this.$(".vjs-bg-opacity > select").selectedIndex=0;this.$(".vjs-window-opacity > select").selectedIndex=0;this.$(".vjs-edge-style select").selectedIndex=0;this.$(".vjs-font-family select").selectedIndex=0;this.$(".vjs-font-percent select").selectedIndex=2;this.updateDisplay()}));Events.on(this.$(".vjs-fg-color > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-bg-color > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".window-color > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-text-opacity > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-bg-opacity > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-window-opacity > select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-font-percent select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-edge-style select"),"change",Fn.bind(this,this.updateDisplay));Events.on(this.$(".vjs-font-family select"),"change",Fn.bind(this,this.updateDisplay));if(this.options_.persistTextTrackSettings){this.restoreSettings()}}TextTrackSettings.prototype.createEl=function createEl(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:captionOptionsMenuTemplate()})};TextTrackSettings.prototype.getValues=function getValues(){var textEdge=getSelectedOptionValue(this.$(".vjs-edge-style select"));var fontFamily=getSelectedOptionValue(this.$(".vjs-font-family select"));var fgColor=getSelectedOptionValue(this.$(".vjs-fg-color > select"));var textOpacity=getSelectedOptionValue(this.$(".vjs-text-opacity > select"));var bgColor=getSelectedOptionValue(this.$(".vjs-bg-color > select"));var bgOpacity=getSelectedOptionValue(this.$(".vjs-bg-opacity > select"));var windowColor=getSelectedOptionValue(this.$(".window-color > select"));var windowOpacity=getSelectedOptionValue(this.$(".vjs-window-opacity > select"));var fontPercent=_globalWindow2["default"]["parseFloat"](getSelectedOptionValue(this.$(".vjs-font-percent > select")));var result={backgroundOpacity:bgOpacity,textOpacity:textOpacity,windowOpacity:windowOpacity,edgeStyle:textEdge,fontFamily:fontFamily,color:fgColor,backgroundColor:bgColor,windowColor:windowColor,fontPercent:fontPercent};for(var _name in result){if(result[_name]===""||result[_name]==="none"||_name==="fontPercent"&&result[_name]===1){delete result[_name]}}return result};TextTrackSettings.prototype.setValues=function setValues(values){setSelectedOption(this.$(".vjs-edge-style select"),values.edgeStyle);setSelectedOption(this.$(".vjs-font-family select"),values.fontFamily);setSelectedOption(this.$(".vjs-fg-color > select"),values.color);setSelectedOption(this.$(".vjs-text-opacity > select"),values.textOpacity);setSelectedOption(this.$(".vjs-bg-color > select"),values.backgroundColor);setSelectedOption(this.$(".vjs-bg-opacity > select"),values.backgroundOpacity);setSelectedOption(this.$(".window-color > select"),values.windowColor);setSelectedOption(this.$(".vjs-window-opacity > select"),values.windowOpacity);var fontPercent=values.fontPercent;if(fontPercent){fontPercent=fontPercent.toFixed(2)}setSelectedOption(this.$(".vjs-font-percent > select"),fontPercent)};TextTrackSettings.prototype.restoreSettings=function restoreSettings(){var err=undefined,values=undefined;try{var _safeParseTuple=_safeJsonParseTuple2["default"](_globalWindow2["default"].localStorage.getItem("vjs-text-track-settings"));err=_safeParseTuple[0];values=_safeParseTuple[1];if(err){_utilsLogJs2["default"].error(err)}}catch(e){_utilsLogJs2["default"].warn(e)}if(values){this.setValues(values)}};TextTrackSettings.prototype.saveSettings=function saveSettings(){if(!this.options_.persistTextTrackSettings){return}var values=this.getValues();try{if(Object.getOwnPropertyNames(values).length>0){_globalWindow2["default"].localStorage.setItem("vjs-text-track-settings",JSON.stringify(values))}else{_globalWindow2["default"].localStorage.removeItem("vjs-text-track-settings")}}catch(e){_utilsLogJs2["default"].warn(e)}};TextTrackSettings.prototype.updateDisplay=function updateDisplay(){var ttDisplay=this.player_.getChild("textTrackDisplay");if(ttDisplay){ttDisplay.updateDisplay()}};return TextTrackSettings}(_component2["default"]);_component2["default"].registerComponent("TextTrackSettings",TextTrackSettings);function getSelectedOptionValue(target){var selectedOption=undefined;if(target.selectedOptions){selectedOption=target.selectedOptions[0]}else if(target.options){selectedOption=target.options[target.options.selectedIndex]}return selectedOption.value}function setSelectedOption(target,value){if(!value){return}var i=undefined;for(i=0;i<target.options.length;i++){var option=target.options[i];if(option.value===value){break}}target.selectedIndex=i}function captionOptionsMenuTemplate(){var template='<div class="vjs-tracksettings">\n      <div class="vjs-tracksettings-colors">\n        <div class="vjs-fg-color vjs-tracksetting">\n            <label class="vjs-label">Foreground</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-text-opacity vjs-opacity">\n              <select>\n                <option value="">---</option>\n                <option value="1">Opaque</option>\n                <option value="0.5">Semi-Opaque</option>\n              </select>\n            </span>\n        </div> <!-- vjs-fg-color -->\n        <div class="vjs-bg-color vjs-tracksetting">\n            <label class="vjs-label">Background</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-bg-opacity vjs-opacity">\n                <select>\n                  <option value="">---</option>\n                  <option value="1">Opaque</option>\n                  <option value="0.5">Semi-Transparent</option>\n                  <option value="0">Transparent</option>\n                </select>\n            </span>\n        </div> <!-- vjs-bg-color -->\n        <div class="window-color vjs-tracksetting">\n            <label class="vjs-label">Window</label>\n            <select>\n              <option value="">---</option>\n              <option value="#FFF">White</option>\n              <option value="#000">Black</option>\n              <option value="#F00">Red</option>\n              <option value="#0F0">Green</option>\n              <option value="#00F">Blue</option>\n              <option value="#FF0">Yellow</option>\n              <option value="#F0F">Magenta</option>\n              <option value="#0FF">Cyan</option>\n            </select>\n            <span class="vjs-window-opacity vjs-opacity">\n                <select>\n                  <option value="">---</option>\n                  <option value="1">Opaque</option>\n                  <option value="0.5">Semi-Transparent</option>\n                  <option value="0">Transparent</option>\n                </select>\n            </span>\n        </div> <!-- vjs-window-color -->\n      </div> <!-- vjs-tracksettings -->\n      <div class="vjs-tracksettings-font">\n        <div class="vjs-font-percent vjs-tracksetting">\n          <label class="vjs-label">Font Size</label>\n          <select>\n            <option value="0.50">50%</option>\n            <option value="0.75">75%</option>\n            <option value="1.00" selected>100%</option>\n            <option value="1.25">125%</option>\n            <option value="1.50">150%</option>\n            <option value="1.75">175%</option>\n            <option value="2.00">200%</option>\n            <option value="3.00">300%</option>\n            <option value="4.00">400%</option>\n          </select>\n        </div> <!-- vjs-font-percent -->\n        <div class="vjs-edge-style vjs-tracksetting">\n          <label class="vjs-label">Text Edge Style</label>\n          <select>\n            <option value="none">None</option>\n            <option value="raised">Raised</option>\n            <option value="depressed">Depressed</option>\n            <option value="uniform">Uniform</option>\n            <option value="dropshadow">Dropshadow</option>\n          </select>\n        </div> <!-- vjs-edge-style -->\n        <div class="vjs-font-family vjs-tracksetting">\n          <label class="vjs-label">Font Family</label>\n          <select>\n            <option value="">Default</option>\n            <option value="monospaceSerif">Monospace Serif</option>\n            <option value="proportionalSerif">Proportional Serif</option>\n            <option value="monospaceSansSerif">Monospace Sans-Serif</option>\n            <option value="proportionalSansSerif">Proportional Sans-Serif</option>\n            <option value="casual">Casual</option>\n            <option value="script">Script</option>\n            <option value="small-caps">Small Caps</option>\n          </select>\n        </div> <!-- vjs-font-family -->\n      </div>\n    </div>\n    <div class="vjs-tracksettings-controls">\n      <button class="vjs-default-button">Defaults</button>\n      <button class="vjs-done-button">Done</button>\n    </div>';return template}exports["default"]=TextTrackSettings;module.exports=exports["default"]},{"../component":68,"../utils/events.js":147,"../utils/fn.js":148,"../utils/log.js":151,"global/window":10,"safe-json-parse/tuple":59}],137:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _textTrackCueList=_dereq_("./text-track-cue-list");var _textTrackCueList2=_interopRequireDefault(_textTrackCueList);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _trackEnums=_dereq_("./track-enums");var _utilsLogJs=_dereq_("../utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _trackJs=_dereq_("./track.js");var _trackJs2=_interopRequireDefault(_trackJs);var _utilsUrlJs=_dereq_("../utils/url.js");var _xhr=_dereq_("xhr");var _xhr2=_interopRequireDefault(_xhr);var _utilsMergeOptions=_dereq_("../utils/merge-options");var _utilsMergeOptions2=_interopRequireDefault(_utilsMergeOptions);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var parseCues=function parseCues(srcContent,track){var parser=new _globalWindow2["default"].WebVTT.Parser(_globalWindow2["default"],_globalWindow2["default"].vttjs,_globalWindow2["default"].WebVTT.StringDecoder());var errors=[];parser.oncue=function(cue){track.addCue(cue)};parser.onparsingerror=function(error){errors.push(error)};parser.onflush=function(){track.trigger({type:"loadeddata",target:track})};parser.parse(srcContent);if(errors.length>0){if(console.groupCollapsed){console.groupCollapsed("Text Track parsing errors for "+track.src)}errors.forEach(function(error){return _utilsLogJs2["default"].error(error)});if(console.groupEnd){console.groupEnd()}}parser.flush()};var loadTrack=function loadTrack(src,track){var opts={uri:src};var crossOrigin=_utilsUrlJs.isCrossOrigin(src);if(crossOrigin){opts.cors=crossOrigin}_xhr2["default"](opts,Fn.bind(this,function(err,response,responseBody){if(err){return _utilsLogJs2["default"].error(err,response)}track.loaded_=true;if(typeof _globalWindow2["default"].WebVTT!=="function"){if(track.tech_){(function(){var loadHandler=function loadHandler(){return parseCues(responseBody,track)};track.tech_.on("vttjsloaded",loadHandler);track.tech_.on("vttjserror",function(){_utilsLogJs2["default"].error("vttjs failed to load, stopping trying to process "+track.src);track.tech_.off("vttjsloaded",loadHandler)})})()}}else{parseCues(responseBody,track)}}))};var TextTrack=function(_Track){_inherits(TextTrack,_Track);function TextTrack(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,TextTrack);if(!options.tech){throw new Error("A tech was not provided.")}var settings=_utilsMergeOptions2["default"](options,{kind:_trackEnums.TextTrackKind[options.kind]||"subtitles",language:options.language||options.srclang||""});var mode=_trackEnums.TextTrackMode[settings.mode]||"disabled";var default_=settings["default"];if(settings.kind==="metadata"||settings.kind==="chapters"){mode="hidden"}var tt=_Track.call(this,settings);tt.tech_=settings.tech;if(browser.IS_IE8){for(var prop in TextTrack.prototype){if(prop!=="constructor"){tt[prop]=TextTrack.prototype[prop]}}}tt.cues_=[];tt.activeCues_=[];var cues=new _textTrackCueList2["default"](tt.cues_);var activeCues=new _textTrackCueList2["default"](tt.activeCues_);var changed=false;var timeupdateHandler=Fn.bind(tt,function(){this.activeCues;if(changed){this.trigger("cuechange");changed=false}});if(mode!=="disabled"){tt.tech_.on("timeupdate",timeupdateHandler)}Object.defineProperty(tt,"default",{get:function get(){return default_},set:function set(){}});Object.defineProperty(tt,"mode",{get:function get(){return mode},set:function set(newMode){if(!_trackEnums.TextTrackMode[newMode]){return}mode=newMode;if(mode==="showing"){this.tech_.on("timeupdate",timeupdateHandler)}this.trigger("modechange")}});Object.defineProperty(tt,"cues",{get:function get(){if(!this.loaded_){return null}return cues},set:function set(){}});Object.defineProperty(tt,"activeCues",{get:function get(){if(!this.loaded_){return null}if(this.cues.length===0){return activeCues}var ct=this.tech_.currentTime();var active=[];for(var i=0,l=this.cues.length;i<l;i++){var cue=this.cues[i];if(cue.startTime<=ct&&cue.endTime>=ct){active.push(cue)}else if(cue.startTime===cue.endTime&&cue.startTime<=ct&&cue.startTime+.5>=ct){active.push(cue)}}changed=false;if(active.length!==this.activeCues_.length){changed=true}else{for(var i=0;i<active.length;i++){if(this.activeCues_.indexOf(active[i])===-1){changed=true}}}this.activeCues_=active;activeCues.setCues_(this.activeCues_);return activeCues},set:function set(){}});if(settings.src){tt.src=settings.src;loadTrack(settings.src,tt)}else{tt.loaded_=true}return tt}TextTrack.prototype.addCue=function addCue(cue){var tracks=this.tech_.textTracks();if(tracks){for(var i=0;i<tracks.length;i++){if(tracks[i]!==this){tracks[i].removeCue(cue)}}}this.cues_.push(cue);this.cues.setCues_(this.cues_)};TextTrack.prototype.removeCue=function removeCue(_removeCue){var removed=false;for(var i=0,l=this.cues_.length;i<l;i++){var cue=this.cues_[i];if(cue===_removeCue){this.cues_.splice(i,1);removed=true}}if(removed){this.cues.setCues_(this.cues_)}};return TextTrack}(_trackJs2["default"]);TextTrack.prototype.allowedEvents_={cuechange:"cuechange"};exports["default"]=TextTrack;module.exports=exports["default"]},{"../utils/browser.js":143,"../utils/fn.js":148,"../utils/log.js":151,"../utils/merge-options":152,"../utils/url.js":156,"./text-track-cue-list":132,"./track-enums":138,"./track.js":140,"global/document":9,"global/window":10,xhr:62}],138:[function(_dereq_,module,exports){exports.__esModule=true;var VideoTrackKind={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"};var AudioTrackKind={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"};var TextTrackKind={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"};var TextTrackMode={disabled:"disabled",hidden:"hidden",showing:"showing"};exports["default"]={VideoTrackKind:VideoTrackKind,AudioTrackKind:AudioTrackKind,TextTrackKind:TextTrackKind,TextTrackMode:TextTrackMode};module.exports=exports["default"]},{}],139:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _eventTarget=_dereq_("../event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var _utilsFnJs=_dereq_("../utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var TrackList=function(_EventTarget){_inherits(TrackList,_EventTarget);function TrackList(){var tracks=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];var list=arguments.length<=1||arguments[1]===undefined?null:arguments[1];_classCallCheck(this,TrackList);_EventTarget.call(this);if(!list){list=this;if(browser.IS_IE8){list=_globalDocument2["default"].createElement("custom");for(var prop in TrackList.prototype){if(prop!=="constructor"){list[prop]=TrackList.prototype[prop]}}}}list.tracks_=[];Object.defineProperty(list,"length",{get:function get(){return this.tracks_.length}});for(var i=0;i<tracks.length;i++){list.addTrack_(tracks[i])}return list}TrackList.prototype.addTrack_=function addTrack_(track){var index=this.tracks_.length;if(!(""+index in this)){Object.defineProperty(this,index,{get:function get(){return this.tracks_[index]}})}if(this.tracks_.indexOf(track)===-1){this.tracks_.push(track);this.trigger({track:track,type:"addtrack"})}};TrackList.prototype.removeTrack_=function removeTrack_(rtrack){var track=undefined;for(var i=0,l=this.length;i<l;i++){if(this[i]===rtrack){track=this[i];if(track.off){track.off()}this.tracks_.splice(i,1);break}}if(!track){return}this.trigger({track:track,type:"removetrack"})};TrackList.prototype.getTrackById=function getTrackById(id){var result=null;for(var i=0,l=this.length;i<l;i++){var track=this[i];if(track.id===id){result=track;break}}return result};return TrackList}(_eventTarget2["default"]);TrackList.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var _event in TrackList.prototype.allowedEvents_){TrackList.prototype["on"+_event]=null}exports["default"]=TrackList;module.exports=exports["default"]},{"../event-target":106,"../utils/browser.js":143,"../utils/fn.js":148,"global/document":9}],140:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,
enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _utilsGuidJs=_dereq_("../utils/guid.js");var Guid=_interopRequireWildcard(_utilsGuidJs);var _eventTarget=_dereq_("../event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var Track=function(_EventTarget){_inherits(Track,_EventTarget);function Track(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,Track);_EventTarget.call(this);var track=this;if(browser.IS_IE8){track=_globalDocument2["default"].createElement("custom");for(var prop in Track.prototype){if(prop!=="constructor"){track[prop]=Track.prototype[prop]}}}var trackProps={id:options.id||"vjs_track_"+Guid.newGUID(),kind:options.kind||"",label:options.label||"",language:options.language||""};var _loop=function(key){Object.defineProperty(track,key,{get:function get(){return trackProps[key]},set:function set(){}})};for(var key in trackProps){_loop(key)}return track}return Track}(_eventTarget2["default"]);exports["default"]=Track;module.exports=exports["default"]},{"../event-target":106,"../utils/browser.js":143,"../utils/guid.js":150,"global/document":9}],141:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _trackList=_dereq_("./track-list");var _trackList2=_interopRequireDefault(_trackList);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var disableOthers=function disableOthers(list,track){for(var i=0;i<list.length;i++){if(track.id===list[i].id){continue}list[i].selected=false}};var VideoTrackList=function(_TrackList){_inherits(VideoTrackList,_TrackList);function VideoTrackList(){var tracks=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];_classCallCheck(this,VideoTrackList);var list=undefined;for(var i=tracks.length-1;i>=0;i--){if(tracks[i].selected){disableOthers(tracks,tracks[i]);break}}if(browser.IS_IE8){list=_globalDocument2["default"].createElement("custom");for(var prop in _trackList2["default"].prototype){if(prop!=="constructor"){list[prop]=_trackList2["default"].prototype[prop]}}for(var prop in VideoTrackList.prototype){if(prop!=="constructor"){list[prop]=VideoTrackList.prototype[prop]}}}list=_TrackList.call(this,tracks,list);list.changing_=false;Object.defineProperty(list,"selectedIndex",{get:function get(){for(var i=0;i<this.length;i++){if(this[i].selected){return i}}return-1},set:function set(){}});return list}VideoTrackList.prototype.addTrack_=function addTrack_(track){var _this=this;if(track.selected){disableOthers(this,track)}_TrackList.prototype.addTrack_.call(this,track);if(!track.addEventListener){return}track.addEventListener("selectedchange",function(){if(_this.changing_){return}_this.changing_=true;disableOthers(_this,track);_this.changing_=false;_this.trigger("change")})};VideoTrackList.prototype.addTrack=function addTrack(track){this.addTrack_(track)};VideoTrackList.prototype.removeTrack=function removeTrack(track){_TrackList.prototype.removeTrack_.call(this,track)};return VideoTrackList}(_trackList2["default"]);exports["default"]=VideoTrackList;module.exports=exports["default"]},{"../utils/browser.js":143,"./track-list":139,"global/document":9}],142:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _trackEnums=_dereq_("./track-enums");var _track=_dereq_("./track");var _track2=_interopRequireDefault(_track);var _utilsMergeOptions=_dereq_("../utils/merge-options");var _utilsMergeOptions2=_interopRequireDefault(_utilsMergeOptions);var _utilsBrowserJs=_dereq_("../utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var VideoTrack=function(_Track){_inherits(VideoTrack,_Track);function VideoTrack(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,VideoTrack);var settings=_utilsMergeOptions2["default"](options,{kind:_trackEnums.VideoTrackKind[options.kind]||""});var track=_Track.call(this,settings);var selected=false;if(browser.IS_IE8){for(var prop in VideoTrack.prototype){if(prop!=="constructor"){track[prop]=VideoTrack.prototype[prop]}}}Object.defineProperty(track,"selected",{get:function get(){return selected},set:function set(newSelected){if(typeof newSelected!=="boolean"||newSelected===selected){return}selected=newSelected;this.trigger("selectedchange")}});if(settings.selected){track.selected=settings.selected}return track}return VideoTrack}(_track2["default"]);exports["default"]=VideoTrack;module.exports=exports["default"]},{"../utils/browser.js":143,"../utils/merge-options":152,"./track":140,"./track-enums":138}],143:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var USER_AGENT=_globalWindow2["default"].navigator.userAgent;var webkitVersionMap=/AppleWebKit\/([\d.]+)/i.exec(USER_AGENT);var appleWebkitVersion=webkitVersionMap?parseFloat(webkitVersionMap.pop()):null;var IS_IPAD=/iPad/i.test(USER_AGENT);exports.IS_IPAD=IS_IPAD;var IS_IPHONE=/iPhone/i.test(USER_AGENT)&&!IS_IPAD;exports.IS_IPHONE=IS_IPHONE;var IS_IPOD=/iPod/i.test(USER_AGENT);exports.IS_IPOD=IS_IPOD;var IS_IOS=IS_IPHONE||IS_IPAD||IS_IPOD;exports.IS_IOS=IS_IOS;var IOS_VERSION=function(){var match=USER_AGENT.match(/OS (\d+)_/i);if(match&&match[1]){return match[1]}}();exports.IOS_VERSION=IOS_VERSION;var IS_ANDROID=/Android/i.test(USER_AGENT);exports.IS_ANDROID=IS_ANDROID;var ANDROID_VERSION=function(){var match=USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),major,minor;if(!match){return null}major=match[1]&&parseFloat(match[1]);minor=match[2]&&parseFloat(match[2]);if(major&&minor){return parseFloat(match[1]+"."+match[2])}else if(major){return major}else{return null}}();exports.ANDROID_VERSION=ANDROID_VERSION;var IS_OLD_ANDROID=IS_ANDROID&&/webkit/i.test(USER_AGENT)&&ANDROID_VERSION<2.3;exports.IS_OLD_ANDROID=IS_OLD_ANDROID;var IS_NATIVE_ANDROID=IS_ANDROID&&ANDROID_VERSION<5&&appleWebkitVersion<537;exports.IS_NATIVE_ANDROID=IS_NATIVE_ANDROID;var IS_FIREFOX=/Firefox/i.test(USER_AGENT);exports.IS_FIREFOX=IS_FIREFOX;var IS_EDGE=/Edge/i.test(USER_AGENT);exports.IS_EDGE=IS_EDGE;var IS_CHROME=!IS_EDGE&&/Chrome/i.test(USER_AGENT);exports.IS_CHROME=IS_CHROME;var IS_IE8=/MSIE\s8\.0/.test(USER_AGENT);exports.IS_IE8=IS_IE8;var TOUCH_ENABLED=!!("ontouchstart"in _globalWindow2["default"]||_globalWindow2["default"].DocumentTouch&&_globalDocument2["default"]instanceof _globalWindow2["default"].DocumentTouch);exports.TOUCH_ENABLED=TOUCH_ENABLED;var BACKGROUND_SIZE_SUPPORTED="backgroundSize"in _globalDocument2["default"].createElement("video").style;exports.BACKGROUND_SIZE_SUPPORTED=BACKGROUND_SIZE_SUPPORTED},{"global/document":9,"global/window":10}],144:[function(_dereq_,module,exports){exports.__esModule=true;exports.bufferedPercent=bufferedPercent;var _timeRangesJs=_dereq_("./time-ranges.js");function bufferedPercent(buffered,duration){var bufferedDuration=0,start,end;if(!duration){return 0}if(!buffered||!buffered.length){buffered=_timeRangesJs.createTimeRange(0,0)}for(var i=0;i<buffered.length;i++){start=buffered.start(i);end=buffered.end(i);if(end>duration){end=duration}bufferedDuration+=end-start}return bufferedDuration/duration}},{"./time-ranges.js":154}],145:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _logJs=_dereq_("./log.js");var _logJs2=_interopRequireDefault(_logJs);var defaultBehaviors={get:function get(obj,key){return obj[key]},set:function set(obj,key,value){obj[key]=value;return true}};exports["default"]=function(target){var messages=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];if(typeof Proxy==="function"){var _ret=function(){var handler={};Object.keys(messages).forEach(function(key){if(defaultBehaviors.hasOwnProperty(key)){handler[key]=function(){_logJs2["default"].warn(messages[key]);return defaultBehaviors[key].apply(this,arguments)}}});return{v:new Proxy(target,handler)}}();if(typeof _ret==="object")return _ret.v}return target};module.exports=exports["default"]},{"./log.js":151}],146:[function(_dereq_,module,exports){exports.__esModule=true;exports.getEl=getEl;exports.createEl=createEl;exports.textContent=textContent;exports.insertElFirst=insertElFirst;exports.getElData=getElData;exports.hasElData=hasElData;exports.removeElData=removeElData;exports.hasElClass=hasElClass;exports.addElClass=addElClass;exports.removeElClass=removeElClass;exports.toggleElClass=toggleElClass;exports.setElAttributes=setElAttributes;exports.getElAttributes=getElAttributes;exports.blockTextSelection=blockTextSelection;exports.unblockTextSelection=unblockTextSelection;exports.findElPosition=findElPosition;exports.getPointerPosition=getPointerPosition;exports.isEl=isEl;exports.isTextNode=isTextNode;exports.emptyEl=emptyEl;exports.normalizeContent=normalizeContent;exports.appendContent=appendContent;exports.insertContent=insertContent;var _templateObject=_taggedTemplateLiteralLoose(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _taggedTemplateLiteralLoose(strings,raw){strings.raw=raw;return strings}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _guidJs=_dereq_("./guid.js");var Guid=_interopRequireWildcard(_guidJs);var _logJs=_dereq_("./log.js");var _logJs2=_interopRequireDefault(_logJs);var _tsml=_dereq_("tsml");var _tsml2=_interopRequireDefault(_tsml);function isNonBlankString(str){return typeof str==="string"&&/\S/.test(str)}function throwIfWhitespace(str){if(/\s/.test(str)){throw new Error("class has illegal whitespace characters")}}function classRegExp(className){return new RegExp("(^|\\s)"+className+"($|\\s)")}function createQuerier(method){return function(selector,context){if(!isNonBlankString(selector)){return _globalDocument2["default"][method](null)}if(isNonBlankString(context)){context=_globalDocument2["default"].querySelector(context)}return(isEl(context)?context:_globalDocument2["default"])[method](selector)}}function getEl(id){if(id.indexOf("#")===0){id=id.slice(1)}return _globalDocument2["default"].getElementById(id)}function createEl(){var tagName=arguments.length<=0||arguments[0]===undefined?"div":arguments[0];var properties=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var attributes=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];var el=_globalDocument2["default"].createElement(tagName);Object.getOwnPropertyNames(properties).forEach(function(propName){var val=properties[propName];if(propName.indexOf("aria-")!==-1||propName==="role"||propName==="type"){_logJs2["default"].warn(_tsml2["default"](_templateObject,propName,val));el.setAttribute(propName,val)}else{el[propName]=val}});Object.getOwnPropertyNames(attributes).forEach(function(attrName){var val=attributes[attrName];el.setAttribute(attrName,attributes[attrName])});return el}function textContent(el,text){if(typeof el.textContent==="undefined"){el.innerText=text}else{el.textContent=text}}function insertElFirst(child,parent){if(parent.firstChild){parent.insertBefore(child,parent.firstChild)}else{parent.appendChild(child)}}var elData={};var elIdAttr="vdata"+(new Date).getTime();function getElData(el){var id=el[elIdAttr];if(!id){id=el[elIdAttr]=Guid.newGUID()}if(!elData[id]){elData[id]={}}return elData[id]}function hasElData(el){var id=el[elIdAttr];if(!id){return false}return!!Object.getOwnPropertyNames(elData[id]).length}function removeElData(el){var id=el[elIdAttr];if(!id){return}delete elData[id];try{delete el[elIdAttr]}catch(e){if(el.removeAttribute){el.removeAttribute(elIdAttr)}else{el[elIdAttr]=null}}}function hasElClass(element,classToCheck){if(element.classList){return element.classList.contains(classToCheck)}else{throwIfWhitespace(classToCheck);return classRegExp(classToCheck).test(element.className)}}function addElClass(element,classToAdd){if(element.classList){element.classList.add(classToAdd)}else if(!hasElClass(element,classToAdd)){element.className=(element.className+" "+classToAdd).trim()}return element}function removeElClass(element,classToRemove){if(element.classList){element.classList.remove(classToRemove)}else{throwIfWhitespace(classToRemove);element.className=element.className.split(/\s+/).filter(function(c){return c!==classToRemove}).join(" ")}return element}function toggleElClass(element,classToToggle,predicate){var has=hasElClass(element,classToToggle);if(typeof predicate==="function"){predicate=predicate(element,classToToggle)}if(typeof predicate!=="boolean"){predicate=!has}if(predicate===has){return}if(predicate){addElClass(element,classToToggle)}else{removeElClass(element,classToToggle)}return element}function setElAttributes(el,attributes){Object.getOwnPropertyNames(attributes).forEach(function(attrName){var attrValue=attributes[attrName];if(attrValue===null||typeof attrValue==="undefined"||attrValue===false){el.removeAttribute(attrName)}else{el.setAttribute(attrName,attrValue===true?"":attrValue)}})}function getElAttributes(tag){var obj,knownBooleans,attrs,attrName,attrVal;obj={};knownBooleans=","+"autoplay,controls,loop,muted,default"+",";if(tag&&tag.attributes&&tag.attributes.length>0){attrs=tag.attributes;for(var i=attrs.length-1;i>=0;i--){attrName=attrs[i].name;attrVal=attrs[i].value;if(typeof tag[attrName]==="boolean"||knownBooleans.indexOf(","+attrName+",")!==-1){attrVal=attrVal!==null?true:false}obj[attrName]=attrVal}}return obj}function blockTextSelection(){_globalDocument2["default"].body.focus();_globalDocument2["default"].onselectstart=function(){return false}}function unblockTextSelection(){_globalDocument2["default"].onselectstart=function(){return true}}function findElPosition(el){var box=undefined;if(el.getBoundingClientRect&&el.parentNode){box=el.getBoundingClientRect()}if(!box){return{left:0,top:0}}var docEl=_globalDocument2["default"].documentElement;var body=_globalDocument2["default"].body;var clientLeft=docEl.clientLeft||body.clientLeft||0;var scrollLeft=_globalWindow2["default"].pageXOffset||body.scrollLeft;var left=box.left+scrollLeft-clientLeft;var clientTop=docEl.clientTop||body.clientTop||0;var scrollTop=_globalWindow2["default"].pageYOffset||body.scrollTop;var top=box.top+scrollTop-clientTop;return{left:Math.round(left),top:Math.round(top)}}function getPointerPosition(el,event){var position={};var box=findElPosition(el);var boxW=el.offsetWidth;var boxH=el.offsetHeight;var boxY=box.top;var boxX=box.left;var pageY=event.pageY;var pageX=event.pageX;if(event.changedTouches){pageX=event.changedTouches[0].pageX;pageY=event.changedTouches[0].pageY}position.y=Math.max(0,Math.min(1,(boxY-pageY+boxH)/boxH));position.x=Math.max(0,Math.min(1,(pageX-boxX)/boxW));return position}function isEl(value){return!!value&&typeof value==="object"&&value.nodeType===1}function isTextNode(value){return!!value&&typeof value==="object"&&value.nodeType===3}function emptyEl(el){while(el.firstChild){el.removeChild(el.firstChild)}return el}function normalizeContent(content){if(typeof content==="function"){content=content()}return(Array.isArray(content)?content:[content]).map(function(value){if(typeof value==="function"){value=value()}if(isEl(value)||isTextNode(value)){return value}if(typeof value==="string"&&/\S/.test(value)){return _globalDocument2["default"].createTextNode(value)}}).filter(function(value){return value})}function appendContent(el,content){normalizeContent(content).forEach(function(node){return el.appendChild(node)});return el}function insertContent(el,content){return appendContent(emptyEl(el),content)}var $=createQuerier("querySelector");exports.$=$;var $$=createQuerier("querySelectorAll");exports.$$=$$},{"./guid.js":150,"./log.js":151,"global/document":9,"global/window":10,tsml:61}],147:[function(_dereq_,module,exports){exports.__esModule=true;exports.on=on;exports.off=off;exports.trigger=trigger;exports.one=one;exports.fixEvent=fixEvent;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}var _domJs=_dereq_("./dom.js");var Dom=_interopRequireWildcard(_domJs);var _guidJs=_dereq_("./guid.js");var Guid=_interopRequireWildcard(_guidJs);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);function on(elem,type,fn){if(Array.isArray(type)){return _handleMultipleEvents(on,elem,type,fn)}var data=Dom.getElData(elem);if(!data.handlers)data.handlers={};if(!data.handlers[type])data.handlers[type]=[];if(!fn.guid)fn.guid=Guid.newGUID();data.handlers[type].push(fn);if(!data.dispatcher){data.disabled=false;data.dispatcher=function(event,hash){if(data.disabled)return;event=fixEvent(event);var handlers=data.handlers[event.type];if(handlers){var handlersCopy=handlers.slice(0);for(var m=0,n=handlersCopy.length;m<n;m++){if(event.isImmediatePropagationStopped()){break}else{handlersCopy[m].call(elem,event,hash)}}}}}if(data.handlers[type].length===1){if(elem.addEventListener){elem.addEventListener(type,data.dispatcher,false)}else if(elem.attachEvent){elem.attachEvent("on"+type,data.dispatcher)}}}function off(elem,type,fn){if(!Dom.hasElData(elem))return;var data=Dom.getElData(elem);if(!data.handlers){return}if(Array.isArray(type)){return _handleMultipleEvents(off,elem,type,fn)}var removeType=function removeType(t){data.handlers[t]=[];_cleanUpEvents(elem,t)};if(!type){for(var t in data.handlers){removeType(t)}return}var handlers=data.handlers[type];if(!handlers)return;if(!fn){removeType(type);return}if(fn.guid){for(var n=0;n<handlers.length;n++){if(handlers[n].guid===fn.guid){handlers.splice(n--,1)}}}_cleanUpEvents(elem,type)}function trigger(elem,event,hash){var elemData=Dom.hasElData(elem)?Dom.getElData(elem):{};var parent=elem.parentNode||elem.ownerDocument;if(typeof event==="string"){event={type:event,target:elem}}event=fixEvent(event);if(elemData.dispatcher){elemData.dispatcher.call(elem,event,hash)}if(parent&&!event.isPropagationStopped()&&event.bubbles===true){trigger.call(null,parent,event,hash)}else if(!parent&&!event.defaultPrevented){var targetData=Dom.getElData(event.target);if(event.target[event.type]){targetData.disabled=true;if(typeof event.target[event.type]==="function"){event.target[event.type]()}targetData.disabled=false}}return!event.defaultPrevented}function one(elem,type,fn){if(Array.isArray(type)){return _handleMultipleEvents(one,elem,type,fn)}var func=function func(){off(elem,type,func);fn.apply(this,arguments)};func.guid=fn.guid=fn.guid||Guid.newGUID();on(elem,type,func)}function fixEvent(event){function returnTrue(){return true}function returnFalse(){return false}if(!event||!event.isPropagationStopped){var old=event||_globalWindow2["default"].event;event={};for(var key in old){if(key!=="layerX"&&key!=="layerY"&&key!=="keyLocation"&&key!=="webkitMovementX"&&key!=="webkitMovementY"){if(!(key==="returnValue"&&old.preventDefault)){event[key]=old[key]}}}if(!event.target){event.target=event.srcElement||_globalDocument2["default"]}if(!event.relatedTarget){event.relatedTarget=event.fromElement===event.target?event.toElement:event.fromElement}event.preventDefault=function(){if(old.preventDefault){old.preventDefault()}event.returnValue=false;old.returnValue=false;event.defaultPrevented=true};event.defaultPrevented=false;event.stopPropagation=function(){if(old.stopPropagation){old.stopPropagation()}event.cancelBubble=true;old.cancelBubble=true;event.isPropagationStopped=returnTrue};event.isPropagationStopped=returnFalse;event.stopImmediatePropagation=function(){if(old.stopImmediatePropagation){old.stopImmediatePropagation()}event.isImmediatePropagationStopped=returnTrue;event.stopPropagation()};event.isImmediatePropagationStopped=returnFalse;if(event.clientX!=null){var doc=_globalDocument2["default"].documentElement,body=_globalDocument2["default"].body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}event.which=event.charCode||event.keyCode;if(event.button!=null){event.button=event.button&1?0:event.button&4?1:event.button&2?2:0}}return event}function _cleanUpEvents(elem,type){var data=Dom.getElData(elem);if(data.handlers[type].length===0){delete data.handlers[type];if(elem.removeEventListener){elem.removeEventListener(type,data.dispatcher,false)}else if(elem.detachEvent){elem.detachEvent("on"+type,data.dispatcher)}}if(Object.getOwnPropertyNames(data.handlers).length<=0){delete data.handlers;delete data.dispatcher;delete data.disabled}if(Object.getOwnPropertyNames(data).length===0){Dom.removeElData(elem)}}function _handleMultipleEvents(fn,elem,types,callback){types.forEach(function(type){fn(elem,type,callback)})}},{"./dom.js":146,"./guid.js":150,"global/document":9,"global/window":10}],148:[function(_dereq_,module,exports){exports.__esModule=true;var _guidJs=_dereq_("./guid.js");var bind=function bind(context,fn,uid){if(!fn.guid){fn.guid=_guidJs.newGUID()}var ret=function ret(){return fn.apply(context,arguments)};ret.guid=uid?uid+"_"+fn.guid:fn.guid;return ret};exports.bind=bind},{"./guid.js":150}],149:[function(_dereq_,module,exports){exports.__esModule=true;function formatTime(seconds){var guide=arguments.length<=1||arguments[1]===undefined?seconds:arguments[1];return function(){seconds=seconds<0?0:seconds;var s=Math.floor(seconds%60);var m=Math.floor(seconds/60%60);var h=Math.floor(seconds/3600);var gm=Math.floor(guide/60%60);var gh=Math.floor(guide/3600);if(isNaN(seconds)||seconds===Infinity){h=m=s="-"}h=h>0||gh>0?h+":":"";m=((h||gm>=10)&&m<10?"0"+m:m)+":";s=s<10?"0"+s:s;return h+m+s}()}exports["default"]=formatTime;module.exports=exports["default"]},{}],150:[function(_dereq_,module,exports){exports.__esModule=true;exports.newGUID=newGUID;var _guid=1;function newGUID(){return _guid++}},{}],151:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var log=function log(){_logType(null,arguments)};log.history=[];log.error=function(){_logType("error",arguments)};log.warn=function(){_logType("warn",arguments)};function _logType(type,args){var argsArray=Array.prototype.slice.call(args);var noop=function noop(){};var console=_globalWindow2["default"]["console"]||{log:noop,warn:noop,error:noop};if(type){argsArray.unshift(type.toUpperCase()+":")}else{type="log"}log.history.push(argsArray);argsArray.unshift("VIDEOJS:");if(console[type].apply){console[type].apply(console,argsArray)}else{console[type](argsArray.join(" "))}}exports["default"]=log;module.exports=exports["default"]},{"global/window":10}],152:[function(_dereq_,module,exports){exports.__esModule=true;exports["default"]=mergeOptions;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _lodashCompatObjectMerge=_dereq_("lodash-compat/object/merge");var _lodashCompatObjectMerge2=_interopRequireDefault(_lodashCompatObjectMerge);function isPlain(obj){return!!obj&&typeof obj==="object"&&obj.toString()==="[object Object]"&&obj.constructor===Object}var customizer=function customizer(destination,source){if(!isPlain(source)){return source}if(!isPlain(destination)){return mergeOptions(source)}};function mergeOptions(){var args=Array.prototype.slice.call(arguments);args.unshift({});args.push(customizer);_lodashCompatObjectMerge2["default"].apply(null,args);return args[0]}module.exports=exports["default"]},{"lodash-compat/object/merge":48}],153:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var createStyleElement=function createStyleElement(className){var style=_globalDocument2["default"].createElement("style");style.className=className;return style};exports.createStyleElement=createStyleElement;var setTextContent=function setTextContent(el,content){if(el.styleSheet){el.styleSheet.cssText=content}else{el.textContent=content}};exports.setTextContent=setTextContent},{"global/document":9}],154:[function(_dereq_,module,exports){exports.__esModule=true;exports.createTimeRanges=createTimeRanges;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _logJs=_dereq_("./log.js");var _logJs2=_interopRequireDefault(_logJs);function createTimeRanges(start,end){if(Array.isArray(start)){return createTimeRangesObj(start)}else if(start===undefined||end===undefined){return createTimeRangesObj()}return createTimeRangesObj([[start,end]])}exports.createTimeRange=createTimeRanges;function createTimeRangesObj(ranges){if(ranges===undefined||ranges.length===0){return{length:0,start:function start(){throw new Error("This TimeRanges object is empty")},end:function end(){throw new Error("This TimeRanges object is empty")}}}return{length:ranges.length,start:getRange.bind(null,"start",0,ranges),end:getRange.bind(null,"end",1,ranges)}}function getRange(fnName,valueIndex,ranges,rangeIndex){if(rangeIndex===undefined){_logJs2["default"].warn("DEPRECATED: Function '"+fnName+"' on 'TimeRanges' called without an index argument.");rangeIndex=0}rangeCheck(fnName,rangeIndex,ranges.length-1);return ranges[rangeIndex][valueIndex]}function rangeCheck(fnName,index,maxIndex){if(index<0||index>maxIndex){throw new Error("Failed to execute '"+fnName+"' on 'TimeRanges': The index provided ("+index+") is greater than or equal to the maximum bound ("+maxIndex+").")}}},{"./log.js":151}],155:[function(_dereq_,module,exports){exports.__esModule=true;function toTitleCase(string){return string.charAt(0).toUpperCase()+string.slice(1)}exports["default"]=toTitleCase;module.exports=exports["default"]},{}],156:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _globalDocument=_dereq_("global/document");var _globalDocument2=_interopRequireDefault(_globalDocument);var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var parseUrl=function parseUrl(url){var props=["protocol","hostname","port","pathname","search","hash","host"];var a=_globalDocument2["default"].createElement("a");a.href=url;var addToBody=a.host===""&&a.protocol!=="file:";var div=undefined;if(addToBody){div=_globalDocument2["default"].createElement("div");div.innerHTML='<a href="'+url+'"></a>';a=div.firstChild;div.setAttribute("style","display:none; position:absolute;");_globalDocument2["default"].body.appendChild(div)}var details={};for(var i=0;i<props.length;i++){details[props[i]]=a[props[i]]}if(details.protocol==="http:"){details.host=details.host.replace(/:80$/,"")}if(details.protocol==="https:"){details.host=details.host.replace(/:443$/,"")}if(addToBody){_globalDocument2["default"].body.removeChild(div)}return details};exports.parseUrl=parseUrl;var getAbsoluteURL=function getAbsoluteURL(url){if(!url.match(/^https?:\/\//)){var div=_globalDocument2["default"].createElement("div");div.innerHTML='<a href="'+url+'">x</a>';url=div.firstChild.href}return url};exports.getAbsoluteURL=getAbsoluteURL;var getFileExtension=function getFileExtension(path){if(typeof path==="string"){var splitPathRe=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i;var pathParts=splitPathRe.exec(path);if(pathParts){return pathParts.pop().toLowerCase()}}return""};exports.getFileExtension=getFileExtension;var isCrossOrigin=function isCrossOrigin(url){var winLoc=_globalWindow2["default"].location;var urlInfo=parseUrl(url);var srcProtocol=urlInfo.protocol===":"?winLoc.protocol:urlInfo.protocol;var crossOrigin=srcProtocol+urlInfo.host!==winLoc.protocol+winLoc.host;return crossOrigin};exports.isCrossOrigin=isCrossOrigin},{"global/document":9,"global/window":10}],157:[function(_dereq_,module,exports){exports.__esModule=true;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _globalWindow=_dereq_("global/window");var _globalWindow2=_interopRequireDefault(_globalWindow);var _globalDocument=_dereq_("global/document");
var _globalDocument2=_interopRequireDefault(_globalDocument);var _setup=_dereq_("./setup");var setup=_interopRequireWildcard(_setup);var _utilsStylesheetJs=_dereq_("./utils/stylesheet.js");var stylesheet=_interopRequireWildcard(_utilsStylesheetJs);var _component=_dereq_("./component");var _component2=_interopRequireDefault(_component);var _eventTarget=_dereq_("./event-target");var _eventTarget2=_interopRequireDefault(_eventTarget);var _utilsEventsJs=_dereq_("./utils/events.js");var Events=_interopRequireWildcard(_utilsEventsJs);var _player=_dereq_("./player");var _player2=_interopRequireDefault(_player);var _pluginsJs=_dereq_("./plugins.js");var _pluginsJs2=_interopRequireDefault(_pluginsJs);var _srcJsUtilsMergeOptionsJs=_dereq_("../../src/js/utils/merge-options.js");var _srcJsUtilsMergeOptionsJs2=_interopRequireDefault(_srcJsUtilsMergeOptionsJs);var _utilsFnJs=_dereq_("./utils/fn.js");var Fn=_interopRequireWildcard(_utilsFnJs);var _tracksTextTrackJs=_dereq_("./tracks/text-track.js");var _tracksTextTrackJs2=_interopRequireDefault(_tracksTextTrackJs);var _tracksAudioTrackJs=_dereq_("./tracks/audio-track.js");var _tracksAudioTrackJs2=_interopRequireDefault(_tracksAudioTrackJs);var _tracksVideoTrackJs=_dereq_("./tracks/video-track.js");var _tracksVideoTrackJs2=_interopRequireDefault(_tracksVideoTrackJs);var _objectAssign=_dereq_("object.assign");var _objectAssign2=_interopRequireDefault(_objectAssign);var _utilsTimeRangesJs=_dereq_("./utils/time-ranges.js");var _utilsFormatTimeJs=_dereq_("./utils/format-time.js");var _utilsFormatTimeJs2=_interopRequireDefault(_utilsFormatTimeJs);var _utilsLogJs=_dereq_("./utils/log.js");var _utilsLogJs2=_interopRequireDefault(_utilsLogJs);var _utilsDomJs=_dereq_("./utils/dom.js");var Dom=_interopRequireWildcard(_utilsDomJs);var _utilsBrowserJs=_dereq_("./utils/browser.js");var browser=_interopRequireWildcard(_utilsBrowserJs);var _utilsUrlJs=_dereq_("./utils/url.js");var Url=_interopRequireWildcard(_utilsUrlJs);var _extendJs=_dereq_("./extend.js");var _extendJs2=_interopRequireDefault(_extendJs);var _lodashCompatObjectMerge=_dereq_("lodash-compat/object/merge");var _lodashCompatObjectMerge2=_interopRequireDefault(_lodashCompatObjectMerge);var _utilsCreateDeprecationProxyJs=_dereq_("./utils/create-deprecation-proxy.js");var _utilsCreateDeprecationProxyJs2=_interopRequireDefault(_utilsCreateDeprecationProxyJs);var _xhr=_dereq_("xhr");var _xhr2=_interopRequireDefault(_xhr);var _techTechJs=_dereq_("./tech/tech.js");var _techTechJs2=_interopRequireDefault(_techTechJs);var _techHtml5Js=_dereq_("./tech/html5.js");var _techHtml5Js2=_interopRequireDefault(_techHtml5Js);var _techFlashJs=_dereq_("./tech/flash.js");var _techFlashJs2=_interopRequireDefault(_techFlashJs);if(typeof HTMLVideoElement==="undefined"){_globalDocument2["default"].createElement("video");_globalDocument2["default"].createElement("audio");_globalDocument2["default"].createElement("track")}var videojs=function videojs(id,options,ready){var tag=undefined;if(typeof id==="string"){if(id.indexOf("#")===0){id=id.slice(1)}if(videojs.getPlayers()[id]){if(options){_utilsLogJs2["default"].warn('Player "'+id+'" is already initialised. Options will not be applied.')}if(ready){videojs.getPlayers()[id].ready(ready)}return videojs.getPlayers()[id]}else{tag=Dom.getEl(id)}}else{tag=id}if(!tag||!tag.nodeName){throw new TypeError("The element or ID supplied is not valid. (videojs)")}return tag["player"]||_player2["default"].players[tag.playerId]||new _player2["default"](tag,options,ready)};if(_globalWindow2["default"].VIDEOJS_NO_DYNAMIC_STYLE!==true){var style=Dom.$(".vjs-styles-defaults");if(!style){style=stylesheet.createStyleElement("vjs-styles-defaults");var head=Dom.$("head");head.insertBefore(style,head.firstChild);stylesheet.setTextContent(style,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}setup.autoSetupTimeout(1,videojs);videojs.VERSION="5.10.2-25";videojs.HOLA_VERSION=true;videojs.options=_player2["default"].prototype.options_;videojs.getPlayers=function(){return _player2["default"].players};videojs.players=_utilsCreateDeprecationProxyJs2["default"](_player2["default"].players,{get:"Access to videojs.players is deprecated; use videojs.getPlayers instead",set:"Modification of videojs.players is deprecated"});videojs.getComponent=_component2["default"].getComponent;videojs.registerComponent=function(name,comp){if(_techTechJs2["default"].isTech(comp)){_utilsLogJs2["default"].warn("The "+name+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)")}_component2["default"].registerComponent.call(_component2["default"],name,comp)};videojs.getTech=_techTechJs2["default"].getTech;videojs.registerTech=_techTechJs2["default"].registerTech;videojs.browser=browser;videojs.TOUCH_ENABLED=browser.TOUCH_ENABLED;videojs.extend=_extendJs2["default"];videojs.mergeOptions=_srcJsUtilsMergeOptionsJs2["default"];videojs.bind=Fn.bind;videojs.plugin=_pluginsJs2["default"];videojs.addLanguage=function(code,data){var _merge;code=(""+code).toLowerCase();return _lodashCompatObjectMerge2["default"](videojs.options.languages,(_merge={},_merge[code]=data,_merge))[code]};videojs.log=_utilsLogJs2["default"];videojs.createTimeRange=videojs.createTimeRanges=_utilsTimeRangesJs.createTimeRanges;videojs.formatTime=_utilsFormatTimeJs2["default"];videojs.parseUrl=Url.parseUrl;videojs.isCrossOrigin=Url.isCrossOrigin;videojs.EventTarget=_eventTarget2["default"];videojs.on=Events.on;videojs.one=Events.one;videojs.off=Events.off;videojs.trigger=Events.trigger;videojs.xhr=_xhr2["default"];videojs.TextTrack=_tracksTextTrackJs2["default"];videojs.AudioTrack=_tracksAudioTrackJs2["default"];videojs.VideoTrack=_tracksVideoTrackJs2["default"];videojs.isEl=Dom.isEl;videojs.isTextNode=Dom.isTextNode;videojs.createEl=Dom.createEl;videojs.hasClass=Dom.hasElClass;videojs.addClass=Dom.addElClass;videojs.removeClass=Dom.removeElClass;videojs.toggleClass=Dom.toggleElClass;videojs.setAttributes=Dom.setElAttributes;videojs.getAttributes=Dom.getElAttributes;videojs.emptyEl=Dom.emptyEl;videojs.appendContent=Dom.appendContent;videojs.insertContent=Dom.insertContent;if(typeof define==="function"&&define["amd"]){define("videojs",[],function(){return videojs})}else if(typeof exports==="object"&&typeof module==="object"){module["exports"]=videojs}exports["default"]=videojs;module.exports=exports["default"]},{"../../src/js/utils/merge-options.js":152,"./component":68,"./event-target":106,"./extend.js":107,"./player":115,"./plugins.js":116,"./setup":120,"./tech/flash.js":123,"./tech/html5.js":124,"./tech/tech.js":126,"./tracks/audio-track.js":129,"./tracks/text-track.js":137,"./tracks/video-track.js":142,"./utils/browser.js":143,"./utils/create-deprecation-proxy.js":145,"./utils/dom.js":146,"./utils/events.js":147,"./utils/fn.js":148,"./utils/format-time.js":149,"./utils/log.js":151,"./utils/stylesheet.js":153,"./utils/time-ranges.js":154,"./utils/url.js":156,"global/document":9,"global/window":10,"lodash-compat/object/merge":48,"object.assign":53,xhr:62}]},{},[157])(157)});return videojs});
define("videojs5-osmf",[],function(){var define;(function(window,videojs,document,undefined){var Flash=videojs.getComponent("Flash");var Osmf=videojs.extend(Flash,{constructor:function(options,ready){var source=options.source;var _player=videojs(options.playerId);_player.osmf=this;options.flashVars={playerId:options.playerId,readyFunction:"onReady",eventProxyFunction:"onEvent",errorEventProxyFunction:"onError"};Flash.call(this,options,ready);this.firstplay=false;this.loadstart=false;_player.on("loadeddata",Osmf.onLoadedData);_player.on("ended",Osmf.onEnded);options.source=source}});Osmf.formats={"application/adobe-f4m":"F4M","application/adobe-f4v":"F4V","application/dash+xml":"MPD"};Osmf.canPlaySource=function(src){var type=src.type.replace(/;.*/,"").toLowerCase();return type in Osmf.formats?"maybe":""};Osmf.log_enabled=false;var api=Osmf.prototype;var readWrite=["preload","defaultPlaybackRate","playbackRate","autoplay","loop","mediaGroup","controller","controls","volume","muted","defaultMuted"];var readOnly=["error","networkState","readyState","seeking","videoWidth","startOffsetTime","paused","played","ended","streamType","initialTime","videoHeight","currentLevel","levels"];var createSetter=function(attr){var attrUpper=attr.charAt(0).toUpperCase()+attr.slice(1);api["set"+attrUpper]=function(val){if(!this.el_.vjs_setProperty)return;return this.el_.vjs_setProperty(attr,val)}};var createGetter=function(attr){api[attr]=function(){if(!this.el_.vjs_getProperty)return;return this.el_.vjs_getProperty(attr)}};(function(){for(var i=0;i<readWrite.length;i++){createGetter(readWrite[i]);createSetter(readWrite[i])}for(i=0;i<readOnly.length;i++)createGetter(readOnly[i])})();Osmf.prototype.duration=function(){return this.el_?this.streamType()=="live"?Infinity:this.el_.vjs_getProperty("duration"):0};Osmf.prototype.play=function(){this.el_.vjs_play()};Osmf.prototype.load=function(){this.el_.vjs_load()};Osmf.prototype.paused=function(){return this.el_.vjs_paused()};Osmf.prototype.pause=function(){this.el_.vjs_pause()};Osmf.prototype.currentTime=function(value){if(!value)return this.el_.vjs_getProperty("currentTime");this.el_.vjs_setProperty("currentTime")};Osmf.prototype.streamStatus=function(){return this.el_.streamStatus()};Osmf.isSupported=function(){return Flash.version()[0]>=10};Osmf.onLoadedData=function(){var player=this;if(player.options_.autoplay)player.play();else if(player.options_.preload&&player.options_.preload!=="none"){if(player.currentTime())player.currentTime(0);player.play();player.pause();player.bigPlayButton.show();player.bigPlayButton.one("click",function(){player.bigPlayButton.hide()})}};Osmf.onEnded=function(){if(this.options().loop)this.currentTime(0);this.pause()};Osmf.onReady=function(currentSwf){if(Osmf.log_enabled)videojs.log("OSMF","Ready",currentSwf);Flash.onReady(currentSwf);var tech=document.getElementById(currentSwf).tech;if(tech.currentSrc()&&tech.currentSrc().length>0)tech.el_.vjs_src(tech.currentSrc())};Osmf.onError=function(currentSwf,err){var tech=document.getElementById(currentSwf).tech;if(err=="loaderror")err="srcnotfound";if(Osmf.log_enabled)videojs.log("OSMF","Error",err);if(tech.options_.reconnectOnError&&!tech.reconnecting_){tech.reconnecting_=true;tech.trigger("waiting");setTimeout(function(){tech.src(tech.currentSrc());tech.reconnecting_=false;tech.error(null)},5e3)}tech.error({code:4,msg:""})};Osmf.onEvent=function(currentSwf,event,data){var tech=document.getElementById(currentSwf).tech;switch(event){case"playing":if(tech.firstplay===false){if(Osmf.log_enabled)videojs.log("OSMF","Event",currentSwf,"loadstart");tech.trigger("loadstart");tech.loadstart=true;if(Osmf.log_enabled)videojs.log("OSMF","Event",currentSwf,"firstplay");tech.trigger("firstplay");tech.firstplay=true}break;case"buffering":event="waiting";break;case"ready":event="loadeddata";break}tech.trigger(event,data);if(event!=="timeupdate"&&Osmf.log_enabled)videojs.log("OSMF","Event",currentSwf,event)};Osmf.prototype.supportsFullScreen=function(){return false};Osmf.prototype.enterFullScreen=function(){return false};videojs.options.osmf={};videojs.options.techOrder.push("osmf");videojs.registerComponent("Osmf",Osmf)})(window,window.videojs,document);return{}});
define("videojs-thumbnails",[],function(){(function(){var defaults={0:{src:"example-thumbnail.png"}},extend=function(){var args,target,i,object,property;args=Array.prototype.slice.call(arguments);target=args.shift()||{};for(i in args){object=args[i];for(property in object){if(object.hasOwnProperty(property)){if(typeof object[property]==="object"){target[property]=extend(target[property],object[property])}else{target[property]=object[property]}}}}return target},getComputedStyle=function(el,pseudo){return function(prop){if(window.getComputedStyle){return window.getComputedStyle(el,pseudo)[prop]}else{return el.currentStyle[prop]}}},offsetParent=function(el){if(el.nodeName!=="HTML"&&getComputedStyle(el)("position")==="static"){return offsetParent(el.offsetParent)}return el},getVisibleWidth=function(el,width){var clip;if(width){return parseFloat(width)}clip=getComputedStyle(el)("clip");if(clip!=="auto"&&clip!=="inherit"){clip=clip.split(/(?:\(|\))/)[1].split(/(?:,| )/);if(clip.length===4){return parseFloat(clip[1])-parseFloat(clip[3])}}return 0},getScrollOffset=function(){if(window.pageXOffset){return{x:window.pageXOffset,y:window.pageYOffset}}return{x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop}},unfoldSpritesConf=function(options){var last={};Object.keys(options).forEach(function(key){var s;if(!(s=options[key].sprites))return;s.position.forEach(function(pos,i){var offset=s.width/2+s.width*i;var r={left:s.width*i,right:s.width*(i+1),top:0,bottom:s.height};options[pos]=options[pos]||{};options[pos]=extend({},last,options[pos],{style:{left:"-"+offset+"px",clip:"rect("+r.top+"px, "+r.right+"px, "+r.bottom+"px, "+r.left+"px)",width:s.width*s.position.length,height:s.height}});last=options[key]});delete options[key].sprites});return options};videojs.plugin("thumbnails",function(options){var div,settings,img,player,progressControl,duration,moveListener,moveCancel;options=options&&unfoldSpritesConf(options);settings=extend({},defaults,options);player=this;(function(){var progressControl,addFakeActive,removeFakeActive;if(navigator.userAgent.toLowerCase().indexOf("android")!==-1){progressControl=player.controlBar.progressControl;addFakeActive=function(){progressControl.addClass("fake-active")};removeFakeActive=function(){progressControl.removeClass("fake-active")};progressControl.on("touchstart",addFakeActive);progressControl.on("touchend",removeFakeActive);progressControl.on("touchcancel",removeFakeActive)}})();div=document.createElement("div");div.className="vjs-thumbnail-holder";img=document.createElement("img");div.appendChild(img);img.src=settings["0"].src;img.className="vjs-thumbnail";extend(img.style,settings["0"].style);if(!img.style.left&&!img.style.right){img.onload=function(){img.style.left=-(img.naturalWidth/2)+"px"}}duration=player.duration();player.on("durationchange",function(event){duration=player.duration()});player.on("loadedmetadata",function(event){duration=player.duration()});progressControl=player.controlBar.progressControl;progressControl.el().appendChild(div);moveListener=function(event){var mouseTime,time,active,left,setting,pageX,right,width,halfWidth,pageXOffset,clientRect;active=0;pageXOffset=getScrollOffset().x;clientRect=offsetParent(progressControl.el()).getBoundingClientRect();right=(clientRect.width||clientRect.right)+pageXOffset;pageX=event.pageX;if(event.changedTouches){pageX=event.changedTouches[0].pageX}left=pageX||event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;left-=offsetParent(progressControl.el()).getBoundingClientRect().left+pageXOffset;mouseTime=Math.floor((left-progressControl.el().offsetLeft)/progressControl.width()*duration);for(time in settings){if(mouseTime>time){active=Math.max(active,time)}}setting=settings[active];if(setting.src&&img.src!=setting.src){img.src=setting.src}if(setting.style&&img.style!=setting.style){extend(img.style,setting.style)}width=getVisibleWidth(img,setting.width||settings[0].width);halfWidth=width/2;if(left+halfWidth>right){left-=left+halfWidth-right}else if(left<halfWidth){left=halfWidth}div.style.left=left+"px"};progressControl.on("mousemove",moveListener);progressControl.on("touchmove",moveListener);moveCancel=function(event){div.style.left="-1000px"};progressControl.on("mouseout",moveCancel);progressControl.on("touchcancel",moveCancel);progressControl.on("touchend",moveCancel);player.on("userinactive",moveCancel)})})();return{}});
define("videojs-hola-skin",["vjs5_10"],function(){var define;(function(window,vjs){function add_css(url,ver){var link=document.createElement("link");link.setAttribute("rel","stylesheet");link.setAttribute("href",url+(ver?"?"+ver:""));document.getElementsByTagName("head")[0].appendChild(link)}function get_class_name(element){return element.className.split(/\s+/g)}function add_class_name(element,class_name){var classes=get_class_name(element);if(classes.indexOf(class_name)==-1){classes.push(class_name);element.className=classes.join(" ");return true}return false}function remove_class_name(element,class_name){var classes=get_class_name(element);var class_index=classes.indexOf(class_name);if(class_index>=0){classes.splice(class_index,1);element.className=classes.join(" ")}}var HolaSkin=function(video,opt){var _this=this;this.vjs=video;this.el=video.el();this.opt=opt;this.intv=0;this.stagger=5;this.steptotal=5;this.classes_added=[];this.vjs.on("dispose",function(){_this.dispose()});this.vjs.on("ready",function(){_this.init()});this._resize=this.resize.bind(this);this.vjs.on("resize",this._resize);window.addEventListener("resize",this._resize);this.apply();this.resize()};HolaSkin.prototype.apply=function(){var c,classes=[this.opt.className];if(this.opt.show_controls_before_start)classes.push("vjs-show-controls-before-start");while(c=classes.shift()){if(add_class_name(this.el,c))this.classes_added.push(c)}};HolaSkin.prototype.resize=function(){var vjs_large="vjs-large";if(this.el.offsetWidth>=768)add_class_name(this.el,vjs_large);else remove_class_name(this.el,vjs_large)};var play1="M 0,0 0,20 14,10 Z";var play2="M 0,0 0,20 0,10 Z";var pause1="M 0,0 0,0 0,20 0,20 M 0,0 0,0 0,20 0,20 Z";var pause2="M 0,0 5,0 5,20 0,20 M 9,0 14,0 14,20 9,20 Z";var replay="";var morph_html=['<svg height="3em" width="3em" viewBox="-13 -10 40 40">','<g id="move">','<g id="{morph}">','<path d="M 0,0 5,0 5,20 0,20 M 9,0 14,0 14,20 9,20 Z"/>','<path d="M 0,0 0,20 14,10 Z"/>','<g class="replay">','<g class="arrow">','<path class="st1" d="M50,50.3c-3.6,3.5-8.5,5.7-14,5.7c-11,0-20-9-20-20s9-20,20-20s20,9,20,20"/>','<polygon class="st2" points="64,36 48,36 56,46"/>',"</g>","</g>","</g>","</g>","</svg>"].join("");var umorph_html=['<svg width="100%" height="100%" viewBox="-15 -10 40 40">','<use id="u{morph}" xlink:href="#{morph}" x="0" y="0"/>',"</svg>"].join("");var volume_icon_svg='<svg height="2.8em" width="2.8em" viewBox="-5 -7 30 30">'+'<polygon points="4,5 4,5 0,5 0,11 4,11 4,11 8,16 8,0"/>'+'<polygon class="volume-level-0" points="11.5,4 10,5.5 12.5,8 10,10.5 11.5,12 14,9.5 16.5,12 18,10.5 15.5,8 18,5.5 16.5,4 14,6.5"/>'+"<g>"+'<path class="volume-level-1" d="M10,4.6v6.9c1.2-0.7,2-2,2-3.4S11.2,5.2,10,4.6z"/>'+'<path class="volume-level-2" d="M16,8c0-2.2-0.9-4.2-2.3-5.6L12,3.6c1.2,1.1,2,2.7,2,4.4c0,1.8-0.8,3.3-2,4.4l1.7,1.2C15.1,12.2,16,10.2,16,8z"/>'+'<path class="volume-level-3" d="M16.9,0l-1.6,1.2C17,3,18,5.4,18,8c0,2.6-1,5-2.7,6.8l1.6,1.2c1.9-2.1,3.1-4.9,3.1-8C20,4.9,18.8,2.1,16.9,0z"/>'+"</g>"+"</svg>";var gap_name="vjs-slider-gap";var slider_gaps='<div class="'+gap_name+'-left"></div><div class="'+gap_name+'-right"></div>';HolaSkin.prototype.set_play_button_state=function(btn_svg,state){if(this.play_state==state)return;this.play_state=state;var intv=this.intv;var _this=this;var steptotal=this.steptotal;var stagger=this.stagger;function mk_transition(from,to,steps){return function(){var start=isNaN(from)?from:parseFloat(from);var delta=isNaN(from)?"":(parseFloat(to)-start)/parseFloat(steps);return function(){return start+=delta}}()}function mk_transform(from_path,to_path,steps){var path1pts=from_path.split(" ").slice(1,-1);var path2pts=to_path.split(" ").slice(1,-1);return function(){var pathgen=path1pts.map(function(coord,index){return coord.split(",").map(function(fld,idx){return mk_transition(fld,path2pts[index].split(",")[idx],steps)})});return function(){return pathgen.reduce(function(prev,curr){if(curr.length==1)return prev+" "+curr[0]();return prev+" "+curr.reduce(function(prv,crr){return prv()+","+crr()})},"M")+" Z"}}()}var umorph=document.getElementById("umorph_"+this.vjs.id());var bars=btn_svg.getElementsByTagName("path");var stepcnt=0,stepcnt1=0;if(intv)clearInterval(intv);if(state=="ended"){umorph.setAttribute("transform","translate(-2, 0)");var render_cnt=5;var render_intv=setInterval(function(){bars[0].setAttribute("transform","rotate("+render_cnt+")");render_cnt--;if(render_cnt<0)clearInterval(render_intv)},100);btn_svg.parentNode.setAttribute("transform","translate(0, 0)");bars[0].setAttribute("d",replay);bars[1].setAttribute("display","none");return}bars[1].removeAttribute("display");var is_transformed=btn_svg.parentNode.getAttribute("transform");btn_svg.parentNode.removeAttribute("transform");umorph.removeAttribute("transform");if(is_transformed)bars[0].setAttribute("d","");if(state=="paused"){var mk_path3=mk_transform(play2,play1,steptotal);var mk_path4=mk_transform(pause2,pause1,steptotal);this.intv=setInterval(function(){if(stepcnt<steptotal)bars[1].setAttribute("d",mk_path4());if(stepcnt>=stagger)bars[0].setAttribute("d",mk_path3());stepcnt++;if(stepcnt>=steptotal+stagger){clearInterval(_this.intv);_this.intv=0}},20);return}var mk_path1=mk_transform(play1,play2,steptotal);var mk_path2=mk_transform(pause1,pause2,steptotal);this.intv=setInterval(function(){if(stepcnt<steptotal)bars[0].setAttribute("d",mk_path1());if(stepcnt>=stagger)bars[1].setAttribute("d",mk_path2());stepcnt++;if(stepcnt>=steptotal+stagger){clearInterval(_this.intv);_this.intv=0}},20)};HolaSkin.prototype.init=function(){var _this=this;var player=this.vjs;if(!!this.opt.no_play_transform){this.steptotal=1;this.stagger=0}this.has_played=false;var play_button=player.controlBar.playToggle.el();play_button.insertAdjacentHTML("beforeend",morph_html.replace(/{morph}/g,"morph_"+player.id()));player.bigPlayButton.el().insertAdjacentHTML("beforeend",umorph_html.replace(/{morph}/g,"morph_"+player.id()));player.on("play",function(){_this.is_ended=false;_this.update_state(player)}).on("pause",function(){_this.update_state(player)}).on("adend",function(){_this.update_state(player)}).on("ended",function(){_this.is_ended=true;_this.update_state(player)}).on("seeking",function(){if(player.currentTime()){_this.is_ended=false;_this.has_played=true}else _this.has_played=false;_this.update_state(player)}).on("timeupdate",function(val,t1,t2){var has_pos=!!player.currentTime();if(has_pos==_this.has_played)return;_this.has_played=has_pos;_this.update_state(player)});this.update_state(player);var volume_slider=player.controlBar.volumeMenuButton.volumeBar.el();volume_slider.insertAdjacentHTML("beforeend",slider_gaps);var progress_holder=player.controlBar.progressControl.seekBar.el();progress_holder.insertAdjacentHTML("beforeend",slider_gaps)};HolaSkin.prototype.update_state=function(player){var play_button=player.controlBar.playToggle.el();var big_play_button=player.bigPlayButton.el();var replay_classname="vjs-play-control-replay";var started_classname="vjs-pos-started";var ended_classname="vjs-pos-ended";if(this.is_ended){add_class_name(play_button,replay_classname);add_class_name(big_play_button,replay_classname);add_class_name(player.el_,ended_classname)}else{remove_class_name(play_button,replay_classname);remove_class_name(big_play_button,replay_classname);remove_class_name(player.el_,ended_classname)}if(this.has_played)add_class_name(player.el_,started_classname);else{remove_class_name(player.el_,started_classname);remove_class_name(player.el_,ended_classname)}this.set_play_button_state(document.getElementById("morph_"+player.id()),this.is_ended?"ended":player.paused()?"paused":"playing")};HolaSkin.prototype.dispose=function(){while(this.classes_added.length)remove_class_name(this.el,this.classes_added.pop());window.removeEventListener("resize",this._resize)};var MenuButton=vjs.getComponent("MenuButton");var VolumeMenuButton=vjs.getComponent("VolumeMenuButton");VolumeMenuButton.prototype.createEl=function(){var el=MenuButton.prototype.createEl.call(this);var icon=this.icon_=document.createElement("div");icon.setAttribute("class","vjs-button-icon");icon.innerHTML=volume_icon_svg;el.insertBefore(icon,el.firstChild);return el};VolumeMenuButton.prototype.tooltipHandler=function(){return this.icon_};var Button=vjs.getComponent("Button");var FullscreenToggle=vjs.getComponent("FullscreenToggle");FullscreenToggle.prototype.controlText_="Full screen";FullscreenToggle.prototype.createEl=function(){var el=Button.prototype.createEl.call(this);var icon=this.icon_=document.createElement("div");icon.setAttribute("class","vjs-button-icon");el.insertBefore(icon,el.firstChild);return el};FullscreenToggle.prototype.updateHint=function(){if(this.player_.isFullscreen()){this.controlText("Exit full screen")}else{this.controlText("Full screen")}};var defaults={className:"vjs5-hola-skin",css:"/css/videojs-hola-skin.css",ver:"ver=0.0.5-39"};vjs.plugin("hola_skin",function(options){if(options===false)options={css:false,className:false};var opt=vjs.mergeOptions(defaults,options);if(opt.css&&(!options.className||options.css))add_css(opt.css,opt.ver);new HolaSkin(this,opt)})})(window,window.videojs);return{}});
define("videojs-utils",[],function(){(function(window,vjs){vjs.utils=vjs.utils||{};function local_storage_init(){function get_cookie_item(key){if(!key||!has_cookie_item(key))return null;var reg_ex=new RegExp("(?:^|.*;\\s*)"+window.escape(key).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*");return window.unescape(document.cookie.replace(reg_ex,"$1"))}function set_cookie_item(key,value,end,path,domain,secure){if(!key||/^(?:expires|max\-age|path|domain|secure)$/i.test(key))return;var expires="";if(end){switch(end.constructor){case Number:expires=end===Infinity?"; expires=Tue, 19 Jan 2038 03:14:07 GMT":"; max-age="+end;break;case String:expires="; expires="+end;break;case Date:expires="; expires="+end.toGMTString();break}}document.cookie=window.escape(key)+"="+window.escape(value)+expires+(domain?"; domain="+domain:"")+(path?"; path="+path:"")+(secure?"; secure":"")}function has_cookie_item(key){return new RegExp("(?:^|;\\s*)"+window.escape(key).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}function has_local_storage(){try{window.localStorage.setItem("vjs-storage-test","value");window.localStorage.removeItem("vjs-storage-test");return true}catch(e){return false}}vjs.utils.localStorage=has_local_storage()?window.localStorage:{getItem:get_cookie_item,setItem:function(key,value){set_cookie_item(key,value,Infinity,"/")}}}local_storage_init()})(window,window.videojs);return{}});
define("videojs-settings",["vjs5_10","videojs-hola-skin","videojs-utils"],function(){var define;(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){(function(window,vjs){vjs.utils=vjs.utils||{};function local_storage_init(){function get_cookie_item(key){if(!key||!has_cookie_item(key))return null;var reg_ex=new RegExp("(?:^|.*;\\s*)"+window.escape(key).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*");return window.unescape(document.cookie.replace(reg_ex,"$1"))}function set_cookie_item(key,value,end,path,domain,secure){if(!key||/^(?:expires|max\-age|path|domain|secure)$/i.test(key))return;var expires="";if(end){switch(end.constructor){case Number:expires=end===Infinity?"; expires=Tue, 19 Jan 2038 03:14:07 GMT":"; max-age="+end;break;case String:expires="; expires="+end;break;case Date:expires="; expires="+end.toGMTString();break}}document.cookie=window.escape(key)+"="+window.escape(value)+expires+(domain?"; domain="+domain:"")+(path?"; path="+path:"")+(secure?"; secure":"")}function has_cookie_item(key){return new RegExp("(?:^|;\\s*)"+window.escape(key).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}function has_local_storage(){try{window.localStorage.setItem("vjs-storage-test","value");window.localStorage.removeItem("vjs-storage-test");return true}catch(e){return false}}vjs.utils.localStorage=has_local_storage()?window.localStorage:{getItem:get_cookie_item,setItem:function(key,value){set_cookie_item(key,value,Infinity,"/")}}}local_storage_init()})(window,window.videojs)},{}],2:[function(_dereq_,module,exports){(function(global,factory){if(typeof define==="function"&&define.amd){define(["module","select"],factory)}else if(typeof exports!=="undefined"){factory(module,_dereq_("select"))}else{var mod={exports:{}};factory(mod,global.select);global.clipboardAction=mod.exports}})(this,function(module,_select){var _select2=_interopRequireDefault(_select);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var ClipboardAction=function(){function ClipboardAction(options){_classCallCheck(this,ClipboardAction);this.resolveOptions(options);this.initSelection()}_createClass(ClipboardAction,[{key:"resolveOptions",value:function resolveOptions(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=options.action;this.emitter=options.emitter;this.target=options.target;this.text=options.text;this.trigger=options.trigger;this.selectedText=""}},{key:"initSelection",value:function initSelection(){if(this.text){this.selectFake()}else if(this.target){this.selectTarget()}}},{key:"selectFake",value:function selectFake(){var _this=this;var isRTL=document.documentElement.getAttribute("dir")=="rtl";this.removeFake();this.fakeHandlerCallback=function(){return _this.removeFake()};this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||true;this.fakeElem=document.createElement("textarea");this.fakeElem.style.fontSize="12pt";this.fakeElem.style.border="0";this.fakeElem.style.padding="0";this.fakeElem.style.margin="0";this.fakeElem.style.position="absolute";this.fakeElem.style[isRTL?"right":"left"]="-9999px";var yPosition=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.addEventListener("focus",window.scrollTo(0,yPosition));this.fakeElem.style.top=yPosition+"px";this.fakeElem.setAttribute("readonly","");this.fakeElem.value=this.text;document.body.appendChild(this.fakeElem);this.selectedText=(0,_select2.default)(this.fakeElem);this.copyText()}},{key:"removeFake",value:function removeFake(){if(this.fakeHandler){document.body.removeEventListener("click",this.fakeHandlerCallback);this.fakeHandler=null;this.fakeHandlerCallback=null}if(this.fakeElem){document.body.removeChild(this.fakeElem);this.fakeElem=null}}},{key:"selectTarget",value:function selectTarget(){this.selectedText=(0,_select2.default)(this.target);this.copyText()}},{key:"copyText",value:function copyText(){var succeeded=void 0;try{succeeded=document.execCommand(this.action)}catch(err){succeeded=false}this.handleResult(succeeded)}},{key:"handleResult",value:function handleResult(succeeded){this.emitter.emit(succeeded?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function clearSelection(){if(this.target){this.target.blur()}window.getSelection().removeAllRanges()}},{key:"destroy",value:function destroy(){this.removeFake()}},{key:"action",set:function set(){var action=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"copy";this._action=action;if(this._action!=="copy"&&this._action!=="cut"){throw new Error('Invalid "action" value, use either "copy" or "cut"')}},get:function get(){return this._action}},{key:"target",set:function set(target){if(target!==undefined){if(target&&(typeof target==="undefined"?"undefined":_typeof(target))==="object"&&target.nodeType===1){if(this.action==="copy"&&target.hasAttribute("disabled")){throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute')}if(this.action==="cut"&&(target.hasAttribute("readonly")||target.hasAttribute("disabled"))){throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}this._target=target}else{throw new Error('Invalid "target" value, use a valid Element')}}},get:function get(){return this._target}}]);return ClipboardAction}();module.exports=ClipboardAction})},{select:8}],3:[function(_dereq_,module,exports){(function(global,factory){if(typeof define==="function"&&define.amd){define(["module","./clipboard-action","tiny-emitter","good-listener"],factory)}else if(typeof exports!=="undefined"){factory(module,_dereq_("./clipboard-action"),_dereq_("tiny-emitter"),_dereq_("good-listener"))}else{var mod={exports:{}};factory(mod,global.clipboardAction,global.tinyEmitter,global.goodListener);global.clipboard=mod.exports}})(this,function(module,_clipboardAction,_tinyEmitter,_goodListener){var _clipboardAction2=_interopRequireDefault(_clipboardAction);var _tinyEmitter2=_interopRequireDefault(_tinyEmitter);var _goodListener2=_interopRequireDefault(_goodListener);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Clipboard=function(_Emitter){_inherits(Clipboard,_Emitter);function Clipboard(trigger,options){_classCallCheck(this,Clipboard);var _this=_possibleConstructorReturn(this,(Clipboard.__proto__||Object.getPrototypeOf(Clipboard)).call(this));_this.resolveOptions(options);_this.listenClick(trigger);return _this}_createClass(Clipboard,[{key:"resolveOptions",value:function resolveOptions(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=typeof options.action==="function"?options.action:this.defaultAction;this.target=typeof options.target==="function"?options.target:this.defaultTarget;this.text=typeof options.text==="function"?options.text:this.defaultText}},{key:"listenClick",value:function listenClick(trigger){var _this2=this;this.listener=(0,_goodListener2.default)(trigger,"click",function(e){return _this2.onClick(e)})}},{key:"onClick",value:function onClick(e){var trigger=e.delegateTarget||e.currentTarget;if(this.clipboardAction){this.clipboardAction=null}this.clipboardAction=new _clipboardAction2.default({action:this.action(trigger),target:this.target(trigger),text:this.text(trigger),trigger:trigger,emitter:this})}},{key:"defaultAction",value:function defaultAction(trigger){return getAttributeValue("action",trigger)}},{key:"defaultTarget",value:function defaultTarget(trigger){var selector=getAttributeValue("target",trigger);if(selector){return document.querySelector(selector)}}},{key:"defaultText",value:function defaultText(trigger){return getAttributeValue("text",trigger)}},{key:"destroy",value:function destroy(){this.listener.destroy();if(this.clipboardAction){this.clipboardAction.destroy();this.clipboardAction=null}}}]);return Clipboard}(_tinyEmitter2.default);function getAttributeValue(suffix,element){var attribute="data-clipboard-"+suffix;if(!element.hasAttribute(attribute)){return}return element.getAttribute(attribute)}module.exports=Clipboard})},{"./clipboard-action":2,"good-listener":7,"tiny-emitter":9}],4:[function(_dereq_,module,exports){var DOCUMENT_NODE_TYPE=9;if(Element&&!Element.prototype.matches){var proto=Element.prototype;proto.matches=proto.matchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector||proto.webkitMatchesSelector}function closest(element,selector){while(element&&element.nodeType!==DOCUMENT_NODE_TYPE){if(element.matches(selector))return element;element=element.parentNode}}module.exports=closest},{}],5:[function(_dereq_,module,exports){var closest=_dereq_("./closest");function delegate(element,selector,type,callback,useCapture){var listenerFn=listener.apply(this,arguments);element.addEventListener(type,listenerFn,useCapture);return{destroy:function(){element.removeEventListener(type,listenerFn,useCapture)}}}function listener(element,selector,type,callback){return function(e){e.delegateTarget=closest(e.target,selector);if(e.delegateTarget){callback.call(element,e)}}}module.exports=delegate},{"./closest":4}],6:[function(_dereq_,module,exports){exports.node=function(value){return value!==undefined&&value instanceof HTMLElement&&value.nodeType===1};exports.nodeList=function(value){var type=Object.prototype.toString.call(value);return value!==undefined&&(type==="[object NodeList]"||type==="[object HTMLCollection]")&&"length"in value&&(value.length===0||exports.node(value[0]))};exports.string=function(value){return typeof value==="string"||value instanceof String};exports.fn=function(value){var type=Object.prototype.toString.call(value);return type==="[object Function]"}},{}],7:[function(_dereq_,module,exports){var is=_dereq_("./is");var delegate=_dereq_("delegate");function listen(target,type,callback){if(!target&&!type&&!callback){throw new Error("Missing required arguments")}if(!is.string(type)){throw new TypeError("Second argument must be a String")}if(!is.fn(callback)){throw new TypeError("Third argument must be a Function")}if(is.node(target)){return listenNode(target,type,callback)}else if(is.nodeList(target)){return listenNodeList(target,type,callback)}else if(is.string(target)){return listenSelector(target,type,callback)}else{throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}}function listenNode(node,type,callback){node.addEventListener(type,callback);return{destroy:function(){node.removeEventListener(type,callback)}}}function listenNodeList(nodeList,type,callback){Array.prototype.forEach.call(nodeList,function(node){node.addEventListener(type,callback)});return{destroy:function(){Array.prototype.forEach.call(nodeList,function(node){node.removeEventListener(type,callback)})}}}function listenSelector(selector,type,callback){return delegate(document.body,selector,type,callback)}module.exports=listen},{"./is":6,delegate:5}],8:[function(_dereq_,module,exports){function select(element){var selectedText;if(element.nodeName==="SELECT"){element.focus();selectedText=element.value}else if(element.nodeName==="INPUT"||element.nodeName==="TEXTAREA"){element.focus();element.setSelectionRange(0,element.value.length);selectedText=element.value}else{if(element.hasAttribute("contenteditable")){element.focus()}var selection=window.getSelection();var range=document.createRange();range.selectNodeContents(element);selection.removeAllRanges();selection.addRange(range);selectedText=selection.toString()}return selectedText}module.exports=select},{}],9:[function(_dereq_,module,exports){function E(){}E.prototype={on:function(name,callback,ctx){var e=this.e||(this.e={});(e[name]||(e[name]=[])).push({fn:callback,ctx:ctx});return this},once:function(name,callback,ctx){var self=this;function listener(){self.off(name,listener);callback.apply(ctx,arguments)}listener._=callback;return this.on(name,listener,ctx)},emit:function(name){var data=[].slice.call(arguments,1);var evtArr=((this.e||(this.e={}))[name]||[]).slice();var i=0;var len=evtArr.length;for(i;i<len;i++){evtArr[i].fn.apply(evtArr[i].ctx,data)}return this},off:function(name,callback){var e=this.e||(this.e={});var evts=e[name];var liveEvents=[];if(evts&&callback){for(var i=0,len=evts.length;i<len;i++){if(evts[i].fn!==callback&&evts[i].fn._!==callback)liveEvents.push(evts[i])}}liveEvents.length?e[name]=liveEvents:delete e[name];return this}};module.exports=E},{}],10:[function(_dereq_,module,exports){(function(window,vjs){_dereq_("@hola.org/videojs-utils");var Clipboard=_dereq_("clipboard");var vjs_merge=function(obj1,obj2){if(!obj2){return obj1}for(var key in obj2){if(Object.prototype.hasOwnProperty.call(obj2,key)){obj1[key]=obj2[key]}}return obj1};var settings_icon_svg='<svg height="100%" width="100%" viewBox="0 0 16 16">'+'<path class="st0" d="M16,9.4V6.6h-2.2c-0.2-0.6-0.4-1.3-0.8-1.8l1.5-1.5l-1.9-1.9l-1.5,1.5C10.6,2.6,10,2.3,9.4,2.2V0H6.6v2.2'+"C6,2.3,5.4,2.6,4.8,2.9L3.3,1.4L1.4,3.3l1.5,1.5C2.6,5.4,2.3,6,2.2,6.6H0v2.7h2.2c0.2,0.6,0.4,1.3,0.8,1.8l-1.5,1.5l1.9,1.9l1.5-1.5"+"c0.5,0.3,1.2,0.6,1.8,0.8V16h2.7v-2.2c0.6-0.2,1.3-0.4,1.8-0.8l1.5,1.5l1.9-1.9l-1.5-1.5c0.3-0.5,0.6-1.2,0.8-1.8H16z M8,11"+'c-1.7,0-3-1.3-3-3s1.3-3,3-3s3,1.3,3,3S9.7,11,8,11z"/>'+"</svg>";var Menu=vjs.getComponent("Menu");vjs.registerComponent("PopupMenu",vjs.extend(Menu,{className:"vjs-rightclick-popup",popped:false,constructor:function(player,options){Menu.call(this,player,options);var player_=player;this.addClass(this.className);this.hide();var _this=this;var opt=this.options_;var offset=opt.offset||5;this.addChild(new LogButton(player,{label:"Download log"}));this.addChild(new CopyLogButton(player,{label:"Copy debug info"}));if(opt.report){opt.report=vjs.mergeOptions({label:"Report playback issue"},opt.report);this.addChild(new ReportButton(player,opt.report))}if(opt.info){opt.info=vjs.mergeOptions({label:"Stats for nerds"},opt.info);this.addChild(new InfoButton(player,opt.info))}if(opt.graph){opt.graph=vjs.mergeOptions({label:"CDN overlay"},opt.graph);this.addChild(new GraphButton(player,opt.graph))}this.addChild(new MenuItemLink(player,{href:"https://holacdn.com/player",label:"About Hola Player"}));player_.on("contextmenu",function(evt){evt.preventDefault();if(_this.popped){_this.hide();_this.popped=false}else{_this.show();var oX=evt.offsetX;var oY=evt.offsetY;var left_shift=_this.el_.offsetWidth+oX+offset-player_.el_.offsetWidth;left_shift=Math.max(0,left_shift);var top_shift=_this.el_.offsetHeight+oY+offset-player_.el_.offsetHeight;top_shift=Math.max(0,top_shift);oX=oX-left_shift;oY=oY-top_shift;_this.el_.style.top=oY+"px";_this.el_.style.left=oX+"px";_this.popped=true;_this.check_items()}});player_.on("click",function(evt){if(_this.popped){_this.hide();_this.popped=false;evt.stopPropagation();evt.preventDefault();return false}});this.children().forEach(function(item){item.on("click",function(evt){_this.hide();_this.popped=false})})},check_items:function(){this.children().forEach(function(item){if(item.is_visible)item.toggleClass("vjs-hidden",!item.is_visible())})}}));var MenuButton=vjs.getComponent("MenuButton");vjs.registerComponent("SettingsButton",vjs.extend(MenuButton,{controlText_:"Settings",constructor:function(player,options){MenuButton.call(this,player,options);player.one("play",vjs.bind(this,this.updateSelected));player.on("resolutionchange",vjs.bind(this,this.updateSelected));this.updateSelected()},createEl:function(){var settings_button=MenuButton.prototype.createEl.call(this);var icon=this.icon_=document.createElement("div");icon.setAttribute("class","vjs-button-icon");icon.innerHTML=settings_icon_svg;settings_button.insertBefore(icon,settings_button.firstChild);return settings_button},buildCSSClass:function(){var className=MenuButton.prototype.buildCSSClass.call(this);return className+" vjs-settings-button"},createItems:function(){var items=[];var player=this.player_;var quality=this.options_.quality;var sources=quality&&quality.sources?quality.sources:player.options_.sources;if(!sources||!sources.length)return[];var label;for(var i=0;i<sources.length;i+=1){label=sources[i].label||(sources.length==1?"Auto":"Source "+(i+1));items.push(new QualityButton(player,vjs_merge(sources[i],{label:label})))}return items},createMenu:function(){var _this=this;var menu=MenuButton.prototype.createMenu.call(this);menu.addClass("vjs-menu-popup-on-click");menu.children().forEach(function(component){component.on("click",function(){_this.handleClick()})});return menu},handleClick:function(){var expanded_classname="vjs-settings-expanded";if(this.buttonPressed_){this.player_.removeClass(expanded_classname);this.unpressButton()}else{this.player_.addClass(expanded_classname);this.pressButton()}},tooltipHandler:function(){return this.icon_},updateSelected:function(){var selected=this.selectedLevel;this.menu.children().forEach(function(item){if(item.options_.src)item.selected(item.is_current_src());else item.selected(item.options_.level_id==selected)})},levelsChanged:function(levels){var current=(this.options_.quality||{}).sources||[];if(current.length!=levels.length)return true;for(var i=0;i<levels.length;i++){if(current[i].level_id!=levels[i].id)return true}return false},updateQuality:function(data){var sources=[];var callback=data.callback;var levels=data.quality.list;this.selectedLevel=data.quality.selected;if(this.levelsChanged(levels)){levels.forEach(function(item){sources.push({level_id:item.id,label:item.label,callback:callback})});this.options_.quality=this.options_.quality||{};this.options_.quality.sources=sources;this.update()}this.updateSelected()}}));var Component=vjs.getComponent("Component");vjs.registerComponent("Overlay",vjs.extend(Component,{createEl:function(type,props){var custom_class=this.options_["class"];custom_class=custom_class?" "+custom_class:"";var proto_component=Component.prototype;var container=proto_component.createEl.call(this,"div",vjs_merge({className:"vjs-info-overlay"+custom_class},props));this.createContent(container);return container},createContent:function(container){}}));function round(val){if(typeof val!="number")return val;return val.toFixed(3)}function is_wrapper_attached(check_bws){var hola=window.hola_cdn;return hola&&hola.get_wrapper()&&(!check_bws||!!hola._get_bws())}var Overlay=vjs.getComponent("Overlay");vjs.registerComponent("InfoOverlay",vjs.extend(Overlay,{constructor:function(player,options){this.info_data={duration:{units:"sec",title:"Duration",get:function(p){return round(p.duration())}},position:{units:"sec",title:"Position",get:function(p){return round(p.currentTime())}},buffered:{units:"sec",title:"Current buffer",get:function(p){var range=p.buffered();var pos=p.currentTime();if(range&&range.length){for(var i=0;i<range.length;i+=1){if(range.start(i)<=pos&&range.end(i)>=pos)return round(range.end(i)-pos)}}return"--"}},downloaded:{units:"sec",title:"Downloaded",get:function(p){var range=p.buffered();var buf_sec=0;if(range&&range.length){for(var i=0;i<range.length;i+=1)buf_sec+=range.end(i)-range.start(i)}return round(buf_sec)}}};Overlay.call(this,player,options)},createContent:function(container){var _this=this;var player=this.player_;function create_el(el,opt){opt=opt?vjs_merge(opt):opt;var proto_component=Component.prototype;return proto_component.createEl.call(_this,el,opt)}var title=create_el("div",{className:"vjs-info-overlay-title",innerHTML:"Technical info"});var close_btn=create_el("div",{className:"vjs-info-overlay-x"});close_btn.addEventListener("click",function(){_this.toggle()});var content=create_el("div",{className:"vjs-info-overlay-content"});var list=create_el("ul",{className:"vjs-info-overlay-list"});var item;var title_text;for(var i in this.info_data){item=create_el("li",{className:"vjs-info-overlay-list-item"});title_text=this.info_data[i].title;if(this.info_data[i].units)title_text+=" ["+this.info_data[i].units+"]";title_text+=": ";item.appendChild(create_el("strong",{innerHTML:title_text}));this.info_data[i].el=create_el("span");item.appendChild(this.info_data[i].el);list.appendChild(item)}content.appendChild(list);container.appendChild(title);container.appendChild(close_btn);container.appendChild(content);this.update();player.on("timeupdate",function(){_this.update()});setInterval(function(){_this.update()},1e3)},update:function(){var player=this.player_;var info=this.info_data;for(var i in info)info[i].el.innerHTML=info[i].get(player)},toggle:function(caller){if(caller)this.last_caller=caller;if(this.visible){this.visible=false;if(this.last_caller)this.last_caller.selected(false);this.addClass("vjs-hidden");return}this.update();this.visible=true;this.removeClass("vjs-hidden")}}));vjs.registerComponent("NotifyOverlay",vjs.extend(Overlay,{createContent:function(container){var _this=this;function create_el(el,opt){opt=opt?vjs_merge(opt):opt;var proto_component=Component.prototype;return proto_component.createEl.call(_this,el,opt)}var title=create_el("div",{className:"vjs-notify-overlay-title",innerHTML:"Issue report sent."});var content=create_el("div",{className:"vjs-notify-overlay-content",innerHTML:"Thank you!"});container.appendChild(title);container.appendChild(content)},flash:function(){if(this.visible)return;this.visible=true;this.removeClass("vjs-hidden");var _this=this;setTimeout(function(){_this.addClass("vjs-notify-flash")},50);setTimeout(function(){_this.visible=false;_this.removeClass("vjs-notify-flash");_this.addClass("vjs-hidden")},3500)}}));var MenuItem=vjs.getComponent("MenuItem");vjs.registerComponent("MenuItemLink",vjs.extend(MenuItem,{createEl:function(type,props){var prot=MenuItem.prototype;var label=this.localize(this.options_.label);var el=prot.createEl.call(this,"li",vjs_merge({className:"vjs-menu-item vjs-menu-item-link",innerHTML:""},props));this.link=Component.prototype.createEl("a",{className:"vjs-menu-link",innerHTML:label},{target:"_blank",href:this.options_.href||"#"});el.appendChild(this.link);return el},handleClick:function(e){e.stopPropagation()}}));var MenuItemLink=vjs.getComponent("MenuItemLink");vjs.registerComponent("ReportButton",vjs.extend(MenuItem,{constructor:function(player,options){MenuItem.call(this,player,options);var player_=player;this.on("click",function(){player_.trigger({type:"problem_report"});var overlay;if(overlay=player.getChild("NotifyOverlay"))overlay.flash();this.selected(false)})},is_visible:is_wrapper_attached}));var ReportButton=vjs.getComponent("ReportButton");vjs.registerComponent("LogButton",vjs.extend(MenuItem,{constructor:function(player,options){MenuItem.call(this,player,options);var player_=player;this.on("click",function(){player_.trigger({type:"save_logs"});this.selected(false)})},is_visible:is_wrapper_attached}));var LogButton=vjs.getComponent("LogButton");vjs.registerComponent("GraphButton",vjs.extend(MenuItem,{constructor:function(player,options){MenuItem.call(this,player,options);var player_=player;this.on("click",function(){player_.trigger({type:"cdn_graph_overlay"});this.selected(false)})},is_visible:is_wrapper_attached.bind(null,true)}));var GraphButton=vjs.getComponent("GraphButton");vjs.registerComponent("CopyLogButton",vjs.extend(MenuItem,{constructor:function(player,options){MenuItem.call(this,player,options);var player_=player;this.clipboard=new Clipboard(this.el_,{text:function(){if(!player_.hola_logs)return"Can't find hola_logs method!";return player_.hola_logs()}})},dispose:function(){this.clipboard.destroy();MenuItem.prototype.dispose.call(this)},is_visible:is_wrapper_attached}));var CopyLogButton=vjs.getComponent("CopyLogButton");vjs.registerComponent("InfoButton",vjs.extend(MenuItem,{constructor:function(player,options){MenuItem.call(this,player,options);this.on("click",function(){var overlay;if(overlay=player.getChild("InfoOverlay"))overlay.toggle(this)})}}));var InfoButton=vjs.getComponent("InfoButton");vjs.registerComponent("MenuLabel",vjs.extend(Component,{createEl:function(type,props){var prot=Component.prototype;return prot.createEl.call(this,"li",vjs_merge({className:"vjs-menu-item vjs-menu-label",innerHTML:this.options_.label},props))}}));var MenuLabel=vjs.getComponent("MenuLabel");vjs.registerComponent("QualityButton",vjs.extend(MenuItem,{constructor:function(player,options){options=vjs_merge({selectable:true},options);MenuItem.call(this,player,options);if(options["default"])this.player_.src(options.src)},is_current_src:function(){var player=this.player_;var current_src=player.cache_.src;var hola=window.hola_cdn;var hola_player=hola&&hola.get_player?hola.get_player():null;if(hola_player&&hola_player.vjs===player)current_src=hola_player.get_url();return this.options_.src==current_src},handleClick:function(){var player=this.player_;var quality=this.options_;var level_id=this.options_.level_id;if(player.techName_!=="Html5"&&level_id===undefined)return;var event=new window.CustomEvent("beforeresolutionchange");player.trigger(event,quality);if(event.defaultPrevented)return;if(level_id!==undefined){if(this.options_.callback)this.options_.callback(level_id);player.trigger("resolutionchange");return this}if(this.is_current_src()){player.trigger("resolutionchange");return this}var current_time=player.currentTime();var remain_paused=player.paused();player.pause();player.src(quality.src);player.ready(function(){player.one("loadeddata",vjs.bind(this,function(){this.currentTime(current_time)}));player.trigger("resolutionchange");if(!remain_paused){player.load();player.play()}})}}));var QualityButton=vjs.getComponent("QualityButton");vjs.plugin("settings",function(opt){var video=this;if(opt===undefined||opt===true)opt={info:true,report:true,quality:false};opt=vjs.mergeOptions({},opt);video.ready(function(){function local_storage_set(key,value){try{vjs.utils.localStorage.setItem(key,value)}catch(e){}}function local_storage_get(key){try{return vjs.utils.localStorage.getItem(key)}catch(e){return null}}function sources_normalize(sources,label_sav){var i,source_def,source_sav;sources=sources.filter(function(e){return e.src});for(i=0;i<sources.length;i+=1){if(!sources[i].label)sources[i].label=sources[i].type;if(!source_def&&sources[i]["default"]!==undefined)source_def=sources[i];if(label_sav&&label_sav==sources[i].label&&sources[i]["prevent-default"]===undefined){source_sav=sources[i]}}for(i=0;i<sources.length;i+=1){sources[i]["default"]=source_sav?sources[i]===source_sav:source_def?sources[i]===source_def:!i}return sources}function add_settings_button(){return video.controlBar.addChild("SettingsButton",vjs.mergeOptions({},opt))}var is_hls_provider=video.tech_.flashlsProvider||video.tech_.hlsProvider;if(opt.quality&&!is_hls_provider){var quality_key="vjs5_quality";if(opt.quality===true)opt.quality={sources:video.options_.sources};opt.quality.sources=sources_normalize(opt.quality.sources,local_storage_get(quality_key));video.on("resolutionchange",function(){var sources=opt.quality.sources;for(var i=0;i<sources.length;i++){if(video.currentSrc()!=sources[i].src)continue;local_storage_set(quality_key,sources[i].label);break}})}var settings_button;if(opt.quality&&opt.quality.sources&&opt.quality.sources.length>1)settings_button=add_settings_button();if(opt.quality&&is_hls_provider){video.tech_.on("loadedqualitydata",function(e,data){var sources=data&&data.quality&&data.quality.list||[];if(sources.length<2)return;if(!settings_button)settings_button=add_settings_button();settings_button.updateQuality(data)})}if(opt.info){video.addChild("InfoOverlay",{}).addClass("vjs-hidden")}if(opt.report){video.addChild("NotifyOverlay",{"class":"vjs-notify-overlay"}).addClass("vjs-hidden")}if(opt.volume||opt.volume===undefined){var volume_key="vjs5_volume",mute_key="vjs5_mute";var volume=vjs.mergeOptions({level:1,mute:false},opt.volume);video.ready(function(){if(!volume.override_local_storage){var ls_level,ls_mute;if((ls_level=local_storage_get(volume_key))!=null)volume.level=ls_level;if((ls_mute=local_storage_get(mute_key))!=null)volume.mute=ls_mute=="true"}video.volume(volume.level);video.muted(volume.mute)});video.on("volumechange",function(){local_storage_set(volume_key,video.volume());local_storage_set(mute_key,video.muted())})}var menu=video.addChild("PopupMenu",vjs.mergeOptions({},opt));video.on("hola.wrapper_attached",menu.check_items.bind(menu));video.on("hola.wrapper_detached",menu.check_items.bind(menu))})})})(window,window.videojs)},{"@hola.org/videojs-utils":1,clipboard:3}]},{},[10]);return{}});
require(["/svc/cdn/pub/config.js","jquery","/svc/cdn/pub/util.js","/svc/cdn/pub/log.js","/util/conv.js","/svc/cdn/pub/hls.js","vjs5_10","videojs5-osmf","videojs-thumbnails","videojs-hola-skin","videojs-settings"],function(config,$,util,_log,conv,hls,vjs5){var assign=Object.assign;var is_debug;_log.type="hola_vjs5_10";var log=_log.set_module("player");try{is_debug=+localStorage.getItem("hola_player_dbg")}catch(err){}function debug_log(s){if(!is_debug)return;log.notice(s)}var inited;function init(){if(inited)return;inited=true;add_cdn_loader();$(".vjs-styles-defaults").remove();init_player();debug_log("Loading config...")}var zdot_json=conv.JSON_parse(require.zdot("json"))||{};var player_conf=zdot_json.gen.player||{};var cdn_loaded,on_cdnload;function add_cdn_loader(){var customer=zdot_json.customer;if(!customer)return;if(util.dom_query('script[src*="//player.h-cdn.com/loader"]')){log.warn("Hola loader.js is included with Hola Player. There is "+"no need to load it separately");return}debug_log("Adding CDN loader...");util.load_script("//player.h-cdn.com/loader.js?customer="+customer,function(){cdn_loaded=true;if(on_cdnload)on_cdnload()},{async:true,crossOrigin:"anonymous"})}var on_init;function init_player(){debug_log("Init player..."+require.zdot("version"));var E={};E.init=function(opt,cb){if(typeof opt=="function"){cb=opt;opt={}}opt=opt||{};attach_videojs_hola_flashls_provider(window,vjs5);attach_videojs_hola_hls_provider(window,vjs5,hls);if(player_conf.brightcove&&opt.video_id&&!opt.sources){debug_log("fetching from brightcove...");var bc_opts=assign({video_id:opt.video_id},player_conf.brightcove);return util.services.brightcove(bc_opts,function(sources){E.init(assign(opt,{sources:sources}),cb)})}debug_log("vjs5 init...");if(opt.conf)util.init(opt.conf);if(opt.cdn_onload){if(cdn_loaded)opt.cdn_onload();else on_cdnload=opt.cdn_onload}var element=opt.player?$(opt.player)[0]:util.dom_query("video, object, embed");if($(element).is("div")||$(element).is("object")){var $video=$("<video>",{id:"__hola_player_unique_id__","class":"video-js",preload:opt.preload||"auto",poster:opt.poster});opt.player="#"+$video.attr("id");var sources=opt.sources;if(!(opt.video_url||sources&&sources.length)){return cb&&cb(null)}if(sources&&sources.length){sources=sources.map(function(source){var url=source.src||source.file;return{src:url,type:source.type||util.guess_link_type(url)}})}else{sources=[{src:opt.video_url,type:opt.video_type||util.guess_link_type(opt.video_url)}]}$video.append(sources.map(function(source){return $("<source>",source)}));var position=$(element).css("position");$video.css({position:position=="static"?"relative":position,left:$(element).css("left"),top:$(element).css("top")}).attr({width:opt.width||$(element).width(),height:opt.height||$(element).height()}).insertAfter(element);$(element).hide();element=$video[0]}if($(element).is("video")){element.controls=false;if(!opt.sources){opt.sources=$(element).find("source").map(function(){var source=$(this);return{src:source.attr("src"),type:source.attr("type"),label:source.attr("label"),"default":!!source.attr("default")}}).get()}$(element).removeAttr("data-setup");reset_native_hls(element,opt.sources)}E.init_ui(element,opt,function(){init_vjs(element,opt,cb)})};function init_vjs(element,opt,cb){var tech_order=opt.tech=="flash"?["flash","html5"]:["html5","flash"];tech_order.push("osmf");var vjs_opt={osmf:{swf:config.swf_urls.videojs5_osmf},flash:{swf:config.swf_urls.videojs5_10,accelerated:util.conf_get("player.flash.accelerated")},html5:{hlsjsConfig:Object.assign(!opt.withCredentials?{}:{xhrSetup:function(xhr){xhr.withCredentials=true}},util.def_hola_hls_config())},inactivityTimeout:opt.inactivity_timeout===undefined?2e3:opt.inactivity_timeout,autoplay:opt.auto_play,techOrder:tech_order,tooltips:true,plugins:{settings:false,hola_skin:opt.skin?false:{css:config.css_urls.hola_skin,no_play_transform:opt.no_play_transform,show_controls_before_start:opt.show_controls_before_start}}};if(opt.poster)vjs_opt.poster=opt.poster;if(opt.sources)vjs_opt.sources=opt.sources;else if(opt.video_url){vjs_opt.sources=[{src:opt.video_url,type:opt.video_type||util.guess_link_type(opt.video_url)}]}var settings_options=player_conf.settings!=null?player_conf.settings:util.conf_get("player.settings");if(settings_options===undefined||settings_options===true)settings_options={info:true,report:true};if(settings_options!==false){if(settings_options.quality||settings_options.quality===undefined)settings_options.quality={sources:vjs_opt.sources||[]};settings_options.graph=opt.graph;settings_options.volume=opt.volume;vjs_opt.plugins.settings=settings_options}debug_log("init_vjs");var play_fired=false;vjs5(element,vjs_opt,function(){var player=this;debug_log("vjs5 inited! using tech: "+player.techName_);player.controls(true);player.controlBar.show();if(opt.thumbnails)player.thumbnails(opt.thumbnails);player.on("play",function(){play_fired=true;player.bigPlayButton.hide()}).on("pause",function(e){if(player.scrubbing())e.stopImmediatePropagation();if(opt.big_pause_btn)player.bigPlayButton.show()}).on("ended",function(){if(player.ads&&player.ads.state=="content-playback")return void debug_log("contentended");player.posterImage.show();player.bigPlayButton.show();if(!player.paused())player.pause();player.currentTime(0)}).on("problem_report",function(e){var player_logs=e&&e.data;if(player_logs===undefined){e.stopImmediatePropagation();player.trigger({type:"problem_report",data:_log.get_logs()||[""]})}}).on("cdn_graph_overlay",function(e){var hola_cdn=window.hola_cdn;var bws=hola_cdn&&hola_cdn._get_bws();if(window.cdn_graph||!bws||hola_cdn._get_mode()!="cdn")return;try{var ldr=hola_cdn.get_wrapper().loader;var gopt={graph:"newgraph_progress_mode_highlight_tips",player_obj:bws.player,video:bws.player.vjs};var url="//player.h-cdn.com"+require.zdot("cdngraph_js");ldr.util.load_script(url,function(){window.cdn_graph.init(gopt,bws,ldr)})}catch(err){log.err(err.stack||err)}}).on("save_logs",function(e){var player_logs=e&&e.data;if(player_logs===undefined){e.stopImmediatePropagation();player.trigger({type:"save_logs",data:_log.get_logs()||[""]})}});if(player_conf.play_on_seek)player.on("seeked",function(){player.play()});if(cb)try{cb(player)}catch(e){log.err(e.stack||e)}setTimeout(function(){if(!player.paused()&&!play_fired)player.trigger("play")},0)})}function add_css(url,onload){var link=document.createElement("link");link.setAttribute("rel","stylesheet");link.setAttribute("href",url);link.onload=onload;document.getElementsByTagName("head")[0].appendChild(link)}E.init_ui=function(element,opt,cb){var css=config.css_urls.videojs;var skin;if(opt.skin&&element){skin=opt.skin;debug_log("apply skin",skin);var filename=skin+".min";$(element).addClass(skin);add_css(css,function(){add_css("//player.h-cdn.com/css/"+filename+".css?"+require.zdot("qs_ver"),cb)})}else{debug_log("apply default skin");add_css(css,cb)}if(opt.thumbnails)add_css(config.css_urls.thumbnails)};if(on_init){debug_log("Player inited!");on_init(E)}else{debug_log("Waiting for player init.");window.hola_player=function(cb){return cb&&cb(E)}}}window.hola_player=function(cb){on_init=cb};init();var hlsTypeRE=/^application\/(vnd\.apple\.|x-)mpegurl$/i;var hlsExtRE=/\.m3u8/i;function attach_videojs_hola_hls_provider(window,videojs,Hls){function HolaProviderHLS(source,tech){tech.name_="holaHLS";var _video=tech.el(),_hls,is_live;this.duration=function(){return is_live?Infinity:_video.duration||0};this.dispose=function(){_hls.destroy()};_hls=new Hls(tech.options_.hlsjsConfig||{});tech.hls_obj=_hls;_hls.manual_level=-1;_hls.on(Hls.Events.LEVEL_LOADED,function(event,data){is_live=data.details.live});_hls.on(Hls.Events.LEVEL_SWITCH,update_quality);function level_switch(id){_hls.manual_level=id;if(_hls.hola_adaptive){(_video.player||videojs.getPlayers()[_video.playerId]).trigger("mediachange")}else _hls.loadLevel=id;update_quality()}function level_label(level){if(level.height)return level.height+"p";if(level.width)return Math.round(level.width*9/16)+"p";if(level.bitrate)return conv.scaled_number(level.bitrate,{base:1024})+"bps";return 0}function level_data(id,label){return{id:id,label:label}}function update_quality(){var list=[],levels=_hls.levels;if(levels.length>1)list.push(level_data(-1,"auto"));levels.forEach(function(level,index){list.push(level_data(index,level_label(level)))});tech.trigger("loadedqualitydata",{quality:{list:list,selected:_hls.manual_level,current:_hls.loadLevel},callback:level_switch})}_hls.attachMedia(_video);_hls.loadSource(source.src)}if(!Hls.isSupported||!Hls.isSupported())return void console.error("Hls.js is not supported in this browser!");videojs.getComponent("Html5").registerSourceHandler({canHandleSource:function(source){if(hlsTypeRE.test(source.type))return"probably";else if(hlsExtRE.test(source.src))return"maybe";return""},handleSource:function(source,tech){if(tech.hlsProvider)tech.hlsProvider.dispose();tech.hlsProvider=new HolaProviderHLS(source,tech);return tech.hlsProvider}},0);videojs.HolaProviderHLS=HolaProviderHLS}function attach_videojs_hola_flashls_provider(window,videojs){videojs.getComponent("Flash").registerSourceHandler({canHandleSource:function(source){if(hlsTypeRE.test(source.type))return"probably";else if(hlsExtRE.test(source.src))return"maybe";return""},handleSource:function(source,tech){tech.setSrc(source.src)}},0)}function reset_native_hls(el,sources){var is_hls=function(e){return util.get_video_type(e.src)=="hls"};if(!el.canPlayType("application/x-mpegurl")||!sources.some(is_hls))return;el.src="";el.load()}});define("/svc/cdn/pub/player_vjs5_10.js",function(){});

}());
//# sourceMappingURL=/player_vjs5_10.js?customer=demo&md5=1023721-11b03902&map=true